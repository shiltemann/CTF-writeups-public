---
layout: writeup
title: 'Dec 12: Crypt-o-Math'
level:
difficulty:
points:
categories: []
tags: []
flag: HV16-laWz-D5yT-0Uzb-DFj0-FIsL

---

## Challenge

*Crypto? Math? Maybe both?*

you remember math classes at school?

hopefully you payed attention - and even if not, there are other ways to
solve this challenge.

    -----BEGIN HV16 CHALLENGE-----
    m,b,p
    260492575707724061121829547730531689268,219331109722881671601619265628380637246,264919855316001119104226076800779561423
    177037883108301921298501682022541052670,139010999389216475313896172223515984938,320424365363679773525372180610490277297
    201530751445587644733838605908487065258,156283960365344379794603462644218812025,260817421396746284411005790925469586671
    243507266865305317073588348849175479231,228672633794460367905186619683512549913,311961837617653522368820984616392093801
    235979373536480839808082706396503872744,193357134507240975900584464141934560197,272109227670221371468387040437351965901
    230551569853098007600677345727280344755,287930781315318970473254677546577038359,267938315516895485484707051396200706443
    243574932572443222972750303823800502163,301120142698243924290763614435454565780,298644815229643145404450351035804160241
    227879528304283891530899499744980291425,259647428751561260984852593239590962832,269635859822490692863508746527322139429
    193780289185955117334123511554895799539,230518059194860774985531587526031582924,207593226880414101384701594893426311937
    195425447990038725090924967791915486200,211074736770197591575170253798012315012,268179617336236355437933191393015865423
    182160695615960388203641943769582257756,226052690185182197055109796183513576908,206467790630567275126889799309355179359
    270365608703884312725165910007312396490,213419845252996446560398094913250521674,324158008615298179424325819513870548587
    201137118708843924452456973486310609161,159816376238003107002192693657105630045,290037217831618223964293971372160917859
    173038113384777542289872672569239525188,189558894159177271916644208007912631998,183921485447992361971839173200969564297
    203079462849536394511816713024005910404,265255113893859933710071781082768935284,214860441818087898101519465166073705553
    175435955454496700514946039667711586185,321302129754052602637931061925096198926,176882035352883165226937995777991718197
    200701714682593432395729715130128082931,240366172083509768840032993181552166546,262938198945065824235502495190974734479
    299752902236935158362307014205359355636,235711956783855914923056820687273121476,332555996220370247549433065033032955347
    215902963387633985679795544753434436743,271635699405692295953353834140161222963,234686602415496986215568540582391915559
    205034325176731455396463659428717818520,272071326791294957481838950480920388378,206409649750015144058460651952033121471
    186202058515529112089774144624697652752,254056783751113612320599805874190538383,203950808577618100941828939328974427763
    287901749499474956286121649902808545796,182193516067311697257425115832952178725,310661715406253093730218700854274682783
    188797174721730846063832466557549096934,204289631640363328059573883403131553162,202398097602736311826665715995283701469
    173276488624612107075891981111532248427,143340215883386310219352729908142093188,310272112653851647580237588097526878451
    300899937001700644581647299928269672025,333680929290782211826332325236347007941,313491113294105066840003438756384124923
    179363152345949876980223861387117154037,192660289980311571512766813788452507319,191173487237342005980035033206582186319
    274297779066581320003362916911839787292,230968818301666954768423827202499074222,280249595392717543321356899242915413241
    173512792712172909456131993539106342879,276670255129140880258696821649524107343,176080436791985260266403840744627297429
    217267141898619422837859646397422811530,192415481924499182031594124394175595334,261771203728758901533499406756951694139
    m = a * 0x1337 * b % p
    a=flag
    -----END HV16 CHALLENGE-----

## Solution

Seems clear we would need to find `a` for each set of `(m,b,p)`, since
there are 29 such tuples, it is safe to assume
each encodes one letter of the flag.

There is surely a direct way to compute this, but my modular arithmetic
is a bit rusty, so just going to bruteforce it:

    cts=[[260492575707724061121829547730531689268,219331109722881671601619265628380637246,264919855316001119104226076800779561423],
    [177037883108301921298501682022541052670,139010999389216475313896172223515984938,320424365363679773525372180610490277297],
    [201530751445587644733838605908487065258,156283960365344379794603462644218812025,260817421396746284411005790925469586671],
    [243507266865305317073588348849175479231,228672633794460367905186619683512549913,311961837617653522368820984616392093801],
    [235979373536480839808082706396503872744,193357134507240975900584464141934560197,272109227670221371468387040437351965901],
    [230551569853098007600677345727280344755,287930781315318970473254677546577038359,267938315516895485484707051396200706443],
    [243574932572443222972750303823800502163,301120142698243924290763614435454565780,298644815229643145404450351035804160241],
    [227879528304283891530899499744980291425,259647428751561260984852593239590962832,269635859822490692863508746527322139429],
    [193780289185955117334123511554895799539,230518059194860774985531587526031582924,207593226880414101384701594893426311937],
    [195425447990038725090924967791915486200,211074736770197591575170253798012315012,268179617336236355437933191393015865423],
    [182160695615960388203641943769582257756,226052690185182197055109796183513576908,206467790630567275126889799309355179359],
    [270365608703884312725165910007312396490,213419845252996446560398094913250521674,324158008615298179424325819513870548587],
    [201137118708843924452456973486310609161,159816376238003107002192693657105630045,290037217831618223964293971372160917859],
    [173038113384777542289872672569239525188,189558894159177271916644208007912631998,183921485447992361971839173200969564297],
    [203079462849536394511816713024005910404,265255113893859933710071781082768935284,214860441818087898101519465166073705553],
    [175435955454496700514946039667711586185,321302129754052602637931061925096198926,176882035352883165226937995777991718197],
    [200701714682593432395729715130128082931,240366172083509768840032993181552166546,262938198945065824235502495190974734479],
    [299752902236935158362307014205359355636,235711956783855914923056820687273121476,332555996220370247549433065033032955347],
    [215902963387633985679795544753434436743,271635699405692295953353834140161222963,234686602415496986215568540582391915559],
    [205034325176731455396463659428717818520,272071326791294957481838950480920388378,206409649750015144058460651952033121471],
    [186202058515529112089774144624697652752,254056783751113612320599805874190538383,203950808577618100941828939328974427763],
    [287901749499474956286121649902808545796,182193516067311697257425115832952178725,310661715406253093730218700854274682783],
    [188797174721730846063832466557549096934,204289631640363328059573883403131553162,202398097602736311826665715995283701469],
    [173276488624612107075891981111532248427,143340215883386310219352729908142093188,310272112653851647580237588097526878451],
    [300899937001700644581647299928269672025,333680929290782211826332325236347007941,313491113294105066840003438756384124923],
    [179363152345949876980223861387117154037,192660289980311571512766813788452507319,191173487237342005980035033206582186319],
    [274297779066581320003362916911839787292,230968818301666954768423827202499074222,280249595392717543321356899242915413241],
    [173512792712172909456131993539106342879,276670255129140880258696821649524107343,176080436791985260266403840744627297429],
    [217267141898619422837859646397422811530,192415481924499182031594124394175595334,261771203728758901533499406756951694139]]

    alphabet="-ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuwyz0123456789"

    pt=''
    for (m,b,p) in cts:
        for c in alphabet:
            if (ord(c)*0x1337*b)%p == m:
                pt += c
    print pt
{: .language-python}

This spits out our nugget :)


