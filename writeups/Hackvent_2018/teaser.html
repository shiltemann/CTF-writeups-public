<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Teaser" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups by team Galaxians." /><meta property="og:description" content="A set of CTF writeups by team Galaxians." /><link rel="canonical" href="https://shiltemann.github.io/CTF-writeups-public/writeups/Hackvent_2018/teaser.html" /><meta property="og:url" content="https://shiltemann.github.io/CTF-writeups-public/writeups/Hackvent_2018/teaser.html" /><meta property="og:site_name" content="Galaxians CTF" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Teaser" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","dateModified":"2023-05-17T20:19:52+02:00","description":"A set of CTF writeups by team Galaxians.","headline":"Teaser","url":"https://shiltemann.github.io/CTF-writeups-public/writeups/Hackvent_2018/teaser.html"}</script><title> Galaxians CTF | Teaser</title><link rel="apple-touch-icon" sizes="180x180" href="/CTF-writeups-public/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/CTF-writeups-public/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/CTF-writeups-public/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/CTF-writeups-public/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/CTF-writeups-public/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Galaxians CTF"><meta name="application-name" content="Galaxians CTF"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/CTF-writeups-public/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/CTF-writeups-public/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/CTF-writeups-public/" class="mx-auto"> <img src="/CTF-writeups-public/assets/img/galaxians-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/CTF-writeups-public/">Galaxians CTF</a></div><div class="site-subtitle font-italic">Galactic Girlfiends Hack the Universe!</div></div><ul class="w-100"><li class="nav-item"> <a href="/CTF-writeups-public/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/posts/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/shiltemann" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['galaxians','galaxians.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/CTF-writeups-public/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/CTF-writeups-public/"> Home </a> </span> <span><a href="/CTF-writeups-public/writeups/Hackvent_2018/">Hackvent 2018</a></span> <span>Teaser</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Writeup</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> Teaser</h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img src="writeupfiles/Teaser.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><em>Stage 1</em></p><p>The image contains braille code. We translate it to <code class="language-plaintext highlighter-rouge">http://bit.ly/2TJvxHt</code>, which leads us the following image:</p><p><img src="writeupfiles/teaser/Flag_Stage_1.png" alt="" /></p><p>this QR decodes to <code class="language-plaintext highlighter-rouge">Rushed by ..</code></p><p>It turns out the bit.ly link actually translated to <code class="language-plaintext highlighter-rouge">https://hackvent.hacking-lab.com/T34s3r_MMXVIII/index.php?flag=UI18-GAUa-lXhq-htyV-w2Wr-0yiV</code> but redirected. The <code class="language-plaintext highlighter-rouge">flag</code> parameter when ROT13’d gives us the first flag: <code class="language-plaintext highlighter-rouge">HV18-TNHn-yKud-uglI-j2Je-0lvI</code></p><p>When we fill in the correct flag in the url, we get to the next stage: <code class="language-plaintext highlighter-rouge">https://hackvent.hacking-lab.com/T34s3r_MMXVIII/index.php?flag=HV18-TNHn-yKud-uglI-j2Je-0lvI</code>, which redirects to <code class="language-plaintext highlighter-rouge">https://hackvent.hacking-lab.com/T34s3r_MMXVIII/ZOoxjUSe1OVB7OPoVrsX.pdf</code></p><p><a href="writeupfiles/teaser/stage2.pdf">pdf file</a></p><p>Ok, there is lots here, lets get all the elements of the pdf with http://extractpdf.com</p><p><em>Stage 2</em></p><p>We find some Morse code text in the pdf:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>HACKvent 2018

.... ...- .---- ---.. -....- --. --- .-. .. -....- --.. .-. ... -... -....- ..- ..-. .- . -....- - ... -.... -.-. -....- -.-. ...- - -
</pre></table></code></div></div><p>this decodes to: <code class="language-plaintext highlighter-rouge">HV18-GORI-ZRSB-UFAE-TS6C-CVTT</code>, which is our second flag</p><p><em>Stage 3</em></p><p>We also find some images in the pdf:</p><p><img src="writeupfiles/teaser/stage2-banner.jpeg" alt="" /><br /> <img src="writeupfiles/teaser/stage2-ball.jpeg" alt="" /><br /> <img src="writeupfiles/teaser/stage2-stereogram.png" alt="" /></p><p>The stereogram image can be decoded <a href="http://magiceye.ecksdee.co.uk/">here</a> and gives:</p><p><img src="writeupfiles/teaser/stereogram-decoded.png" alt="" /></p><p>we clean it up a bit with GIMP so that we can scan it:</p><p><img src="writeupfiles/teaser/stereogram-decoded-cleaned.png" alt="" /></p><p>and this is our 3rd flag: <code class="language-plaintext highlighter-rouge">HV18-p2LK-DNcI-YKw7-T9Ad-mH3v</code></p><p><em>Stage 4</em></p><p>Next, we try binwalk on the pdf:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="nv">$ </span>binwalk stage2.pdf
DECIMAL       HEXADECIMAL     DESCRIPTION
<span class="nt">--------------------------------------------------------------------------------</span>
0             0x0             PDF document, version: <span class="s2">"1.7"</span>
404           0x194           Unix path: /PDF/Text/ImageB/ImageC/ImageI] <span class="o">&gt;&gt;</span>/MediaBox[ 0 0 595.32 841.92] /Contents 4 0 R/Group&lt;&lt;/Type/Group/S/Transparency/CS/DeviceRGB&gt;&gt;
621           0x26D           Zlib compressed data, default compression
1751          0x6D7           Unix path: /Type/XObject/Subtype/Image/Width 1000/Height 340/ColorSpace/DeviceRGB/BitsPerComponent 8/Filter/DCTDecode/Interpolate <span class="nb">true</span>/Leng
1899          0x76B           JPEG image data, JFIF standard 1.01
1929          0x789           TIFF image data, big-endian, offset of first image directory: 8
51778         0xCA42          Unix path: /Type/ExtGState/BM/Normal/ca 1&gt;&gt;
51831         0xCA77          Unix path: /Type/Font/Subtype/TrueType/Name/F1/BaseFont/BCDEEE+Calibri/Encoding/WinAnsiEncoding/FontDescriptor 8 0 R/FirstChar 32/LastChar
51998         0xCB1E          Unix path: /Type/FontDescriptor/FontName/BCDEEE+Calibri/Flags 32/ItalicAngle 0/Ascent 750/Descent <span class="nt">-250</span>/CapHeight 750/AvgWidth 521/MaxWidth
52237         0xCC0D          Unix path: /Type/ExtGState/BM/Normal/CA 1&gt;&gt;
52291         0xCC43          Unix path: /Type/XObject/Subtype/Image/Width 781/Height 781/ColorSpace/DeviceRGB/BitsPerComponent 8/Interpolate <span class="nb">false</span>/Filter/FlateDecode/Le
52442         0xCCDA          Zlib compressed data, default compression
187860        0x2DDD4         Unix path: /Type/Font/Subtype/TrueType/Name/F2/BaseFont/BCDFEE+Arial-Black/Encoding/WinAnsiEncoding/FontDescriptor 12 0 R/FirstChar 32/Last
188034        0x2DE82         Unix path: /Type/FontDescriptor/FontName/BCDFEE+Arial-Black/Flags 32/ItalicAngle 0/Ascent 1101/Descent <span class="nt">-212</span>/CapHeight 716/AvgWidth 552/MaxW
188279        0x2DF77         Unix path: /Type/Font/Subtype/TrueType/Name/F3/BaseFont/TimesNewRomanPS-BoldMT/Encoding/WinAnsiEncoding/FontDescriptor 14 0 R/FirstChar 32/
188456        0x2E028         Unix path: /Type/FontDescriptor/FontName/TimesNewRomanPS-BoldMT/Flags 32/ItalicAngle 0/Ascent 891/Descent <span class="nt">-216</span>/CapHeight 677/AvgWidth 427/M
188698        0x2E11A         Unix path: /Type/XObject/Subtype/Image/Width 200/Height 200/ColorSpace/DeviceRGB/BitsPerComponent 8/Filter/DCTDecode/Interpolate <span class="nb">true</span>/Lengt
188844        0x2E1AC         JPEG image data, JFIF standard 1.01
188874        0x2E1CA         TIFF image data, big-endian, offset of first image directory: 8
195577        0x2FBF9         Zlib compressed data, default compression
196145        0x2FE31         Zlib compressed data, default compression
215877        0x34B45         Zlib compressed data, default compression
231310        0x3878E         Unix path: /Type/Metadata/Subtype/XML/Length 3075&gt;&gt;
231494        0x38846         Unix path: /www.w3.org/1999/02/22-rdf-syntax-ns#<span class="s2">"&gt;
231734        0x38936         Unix path: /purl.org/dc/elements/1.1/"</span><span class="o">&gt;</span>
232171        0x38AEB         Unix path: /ns.adobe.com/xap/1.0/mm/<span class="s2">"&gt;
234681        0x394B9         Zlib compressed data, default compression
236069        0x39A25         RAR archive data, first volume type: MAIN_HEAD
236135        0x39A67         Zip archive data, encrypted at least v2.0 to extract, compressed size: 210390, uncompressed size: 210378, name: z.zip
446647        0x6D0B7         End of Zip archive

# we see there are files appended, we extract with:
</span><span class="nv">$ </span><span class="s2">binwalk -e stage2.pdf
</span></pre></table></code></div></div><p>Reveals an <a href="writeupfiles/teaser/_stage2.pdf.extracted/Final_easy.zip">encrypted zip file</a></p><p>TODO</p><p><em>Stage 5</em></p><p>The zip file also contained this QR code image:</p><p><img src="writeupfiles/teaser/_stage2.pdf.extracted/QR3C.png" alt="" /></p><p>Which looks suspiciously like a challenge from HACKvent 2015, my writeup <a href="https://github.com/shiltemann/CTF-writeups-galaxians/tree/master/Hackvent_2015#dec-17-santas-quick-response">here</a></p><p>Extracting these to their component channels:</p><p><img src="writeupfiles/QR3C_r.png" alt="" /><br /> <img src="writeupfiles/QR3C_g.png" alt="" /><br /> <img src="writeupfiles/QR3C_b.png" alt="" /></p><p>These won’t scan on their own, because they are missing timing and masking areas, but a lot of the information is there. We use <a href="https://merricx.github.io/qrazybox/">QRazyBox</a> to restore these missing pieces and are able to find our flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>red:   HV18-3I5a-
green: Rnrl-s28r-
blue:  SRHj-Lhzx
</pre></table></code></div></div><p>So our complete flag is:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>HV18-3I5a-Rnrl-s28r-SRHj-Lhzx
</pre></table></code></div></div><p><em>Stage 6</em></p><p>The zip file also contained a <a href="writeupfiles/teaser/_stage2.pdf.extracted/Santa.txt">Santa.txt</a> file:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>Santa has caught up with the information age and does not trust
clear-text commands anymore.
He has decided that all communications
have to be encrypted to prevent an unfriendly take-over of his team.
Santa chooses a simple, secure, and toolless encryption scheme.
However, his team's memory capacity is limited and so he can only use
their names (Dasher, Dancer, Prancer, Vixen, Comet, Cupid, Donder and
Blitzen) as keys.



Where is the team headed to?

STTYN YATLOEP DNEA ONBL TGNTO MHEHH EISTIARIB FHSRA LD IIONA NL HERUV LN17-PTAA-RTON-RDOE-MCTN-AHCO
</pre></table></code></div></div><p>TODO</p><p><em>Stage 7</em></p><p>The zip file also contained the following image:</p><p><img src="writeupfiles/teaser/_stage2.pdf.extracted/old_school.jpg" alt="" /></p><p>This appears to be an IBM-029 punch card by the faint lettering on the right.<br /> Fortunately <a href="https://en.wikipedia.org/wiki/Keypunch#IBM_029_Card_Punch">wikipedia</a><br /> has a full translation of that format:</p><p><img src="writeupfiles/Blue-punch-card-front-horiz_top-char-contrast-stretched.png" alt="" /></p><p>I’m arbitrarily going to number the colums to be -2, -1, 0 (the row of 0s), 1 .. 9 because that makes sense to me?</p><div class="table-wrapper"><table><thead><tr><th>Column<th>Values<tbody><tr><td>1<td>6, -1<tr><td>2<td>2<tr><td>3<td>9 0<tr><td>4<td>-1<tr><td>5<td>-2 8<tr><td>6<td>4<tr><td>7<td>7 -1<tr><td>8<td>1 -2<tr><td>9<td>3 -1<tr><td>10<td>5<tr><td>11<td>2<tr><td>12<td>90<tr><td>13<td>4<tr><td>14<td>-1<tr><td>15<td>3<tr><td>16<td>6 -2<tr><td>17<td>1<tr><td>18<td>9<tr><td>19<td>-1<tr><td>20<td>-2 8<tr><td>21<td>0 5<tr><td>22<td>1<tr><td>23<td>8<tr><td>24<td>-1<tr><td>25<td>0<tr><td>26<td>3 -1<tr><td>27<td>4 -2<tr><td>28<td>-1 3 8<tr><td>29<td>-1<tr><td>30<td>0 2<tr><td>31<td>-2 3<tr><td>32<td>-2 8<tr><td>33<td>0<tr><td>34<td>-1<tr><td>35<td>0<tr><td>36<td>-1 3<tr><td>37<td>1<tr><td>38<td>0 2<tr><td>39<td>-1<tr><td>40<td>4<tr><td>41<td>0 6<tr><td>42<td>3<tr><td>43<td>02<tr><td>44<td>-1<tr><td>45<td>0<tr><td>46<td>-1 4<tr><td>47<td>3<tr><td>48<td>8 2 -1<tr><td>49<td>-1<tr><td>50<td>3<tr><td>51<td>1<tr><td>52<td>2<tr><td>53<td>4 6<tr><td>54<td>-1<tr><td>55<td>-2 8<tr><td>56<td>9 0<tr><td>57<td>3<tr><td>58<td>3 -2<tr><td>59<td>-1<tr><td>60<td>5<tr><td>61<td>2 4<tr><td>62<td>1<tr><td>63<td>-1 2<tr><td>64<td>-1<tr><td>65<td>-2 3<tr><td>66<td>3<tr><td>67<td>-2 0 2 8<tr><td>68<td>_<tr><td>69<td>-1<tr><td>70<td>0 5<tr><td>71<td>0 9<tr><td>72<td>3<tr><td>73<td>0 6<tr><td>74<td>-1<tr><td>75<td>-2 3<tr><td>76<td>0 6<tr><td>77<td>0 2<tr><td>78<td>-2 3<tr><td>79<td>-1<tr><td>80<td>1</table></div><p>We then use the translation matrix we found to write a <a href="writeupfiles/ibm-029-decode.py">small python script</a><br /> Which will output the following when run:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>O2Z-H4PAL52¿4-3F19-HV18-0LD$-SCH0-0L1S-4W3S-0M3!-312¿-HZ3C-5¿1K-C3¿¿-VZ3W-CWSC-1¿
</pre></table></code></div></div><p>(¿ used when couldn’t identify a character correctly, maybe transcription mistakes by me.)<br /> But the flag is clearly visible in the center: <code class="language-plaintext highlighter-rouge">HV18-0LD$-SCH0-0L1S-4W3S-0M3!</code></p><p><em>Stage 8</em></p><p>The zip file also contained the file <a href="writeupfile/teaser/_stage2.pdf.extracted/teaser.pls">teaser.pls</a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre>CREATE OR REPLACE FUNCTION checkHV18teaser wrapped
a000000
b2
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
abcd
8
37f 22f
9bGsDUl+WXOiRvCg6f+CmODMp3UwgwIJ+txqfC9Dgz+VaPwOTWaoKj5jW2QUCQapzabE52vy
50h+W7xBf1NE2/Fa93pBwUJtOxLvz1WIU75VaGjqH5M6oL4/aHovVUteU3Arw0eLvVRDEvbd
0mLqbyd4kEtMnI76J3vuLaHC1mkYuwEN6bdmd3GQPBtHV4fWHr5OM5B81yX+kw0560LKdDx8
mVHJvc7y7vShjsCpFgEUd6sfN3ZbOkjjbg+AJSGuIjZzvT7vkQwM5wcQL73C6+BCiaaEG2ja
r+3zqCSk6QzcKvIwuBwXf9UHGL4YS47JO3EOmIPOy8VQYfY1M9g6UeieqOftVm/Pr8smR11r
UWM8kk1WTmMvY13s1Klpr7tFnzwjmnSnTP9Exz/dV5+cU3mlgyjqkAIsWnGqDGKMfVahOHSc
Bzalmd+HDxxBF39ymrsGHfBUv0gAPtnYVCVWiG0Q9ij5DbBffRrsx4uOYuAqJ4KwT5vNpKon
MSMAM3ZsIFVQgfnY/sfkB+jfGEuldGYiui7zvIMSHVDfPEE=

/
</pre></table></code></div></div><p>These are wrapped oracle functions and we can unwrap it using https://www.codecrete.net/UnwrapIt/</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">FUNCTION</span> <span class="n">checkHV18teaser</span><span class="p">(</span><span class="n">FLAG</span> <span class="n">VARCHAR2</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">NUMBER</span> <span class="k">IS</span>
<span class="n">A</span> <span class="n">VARCHAR2</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">B</span> <span class="n">NUMBER</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="k">C</span> <span class="n">NUMBER</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="n">H</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
<span class="k">BEGIN</span>
<span class="n">A</span> <span class="p">:</span><span class="o">=</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="s1">'HV18'</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">B</span> <span class="p">:</span><span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="k">C</span> <span class="p">:</span><span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(((</span><span class="n">B</span> <span class="o">*</span> <span class="k">C</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6497</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">B</span> <span class="o">&lt;</span> <span class="k">C</span><span class="p">))</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">A</span> <span class="p">:</span><span class="o">=</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="n">STANDARD_HASH</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">'MD5'</span><span class="p">)</span> <span class="k">INTO</span> <span class="n">H</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span><span class="n">H</span> <span class="o">=</span> <span class="s1">'CF945B5A36D1D3E68FFF78829CC8DBF6'</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">IF</span> <span class="k">NOT</span> <span class="p">((</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_VARCHAR2</span><span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">BIT_XOR</span> <span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span> <span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">4</span><span class="p">))))</span> <span class="o">=</span> <span class="s1">'zvru'</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="o">=</span> <span class="n">SQRT</span><span class="p">(</span><span class="mi">8814961</span><span class="p">)))</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span> <span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_VARCHAR2</span><span class="p">(</span><span class="n">UTL_ENCODE</span><span class="p">.</span><span class="n">BASE64_ENCODE</span><span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">4</span><span class="p">))))</span> <span class="o">=</span> <span class="s1">'RjBtMA=='</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">DBMS_OUTPUT</span><span class="p">.</span><span class="n">PUT_LINE</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="k">RETURN</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</pre></table></code></div></div><p>so this is the function that validates the flag, we reverse engineer it to find the flag. Next is the code again, with some comments:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="k">FUNCTION</span> <span class="n">checkHV18teaser</span><span class="p">(</span><span class="n">FLAG</span> <span class="n">VARCHAR2</span><span class="p">)</span> <span class="k">RETURN</span> <span class="n">NUMBER</span> <span class="k">IS</span>
<span class="n">A</span> <span class="n">VARCHAR2</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">B</span> <span class="n">NUMBER</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="k">C</span> <span class="n">NUMBER</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="n">H</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
<span class="k">BEGIN</span>

<span class="cm">/* flag starts with "HV18", no surprises there */</span>
<span class="n">A</span> <span class="p">:</span><span class="o">=</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="s1">'HV18'</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="cm">/* "7389"  (73 * 89 = 6497) */</span>
<span class="n">B</span> <span class="p">:</span><span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="k">C</span> <span class="p">:</span><span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(((</span><span class="n">B</span> <span class="o">*</span> <span class="k">C</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6497</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">B</span> <span class="o">&lt;</span> <span class="k">C</span><span class="p">))</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>


<span class="cm">/* "H0b0" has the required md5 hash (found via hashkiller.co.uk) */</span>
<span class="n">A</span> <span class="p">:</span><span class="o">=</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="k">SELECT</span> <span class="n">STANDARD_HASH</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">'MD5'</span><span class="p">)</span> <span class="k">INTO</span> <span class="n">H</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span><span class="n">H</span> <span class="o">=</span> <span class="s1">'CF945B5A36D1D3E68FFF78829CC8DBF6'</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="cm">/* next two segements when XOR'ed must make 'zvru', and
   second of the two segments is 2969 (square root of 8814961)
   "HODL-2969" */</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">((</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_VARCHAR2</span><span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">BIT_XOR</span> <span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span> <span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">4</span><span class="p">))))</span> <span class="o">=</span> <span class="s1">'zvru'</span><span class="p">)</span> <span class="k">AND</span> <span class="p">(</span><span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="o">=</span> <span class="n">SQRT</span><span class="p">(</span><span class="mi">8814961</span><span class="p">)))</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="cm">/* "F0m0" (last segment must match the given base64 string) */</span>
<span class="n">IF</span> <span class="k">NOT</span> <span class="p">(</span> <span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_VARCHAR2</span><span class="p">(</span><span class="n">UTL_ENCODE</span><span class="p">.</span><span class="n">BASE64_ENCODE</span><span class="p">(</span><span class="n">UTL_RAW</span><span class="p">.</span><span class="n">CAST_TO_RAW</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">FLAG</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">4</span><span class="p">))))</span> <span class="o">=</span> <span class="s1">'RjBtMA=='</span><span class="p">)</span> <span class="k">THEN</span>
  <span class="k">RETURN</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">END</span> <span class="n">IF</span><span class="p">;</span>

<span class="n">DBMS_OUTPUT</span><span class="p">.</span><span class="n">PUT_LINE</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="k">RETURN</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>HV18-7389-H0b0-HODL-2969-F0m0
</pre></table></code></div></div><h2> Flag</h2><code> </code></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/CTF-writeups-public/tag/image/">image</a> <a class="post-tag" href="/CTF-writeups-public/tag/rsa/">RSA</a> <a class="post-tag" href="/CTF-writeups-public/tag/lsb/">LSB</a> <a class="post-tag" href="/CTF-writeups-public/tag/cipher/">cipher</a> <a class="post-tag" href="/CTF-writeups-public/tag/pcap/">pcap</a> <a class="post-tag" href="/CTF-writeups-public/tag/audio/">audio</a> <a class="post-tag" href="/CTF-writeups-public/tag/aws/">aws</a> <a class="post-tag" href="/CTF-writeups-public/tag/bash/">bash</a> <a class="post-tag" href="/CTF-writeups-public/tag/binwalk/">binwalk</a> <a class="post-tag" href="/CTF-writeups-public/tag/crib-dragging/">crib dragging</a></div></div></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/CTF-writeups-public/tag/image/">image</a> <a class="post-tag" href="/CTF-writeups-public/tag/rsa/">RSA</a> <a class="post-tag" href="/CTF-writeups-public/tag/lsb/">LSB</a> <a class="post-tag" href="/CTF-writeups-public/tag/cipher/">cipher</a> <a class="post-tag" href="/CTF-writeups-public/tag/pcap/">pcap</a> <a class="post-tag" href="/CTF-writeups-public/tag/audio/">audio</a> <a class="post-tag" href="/CTF-writeups-public/tag/aws/">aws</a> <a class="post-tag" href="/CTF-writeups-public/tag/bash/">bash</a> <a class="post-tag" href="/CTF-writeups-public/tag/binwalk/">binwalk</a> <a class="post-tag" href="/CTF-writeups-public/tag/crib-dragging/">crib dragging</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/shiltemann">Team Galaxians</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/CTF-writeups-public/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/CTF-writeups-public/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/CTF-writeups-public/app.js"></script>
