<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Hacky Easter 2017" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups by team Galaxians." /><meta property="og:description" content="A set of CTF writeups by team Galaxians." /><link rel="canonical" href="/writeups/HackyEaster_2017/" /><meta property="og:url" content="/writeups/HackyEaster_2017/" /><meta property="og:site_name" content="Galaxians CTF" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2017-04-01T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hacky Easter 2017" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2017-04-01T00:00:00+02:00","datePublished":"2017-04-01T00:00:00+02:00","description":"A set of CTF writeups by team Galaxians.","headline":"Hacky Easter 2017","mainEntityOfPage":{"@type":"WebPage","@id":"/writeups/HackyEaster_2017/"},"url":"/writeups/HackyEaster_2017/"}</script><title> Galaxians CTF | Hacky Easter 2017</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Galaxians CTF"><meta name="application-name" content="Galaxians CTF"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/galaxians-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Galaxians CTF</a></div><div class="site-subtitle font-italic">Galactic Girlfiends Hack the Universe!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/posts/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/shiltemann" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['galaxians','galaxians.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hacky Easter 2017</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Ctf-event</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> Hacky Easter 2017</h1><p>The annual Hacky Easter Event from Hacking-Lab</p><div class="post-content"><h1>Overview</h1><div class="table-wrapper"><div class="table-wrapper"><table><thead><tr><th>Challenge<th>Difficulty<th>Points<th>Category<th>Flag<tbody><tr><td><a href="#teaser">Teaser</a><td><td><td><td><code>one do3s not simply s0lve a tea3er 0f hacky easter</code><tr><td><a href="#puzzle-this">Puzzle This!</a><td>easy<td><td><td><code>C5LHYOifJSLOnYmKjBmS</code><tr><td><a href="#lots-of-dots">Lots of Dots</a><td>easy<td><td><td><code>pJ94m6jt3AYbogL2gv9i</code><tr><td><a href="#favourite-letters">Favourite Letters</a><td>easy<td><td><td><code>Sf2MF6QPqpTrB7Eh2is7</code><tr><td><a href="#cool-car">Cool Car</a><td>easy<td><td><td><code>MuxlR4DSDdQDUeyKhKnT</code><tr><td><a href="#key-strokes">Key Strokes</a><td>easy<td><td><td><code>2MmSpjmlU6NPAhCUVyUP</code><tr><td><a href="#message-to-ken">Message to Ken</a><td>easy<td><td><td><code>uktVsuNNyPVQarmXTuYU</code><tr><td><a href="#crypto-for-rookies">Crypto for Rookies</a><td>easy<td><td><td><code>2owhVG07plVCwLD1Ggmn</code><tr><td><a href="#snd-mny">Snd Mny</a><td>easy<td><td><td><code>t10fBcKFNKShxwos5g0e</code><tr><td><a href="#microscope">Microscope</a><td>easy<td><td><td><code>rcwuXWsHjUcU7BbOLC18</code><tr><td><a href="#an-egg-or-not">An egg or not â€¦</a><td>Medium<td><td><td><code>UALYyPlhy2aYfYpzcJHA</code><tr><td><a href="#tweaked-tweet">Tweaked Tweet</a><td>medium<td><td><td> unsolved<tr><td><a href="#once-upon-a-file">Once Upon a File</a><td>medium<td><td><td><code>duRpDmUeN0d71XzeF8ae</code><tr><td><a href="#shards">Shards</a><td>medium<td><td><td> unsolved<tr><td><a href="#p-cap">P Cap</a><td><td><td><td> unsolved<tr><td><a href="#pathfinder">Pathfinder</a><td><td><td><td><code>xdzEPrFsO8jZH0OHLweM</code><tr><td><a href="#nitwit-s-doormat-key">Nitwitâ€™s doormat key</a><td><td><td><td> unsolved<tr><td><a href="#spaghetti-hash">Spaghetti hash</a><td><td><td><td><code>ICBXMH6GJqMqYDsjkaCn</code><tr><td><a href="#game-set-and-hash">Game, Set, and Hash</a><td><td><td><td><code>fl3uB75EGl1sadBNycvx</code></table></div></div><h1 id="teaser"> Teaser <a href="/writeups/HackyEaster_2017/00-teaser.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Solve the riddles and get a solution fragment from each.<li>Combine all the fragments in the right manner.<li>Decode the result to get the final solution string.<li>Sign-Up on Hacking-Lab, if you donâ€™t have an account yet.<li>Submit your solution in Hacking-Lab HERE.<li>Wait for April 4, when HackyEaster 2017 starts!</ol><h2 id="solutions"><span class="mr-2">Solutions</span><a href="#solutions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><em>Riddle 1</em></p><p><code class="language-plaintext highlighter-rouge">MBD2A !ysaep ,ysaE</code></p><p>Reverse: <code class="language-plaintext highlighter-rouge">Easy, peasy! A2DBM</code></p><p><em>Riddle 2</em></p><p><code class="language-plaintext highlighter-rouge">UGllY2Ugb2YgY2FrZSEgWlhHSUQ=</code></p><p>b64 decode: <code class="language-plaintext highlighter-rouge">Piece of cake! ZXGID</code></p><p><em>Riddle 3</em></p><p>One for free here: 404 - not found!</p><p>invisible text on webpage: <code class="language-plaintext highlighter-rouge">One for free here: 404 - not found! XIZLS</code></p><p><em>Riddle 4</em></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>eval(function(p,a,c,k,e,d){e=function(c){return c};if(!''.replace(/^/,String)){while(c--){d[c]=k[c]||c}
k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(
new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('0(\'1\');',2,2,'alert|VYGY6'.split('|'),0,{}))
</pre></table></code></div></div><p>run the javascript: <code class="language-plaintext highlighter-rouge">VYGY6</code></p><p><em>Riddle 5</em></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>3a3ea00cfc35332cedf6e5e9a32e94da
9d5ed678fe57bcca610140957afab571
f09564c9ca56850d4cd6b3319e541aee
5dbc98dcc983a70728bd082d1a47546e
7fc56270e7a70fa81a5935b72eacbe29
</pre></table></code></div></div><p>md5: <code class="language-plaintext highlighter-rouge">EBQSA</code></p><p><em>Riddle 6</em></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>--- -. . / -- --- .-. . / .... . .-. . ---... / .--- .- --- -- -.--
</pre></table></code></div></div><p>morse code: <code class="language-plaintext highlighter-rouge">ONEMOREHERE: JAOMY</code></p><p><em>Riddle 7</em></p><p><code class="language-plaintext highlighter-rouge">Hwldp wx, Euxwh! QYAVL</code></p><p>ROT23: <code class="language-plaintext highlighter-rouge">Etiam tu, Brute! NVXSI</code></p><p><em>Riddle 8</em></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>84 97 107 101 32 116 104 105 115 58 32 71 89 53 84 70
</pre></table></code></div></div><p>ascii: <code class="language-plaintext highlighter-rouge">Take this: GY5TF</code></p><p><em>Riddle 9</em></p><p>Just a bit: /2mi4AMj</p><p>bit.ly: <code class="language-plaintext highlighter-rouge">5DFME</code></p><p><em>Riddle 10</em></p><p>No Comment</p><p>HTML comment: ` `</p><p><em>Riddle 11</em></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½
ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»
ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘½ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘»ðŸ‘½ðŸ‘»ðŸ‘½ðŸ‘½
</pre></table></code></div></div><p>Binary: <code class="language-plaintext highlighter-rouge">CONGRATS! N5XGK</code></p><p><em>Riddle 12</em></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>697c611778601371647d12177e7d060572
3133333731333337313333373133333731
</pre></table></code></div></div><p>xor the strings together:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">a</span><span class="o">=</span><span class="sh">"</span><span class="s">697c611778601371647d12177e7d060572</span><span class="sh">"</span>
<span class="n">b</span><span class="o">=</span><span class="sh">"</span><span class="s">3133333731333337313333373133333731</span><span class="sh">"</span>
<span class="n">out</span><span class="o">=</span><span class="sh">''</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">out</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">c</span><span class="o">^</span><span class="n">d</span><span class="p">)</span>

<span class="k">print</span> <span class="n">out</span>
</pre></table></code></div></div><p>xor: <code class="language-plaintext highlighter-rouge">XOR IS FUN! ON52C</code></p><p><em>Riddle 13</em></p><p>URER LBH TB: MJX4E</p><p>ROT13: <code class="language-plaintext highlighter-rouge">HERE YOU GO: ZWK4R</code></p><p><em>Riddle 14</em></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>89504E470D0A1A0A0000000D494844520000001D0000000708020000007BBCD1A5000000017352474200AECE1CE90
000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000001874455874536F
667477617265007061696E742E6E657420342E302E36FC8C63DF000001AA4944415428534D513DC8416118BD7E4A1
9180C0665A0582C8C7E22DF20C5480A130629060CF29792C16CB06293C82283C2F0C562540693C94F297F2983FB9D
EBF9BEDB77A673CE7DEE799FF3BE0CFB81C160904824C4098542C1E17098CDE672B90C399D4E9D4EA740208846A39
BCD2693C9300CF3F5079A29168B56ABD5E572B5DBEDDF5C954A85B9D3E944D2EBF5D66AB5DBEDF67EBF5BADD6EBF5
1A8D4676BB1D9F7ABD9EDFEF877FBFDFE3F1782E97BB5EAFF0B1473A9D063F1C0E1A8D86CB1D8FC7D8CBE3F1341A0
DC8C964A2502840FE83CF050987C3642693C96AB54A1C558810B8DC4824321C0E178B85CD66836C369BD80244A7D3
A194DBED7E3C1E8893CBE5E804743A1DEE57964DA552F57A1D64B7DB994C2632095CAE4C260B8542C160502A95AED
7EBC160100804E05F2E97E3F1882054E6F7DDEFF770CEE73378369BA5DCE7F3899B04E1C174BBDD582CF6FD01162F
954AD84EA9542E974B9A108BC5FF7301AD564B2F91CFE729174033BC1BF17EBFCFF87CBEF97C4E7ABBDDEAF57A90D
96C66341A3FA519FE5AD56A35A44824C2D99F71B652A9F0B9ABD5CA62B1604028142612891FA2F7838B729D41E800
00000049454E44AE426082
</pre></table></code></div></div><p>turned out to be hex representation of png image, convert back:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">binascii</span>

<span class="n">ct</span> <span class="o">=</span> <span class="sh">'</span><span class="s">89504E470D0A1A0A0000000D494844520000001D0000000708020000007BBCD1A5000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000001874455874536F667477617265007061696E742E6E657420342E302E36FC8C63DF000001AA4944415428534D513DC8416118BD7E4A19180C0665A0582C8C7E22DF20C5480A130629060CF29792C16CB06293C82283C2F0C562540693C94F297F2983FB9DEBF9BEDB77A673CE7DEE799FF3BE0CFB81C160904824C4098542C1E17098CDE672B90C399D4E9D4EA740208846A39BCD2693C9300CF3F5079A29168B56ABD5E572B5DBEDDF5C954A85B9D3E944D2EBF5D66AB5DBEDF67EBF5BADD6EBF51A8D4676BB1D9F7ABD9EDFEF877FBFDFE3F1782E97BB5EAFF0B1473A9D063F1C0E1A8D86CB1D8FC7D8CBE3F1341A0DC8C964A2502840FE83CF050987C3642693C96AB54A1C558810B8DC4824321C0E178B85CD66836C369BD80244A7D3A194DBED7E3C1E8893CBE5E804743A1DEE57964DA552F57A1D64B7DB994C2632095CAE4C260B8542C160502A95AED7EBC160100804E05F2E97E3F1882054E6F7DDEFF770CEE73378369BA5DCE7F3899B04E1C174BBDD582CF6FD01162F954AD84EA9542E974B9A108BC5FF7301AD564B2F91CFE729174033BC1BF17EBFCFF87CBEF97C4E7ABBDDEAF57A90D96C66341A3FA519FE5AD56A35A44824C2D99F71B652A9F0B9ABD5CA62B1604028142612891FA2F7838B729D41E80000000049454E44AE426082</span><span class="sh">'</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">teaser.png</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w+</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
    <span class="n">fout</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">binascii</span><span class="p">.</span><span class="nf">unhexlify</span><span class="p">(</span><span class="n">ct</span><span class="p">))</span>
</pre></table></code></div></div><p><img src="writeupfiles/teaser.png" alt="" /></p><p>PNG image: <code class="language-plaintext highlighter-rouge">AGBTC</code></p><p><em>Riddle 16</em></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>FRIDAY THE THIRTEENTH, 4:00 PM
/([FOR]*)([ID]{2})([^N]*)(.)(.*)/g
$2E$44
</pre></table></code></div></div><p>regex: <code class="language-plaintext highlighter-rouge">IDEN4</code></p><p><em>Riddle 16</em></p><p><code class="language-plaintext highlighter-rouge">&lt;~&lt;+oue+DGm&gt;FD,5.CghC,+E)./+Ws0B9h&amp;:~&gt;</code></p><p>Base85 decode: <code class="language-plaintext highlighter-rouge">DFMFZ</code></p><h2 id="final-solution"><span class="mr-2">Final Solution</span><a href="#final-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We suspect the solution fragments are part of a base32 encoded string, so we try different possible permutations of the fragments which yield valid outputs:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">itertools</span>
<span class="kn">import</span> <span class="n">base64</span>
<span class="kn">import</span> <span class="n">string</span>

<span class="k">def</span> <span class="nf">extend_solution</span><span class="p">(</span><span class="n">partialsolution</span><span class="p">,</span> <span class="n">mychunks</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s"> try adding different permutations of 4 pieces to current solution, recurse til solution found</span><span class="sh">'''</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">itertools</span><span class="p">.</span><span class="nf">permutations</span><span class="p">(</span><span class="n">mychunks</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">partialsolution</span> <span class="o">+</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">padded</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span>  <span class="sh">'</span><span class="s">=</span><span class="sh">'</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="nf">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">oldchunks</span> <span class="o">=</span> <span class="n">mychunks</span><span class="p">[:]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b32decode</span><span class="p">(</span><span class="n">padded</span><span class="p">)</span>

            <span class="n">valid</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="c1">#if c not in string.printable:
</span>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="nf">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">):</span>
                    <span class="n">valid</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">valid</span><span class="p">:</span>
                <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="k">print</span> <span class="sh">"</span><span class="s">possible solution: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="sh">"</span><span class="s"> (</span><span class="sh">"</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="sh">"</span><span class="s">)</span><span class="sh">"</span>

                <span class="c1">#recursion
</span>                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">mychunks</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="nf">extend_solution</span><span class="p">(</span><span class="n">partialsolution</span><span class="o">+</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">mychunks</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">e</span>
            <span class="nf">exit</span><span class="p">()</span>

        <span class="n">mychunks</span> <span class="o">=</span> <span class="n">oldchunks</span><span class="p">[:]</span>


<span class="n">chunks</span><span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">A2DBM</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ZXGID</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">XIZLS</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">VYGY6</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">EBQSA</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">JAOMY</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">NVXSI</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">GY5TF</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">5DFME</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">A43JN</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">N5XGK</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ON52C</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ZWK4R</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">AGBTC</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">IDEN4</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">DFMFZ</span><span class="sh">'</span><span class="p">]</span>

<span class="k">print</span> <span class="sh">"</span><span class="s">solving..</span><span class="sh">"</span>
<span class="nf">extend_solution</span><span class="p">(</span><span class="sh">''</span><span class="p">,</span><span class="n">chunks</span><span class="p">)</span>
</pre></table></code></div></div><p>this outputs various possible solutions:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>solving..
possible solution:  a tea3s not haeply s1terone do3er 0f sikky earlve (EBQSA5DFMEZXGIDON52CA2DBMVYGY6JAOMYXIZLSN5XGKIDEN4ZWK4RAGBTCA43JNNVXSIDFMFZGY5TF)
possible solution:  a tea3s not haeply s0lveone do3er 0f sikky easter (EBQSA5DFMEZXGIDON52CA2DBMVYGY6JAOMYGY5TFN5XGKIDEN4ZWK4RAGBTCA43JNNVXSIDFMFZXIZLS)
possible solution:  a tea3s not hacky easterone do3er 0f simply s0lve (EBQSA5DFMEZXGIDON52CA2DBMNVXSIDFMFZXIZLSN5XGKIDEN4ZWK4RAGBTCA43JNVYGY6JAOMYGY5TF)
possible solution:  a tea3s not hacky earlveone do3er 0f simply s1ter (EBQSA5DFMEZXGIDON52CA2DBMNVXSIDFMFZGY5TFN5XGKIDEN4ZWK4RAGBTCA43JNVYGY6JAOMYXIZLS)
[..]
possible solution: one do3s not simply s1ter a tea3er 0f hacky earlve (N5XGKIDEN4ZXGIDON52CA43JNVYGY6JAOMYXIZLSEBQSA5DFMEZWK4RAGBTCA2DBMNVXSIDFMFZGY5TF)
possible solution: one do3s not simply s0lve a tea3er 0f hacky easter (N5XGKIDEN4ZXGIDON52CA43JNVYGY6JAOMYGY5TFEBQSA5DFMEZWK4RAGBTCA2DBMNVXSIDFMFZXIZLS)
possible solution: one do3s not sikky easter a tea3er 0f haeply s0lve (N5XGKIDEN4ZXGIDON52CA43JNNVXSIDFMFZXIZLSEBQSA5DFMEZWK4RAGBTCA2DBMVYGY6JAOMYGY5TF)
[..]
possible solution: one do3er 0f sikky earlve a tea3s not haeply s1ter (N5XGKIDEN4ZWK4RAGBTCA43JNNVXSIDFMFZGY5TFEBQSA5DFMEZXGIDON52CA2DBMVYGY6JAOMYXIZLS)
</pre></table></code></div></div><p>and best one and our solution is:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>one do3s not simply s0lve a tea3er 0f hacky easter (N5XGKIDEN4ZXGIDON52CA43JNVYGY6JAOMYGY5TFEBQSA5DFMEZWK4RAGBTCA2DBMNVXSIDFMFZXIZLS)
</pre></table></code></div></div><h2> Flag</h2><code> one do3s not simply s0lve a tea3er 0f hacky easter </code><hr><h1 id="puzzle-this"> Puzzle This! <a href="/writeups/HackyEaster_2017/01-challenge-01-puzzle-this.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>An easy one to start with.</p><p><img src="./writeupfiles/egg01_shuffled.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Shuffled, looks like no rotations.</p><p><img src="./writeupfiles/egg01_unshuffled.png" alt="" /></p><h2> Flag</h2><code> C5LHYOifJSLOnYmKjBmS </code><hr><h1 id="lots-of-dots"> Lots of Dots <a href="/writeups/HackyEaster_2017/02-challenge-02-lots-of-dots.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The dots in the following image contain a secret message. Can you find it?</p><p><img src="./writeupfiles/dots.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Had a non-colourblind person look at it, he said nothing was there. Split out LSB and bingo:</p><p><img src="./writeupfiles/dots_out.png" alt="" /></p><p>Pop into the egg-o-matic:</p><p><img src="./writeupfiles/dots_egg.png" alt="" /></p><h2> Flag</h2><code> pJ94m6jt3AYbogL2gv9i </code><hr><h1 id="favourite-letters"> Favourite Letters <a href="/writeups/HackyEaster_2017/03-challenge-03-favourite-letters.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>    Francesca's favourite letter is s
    Riley's favourite letter is o
    Ellie's favourite letter is a
    Vince's favourite letter is p
    Quintain's favourite letter is r
    Otto's favourite letter is i
    David's favourite letter is p
    Tom's favourite letter is l
    Paul's favourite letter is e
    Ulrich's favourite letter is y
    Henry's favourite letter is w
    Norman's favourite letter is h
    Louis' favourite letter is i
    Zane's favourite letter is s
    York's favourite letter is c
    Bob's favourite letter is h
    Meave's favourite letter is s
    Ian's favourite letter is o
    Sidney's favourite letter is g
    George's favourite letter is s
    Kitty's favourite letter is d
    Wilbert's favourite letter is h
    Adam's favourite letter is t
    Xander's favourite letter is i
    Callum's favourite letter is e
    Jack's favourite letter is r
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>All names start with different letter and there are 26 of them, so lets take the first letter of the name as a hint for the positioning of the favourite letters:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>ABCDEFGHIJKLMNOPQRSTUVWXYZ
thepasswordishieroglyphics
</pre></table></code></div></div><p>put <code class="language-plaintext highlighter-rouge">hieroglyphics</code> into the egg-o-matic to get our egg5</p><p><img src="writeupfiles/egg03.png" alt="" /></p><h2> Flag</h2><code> Sf2MF6QPqpTrB7Eh2is7 </code><hr><h1 id="cool-car"> Cool Car <a href="/writeups/HackyEaster_2017/04-challenge-04-cool-car.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>(Mobile Challenge)</p><p><img src="writeupfiles/egg4_challenge.jpg" alt="" /></p><p>Borat wants to impress the girls. Can you help him find a cool car for his purpose?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a meter we presumably need to fill, source code from decompiled apk shows:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">setLevel</span><span class="p">(</span><span class="nx">l</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">l</span><span class="o">&gt;</span><span class="mi">1000</span><span class="p">)</span> <span class="nx">l</span><span class="o">=</span><span class="mi">1000</span><span class="p">;</span>
  <span class="nf">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#level</span><span class="dl">'</span><span class="p">).</span><span class="nf">css</span><span class="p">(</span><span class="dl">'</span><span class="s1">width</span><span class="dl">'</span><span class="p">,(</span><span class="nx">l</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">px</span><span class="dl">'</span><span class="p">);</span>
  <span class="nf">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#level</span><span class="dl">'</span><span class="p">).</span><span class="nf">css</span><span class="p">(</span><span class="dl">'</span><span class="s1">background-color</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">rgba(</span><span class="dl">'</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">round</span><span class="p">((</span><span class="mi">1000</span><span class="o">-</span><span class="nx">l</span><span class="p">)</span><span class="o">*</span><span class="mf">0.255</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">,</span><span class="dl">'</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="nx">l</span><span class="o">*</span><span class="mf">0.255</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">,0,1.0)</span><span class="dl">'</span><span class="p">);</span>
  <span class="nf">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#level</span><span class="dl">'</span><span class="p">).</span><span class="nf">text</span><span class="p">(</span><span class="dl">""</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="nx">l</span><span class="p">));</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nf">requestLevels</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">ps://sensors</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nf">sensorFeedback</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">jsonResp</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>
    <span class="nf">setLevel</span><span class="p">(</span><span class="nx">jsonResp</span><span class="p">.</span><span class="nx">l</span><span class="p">);</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">jsonResp</span><span class="p">.</span><span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">decryptScrambledEggWithKey</span><span class="p">(</span><span class="nx">jsonResp</span><span class="p">.</span><span class="nx">k</span><span class="p">);</span>
        <span class="nf">clearInterval</span><span class="p">(</span><span class="nx">intervalId</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">intervalId</span> <span class="o">=</span> <span class="nf">setInterval</span><span class="p">(</span><span class="nx">requestLevels</span><span class="p">,</span> <span class="mi">2000</span><span class="p">);</span>
</pre></table></code></div></div><p>so it checks some sensor level, and looks like this needs to be 1000 to get our egg</p><p>hmm, Borat and cars, we find this youtube video https://www.youtube.com/watch?v=yAuu3xOsorQ in which Borat wants a car with a pussy magnet ..hmm, magnets?</p><p>I held a fridge magnet to my phone and the meter filled right up to 1000 and gave me the egg</p><p><img src="writeupfiles/egg4_screenshot.jpg" alt="" /></p><h2> Flag</h2><code> MuxlR4DSDdQDUeyKhKnT </code><hr><h1 id="key-strokes"> Key Strokes <a href="/writeups/HackyEaster_2017/05-challenge-05-key-strokes.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>esc i c e l a n d esc a y a n k e e space f o x
space esc o f l o w e r up esc $ esc i y esc e esc a
y esc / l a return esc r w esc right right right
right esc x i f r esc e esc X x x : s / c e / a g i
c / return esc down d d esc i m esc Z Z
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Oh my gosh this is VIM! Thatâ€™s awesome :D</p><p>Entering the keystrokes as they provide spells out: <code class="language-plaintext highlighter-rouge">magicwandfrankfoxy</code></p><p><img src="./writeupfiles/egg5.png" alt="" /></p><h2> Flag</h2><code> 2MmSpjmlU6NPAhCUVyUP </code><hr><h1 id="message-to-ken"> Message to Ken <a href="/writeups/HackyEaster_2017/06-challenge-06-message-to-ken.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Barbie has written a secret message for her sweetheart Ken. Can you decrypt it?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Fabrgal JaeM Hsa faonah uiff;rnl tf btuxbrffuinhzoroyhitbM Fincta dd
</pre></table></code></div></div><p>Hint: <code class="language-plaintext highlighter-rouge">Shift+Lock+1</code></p><p><strong>Solution</strong> Holy crap this is AWESOME. This relies on you knowing about the barbie typewriters made in the 90s that had a secret code mechanism. http://www.cryptomuseum.com/crypto/mehano/barbie/#e118</p><p>So this is key 2 for coding.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>norm: abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789
   1: torbiudfhgzcvanqyepskxÂ¢1w; RC&gt;GHAPND&lt;VUBLIKJETOYXM2QF 63405789-Â¨
   2: icolapxstvybjeruknfhqg;dzw &gt;FAUTCYOLVJDZINQKSEHG&lt;.1PB 523406789-
   3: hrnctqlpsxwogiekzaufyd+b;Â¢ SARYO&gt;QIUX&lt;GFDLJVTHNP1Z3KC 7405689-Â¨Â§
   4: sneohkbufd;rxtaywiqpzl%cÂ¢+ E&gt;SPNRKLG1XYCUDV&lt;HOIQ2B4JA 805679-Â¨Â§Â£
</pre></table></code></div></div><p>â€˜Beloved KenM The secret password is lipglosspartycocktailM Barbie xxâ€™</p><p>put the password into the egg-o-matic:</p><p><img src="writeupfiles/egg6.png" alt="" /></p><h2> Flag</h2><code> uktVsuNNyPVQarmXTuYU </code><hr><h1 id="crypto-for-rookies"> Crypto for Rookies <a href="/writeups/HackyEaster_2017/07-challenge-07-crypto-for-rookies.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This crypto is not hard to crack.</p><p><img src="writeupfiles/7_challenge.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="table-wrapper"><table><thead><tr><th>Line<th>Cipher<th>Result<tbody><tr><td>1:<td>dancing men cipher<td><code class="language-plaintext highlighter-rouge">BONTBBOK</code><tr><td>2:<td>base64 decode<td><code class="language-plaintext highlighter-rouge">BONTEAOK</code><tr><td>3:<td>alphabet position<td><code class="language-plaintext highlighter-rouge">BONTEBRK</code><tr><td>4:<td>rot13<td><code class="language-plaintext highlighter-rouge">BANTEBOK</code><tr><td>5:<td>pigpen cipher<td><code class="language-plaintext highlighter-rouge">CONTEBOK</code><tr><td>6:<td>reversed?<td><code class="language-plaintext highlighter-rouge">BONTEBOA</code><tr><td>7:<td>rot23?<td><code class="language-plaintext highlighter-rouge">BOPTEBOK</code><tr><td>8:<td>hex:<td><code class="language-plaintext highlighter-rouge">BONYEBOK</code></table></div><p><img src="writeupfiles/pigpen.png" alt="" /></p><p><img src="writeupfiles/dancingmen.jpeg" alt="" /></p><ul><li>final solution: changed letters per line? If so: EABRAOCOBAPKNY<li>Update: not working. Maybe I copied them wrong? Or somethnig else? :S<li>Odd one out per position: <code class="language-plaintext highlighter-rouge">CAPYBARA</code></ul><p>pop this in egg-o-matic and get our egg:</p><p><img src="writeupfiles/egg7.png" alt="" /></p><h2> Flag</h2><code> 2owhVG07plVCwLD1Ggmn </code><hr><h1 id="snd-mny"> Snd Mny <a href="/writeups/HackyEaster_2017/08-challenge-08-snd-mny.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>(Mobile Challenge)</p><p><img src="writeupfiles/egg8_chall.jpg" alt="" /></p><p>Please, Iâ€™m begging you!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>find the relevant code in decompiled apk:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SndActivity</span> <span class="kd">extends</span> <span class="nc">Activity</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">requestWindowFeature</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="n">getWindow</span><span class="o">().</span><span class="na">setFlags</span><span class="o">(</span><span class="nc">AccessibilityNodeInfoCompat</span><span class="o">.</span><span class="na">ACTION_NEXT_HTML_ELEMENT</span><span class="o">,</span> <span class="nc">AccessibilityNodeInfoCompat</span><span class="o">.</span><span class="na">ACTION_NEXT_HTML_ELEMENT</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">C0085R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_snd</span><span class="o">);</span>
        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">action</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">type</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getType</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="s">"android.intent.action.SEND"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">action</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">type</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="no">HTTP</span><span class="o">.</span><span class="na">PLAIN_TEXT_TYPE</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">type</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">text</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getStringExtra</span><span class="o">(</span><span class="s">"android.intent.extra.TEXT"</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">text</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="s">"c95259de1fd719814daef8f1dc4bd64f9d885ff0"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">sha1</span><span class="o">(</span><span class="n">text</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">())))</span> <span class="o">{</span>
                <span class="o">((</span><span class="nc">TextView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">C0085R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sndTextView</span><span class="o">)).</span><span class="na">setText</span><span class="o">(</span><span class="s">"Thank you!!"</span><span class="o">);</span>
                <span class="nc">ImageView</span> <span class="n">image</span> <span class="o">=</span> <span class="o">(</span><span class="nc">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">C0085R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sndImageView</span><span class="o">);</span>
                <span class="kt">byte</span><span class="o">[]</span> <span class="n">decodedString</span> <span class="o">=</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">(</span><span class="n">getString</span><span class="o">(</span><span class="no">C0085R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">f16e</span><span class="o">)</span> <span class="o">+</span> <span class="s">"ROBVi"</span><span class="o">).</span><span class="na">reverse</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="mi">0</span><span class="o">);</span>
                <span class="n">image</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="nc">BitmapFactory</span><span class="o">.</span><span class="na">decodeByteArray</span><span class="o">(</span><span class="n">decodedString</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">decodedString</span><span class="o">.</span><span class="na">length</span><span class="o">));</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">[..]</span>

<span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">c95259de1fd719814daef8f1dc4bd64f9d885ff0</code> is the SHA-1 hash for the string <code class="language-plaintext highlighter-rouge">money</code></p><p>send this string to the app somehow?</p><p>ah, we notice there is now a new entry in the share menu to share to the hackyeaster <code class="language-plaintext highlighter-rouge">SndActivity</code> app.</p><p>we share something random and get the following:</p><p><img src="writeupfiles/egg8_wrong.jpg" alt="" /></p><p>we presumably need to send just the string <code class="language-plaintext highlighter-rouge">money</code> downloaded an app called <em>Clipboard Actions</em> which lets you share anything on your clipboard</p><p><img src="writeupfiles/egg8_share.jpg" alt="" /></p><p><img src="writeupfiles/egg8_right.jpg" alt="" /></p><h2> Flag</h2><code> t10fBcKFNKShxwos5g0e </code><hr><h1 id="microscope"> Microscope <a href="/writeups/HackyEaster_2017/09-challenge-09-microscope.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>(Mobile Challenge)</p><p><img src="writeupfiles/egg9_chall.jpg" alt="" /></p><p>In order to see this easter egg, you have to look closely!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When we click the button, we see a page with a tiny tiny egg on it</p><p><img src="writeupfiles/egg9_tiny.jpg" alt="" /></p><p>We look at the source for the challenge from the decompiled APK</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">ps.hacking.hackyeaster.android</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.app.Activity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.support.v4.view.accessibility.AccessibilityNodeInfoCompat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.webkit.HttpAuthHandler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.webkit.WebResourceError</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.webkit.WebResourceRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.webkit.WebView</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.webkit.WebViewClient</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MicroscopeActivity</span> <span class="kd">extends</span> <span class="nc">Activity</span> <span class="o">{</span>

    <span class="cm">/* renamed from: ps.hacking.hackyeaster.android.MicroscopeActivity.1 */</span>
    <span class="kd">class</span> <span class="nc">C00841</span> <span class="kd">extends</span> <span class="nc">WebViewClient</span> <span class="o">{</span>
        <span class="no">C00841</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceivedHttpAuthRequest</span><span class="o">(</span><span class="nc">WebView</span> <span class="n">view</span><span class="o">,</span> <span class="nc">HttpAuthHandler</span> <span class="n">handler</span><span class="o">,</span> <span class="nc">String</span> <span class="n">host</span><span class="o">,</span> <span class="nc">String</span> <span class="n">realm</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">handler</span><span class="o">.</span><span class="na">proceed</span><span class="o">(</span><span class="s">"he2017"</span><span class="o">,</span> <span class="s">"egggghunthackinglab"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceivedError</span><span class="o">(</span><span class="nc">WebView</span> <span class="n">view</span><span class="o">,</span> <span class="nc">WebResourceRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">WebResourceError</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">view</span><span class="o">.</span><span class="na">loadDataWithBaseURL</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">"&lt;html&gt;&amp;#128048;&lt;/html&gt;"</span><span class="o">,</span> <span class="s">"text/html"</span><span class="o">,</span> <span class="s">"utf-8"</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">requestWindowFeature</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="n">getWindow</span><span class="o">().</span><span class="na">setFlags</span><span class="o">(</span><span class="nc">AccessibilityNodeInfoCompat</span><span class="o">.</span><span class="na">ACTION_NEXT_HTML_ELEMENT</span><span class="o">,</span> <span class="nc">AccessibilityNodeInfoCompat</span><span class="o">.</span><span class="na">ACTION_NEXT_HTML_ELEMENT</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">C0085R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_microscope</span><span class="o">);</span>
        <span class="nc">WebView</span> <span class="n">webview</span> <span class="o">=</span> <span class="o">(</span><span class="nc">WebView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">C0085R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">microscopeWebView</span><span class="o">);</span>
        <span class="n">webview</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setJavaScriptEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">webview</span><span class="o">.</span><span class="na">setWebViewClient</span><span class="o">(</span><span class="k">new</span> <span class="no">C00841</span><span class="o">());</span>
        <span class="n">webview</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="s">"https://hackyeaster.hacking-lab.com/hackyeaster/challenge09_su6z47IoTT7.html"</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="sc">'6'</span><span class="o">,</span> <span class="sc">'5'</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>We see the webpage the app opens with the tiny egg on it: https://hackyeaster.hacking-lab.com/hackyeaster/challenge09_su5z47IoTT7.html</p><p>We open this page:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"cache-control"</span> <span class="na">content=</span><span class="s">"max-age=0"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"cache-control"</span> <span class="na">content=</span><span class="s">"no-cache"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"expires"</span> <span class="na">content=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"expires"</span> <span class="na">content=</span><span class="s">"Tue, 01 Jan 1980 1:00:00 GMT"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"pragma"</span> <span class="na">content=</span><span class="s">"no-cache"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body</span> <span class="na">style=</span><span class="s">"background: url('images/background.jpg') no-repeat center center fixed;  -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size: cover;"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;table</span> <span class="na">width=</span><span class="s">100%</span> <span class="na">height=</span><span class="s">100%</span> <span class="na">border=</span><span class="s">"0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;td</span> <span class="na">style=</span><span class="s">"text-align: center; vertical-align: middle;"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"padding: 20px; width: 180px; height: 180px; position: absolute; left: 50%; top: 50%; margin-top: -110px; margin-left: -110px;"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"images/challenge/egg09_fs0sYle2SN.png"</span> <span class="na">style=</span><span class="s">"width: 12px; height: 12px;"</span> <span class="nt">/&gt;</span>
          <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/table&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>and find the location of the egg image and can view it full-size:</p><p><img src="writeupfiles/egg09_fs0sYle2SN.png" alt="" /></p><h2> Flag</h2><code> rcwuXWsHjUcU7BbOLC18 </code><hr><h1 id="an-egg-or-not"> An egg or not â€¦ <a href="/writeups/HackyEaster_2017/10-challenge-10-an-egg-or-not-.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>â€¦ an egg, thatâ€™s the question!</p><p>Are you able to answer this question and find the (real) egg?</p><p><img src="writeupfiles/10.png" alt="" /></p><p>(original svg verson <a href="writeupfies/10.svg">here</a>)</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The QR code is made of individual dots. Some are doubled up, I think we remove the doubles.</p><p>I stripped out the <code class="language-plaintext highlighter-rouge">&lt;use ...&gt;</code> statements and then transformed into a TSV:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">tmp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">).</span><span class="nf">read</span><span class="p">()</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="se">\t</span><span class="sh">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)]</span>
<span class="n">haveSeen</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="sh">"</span><span class="s">%s,%s</span><span class="sh">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">haveSeen</span><span class="p">:</span>
                <span class="k">print</span> <span class="sh">"""</span><span class="s">&lt;use x=</span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> y=</span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> xlink:href=</span><span class="sh">"</span><span class="s">#%s</span><span class="sh">"</span><span class="s">/&gt;</span><span class="sh">"""</span> <span class="o">%</span> <span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
        <span class="n">haveSeen</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
</pre></table></code></div></div><p><img src="writeupfiles/10.b.png" alt="" /></p><p>(original svg verson <a href="writeupfies/10.b.svg">here</a>)</p><h2> Flag</h2><code> UALYyPlhy2aYfYpzcJHA </code><hr><h1 id="tweaked-tweet"> Tweaked Tweet <a href="/writeups/HackyEaster_2017/11-challenge-11-tweaked-tweet.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>(Mobile Challenge)</p><p><img src="writeupfiles/egg11_chall.jpg" alt="" /></p><p>Blue little birdie create a fancy message, please tweet it!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When we click the button, it prepares a tweet for us:</p><p><img src="writeupfiles/egg11_tweet.jpg" alt="" /></p><p>We check the decompiled sources and see the code to generate the tweet:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">private</span> <span class="kt">void</span> <span class="nf">startTweakedTweet</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">startActivity</span><span class="o">(</span><span class="k">new</span> <span class="nc">Intent</span><span class="o">(</span><span class="s">"android.intent.action.VIEW"</span><span class="o">,</span> <span class="nc">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"https://twitter.com/intent/tweet?text=%23%EF%BC%A8a%EF%BD%83%EF%BD%8By%CE%95%EF%BD%81ste%EF%BD%92%E2%80%A9201%EF%BC%97%E2%80%A9%E2%85%B0%EF%BD%93%E2%80%80a%E2%80%84l%EF%BD%8F%EF%BD%94%E2%80%80%CE%BFf%E2%80%89%EF%BD%86un%EF%BC%81%E2%80%A8%23%D1%81tf%E2%80%88%23%EF%BD%88%EF%BD%81%CF%B2king-lab"</span><span class="o">)));</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>The tweet text:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>#ï¼¨aï½ƒï½‹yÎ•ï½steï½’â€©201ï¼—â€©â…°ï½“â€€aâ€„lï½ï½”â€€Î¿fâ€‰ï½†unï¼â€¨#Ñtfâ€ˆ#ï½ˆï½Ï²king-lab
</pre></table></code></div></div><p>in hex:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>23efbca861efbd83efbd8b79ce95efbd81737465efbd92e280a9323031efbc97e280
a9e285b0efbd93e2808061e280846cefbd8fefbd94e28080cebf66e28089efbd8675
6eefbc81e280a823d1817466e2808823efbd88efbd81cfb26b696e672d6c6162
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="once-upon-a-file"> Once Upon a File <a href="/writeups/HackyEaster_2017/12-challenge-12-once-upon-a-file.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Once upon a file there was a hidden egg. Itâ€™s still waiting to be saved by a noble prince or princess.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Hmm. Zipped file containing a single file, nothing interesting in zipdetails.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">[hxr@leda:~/Downloads]$</span><span class="w"> </span>file file
<span class="gp">file: DOS/MBR boot sector, code offset 0x52+2, OEM-ID "NTFS    ", sectors/cluster 8, Media descriptor 0xf8, sectors/track 63, hidden sectors 1, dos &lt; 4.0 BootSector (0x80), FAT (1Y bit by descriptor);</span><span class="w"> </span>NTFS, sectors/track 63, sectors 10239, <span class="nv">$MFT</span> start cluster 426, <span class="nv">$MFTMirror</span> start cluster 2, bytes/RecordSegment 2^<span class="o">(</span><span class="nt">-1</span><span class="k">*</span>246<span class="o">)</span>, clusters/index block 1, serial number 09850f88350f86a00
</pre></table></code></div></div><p>Ok, thatâ€™s interesting.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">qemu-system-x86_64 -drive format=raw,file=disk.img
</span></pre></table></code></div></div><p><img src="./writeupfiles/12.png" alt="" /></p><p>Not sure where to go from here. tcpdump where itâ€™s pixieing to? EDIT: apparently this is standard qemu/seabios behaviour. Whoops. No idea. Tried <code class="language-plaintext highlighter-rouge">photorec</code> on the disk image with no luck.</p><p>next we tried binwalk</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="nv">$ </span>binwalk <span class="nt">-e</span> file

DECIMAL       HEXADECIMAL     DESCRIPTION
<span class="nt">--------------------------------------------------------------------------------</span>
36447         0x8E5F          Unix path: /0/1/2/3/4/5/6/7/8/9/:/<span class="p">;</span>/&lt;/<span class="o">=</span>/&gt;/?/@/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O/P/Q/R/S/T/U/V/W/X/Y/Z/[/<span class="se">\/</span><span class="o">]</span>/^/_/<span class="sb">`</span>/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o
184320        0x2D000         Zip archive data, at least v2.0 to extract, compressed size: 439156, uncompressed size: 5242880, name: file
623596        0x983EC         End of Zip archive

<span class="nv">$ </span><span class="nb">ls </span>_file.extracted
2D000.zip  file

<span class="nv">$ </span><span class="nb">cd </span>_file.extracted

<span class="nv">$ </span>binwalk <span class="nt">-e</span> file

DECIMAL       HEXADECIMAL     DESCRIPTION
<span class="nt">--------------------------------------------------------------------------------</span>
36447         0x8E5F          Unix path: /0/1/2/3/4/5/6/7/8/9/:/<span class="p">;</span>/&lt;/<span class="o">=</span>/&gt;/?/@/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O/P/Q/R/S/T/U/V/W/X/Y/Z/[/<span class="se">\/</span><span class="o">]</span>/^/_/<span class="sb">`</span>/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o
1093632       0x10B000        Microsoft Cabinet archive data, 17834 bytes, 1 file
2832320       0x2B37C0        Microsoft Cabinet archive data, 17834 bytes, 1 file
3116030       0x2F8BFE        Microsoft executable, MS-DOS
3788479       0x39CEBF        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
3793983       0x39E43F        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
4477995       0x44542B        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: SHA-1 <span class="nb">hash
</span>5073287       0x4D6987        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
5075359       0x4D719F        mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
5173248       0x4EF000        PNG image, 480 x 480, 8-bit colormap, non-interlaced
5173767       0x4EF207        Zlib compressed data, best compression

<span class="nv">$ </span><span class="nb">ls </span>_file.extracted
10B000.cab  2B37C0.cab  4EF207  4EF207.zlib  egg12.png  eg?Z2.png
</pre></table></code></div></div><p>and there we see we get our egg</p><p><img src="writeupfiles/egg12.png" alt="" /></p><h2 id="nugget"><span class="mr-2">Nugget</span><a href="#nugget" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>duRpDmUeN0d71XzeF8ae
</pre></table></code></div></div><h2> Flag</h2><code> duRpDmUeN0d71XzeF8ae </code><hr><h1 id="shards"> Shards <a href="/writeups/HackyEaster_2017/13-challenge-14-shards.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Oh no! What a mess!</p><p><strong>Solution</strong> Image reassembly software??</p><h2 id="nugget"><span class="mr-2">Nugget</span><a href="#nugget" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="p-cap"> P Cap <a href="/writeups/HackyEaster_2017/14-challenge-15-p-cap.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What about a little P cap?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Lotsa SMB traffic, looks like a file named R05h4L.jpg is tranferred. Dollars to doughnuts thatâ€™s an egg.</p><p>opened with wireshark, extracted the objects transferred, seems like two versions of that image, and two webpages:</p><p><a href="writeupfiles/pcap/R05h4L.jpg">R05h4L.jpg</a> (incomplete)</p><p>R05h4L(1).jpg:</p><p><img src="writeupfiles/pcap/R05h4L_1.jpg" alt="" /></p><p>perdu.com (<a href="writeupfiles/pcap/perdu.com.html">html file</a>) (<a href="http://perdu.com">site</a>):</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>Vous Etes Perdu ?<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;h1&gt;</span>Perdu sur l'Internet ?<span class="nt">&lt;/h1&gt;</span>
        <span class="nt">&lt;h2&gt;</span>Pas de panique, on va vous aider<span class="nt">&lt;/h2&gt;</span>
        <span class="nt">&lt;strong&gt;&lt;pre&gt;</span>    * <span class="nt">&lt;-----</span> <span class="na">vous</span> <span class="err">&amp;</span><span class="na">ecirc</span><span class="err">;</span><span class="na">tes</span> <span class="na">ici</span><span class="err">&lt;/</span><span class="na">pre</span><span class="nt">&gt;&lt;/strong&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>nothinghere.pl (<a href="writeupfiles/pcap/nothinghere.pl.html">html file</a>) (<a href="http://nothinghere.pl">site</a>):</p><p>â€“&gt; find login credentials to this site in pcap and log in?</p><h2 id="nugget"><span class="mr-2">Nugget</span><a href="#nugget" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="pathfinder"> Pathfinder <a href="/writeups/HackyEaster_2017/15-challenge-16-pathfinder.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you find the right path?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>$ curl -i hackyeaster.hacking-lab.com:9999
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
Content-Length: 39
Date: Thu, 06 Apr 2017 04:19:00 GMT
Connection: keep-alive

{"Answer":"I only talk to PathFinder!"}
</pre></table></code></div></div><p>aha, letâ€™s pretend weâ€™re PathFinder by setting our user-agent as such:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>curl hackyeaster.hacking-lab.com:9999 --user-agent 'PathFinder'

{"Answer":"Follow one of the possible paths","paths":[1,3,5,8]}
</pre></table></code></div></div><p>Ok, looks like we need to find our way in a maze of some sort. After trying many things, it turned out to be url path, letâ€™s choose path <code class="language-plaintext highlighter-rouge">1</code> by adding <code class="language-plaintext highlighter-rouge">/1</code> to url</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>curl hackyeaster.hacking-lab.com:9999/1 --user-agent 'PathFinder'

{"Answer":"Go on! Follow one of the possible paths","paths":[5]}
</pre></table></code></div></div><p>we are given new options, so we can now visit <code class="language-plaintext highlighter-rouge">/15</code> etc until we find our flag:</p><p>we automate this in a <a href="writeupfiles/16.py">python script</a>:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">pprint</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">findpath</span><span class="p">(</span><span class="n">current_url</span><span class="p">,</span> <span class="n">mypaths</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">count</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">mypaths</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">%</span><span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span> <span class="sh">"</span><span class="s">currently trying: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">current_url</span>
        <span class="n">new_url</span> <span class="o">=</span> <span class="n">current_url</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">new_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">Answer</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">You</span><span class="sh">'</span><span class="s">ve left the path!</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">print</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span>
            <span class="nf">exit</span><span class="p">()</span>

        <span class="c1"># recurse
</span>        <span class="k">elif</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">Answer</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Go on! Follow one of the possible paths</span><span class="sh">"</span><span class="p">:</span>
            <span class="nf">findpath</span><span class="p">(</span><span class="n">new_url</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">paths</span><span class="sh">'</span><span class="p">])</span>

        <span class="c1"># if other response, we found it maybe?
</span>        <span class="k">elif</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">Answer</span><span class="sh">'</span><span class="p">]</span> <span class="o">!=</span> <span class="sh">"</span><span class="s">This leads to nowhere, so turn around!</span><span class="sh">"</span><span class="p">:</span>
            <span class="n">pprint</span><span class="p">.</span><span class="nf">pprint</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="nf">exit</span><span class="p">()</span>

    <span class="c1"># backtrack
</span>

<span class="n">url</span> <span class="o">=</span> <span class="sh">'</span><span class="s">http://hackyeaster.hacking-lab.com:9999/</span><span class="sh">'</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">User-Agent</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">PathFinder</span><span class="sh">'</span><span class="p">}</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nc">Session</span><span class="p">()</span>

<span class="c1"># recursively follow path until we get to an ending
</span><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<span class="nf">findpath</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">paths</span><span class="sh">'</span><span class="p">])</span>
</pre></table></code></div></div><p>this outputs:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre>currently trying: http://hackyeaster.hacking-lab.com:9999/153274689269185
currently trying: http://hackyeaster.hacking-lab.com:9999/153274689269385174847196523496
currently trying: http://hackyeaster.hacking-lab.com:9999/1532746892698531748471965239265
currently trying: http://hackyeaster.hacking-lab.com:9999/153284679269315
currently trying: http://hackyeaster.hacking-lab.com:9999/15328467926975148384
currently trying: http://hackyeaster.hacking-lab.com:9999/153284697269175
currently trying: http://hackyeaster.hacking-lab.com:9999/1532846972697154838
currently trying: http://hackyeaster.hacking-lab.com:9999/15329468724937
currently trying: http://hackyeaster.hacking-lab.com:9999/153294687269385
currently trying: http://hackyeaster.hacking-lab.com:9999/1572846932497
currently trying: http://hackyeaster.hacking-lab.com:9999/15728469326931587484
currently trying: http://hackyeaster.hacking-lab.com:9999/157284693269375184348196527926
currently trying: http://hackyeaster.hacking-lab.com:9999/1572846932697
currently trying: http://hackyeaster.hacking-lab.com:9999/157284693269753184843196527
currently trying: http://hackyeaster.hacking-lab.com:9999/15729468326
currently trying: http://hackyeaster.hacking-lab.com:9999/15729468326935817434817652992654
currently trying: http://hackyeaster.hacking-lab.com:9999/15729468326935817434871652949658371282597134673
currently trying: http://hackyeaster.hacking-lab.com:9999/1572946832693581743487165924
currently trying: http://hackyeaster.hacking-lab.com:9999/157294683269358174843176592
currently trying: http://hackyeaster.hacking-lab.com:9999/15729468326935817484371652949658371252897134673164289567

{u'Answer': u'Thanks PathFinder you saved my life by giving me the solution to this sudoku!',
 u'Secret': u'https://hackyeaster.hacking-lab.com/hackyeaster/images/challenge/egg16_UYgXzJqpfc.png',
 u'sudoku': [[0, 0, 0, 2, 0, 4, 6, 0, 0],
             [2, 0, 9, 0, 0, 0, 0, 0, 0],
             [0, 0, 0, 0, 0, 6, 5, 0, 0],
             [0, 0, 6, 5, 0, 0, 7, 1, 0],
             [0, 0, 0, 9, 0, 0, 0, 4, 0],
             [7, 3, 1, 0, 0, 0, 0, 0, 0],
             [0, 7, 0, 0, 3, 0, 0, 0, 8],
             [0, 8, 0, 0, 2, 7, 0, 3, 1],
             [0, 1, 4, 0, 6, 0, 0, 0, 0]],
 u'your_solution': [[1, 5, 7, 2, 9, 4, 6, 8, 3],
                    [2, 6, 9, 3, 5, 8, 1, 7, 4],
                    [8, 4, 3, 7, 1, 6, 5, 2, 9],
                    [4, 9, 6, 5, 8, 3, 7, 1, 2],
                    [5, 2, 8, 9, 7, 1, 3, 4, 6],
                    [7, 3, 1, 6, 4, 2, 8, 9, 5],
                    [9, 7, 2, 1, 3, 5, 4, 6, 8],
                    [6, 8, 5, 4, 2, 7, 9, 3, 1],
                    [3, 1, 4, 8, 6, 9, 2, 5, 7]]}
</pre></table></code></div></div><p>Aha! weâ€™ve reached the end and the <code class="language-plaintext highlighter-rouge">Secret</code> url give us our egg:</p><p><img src="writeupfiles/egg16.png" alt="" /></p><h2> Flag</h2><code> xdzEPrFsO8jZH0OHLweM </code><hr><h1 id="nitwit-s-doormat-key"> Nitwitâ€™s doormat key <a href="/writeups/HackyEaster_2017/16-challenge-18-nitwits-doormat-key.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>we check the source</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
	<span class="nt">&lt;head&gt;</span>
		<span class="nt">&lt;title&gt;</span>Awesome login by me!<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"script.js"</span> <span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
		<span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"style.css"</span> <span class="na">type=</span><span class="s">"text/css"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/head&gt;</span>
	<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"container1"</span><span class="nt">&gt;</span>
  		<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"uzr"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">placeholder=</span><span class="s">"username"</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"puzzwerd"</span> <span class="na">placeholder=</span><span class="s">"password"</span> <span class="na">type=</span><span class="s">"password"</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"sub"</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">value=</span><span class="s">"Login!"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"container2"</span><span class="nt">&gt;</span>
	 <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">"egg"</span> <span class="na">src=</span><span class="s">"../images/egg_gray.png"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;script&gt;</span>
    <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span> <span class="o">=</span> <span class="p">[</span><span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">1407c2b75f43d3691c240e28204533da74ee4054f5f2538e87b69ec590b04de2c2bd190b</span><span class="dl">'</span><span class="p">;</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">v16441ef9304a5520d663e6580bf16679</span><span class="p">.</span><span class="nf">createElement</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">);</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">getContext</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">6d363479c97439b921ad2bcba054992d8eda9a0c971df8f80920b84ab4eeae83cae6b76c</span><span class="dl">'</span><span class="p">;</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">e77a763321d6cf825534ab228e1dfa33e71447c1637dc3b97dcf2d564e2003f67e7c26aa</span><span class="dl">'</span><span class="p">;</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">;</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">v159851e0e855ec9a87293bada9f49593</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">v159851e0e855ec9a87293bada9f49593</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">;</span>
<span class="p">},</span> <span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="dl">"</span><span class="s2">va587d4b34c724ca63a1afcbaeca7f254</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">return unescape(decodeURIComponent(window.atob(va587d4b34c724ca63a1afcbaeca7f254)))</span><span class="dl">"</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">vbe3ae157bcaf01bd49ec5a9b228e92fb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">va587d4b34c724ca63a1afcbaeca7f254</span><span class="dl">'</span><span class="p">,</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">10</span><span class="p">](</span><span class="nx">v21a3d2d3fc5c2c1e1f3a633bd8f16f7e</span><span class="p">[</span><span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span><span class="p">]));</span>
    <span class="k">return</span> <span class="nx">vbe3ae157bcaf01bd49ec5a9b228e92fb</span><span class="p">;</span>
<span class="p">}];</span>
<span class="nx">v1341746e3d58a8c0d7ce43b877b6beb1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="nx">v21a3d2d3fc5c2c1e1f3a633bd8f16f7e</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">cmV0dXJuJTIwJ2NhbnZhcyclM0I=</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cmV0dXJuJTIwJ25vbmUnJTNC</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cmV0dXJuJTIwJzJkJyUzQg==</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cmV0dXJuJTIwJ3NjcmlwdCclM0I=</span><span class="dl">'</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">vd547050f5153d6953e12ea54b398855a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">v6b31cf3f4c1305942d60342286cd09c5</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cmV0dXJuJTIwJ2RhdGElM0FpbWFnZSUyRnBuZyUzQmJhc2U2NCUyQyclM0I=</span><span class="dl">'</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAIAAAC1eHXNAAANt0lEQVRYhU2USVMciJGFP6pALCUBYk8tgFi0dUstPST3Grbby0RM9M3hn6CIOc3/82Wix3MYT8f0PEmtllogxCKWZCvWgoIqqPKhbY/z9L2Il3l6L1ueSUZf4E5pzZTlQ6hBWLfErD2N9uRt66o8b90VF3gB6tYUPoJp1A1b8gr0WGPyGjTQAb6N5vAUlKBhreCGVLNHxIqpo2noFDumtSKN4XazhvthB31h9vFzudO6jxbFfbSBh1E3PrIWpKe4Jq+YadFlNnC7VRfXRNn0o6Z4axVwDTXFt9AnN6ySPY1WIGESd8CauUDFTiin6oprjqpy2HGMP6DrEaPJpiia78IzyUlkKdjPJLMndRAxGtEk32WUyYriCd5zViCVPUQz3JFsKUccpeCEKIUrqUu4J/OScizZR+uK++HCl9KMSLwmOqwT3CldlSfhLWziI/lzcyLWrIY1gkbRAK5Au12Fc3yCpswcOpKa0ILOzC2oS09NTZ61S7BgjcGeKKFhsyodyTOmYFq34Ax/Zn2Pq6gJGzCKlu1JtGHGxCqas8dwqzhEL+1XYsbsoxdmCh6KNXNot4oJcQWO5Yo1ClX00h5FN3EfHEEV1WERqnYT+vGeaO2xi9L/yn2mifvEuKnDJfQjfizKZkt0mxRV08BF+NSc4iGpFxfRIrQImZfo1KyJLpgWCzACkzABO+ZIauJHeAuq0hR02ovoPhRmod18BDVRRjdQDUpiWb4v1uFY9OAKum9tiZI0A6doRXqP71od+Mgc4Au4aoyvwKA1Cw37tRlGO/gIFmAAbcGKuGd6zKF0TexC60PxxjTRI6jgbesEqvZNsYjOzWOoyzW5BMPmGpShASVYRE15AY3BEOxBGSalPtjErTAPn8rL5lg00GfwHo9Zdbkd74hlOITfW4UKauCG+Q+4QFX5BLqlTasTNmEP5tCoeWUewCKuoW1YswfsI3MHhqCO2kRdjOJ1XJTKqFP6YM7gKRJehClYhvuwL15aTfM12oDiV6iinIjoMFu4PVlRDju3yDuZQ+QhsRjUI+5n7Cl2I2uRDzLP4YH0IXKbqITbHC8yGkkl4zzzo8hh50nEZMYiMZasKVrND5mPFPOOwcjBiKOIU8h0se8b7lpzyRnugUlx2SzBE3SovAhtpa9kbmR2KY+Jccdi5ElQD0acQ6ETuE1sJw/wVWIEqsqSNUd0Bv3pq8pqxkHyHr4kTsItET86RtOXM7cy74jiH4hdxUB4K3WH2Ml4Qd6XltOkTtKj4lqokPEu83LmNaI74tBZCr2IqNqnGQPpOeVp6kgQ7ofTjD68GhEZ65lVck9BcJI+CIrkTMRm5msURH9Gceybb87gteNY1IOh8GCqI90urYc7k75kPROiTDwgD8hSRDXygLhnLohxuRnUrDPRBotkmC5igZhK3ovWjA9kNXMq8lJwD31PtjvqykcRxXA1o+Xfn2kWzeAX0DCPoAW2xDJqwCnutRqiZE9JK2ZOTOJRax1fSAtQhxvmFlRxB5xKy/ZVcRMSXcCc/SWcwGVYhQMxAfto2G6KJTi1Cu/NY7xteuAefCvtoBfQD5+ZW1CDgj0Kb8ygfMfug12xC0341B7DD8Rr+TLahTY4l8Las7btAfM7OEFrYkOahGEwujBFtGDOUFm0fP5MvVZdtMAT/AJqZggN4HlRQ9O4ZJagKG5Cq1lG52IeOnGvmRLzaNx8kDusXfhYvIcxeIsfwpG1Im6bLrwqzcIvAFMXHXgF7qLWW1YZ96Edsy3VYErutX9EXeYUvxTDUEQ7cBPmAfkDfGGqaB1m8Qx+KxLahUwZSvDe3pPmzZlogTb4UdRMQ26idWiHDjMhXuHCptwnhqEdL8K0KaMyuoAqfILumZuoF8/gNNehan1tTqEi2uV71pLVDiNQgip+Cxf2bXQdn4sndps9D1OohH+FDqGET2AWDq1Nq/iYGE7WIkup1nS/csdxC0rylYxF3C/eZE7DXmoNl8h9okxcEOXg0HEuNzN3QlPEZWiPPCcnQ++CM8dA0kbskmdEb3pE+gDYN6Qb5kxxEm5mFhKtQgG25AmxijpFDXfDAXRKBXRbvBKtMCgVRSs+x9Oi0+4XN6EOD82+OYFlU4dDvAk9cr+8KnqgW26Hd/a+PSgq8Aafm/dwWxTu4WMxAjNmHRahD46lLdMPdVyCI3RhymLTvjCnaFwCWqR28yOaQnNiV4xjoN8aQbL7zKIVpgxjMCcdiyFUMB/gSAzg38IOKlTgIfw3rEg1qwde4g17X3qDr8MybJqGGDadYl8q44K9CJ+YPZg0s9BlavgYAX3yX6AkNVANF8RNacGahDLqxitSyZStJnwwS9Dyh2fP7pgNOMEL8DlaELdMGY9Jm+YFbkr9cBPWoWlm8Ftp2bTLQnvmDA/AVfQaquKOaZPfmQ5pF38M780YeosfiiO0gu+YE7EDK6aJWv7t2bNNaDXz8qfWKn+r2YS9KSrWDOzjdbiBCnIbmsV//zHM4xpMSyVYwkXrJv6zNIXrZhdOYRgVxa59F9VgSH5h3RGzuIaG8IBp/QA1PI3GrCXogC14iquoigt/i7DW8I4t2MKXzYH0E76O6tYUdMAbqKMdvCIG8Z71WPwAJXwTlu2HaAs30ct/CvK43Q+rovgEWpN+5UJGAY8oh52rwUVkBT0NXiVtQZN4FLHgGI74EPGx3R/sEXeDs2DV7ow8cXykqDvrybZiDXcQF+QokZH1zAmpnr4Cp8oLqxA5nbyDk6TQgm6gOVOBQdRhdqQuNA6f2q+hhN/DbXvFdMl/MbfNOryEK3DFNO0usYw+ljdgShoS/wr3YNNsme/NsLUvfY8HpbJYN2viNtoSXTCFCmOwhEtSN+7AbxFm0FSsMnxsduDXcIQCBuC3Yh0X0O9g0PwERzCLZCpWCc/iAbOBj8118UsYxatiCu6jH0y7+Ro9hD27DEfwnVxYhk5RgLtwKJ3CrrD8AS+gbfEAKvau2MQ91r55gEZw1azKy6ImwOeihAfhE7MjjZgFGLcrooQqdidehpR70bE4N1eh3Xok3bdad6EbruHX0okZx73WG1GHbvEcj4gO6yOoS1v2ulgxU6iKN9CXNlBCx7AtPsB9aJgX8GuxY9ZRUzyGsrUsvoBOsYbH4E/iN7BiN0RrAY+jVbwK7fiqeIs3rV8Adgeahd/If4ZpcyE14YnYstdh0r4iXlnr4i6esAbEmujBj80P6IEo2K1oWXoolnG7tYCR/ge+xm/shniEin+M2Ilch3bnU+kNeQb3InszTogt8VH4v2AE7ialzFLkkeM5cU05Fqygo3C341rmsfLE2Z4xFLmfmg/XHYOKveQ4vE7sODuUhAr4YWY52ZVmiBNo3UHH5hCeyoe4Yd2DLtgR7WYcl9CkacUXcIEaMCR67UFTlt7CDWtFHkHH0IQx2ENLcsHcFNvQkEuoYgRrqMcelZbhAg7Nn/AtUfwq1CXXIoFVa0IQ3o48I1qDDnLWcR1KitaMA/m5sxIxFbmeqqU7MsfIUlAn6jAQXs4YCA+gqcgNZyPiiuNq+oiYJ9qCe5HrxHj4csaguBJZhNYlGIVW1Guq+LL1Bo1DCTfRktSNu6X/xH2oaV3It2ER7svfoSr02g1zSy6YJdQpLqEKLpuGuAUVUYUJ3IZG8Y8wgXctxBnsmgYUAp+iNXsJT4s9PAU1OEL7omLvoSL+GLbEDfgXdIRHzVvrtuk1PTAgvrWei135rXkHTWigJtShCs/NBlrHc6Zh3lkl+RCquAjborAKi/aw1IQVdIzquE18gDW4iWbwhvXcKthd4hVeM5twTxzKPXgZdcGE6Dab5itRN2U4hGswj4egF63gK9ADm6JDpDUADfgI3TPF7vhmWDnhuES8Tu+TIerOAlnNDMVuxEnSCQ+J4/B7NBgxnfFDcIm8HupMn4R67FXxy9BP0EjfD42kZ1NtGe/Cpxm9mRfBefDAVDKm5efkLXSQfoOKj75hwjrGXWRVfBWaJQ4j7ybXpCV8Ruwkh3AsH1pXw0uOHugLXjvGgnLEqXmleEwc2AcZ40Rb+idoV4ynr4T6kj1l0RSTqrge8a3zl8n7yLng9xHFP/LNknwavAg+R69NdzIVeRgcEheO1vSEsjtizwlB5mXlbuQCMZMsp5sZw5BJNXwQepTuVPwUcSlzN2OEXI2sRVSJRxlF5Zw5z/iEWFFcIgumN7M4HbrIOI14TBzCfPoKOZxk8Iacyegll0LnsBLxNDiMfGBWk0ZkV2QxmMzogAK0Z05FHiZHkWVnTXqa/EicZq5lPsw4xsdBJfgsYwM3Mt+lHpB7olgI3YXu9GLkAXE1cinVQ/Yk00Ej4m1EGx52DmUsB5eIdxGPM6+k1iNOndeUbyKm03OwmFSgLfWBGAhIDysaGWVlRBxnHgVPzA+Kk8h7qSl4r2wxha/lOj5Hl8wmjKEnckV8BydwYNfsYeiSGvIo7JkZ2Jde4kv4jpg3HfB/8LF0V/SLY/iVXDJDUtNehjCr5lCasPZQE3pMAbbwDWsXitcV7cFKZCOYcVTCXdBi7sF2qofYV143OxFHxB7cSTbCdaItsxZ0WT+R3ZHjwQJxQDQcd0USs0G/3YABclA6Tt/P2MQbih68E2pPL8FVchJavnmmDhhHbfYr6IQxUUFN2LYX4YpYQWAAC/H//PPI/J3wPxj0s/ynlZ8N+sc1kH6GvwKgeIkcWQxJLQAAAABJRU5ErkJggg==</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cmV0dXJuJTIwdjE2NDQxZWY5MzA0YTU1MjBkNjYzZTY1ODBiZjE2Njc5LmdldEVsZW1lbnRCeUlkKHZhNTg3ZDRiMzRjNzI0Y2E2M2ExYWZjYmFlY2E3ZjI1NCklM0I=</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cmV0dXJuJTIwZG9jdW1lbnQ=</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Zm9yKHZiOTMyYjI4NGE0YTdlYTdjZWJlMzc5ZTk3MzlhNjYwZSUzRHYxMzQxNzQ2ZTNkNThhOGMwZDdjZTQzYjg3N2I2YmViMSU1QjIlNUQlM0IlMjB2YjkzMmIyODRhNGE3ZWE3Y2ViZTM3OWU5NzM5YTY2MGUlMjAlM0MlMjB2NGM5NWEyNTliYTJmOWQyZGMwMTBkYzEwMzc5Y2FlZjIuZGF0YS5sZW5ndGglM0IlMjB2YjkzMmIyODRhNGE3ZWE3Y2ViZTM3OWU5NzM5YTY2MGUlMkIlM0Q0KXZhNjI3YjZjOGVlMTAzNDk0NGE4Njc5ODNjNTBlNDlhYSUyQiUzRCh2NGM5NWEyNTliYTJmOWQyZGMwMTBkYzEwMzc5Y2FlZjIuZGF0YSU1QnZiOTMyYjI4NGE0YTdlYTdjZWJlMzc5ZTk3MzlhNjYwZSU1RCElM0R2MTM0MTc0NmUzZDU4YThjMGQ3Y2U0M2I4NzdiNmJlYjElNUIxJTVEKSUzRnY5OGI5NjM0NGQxNzMxNzFlNzAzNzY1ODMzOTI0M2EyYSh2NGM5NWEyNTliYTJmOWQyZGMwMTBkYzEwMzc5Y2FlZjIuZGF0YSU1QnZiOTMyYjI4NGE0YTdlYTdjZWJlMzc5ZTk3MzlhNjYwZSU1RCklM0F2MjFhM2QyZDNmYzVjMmMxZTFmM2E2MzNiZDhmMTZmN2UlNUI0JTVEJTNCJTIwdmE2MjdiNmM4ZWUxMDM0OTQ0YTg2Nzk4M2M1MGU0OWFhJTNEdmE2MjdiNmM4ZWUxMDM0OTQ0YTg2Nzk4M2M1MGU0OWFhLnRyaW0oKSUzQg==</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cmV0dXJuJTIwbmV3JTIwSW1hZ2UoKSUzQg==</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">cmV0dXJuJTIwU3RyaW5nLmZyb21DaGFyQ29kZSh2YTU4N2Q0YjM0YzcyNGNhNjNhMWFmY2JhZWNhN2YyNTQpJTNC</span><span class="dl">'</span><span class="p">];</span>
<span class="nx">v16441ef9304a5520d663e6580bf16679</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">11</span><span class="p">)();</span>
<span class="nx">v62647b9bbd4174f7dfe26356c2d80254</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">va587d4b34c724ca63a1afcbaeca7f254</span><span class="dl">'</span><span class="p">,</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">10</span><span class="p">](</span><span class="nx">v21a3d2d3fc5c2c1e1f3a633bd8f16f7e</span><span class="p">[</span><span class="mi">10</span><span class="p">]));</span>
<span class="nx">v159851e0e855ec9a87293bada9f49593</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">7</span><span class="p">](</span><span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">13</span><span class="p">)());</span>
<span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">8</span><span class="p">](</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">vf47cdd4c73ada3018bb2235586095298</span> <span class="o">=</span> <span class="nf">v62647b9bbd4174f7dfe26356c2d80254</span><span class="p">(</span><span class="nx">v21a3d2d3fc5c2c1e1f3a633bd8f16f7e</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
    <span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">0</span><span class="p">)());</span>
    <span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">v159851e0e855ec9a87293bada9f49593</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
    <span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">v159851e0e855ec9a87293bada9f49593</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
    <span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">1</span><span class="p">)();</span>
    <span class="nx">va627b6c8ee1034944a867983c50e49aa</span> <span class="o">=</span> <span class="nx">v21a3d2d3fc5c2c1e1f3a633bd8f16f7e</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
    <span class="nx">v22f584e55a18700bb1e819235e9faec2</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">2</span><span class="p">]([</span><span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span><span class="p">,</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">2</span><span class="p">)()]);</span>
    <span class="nx">v98b96344d173171e7037658339243a2a</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">va587d4b34c724ca63a1afcbaeca7f254</span><span class="dl">'</span><span class="p">,</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">10</span><span class="p">](</span><span class="nx">v21a3d2d3fc5c2c1e1f3a633bd8f16f7e</span><span class="p">[</span><span class="mi">14</span><span class="p">]));</span>
    <span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">.</span><span class="nf">drawImage</span><span class="p">(</span><span class="nx">v159851e0e855ec9a87293bada9f49593</span><span class="p">,</span> <span class="nx">v1341746e3d58a8c0d7ce43b877b6beb1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">v1341746e3d58a8c0d7ce43b877b6beb1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nx">v4c95a259ba2f9d2dc010dc10379caef2</span> <span class="o">=</span> <span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">.</span><span class="nf">getImageData</span><span class="p">(</span><span class="nx">v1341746e3d58a8c0d7ce43b877b6beb1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">v1341746e3d58a8c0d7ce43b877b6beb1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
    <span class="nx">v312f239ab11ab792bbc638880cef0016</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">12</span><span class="p">)();</span>
    <span class="p">(</span><span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">10</span><span class="p">](</span><span class="nx">va627b6c8ee1034944a867983c50e49aa</span><span class="p">)))();</span>
    <span class="nx">vd547050f5153d6953e12ea54b398855a</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">v159851e0e855ec9a87293bada9f49593</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">vd547050f5153d6953e12ea54b398855a</span><span class="p">);</span>
    <span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v14b0e537ea8314aa8eff15a14130f2dc</span><span class="p">);</span>
    <span class="nx">v22f584e55a18700bb1e819235e9faec2</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v4c95a259ba2f9d2dc010dc10379caef2</span><span class="p">);</span>
    <span class="nx">v4c95a259ba2f9d2dc010dc10379caef2</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">vb932b284a4a7ea7cebe379e9739a660e</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">va627b6c8ee1034944a867983c50e49aa</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">v0acc8db6e0b9f93a7f5e1fba4e39431f</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">ve7773f4e18e20899677477e2e500daef</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">vd547050f5153d6953e12ea54b398855a</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">v1362f0e27add34a3855900a0346601e2</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">v16441ef9304a5520d663e6580bf16679</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">v312f239ab11ab792bbc638880cef0016</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">v21a3d2d3fc5c2c1e1f3a633bd8f16f7e</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">v1341746e3d58a8c0d7ce43b877b6beb1</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
    <span class="nx">va587d4b34c724ca63a1afcbaeca7f254</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">vf47cdd4c73ada3018bb2235586095298</span><span class="p">);</span>
    <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">v22f584e55a18700bb1e819235e9faec2</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">v312f239ab11ab792bbc638880cef0016</span> <span class="o">=</span> <span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">9</span><span class="p">](</span><span class="nx">v06b9e817c4ddcf60fbd82113f8c1f49b</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">7</span><span class="p">)()</span> <span class="o">+</span> <span class="nx">v21a3d2d3fc5c2c1e1f3a633bd8f16f7e</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>

	<span class="nt">&lt;/script&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>Letâ€™s try to deobfuscate a bit:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
</pre><td class="rouge-code"><pre><span class="nx">my_function_array</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1">//0</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">'</span><span class="s1">1407c2b75f43d3691c240e28204533da74ee4054f5f2538e87b69ec590b04de2c2bd190b</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="c1">//1</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">charlie</span><span class="p">.</span><span class="nf">createElement</span><span class="p">(</span><span class="nx">my_var</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="c1">//2</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">my_var</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">getContext</span><span class="p">(</span><span class="nx">my_var</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">},</span>
    <span class="c1">//3</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">my_var</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">my_var</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">},</span>
    <span class="c1">//4</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="c1">//5</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="dl">'</span><span class="s1">6d363479c97439b921ad2bcba054992d8eda9a0c971df8f80920b84ab4eeae83cae6b76c</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="c1">//6</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="dl">'</span><span class="s1">e77a763321d6cf825534ab228e1dfa33e71447c1637dc3b97dcf2d564e2003f67e7c26aa</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="c1">//7</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">my_var</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">my_var</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="c1">//8</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">foxtrot</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">my_var</span>
    <span class="p">},</span>
    <span class="c1">//9</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">foxtrot</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">my_var</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="c1">//10</span>
    <span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="dl">"</span><span class="s2">my_var</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">return unescape(decodeURIComponent(window.atob(my_var)))</span><span class="dl">"</span><span class="p">),</span>

    <span class="c1">//11</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">my_var</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">my_new_function</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">my_var</span><span class="dl">'</span><span class="p">,</span>
            <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">10</span><span class="p">](</span> <span class="nx">my_data_array</span><span class="p">[</span><span class="nx">my_var</span><span class="p">]</span> <span class="p">));</span>
        <span class="k">return</span> <span class="nx">my_new_function</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">];</span>

<span class="nx">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="nx">my_data_array</span> <span class="o">=</span> <span class="p">[</span>
    <span class="dl">"</span><span class="s2">return 'canvas';</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">return 'none';</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">return '2d';</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">return 'script';</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">''</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">tango</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">v6b31cf3f4c1305942d60342286cd09c5</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">&lt;png image, see writeupfiles/chall18.png&gt;</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">return document</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">&lt;just data? see writeupfiles/chall18_justdata&gt;</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">return new Image();</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">return String.fromCharCode(my_var);</span><span class="dl">'</span>
<span class="p">];</span>

<span class="nx">charlie</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">11</span><span class="p">)();</span>
<span class="nx">hotel</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">my_var</span><span class="dl">'</span><span class="p">,</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">10</span><span class="p">](</span><span class="nx">my_data_array</span><span class="p">[</span><span class="mi">10</span><span class="p">]));</span>
<span class="nx">foxtrot</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">7</span><span class="p">](</span><span class="nx">my_function_array</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">13</span><span class="p">)());</span>
<span class="nx">my_function_array</span><span class="p">[</span><span class="mi">8</span><span class="p">](</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">kilo</span> <span class="o">=</span> <span class="nf">hotel</span><span class="p">(</span><span class="nx">my_data_array</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
    <span class="nx">bravo</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="nx">my_function_array</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">0</span><span class="p">)());</span>
    <span class="nx">bravo</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">foxtrot</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
    <span class="nx">bravo</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">foxtrot</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
    <span class="nx">bravo</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">1</span><span class="p">)();</span>

    <span class="nx">lima</span> <span class="o">=</span> <span class="nx">my_data_array</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
    <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">2</span><span class="p">]([</span><span class="nx">bravo</span><span class="p">,</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">2</span><span class="p">)()]);</span>
    <span class="nx">mike</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="dl">'</span><span class="s1">my_var</span><span class="dl">'</span><span class="p">,</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">10</span><span class="p">](</span><span class="nx">my_data_array</span><span class="p">[</span><span class="mi">14</span><span class="p">]));</span>
    <span class="nx">alpha</span><span class="p">.</span><span class="nf">drawImage</span><span class="p">(</span><span class="nx">foxtrot</span><span class="p">,</span> <span class="nx">my_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">my_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nx">romeo</span> <span class="o">=</span> <span class="nx">alpha</span><span class="p">.</span><span class="nf">getImageData</span><span class="p">(</span><span class="nx">my_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">my_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">bravo</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">bravo</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
    <span class="nx">sierra</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">12</span><span class="p">)();</span>

    <span class="p">(</span><span class="k">new</span> <span class="nc">Function</span><span class="p">(</span><span class="nx">my_function_array</span><span class="p">[</span><span class="mi">10</span><span class="p">](</span><span class="nx">lima</span><span class="p">)))();</span>

    <span class="nx">tango</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">foxtrot</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">tango</span><span class="p">);</span>
    <span class="nx">bravo</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">bravo</span><span class="p">);</span>
    <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">romeo</span><span class="p">);</span>
    <span class="nx">romeo</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">uniform</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">lima</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>

    <span class="nx">victor</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">yankee</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">tango</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">zulu</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">charlie</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">sierra</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">my_data_array</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">my_list</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">my_var</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
    <span class="nx">my_var</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">kilo</span><span class="p">);</span>
    <span class="nx">my_function_array</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">4</span><span class="p">](</span><span class="nx">alpha</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">sierra</span> <span class="o">=</span> <span class="nx">my_function_array</span><span class="p">[</span><span class="mi">9</span><span class="p">](</span><span class="nx">my_function_array</span><span class="p">[</span><span class="mi">11</span><span class="p">](</span><span class="mi">7</span><span class="p">)()</span> <span class="o">+</span> <span class="nx">my_data_array</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="spaghetti-hash"> Spaghetti hash <a href="/writeups/HackyEaster_2017/17-challenge-20-spaghetti-hash.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Lazy Larry needs to improve the security of his password hashing implementation. He decides to use SHA-512 as a new hashing algorithm in order to be super secure. Unfortunately, the database column for the hash can only hold 128 bit. As Bob is too lazy to extend the column and all the code related to it, he decides to shrink the output of the SHA-512 operation, to 128 bit. For this purpose he picks certain characters from the SHA-512 output for producing the new value.</p><p>You got hold of four password hashes, calculated with Bobâ€™s new implementation. Can you find the corresponding passwords?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>hash 1: 87017a3ffc7bdd5dc5d5c9c348ca21c5
hash 2: ff17891414f7d15aa4719689c44ea039
hash 3: 5b9ea4569ad68b85c7230321ecda3780
hash 4: 6ad211c3f933df6e5569adf21d261637
</pre></table></code></div></div><p>Lucky you, you know that the following web service is calculating Bobâ€™s algorithm. However, the web service only accepts strings of length 4 or less - brute-forcing a password list thus is no option, since the passwords you are looking for are all longer.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://hackyeaster.hacking-lab.com/hackyeaster/hash?string=abcd
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>First we use the web service to determine how the smaller hashes are obtained from the full hashes, next we use a dictionary to test whether the smaller hashes match any of the four we are looking for</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">hashlib</span>

<span class="n">url</span><span class="o">=</span><span class="sh">"</span><span class="s">https://hackyeaster.hacking-lab.com/hackyeaster/hash?string=</span><span class="sh">"</span>

<span class="k">def</span> <span class="nf">all_occurrences</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ch</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ltr</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="n">ltr</span> <span class="o">==</span> <span class="n">ch</span><span class="p">]</span>

<span class="c1"># first, determine where each character in new hashes came from in original
# by looking at multiple ones
</span><span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="sh">"</span><span class="s">abcde</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">sha512</span><span class="p">()</span>
    <span class="n">m</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">c</span><span class="p">)</span>
    <span class="n">pairs</span><span class="p">.</span><span class="nf">append</span><span class="p">([</span><span class="n">m</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">(),</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">])</span>

<span class="n">origins</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])):</span>
    <span class="c1">#print "pos: "+str(i)
</span>    <span class="n">possibilities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">)):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nf">all_occurrences</span><span class="p">(</span><span class="n">pairs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">pairs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="c1">#print n
</span>        <span class="k">if</span> <span class="n">possibilities</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">possibilities</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">possibilities</span> <span class="o">=</span> <span class="n">possibilities</span><span class="p">.</span><span class="nf">intersection</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">origins</span> <span class="o">+=</span> <span class="nf">list</span><span class="p">(</span><span class="n">possibilities</span><span class="p">)</span>

<span class="k">print</span> <span class="sh">"</span><span class="se">\n</span><span class="s">Origin of each position in small hash:</span><span class="sh">"</span>
<span class="k">print</span> <span class="n">origins</span>
<span class="c1"># [65, 17, 115, 31, 45, 11, 67, 92, 0, 7, 123, 37, 5, 22, 87, 124, 25, 89, 38, 61, 90, 109, 63, 28, 102, 12, 47, 59, 110, 86, 24, 18]
</span>
<span class="k">def</span> <span class="nf">get_mini_hash</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">positions</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">sha512</span><span class="p">()</span>
    <span class="n">m</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
    <span class="n">longhash</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">()</span>
    <span class="n">smallhash</span> <span class="o">=</span> <span class="sh">''</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
        <span class="n">smallhash</span> <span class="o">+=</span> <span class="n">longhash</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">smallhash</span>


<span class="c1"># now we know how smaller hashes are derived from larger ones, try word from
# a dictionary to see which match hashes we are looking for
</span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">87017a3ffc7bdd5dc5d5c9c348ca21c5</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">ff17891414f7d15aa4719689c44ea039</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">5b9ea4569ad68b85c7230321ecda3780</span><span class="sh">'</span><span class="p">,</span>
           <span class="sh">'</span><span class="s">6ad211c3f933df6e5569adf21d261637</span><span class="sh">'</span><span class="p">]</span>

<span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">wordlist.txt</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">while</span> <span class="n">found</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">readline</span><span class="p">().</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">smallh</span> <span class="o">=</span> <span class="nf">get_mini_hash</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">origins</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">smallh</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">:</span>
            <span class="k">print</span> <span class="sh">"</span><span class="se">\n</span><span class="s">Found!</span><span class="sh">"</span>
            <span class="k">print</span> <span class="n">w</span>
            <span class="k">print</span> <span class="n">smallh</span>
            <span class="n">found</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></table></code></div></div><p>This outputs the following solutions:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>Origin of each position in small hash:
[65, 17, 115, 31, 45, 11, 67, 92, 0, 7, 123, 37, 5, 22, 87, 124, 25, 89, 38, 61, 90, 109, 63, 28, 102, 12, 47, 59, 110, 86, 24, 18]

Found!
12345678
6ad211c3f933df6e5569adf21d261637

Found!
benchmark
5b9ea4569ad68b85c7230321ecda3780

Found!
Cleveland
ff17891414f7d15aa4719689c44ea039

Found!
Prodigy
87017a3ffc7bdd5dc5d5c9c348ca21c5
</pre></table></code></div></div><p>we fill these four solutions into the egg-o-matic to get our egg:</p><p><img src="writeupfiles/egg20.png" alt="" /></p><h2> Flag</h2><code> ICBXMH6GJqMqYDsjkaCn </code><hr><h1 id="game-set-and-hash"> Game, Set, and Hash <a href="/writeups/HackyEaster_2017/18-challenge-22-game-set-and-hash.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you beat the tennis master?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hackyeaster.hacking-lab.com:8888
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We connect to the service and see the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre>$ nc hackyeaster.hacking-lab.com 8888

Ready for the game?
y
Let's go!
5cc3f82838ba7260203e4590ce03d00e1663d41f6a5167144f5c95d6be2166a0
y
Wrong! Point for me.
----------------------
Player &gt; 0 0
Master   0 15
----------------------
75fba329cb6ee8907a1f009b69353d8c0e9a8228b25a1095c7976efc1eaa259d
k
Wrong! Point for me.
----------------------
Player &gt; 0 0
Master   0 30
----------------------
ed968e840d10d2d313a870bc131a4e2c311d7ad09bdf32b3418147221f51a6e2
h
Wrong! Point for me.
----------------------
Player &gt; 0 0
Master   0 40
----------------------
1a8d9de9490302d2d234f9c92bc2c854910ebf70c5eae016b86f03427fef03b7
h
Wrong! Point for me.
----------------------
Player   0 0
Master &gt; 1 0
----------------------
4ac2ffdb1428fe6572cb751b5b4b861563dc15978e7b140a7f5212cf69ccd35e
h
Wrong! Point for me.
----------------------
Player   0 0
Master &gt; 1 15
----------------------
5867183bb6a671e056f39df1b528221c66b7d7cd999e6660537f95fc95f8487d
</pre></table></code></div></div><p>..looks like weâ€™re playing hash tennis :)</p><p>They all appear to be hashes of the same length, and using <a href="https://crackstation.net/">crackstation</a> we find that:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>5cc3f82838ba7260203e4590ce03d00e1663d41f6a5167144f5c95d6be2166a0	sha256	office
75fba329cb6ee8907a1f009b69353d8c0e9a8228b25a1095c7976efc1eaa259d	sha256	enjoy
ed968e840d10d2d313a870bc131a4e2c311d7ad09bdf32b3418147221f51a6e2	sha256	aaaaa
1a8d9de9490302d2d234f9c92bc2c854910ebf70c5eae016b86f03427fef03b7	sha256	blazer
4ac2ffdb1428fe6572cb751b5b4b861563dc15978e7b140a7f5212cf69ccd35e	sha256	sharapova
5867183bb6a671e056f39df1b528221c66b7d7cd999e6660537f95fc95f8487d	sha256	m080617
</pre></table></code></div></div><p>ok, so theyâ€™re SHA-256 hashes, and they look to be mostly strings commonly found on wordlists ..this shouldnâ€™t be too bad.</p><p>To speed this process up, we use this python implementation of crackstationâ€™s hash lookup tables https://github.com/molochâ€“/hashlookup.</p><p>We use a wordlist (hashkiller), index it, sort the index:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="nv">$ </span>git clone git clone git@github.com:moloch--/hashlookup.git

<span class="nv">$ </span><span class="nb">cd </span>hashlookup

<span class="c"># we used hashkiller's list as wordlist.txt here</span>
<span class="nv">$ </span>./createidx.py <span class="nt">-a</span> sha2-256 <span class="nt">-w</span> wordlist.txt

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Creating Secure Hashing Algorithm 2 <span class="o">(</span>256 bit<span class="o">)</span> index ...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Reading wordlist.txt ...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Completed index file hashkiller.com-sha2-256.idx
<span class="o">[</span><span class="nv">$]</span> All Done.

<span class="nv">$ </span>make

<span class="nv">$ </span>./sortidx <span class="nt">-r</span> 2048 wordlist-sha2-256.idx
Sorting file hashkiller.com-sha2-256.idx ...

<span class="c"># let's test one</span>
<span class="nv">$ </span>./LookupTable.py <span class="nt">-a</span> sha2-256 <span class="nt">-i</span> wordlist-sha2-256.idx <span class="nt">-w</span> wordlist.txt <span class="nt">-c</span> 5cc3f82838ba7260203e4590ce03d00e1663d41f6a5167144f5c95d6be2166a0

		<span class="k">***</span> Results <span class="k">***</span>

0<span class="o">)</span>  5cc3f82838ba7260203e4590ce03d00e1663d41f6a5167144f5c95d6be2166a0 -&gt; office
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Total lookup <span class="nb">time</span>: 0.000882
<span class="o">[</span><span class="nv">$]</span> Cracked 1 of 1 <span class="o">(</span>100.00%<span class="o">)</span>
</pre></table></code></div></div><p>awesome, this works, and is fast, letâ€™s use it to play some tennis:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">telnetlib</span>
<span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">'</span><span class="s">hashlookup</span><span class="sh">'</span><span class="p">)</span>
<span class="kn">from</span> <span class="n">LookupTable</span> <span class="kn">import</span> <span class="n">LookupTable</span>

<span class="n">server</span> <span class="o">=</span> <span class="sh">"</span><span class="s">hackyeaster.hacking-lab.com</span><span class="sh">"</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">8888</span>

<span class="c1"># start the match
</span><span class="n">tn</span> <span class="o">=</span> <span class="n">telnetlib</span><span class="p">.</span><span class="nc">Telnet</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
<span class="k">print</span> <span class="n">tn</span><span class="p">.</span><span class="nf">read_until</span><span class="p">(</span><span class="sh">"</span><span class="s">Ready for the game?</span><span class="sh">"</span><span class="p">)</span>
<span class="n">tn</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">"</span><span class="s">y</span><span class="se">\n</span><span class="sh">"</span> <span class="p">)</span>
<span class="k">print</span> <span class="n">tn</span><span class="p">.</span><span class="nf">read_until</span><span class="p">(</span><span class="sh">"</span><span class="s">Let</span><span class="sh">'</span><span class="s">s go!</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>


<span class="n">l</span> <span class="o">=</span> <span class="nc">LookupTable</span><span class="p">(</span><span class="sh">'</span><span class="s">sha2-256</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">wordlist-sha2-256.idx</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">wordlist.txt</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># play the game
</span><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="c1"># get it
</span>    <span class="n">h</span> <span class="o">=</span> <span class="n">tn</span><span class="p">.</span><span class="nf">read_until</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">).</span><span class="nf">strip</span><span class="p">()</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">h: </span><span class="sh">"</span><span class="o">+</span><span class="n">h</span>

    <span class="c1"># crack it
</span>    <span class="n">t</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="nf">get_all</span><span class="p">([</span><span class="n">h</span><span class="p">])</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">h</span><span class="p">])</span>

    <span class="c1"># return it
</span>    <span class="k">print</span> <span class="sh">"</span><span class="s">Sending answer: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">t</span>
    <span class="n">tn</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span> <span class="p">)</span>

    <span class="c1"># print scoreboard
</span>    <span class="k">print</span> <span class="n">tn</span><span class="p">.</span><span class="nf">read_until</span><span class="p">(</span><span class="sh">"</span><span class="s">----------------------</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">tn</span><span class="p">.</span><span class="nf">read_until</span><span class="p">(</span><span class="sh">"</span><span class="s">----------------------</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">tn</span><span class="p">.</span><span class="nf">read_until</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><p>we run this and win the game!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre><td class="rouge-code"><pre>$ python chall22_tennis.py
Ready for the game?

Let's go!

h: a1bd1312d23002be258c9bb4642bbea77580353869a8ee8844e6940b7e0278b7
Sending answer: qweasd
Correct! Point for you.
----------------------

Player &gt; 0 15
Master   0 0
----------------------


h: 1f8b6d5a89242a0984816601b1a527ed239e16e213182481301d2706f4396703
Sending answer: 4444444
Correct! Point for you.
----------------------

Player &gt; 0 30
Master   0 0
----------------------


h: c90d569a30a14c7da4fcd1347792813a87d982c995f8376411d361289f161e09
Sending answer: None
Wrong! Point for me.
----------------------

Player &gt; 0 30
Master   0 15
----------------------


h: f527721c54550e8a0a7aac8da3116976e0b8f3083d67b614d169e15f3df1a76a
Sending answer: estefania
Correct! Point for you.
----------------------

Player &gt; 0 40
Master   0 15
----------------------


[..]

h: c9bf553d456365516965e2977ec01d38ae7d30d57fae2c99aee02bea6f61ec32
Sending answer: teamo2.
Correct! Point for you.
----------------------

Player   6 6 5 30
Master &gt; 0 0 0 0
----------------------


h: 08a5c5fd12ecee53f4217d0b44369537c27389f7a75711028f5a1ad94845cccf
Sending answer: bangfist
Correct! Point for you.
----------------------

Player   6 6 5 40
Master &gt; 0 0 0 0
----------------------


h: 62fff1a28571a19d7a3126cbf190bc33e9115511d2ee4d6d5e8111410f0e93be
Sending answer: tre2ike
Correct! Point for you.
----------------------

Player &gt; 6 6 6
Master   0 0 0
----------------------


h: You win! Solution is: !stan-the_marth0n$m4n
</pre></table></code></div></div><p>we put the string <code class="language-plaintext highlighter-rouge">!stan-the_marth0n$m4n</code> into the egg-o-matic to get our egg:</p><p><img src="writeupfiles/egg22.png" alt="" /></p><h2> Flag</h2><code> fl3uB75EGl1sadBNycvx </code><hr></div><script> document.addEventListener("DOMContentLoaded", () => { console.log("Hello World!"); tocbot.init({ tocSelector: '#toc', contentSelector: '.post-content', ignoreSelector: '[data-toc-skip]', headingSelector: 'h1', orderedList: false, scrollSmooth: false, }); }); </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li> <a href="/posts/text-and-typography/">Text and Typography</a><li> <a href="/posts/write-a-new-post/">Writing a New Post</a><li> <a href="/posts/getting-started/">Getting Started</a><li> <a href="/posts/customize-the-favicon/">Customize the Favicon</a><li> <a href="/posts/enable-google-pv/">Enable Google Page Views</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tag/image/">image</a> <a class="post-tag" href="/tag/rsa/">RSA</a> <a class="post-tag" href="/tag/lsb/">LSB</a> <a class="post-tag" href="/tag/cipher/">cipher</a> <a class="post-tag" href="/tag/pcap/">pcap</a> <a class="post-tag" href="/tag/audio/">audio</a> <a class="post-tag" href="/tag/aws/">aws</a> <a class="post-tag" href="/tag/bash/">bash</a> <a class="post-tag" href="/tag/binwalk/">binwalk</a> <a class="post-tag" href="/tag/crib-dragging/">crib dragging</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tag/image/">image</a> <a class="post-tag" href="/tag/rsa/">RSA</a> <a class="post-tag" href="/tag/lsb/">LSB</a> <a class="post-tag" href="/tag/cipher/">cipher</a> <a class="post-tag" href="/tag/pcap/">pcap</a> <a class="post-tag" href="/tag/audio/">audio</a> <a class="post-tag" href="/tag/aws/">aws</a> <a class="post-tag" href="/tag/bash/">bash</a> <a class="post-tag" href="/tag/binwalk/">binwalk</a> <a class="post-tag" href="/tag/crib-dragging/">crib dragging</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://github.com/shiltemann">Team Galaxians</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
